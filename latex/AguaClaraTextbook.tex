%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Acknowledgements}}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{0}


        \usepackage{cancel}
    

\title{AguaClara Textbook Documentation}
\date{Jun 01, 2020}
\release{0.068}
\author{AguaClara Cornell}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}


This textbook is written and maintained in \sphinxhref{https://github.com/AguaClara/Textbook}{Github} via \sphinxhref{http://www.sphinx-doc.org/en/master/}{Sphinx}. It uses and refers to AguaClara code and functions in \sphinxhref{https://github.com/AguaClara/aguaclara}{aguaclara}. Listed below are the versions of the programs we use:


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{These are the software versions used to compile this textbook}\label{\detokenize{index:id2}}\label{\detokenize{index:software-versions}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{10}{20}|\X{10}{20}|}
\hline
\sphinxstyletheadfamily 
Software
&\sphinxstyletheadfamily 
version
\\
\hline
Sphinx
&
1.7.5
\\
\hline
aguaclara
&
0.1.8
\\
\hline
Anaconda
&
4.5.4
\\
\hline
Python
&
3.6.5
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\chapter{Acknowledgements}
\label{\detokenize{Acknowledgements:acknowledgements}}\label{\detokenize{Acknowledgements:id1}}\label{\detokenize{Acknowledgements::doc}}
We gratefully acknowledge the funding provided by the Environmental Protection Agency and the National Science Foundation. Together they have provided over \$1 million in support of developing the next generation of sustainable drinking water treatment technologies.


\section{Environmental Protection Agency statement}
\label{\detokenize{Acknowledgements:environmental-protection-agency-statement}}
“This textbook was developed under numerous Assistance Agreements awarded by the U.S. Environmental Protection Agency to Cornell University. It has not been formally reviewed by EPA. The views expressed in this document are solely those of the authors and do not necessarily reflect those of the Agency. EPA does not endorse any products or commercial services mentioned in this publication.”

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{961a201f5bb2324746e0904245efc79fe2157900}.jpg}
\label{\detokenize{Acknowledgements:figure-nsf-logo}}\end{figure}


\section{National Science Foundation statement}
\label{\detokenize{Acknowledgements:national-science-foundation-statement}}
This material is based upon work supported by the National Science Foundation under Grant numbers CBET-1704472 and CBET-1437961. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the National Science Foundation.


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Table of funded research projects that contributed to the knowledge in this textbook.}\label{\detokenize{Acknowledgements:id2}}\label{\detokenize{Acknowledgements:table-funded-proposals}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{30}{180}|\X{150}{180}|}
\hline
\sphinxstyletheadfamily 
Agency
&\sphinxstyletheadfamily 
Proposal Title
\\
\hline
NSF
&
Wrf: Experimental Observation and Modeling of Coagulant Mediated Contaminant Removal: Flocculation, Floc Blankets, and Sedimentation
\\
\hline
USEPA
&
AguaClara’s Ram Pump for Zero Electricity Drinking Water Treatment
\\
\hline
USEPA
&
Environment \& Community Friendly Wastewater Treatment
\\
\hline
USEPA
&
High Rate Sedimentation
\\
\hline
USEPA
&
Novel Reactor Design for Enhanced Removal of Fluoride Using A Modified Nalgonda Method
\\
\hline
USEPA
&
Novel Reactor Design for Enhanced Removal of Fluoride Using A Modified Nalgonda Method
\\
\hline
NSF
&
Experimental Evaluation And Modeling Of Hydraulic Flocculation Systems Under Conditions of Turbulent Flow
\\
\hline
USEPA
&
Application of Foam Filtration to Water Treatment for Rapid Emergency Response
\\
\hline
USEPA
&
Stacked Rapid Sand Filtration - A Robust Filtration Process for Sustainable Drinking Water
\\
\hline
USEPA
&
Sustainable Water Treatment Facility for Communities with Arsenic Contaminated Groundwater
\\
\hline
USEPA
&
Smart Turbidimeters for Remote Monitoring of Water Quality
\\
\hline
USEPA
&
Stacked Rapid Sand Filtration - A Robust Filtration Process for Sustainable Drinking Water Infrastructure
\\
\hline
USEPA
&
Developing A Point-of-Use Filter Utilizing Polyurethane Foam
\\
\hline
USEPA
&
Dose Controller for AguaClara Water Treatment Plants
\\
\hline
USEPA
&
Dose Controller for AguaClara Water Treatment Plants
\\
\hline
USEPA
&
AguaClara: Clean Water for Small Communities
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}
\begin{description}
\item[{More gratitude below!}] \leavevmode\begin{itemize}
\item {} 
Ken Brown and the Sanjuan Foundation

\item {} 
Duane Stiller

\item {} 
Countless other donors whose contributions have made it possible to develop new technologies and share those technologies with partner organizations and communities

\item {} 
Many hundreds of students who gave their time and creativity so that others could have safe water on tap

\item {} 
The Swiss Development Cooperation that has funded the construction of 5 AguaClara plants in Honduras and 2 in Nicaragua

\item {} 
The Cornell Engineering that provided generous funding in the startup years.

\end{itemize}

\end{description}


\chapter{Authors}
\label{\detokenize{Authors:authors}}\label{\detokenize{Authors:title-authors}}\label{\detokenize{Authors::doc}}
This text is a collaborative effort involving hundreds of people. Innovation requires collisions of ideas and the AguaClara program was designed to foster global and multidisciplinary interactions between students, faculty, field engineers, plant operators, implementation partner organizations, and community members. These interactions have provided a continuous and rich source of ideas that make it clear that in a social network it is impossible for anyone to claim ownership of an idea. Thus the inventions, equations, and reactor designs that are described in this text are the product of a large, collaborative, open-source community and none of us can claim that we are the sole authors. The list of authors below have contributed directly to this text.
\begin{itemize}
\item {} 
Monroe Weber-Shirk

\item {} 
Juan Guzman

\item {} 
Clare O’Connor

\item {} 
William Pennock

\item {} 
Leonard Lion

\item {} 
Yingda Du

\item {} 
Zoe Maisel

\item {} 
Justin Conneely

\end{itemize}

This text would not have been possible without the advice, mentoring, and publishing system assembled by Ethan Keller.


\chapter{Introduction to AguaClara Water Treatment Design}
\label{\detokenize{Introduction/Introduction:introduction-to-aguaclara-water-treatment-design}}\label{\detokenize{Introduction/Introduction:title-introduction-to-aguaclara-water-treatment-design}}\label{\detokenize{Introduction/Introduction::doc}}

\section{A Different Kind of Textbook}
\label{\detokenize{Introduction/Introduction:a-different-kind-of-textbook}}\label{\detokenize{Introduction/Introduction:heading-a-different-kind-of-textbook}}
This textbook represents our cumulative insights from our journey that has been motivated by a quest to make the world a better place where everyone has access to safe water on tap, the engineering challenge of optimizing the design of drinking water treatment plants, and the curiosity to understand what controls their performance. We would like to understand what determines which contaminants make it the whole way through a water treatment plant. If we could understand what allows some contaminants to sneak the whole way through a water treatment plant, then we suspect that we could create better designs to more effectively remove contaminants.

Engineering textbooks provide a venue for authors to share what they’ve learned, to organize ideas, and to provide a guide for engineers as they design solutions for real world problems. Engineering textbooks are often intended to document the established core of knowledge. It seems reasonable to assume that what is in textbooks and in peer reviewed literature is mostly true.


\subsection{The edge of knowledge may be closer than we thought}
\label{\detokenize{Introduction/Introduction:the-edge-of-knowledge-may-be-closer-than-we-thought}}\label{\detokenize{Introduction/Introduction:heading-edge-of-knowledge}}
The assumption that what is written and passed down in oral history through the scientific community is true can lead to missed opportunities and lost insights. The hypotheses from one generation of scientists can too easily evolve into new theories in the next generation and then into established theories for the next. The history of drinking water treatment science is cloudy (think high turbidity!) with hypotheses that miss or misrepresent key concepts.

You might wonder why we care so much about getting the science right and being as clear as possible about what is known. After all, the core drinking water treatment technologies were invented before we were born and many of us have safe drinking water coming from our taps. Environmental Engineers have known how to design municipal drinking water treatment plants since they early 1900’s. We care about getting the science right because we hypothesize that there are many opportunities to significantly improve drinking water treatment technologies and that improved understandings of each unit process have the potential to lead to new breakthroughs.

Our contention is that no one has ever optimized the design of a drinking water treatment plant! We are reasonably certain of this because we don’t yet have models (with equations) that describe performance of most of the core unit processes (rapid mix, flocculation, floc blankets, sedimentation, sand filtration) used for surface water treatment. The only possible exception is lamellar sedimentation which can be characterized if we know the size and density distribution of the particles entering the sedimentation tank.

Traditional drinking water treatment textbooks can too easily miss the opportunity to advance the science of drinking water treatment technologies by presenting certainty where there should be skepticism. For example, rapid mix is described as process that occurs in a few seconds, flocculation is described as a process that should be fastest for high turbidity waters and slowest for low turbidity waters, and filtration performance is described by a model that predicts first order removal with respect to filter bed depth. We will demonstrate why each of these assumptions doesn’t match observations, we will discuss new insights into these processes, and we will identify high priority research questions that have the potential to lead to major improvements in drinking water treatment.

We want to encourage skepticism and we want to develop insights to guide thoughtful skepticism. A key skill for successful engineering is the ability to identify the location of the edge of knowledge. The ability to distinguish between what is reasonably certain and what is still in question is what powers the scientific method of slowly extending knowledge. New insights are difficult to obtain if the research is based on a faulty premise.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{Short_walk_to_the_edge}.jpg}
\caption{We’ve learned that we can find the edge of knowledge very soon after we begin researching a water treatment technology (artwork created by Yi Wen Ng in 2012).}\label{\detokenize{Introduction/Introduction:id12}}\label{\detokenize{Introduction/Introduction:figure-short-walk}}\end{figure}

There are significant knowledge gaps in every process that we cover in this textbook. We aren’t yet able to optimize surface water treatment processes because we don’t yet understand the fundamental physics of many of the processes. We are getting closer, join us on the journey.

We need the brightest and the best to create new and better solutions so we can meet the goal of providing everyone with safe drinking water. This challenge is apparently more difficult than building a space station, designing a fuel cell, or inventing the world wide web. So let’s role up our sleeves and begin.


\subsection{Tools to Find the Edge of Knowledge}
\label{\detokenize{Introduction/Introduction:tools-to-find-the-edge-of-knowledge}}\label{\detokenize{Introduction/Introduction:heading-tools-to-find-the-edge-of-knowledge}}\begin{quote}
\begin{itemize}
\item {} 
Don’t believe everything we say

\item {} 
Ask lots of questions

\end{itemize}
\begin{itemize}
\item {} 
How do you know that? The goal here is to identify the difference between what is known and what is hypothesized.

\item {} 
What is the equation that describes the physics of this process? If there isn’t an equation that describes the process and that can be used to design the reactor for the process, then it is likely that the physics of the process is not yet understood.

\item {} 
How could we improve this process? If the physics of a process are fully understood, then dimensionally correct equations can be used to obtain the optimal design for that process.

\item {} 
Is the process design based on “rules of thumb” or on physics? “Rules of thumb” or empirical design guidelines often can be identified by the use of physical parameters that have units. For example, if the design guideline specifies a length, time, or velocity then it is likely that the guideline is not based on physics. If the design guidelines are based on a dimensionless parameter then it is possible that it is based on physics.

\end{itemize}
\begin{itemize}
\item {} 
Evaluate the data to see if it matches predictions of the hypothesized model. Assess whether the authors acknowledge when their data doesn’t match hypothesized models.

\item {} 
Beware of the use of words that are poorly defined and that hide uncertainty. For example, creating a name for a supposed mechanism to describe all of the observations that don’t fit with your theory does NOT mean that you understand that mechanism. The ability to name something doesn’t mean it is understood.

\item {} 
Does this “theory” provide insights that have led to new discoveries or new applications?

\item {} 
Does the “theory” include equations that are based on the fundamental laws of nature?

\item {} 
Does the “theory” use dimensionless constants that are close to one?

\item {} 
Is it an elegant “theory” with no need for special cases?

\end{itemize}
\end{quote}


\subsection{Myth in Environmental Engineering}
\label{\detokenize{Introduction/Introduction:myth-in-environmental-engineering}}\label{\detokenize{Introduction/Introduction:heading-myth-in-environmental-engineering}}\begin{description}
\item[{The following list is designed to get you thinking. These are concepts that are present in the Environmental Engineering community and that may capture some elements of truth and that may also further misconceptions.}] \leavevmode\begin{itemize}
\item {} 
Dead bodies cause disease

\item {} 
Slow sand filters ripen (improve in ability to remove contaminants over time) because of biological growth in the filter bed

\item {} 
If a 20 cm deep sand filter removes 90\% of influent particles, then a 40 cm deep filter will remove 99\% of influent particles

\item {} 
If water is dirty, then you should filter it

\item {} 
Chlorine disinfects dirty water and makes it safe to drink

\item {} 
Chlorination and filtration eliminated typhoid fever from the US

\item {} 
Cessation of chlorination due to fear of disinfection by products caused the cholera outbreak in Peru in 1993

\item {} 
Sedimentation is simple

\item {} 
We already know how to solve the problem of the billions of people who do not having access to safe drinking water

\end{itemize}

\end{description}


\subsection{Uncertainty in Science and Engineering}
\label{\detokenize{Introduction/Introduction:uncertainty-in-science-and-engineering}}\label{\detokenize{Introduction/Introduction:heading-uncertainty-in-science-and-engineering}}
A challenge for authors is to recognize the difference between what is known with a reasonably high degree of certainty and what is assumed to be true without a solid basis. We struggle to tell the difference between fact and hypothesis. The time-honored approach in science is to rely on the peer review process. That process for vetting knowledge has been shown to be flawed.

Your question could be whether the distinction between fact and hypothesis really matters. If the hypothesis is widely accepted as fact and if it has been accepted for decades what benefit is there to calling it a hypothesis rather than a fact?

This question is at the core of our educational philosophy. Is this text the repository of knowledge that we are providing for you to drink or is this text a conversation where we invite you to join the effort to discover better ways to provide safe water on tap?


\subsection{Integrating Educational Philosophy with an Evolving Textbook}
\label{\detokenize{Introduction/Introduction:integrating-educational-philosophy-with-an-evolving-textbook}}\label{\detokenize{Introduction/Introduction:heading-textbook-philosophy}}
This is an evolving textbook. We don’t intend to ever print this book. This book has version numbers just like software with the idea that revisions are rapid and frequent. We commit to helping to accelerate the pace of knowledge generation and to revising this text as you help us identify places where we have presented hypotheses as theory and places where research provides a basis for better theoretical models of the water treatment processes.

Our students are co-creators of knowledge and not empty vessels to be filled with our wisdom. AguaClara technologies are inventions that are the result of idea collisions in the AguaClara labs and from observations and reflections with operators, technicians, and engineers in dozens of water treatment plants. Although we’ve learned a great deal about water treatment since 2005 when AguaClara was founded, there is still much more to be learned. And so it is with a spirit of curiosity that we write this textbook expecting to learn even more in the coming years.

Socrates said “\sphinxhref{https://www.goodreads.com/quotes/69267-education-is-the-kindling-of-a-flame-not-the-filling}{Education is the kindling of a flame, not the filling of a vessel}.” Our goal is to bring the spirit of play, discovery, and mystery into the challenge of improving the quality of life of everyone on the planet by sharing better methods to produce safe drinking water.

In We Make the Road by Walking: Conversations on Education and Social Change, Paulo Freire said,
“\sphinxhref{https://www.goodreads.com/author/quotes/41108.Paulo\_Freire?page=2}{The more we become able to become a child again, to keep ourselves childlike, the more we can understand…}”. We commit to playing together in a relationship where we are all learning and we are all teaching. “Education must begin with the solution of the teacher-student contradiction, by reconciling the poles of the contradiction so that both are simultaneously teachers and students.” - Paulo Freire


\subsection{Respect, Empathy, Love and Curiosity power the AguaClara Innovation System}
\label{\detokenize{Introduction/Introduction:respect-empathy-love-and-curiosity-power-the-aguaclara-innovation-system}}\label{\detokenize{Introduction/Introduction:heading-empathy}}
The AguaClara network of organizations has been methodically inventing improved water treatment technologies since 2005. Our success is based on respect, empathy and love. Innovation requires flocculation of ideas. The transport of ideas between organizations and individuals is mediated by respect. Respect as a cornerstone of organizational culture foster rapid and honest exchange of ideas. The rapid pace of innovation in the AguaClara network is sustained thru a shared culture of respect, empathy, and love.

Curiosity can flourish in a culture of love, respect, and empathy. Asking why and why not and pondering an ever growing number of questions has empowered student teams to take on the quest for new knowledge and new solutions.
\begin{description}
\item[{Any large organization will require a leadership hierarchy and any hierarchy will rely on respect based on fear or respect based on love. \sphinxhref{https://www.forbes.com/sites/lizryan/2015/11/25/the-five-characteristics-of-fear-based-leaders/\#a6179f38a968}{Fear-based hierarchies} impede the accurate sharing of information and can easily devolve into data-free and low-truth decision-making schemes. According to \sphinxhref{https://www.forbes.com/sites/lizryan/2015/11/25/the-five-characteristics-of-fear-based-leaders/\#a6179f38a968}{Liz Ryan}, the characteristics of fear-based leaders include:}] \leavevmode\begin{itemize}
\item {} 
They’ll Teach You, Whether You Like It or Not

\item {} 
Everyone is a Friend or a Foe

\item {} 
It’s All about the Trophies

\item {} 
They Don’t Step Outside Boxes

\item {} 
They’re Addicted to Yardsticks

\end{itemize}

\end{description}

Love-based hierarchies foster honesty and a free-flow of information. Reflection is encouraged across the organization and truth, honesty, and integrity are valued. Staff at the bottom of the hierarchy know that their opinions and reflections are valued and thus they will be willing to report problems to organization leaders and share their ideas.

Love-based leaders relate to others based on true respect for the other. They will take the time to converse with people at all levels of the organization and will value the opportunity to speak with people who are the interface between the organization and the rest of the world. A person’s value is based on being a person, not based on position in the hierarchy.

As water treatment plant designers it is critical that we spend time with a diverse set of stakeholders including community members and water treatment plant operators. Those relationships must begin with respect and valuing their insights. As we spend time together we can develop trust so that they communicate both the good and bad.

We’ve learned much from plant operators. They figured out how to reduce rising flocs at Agalteca, Honduras where we learned that conventional sedimentation tank inlet manifolds generate large circulation currents. Plant operators added curtains to the windows at Moroceli, Honduras (see \hyperref[\detokenize{Introduction/Introduction:figure-moroceli-curtains}]{Fig.\@ \ref{\detokenize{Introduction/Introduction:figure-moroceli-curtains}}}) because they noticed that direct sunlight on the sedimentation tanks caused an increase in settled water turbidity.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{Moroceli_curtains}.jpg}
\caption{Moroceli AguaClara water treatment plant operators installed curtains to reduce direct sunshine on sedimentation tanks. Solar heating produces density currents that carry flocs to the top of the sedimentation tank.}\label{\detokenize{Introduction/Introduction:id13}}\label{\detokenize{Introduction/Introduction:figure-moroceli-curtains}}\end{figure}

Empathy is fundamental in design. Empathy enables us to consider reality from another’s perspective. Empathy enables us to bring the people who will use or benefit from a technology into the design considerations. Empathy brings the insight that water treatment plants need to have roofs and provide a secure work environment both day and night. Empathy brings the insight that replacement parts must be readily available and that generic components are preferred over specialty proprietary components.


\section{The Global Context for Drinking Water Treatment}
\label{\detokenize{Introduction/Introduction:the-global-context-for-drinking-water-treatment}}\label{\detokenize{Introduction/Introduction:heading-the-global-context-for-drinking-water-treatment}}
The \sphinxhref{https://www.un.org/sustainabledevelopment/sustainable-development-goals/}{Sustainable Development Goals: SDGs} and specifically \sphinxhref{https://www.un.org/sustainabledevelopment/water-and-sanitation/}{SDG 6} provide the context and motivation for this text. The first SDG 6 target is: “By 2030, achieve universal and equitable access to safe and affordable drinking water for all.” That goal is daunting and won’t be met using the approaches of the past 5 decades. This text is about creating a new paradigm for the design of high performing water treatment technologies with the goal of making a real contribution toward SDG 6.1.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=100\sphinxpxdimen]{{SDG6}.png}
\caption{Sustainable development goal 6 is all about clean water and sanitation.}\label{\detokenize{Introduction/Introduction:id14}}\label{\detokenize{Introduction/Introduction:figure-sdg6}}\end{figure}

The number of people who currently lack access to reliable safe water on tap is not known. Estimates range from “\sphinxhref{https://www.un.org/sustainabledevelopment/water-and-sanitation/}{1.8 billion who use a source of drinking water that is contaminated with feces}” to the Centers for Disease Control recommendations for where it is \sphinxhref{https://lifehacker.com/know-what-countries-guarantee-drinkable-tap-water-with-1635070463}{usually safe to drink tap water}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{CDC_Global_Safe_Tap_Water}.png}
\caption{There are relatively few countries where it is almost always safe to drink the tap water.}\label{\detokenize{Introduction/Introduction:id15}}\label{\detokenize{Introduction/Introduction:figure-cdc-global-safe-tap-water}}\end{figure}

The \sphinxhref{https://www.un.org/sustainabledevelopment/blog/2017/07/billions-around-the-world-lack-safe-water-proper-sanitation-facilities-reveals-un-report/}{UN estimate in 2017} was that 2.1 billion lack access to safe water. By 2030 there will be an additional \sphinxhref{https://news.un.org/en/story/2015/07/505352-un-projects-world-population-reach-85-billion-2030-driven-growth-developing}{1.2 billion from population growth}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Population_Infographic_01}.jpg}
\caption{1.2 billion people will be added to the global population between 2015 and 2030.}\label{\detokenize{Introduction/Introduction:id16}}\label{\detokenize{Introduction/Introduction:figure-population-infographic-01}}\end{figure}

Thus by 2030 we need to provide safe water for at least 3.3 billion people AND maintain the water supply systems for the 5.2 billion who currently have access to safe water. That is a daunting number that requires some exploration!

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{datetime}
\PYG{n}{People\PYGZus{}needing\PYGZus{}water\PYGZus{}2030} \PYG{o}{=} \PYG{l+m+mf}{3.3}\PYG{o}{*}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{9}
\PYG{n}{now} \PYG{o}{=} \PYG{n}{datetime}\PYG{o}{.}\PYG{n}{datetime}\PYG{o}{.}\PYG{n}{now}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{Task\PYGZus{}time} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{2030} \PYG{o}{\PYGZhy{}} \PYG{n}{now}\PYG{o}{.}\PYG{n}{year}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{year}
\PYG{c+c1}{\PYGZsh{}If we assume we will meet this demand by building the same amount of new capacity each year, then we have}
\PYG{n}{People\PYGZus{}per\PYGZus{}year} \PYG{o}{=} \PYG{n}{People\PYGZus{}needing\PYGZus{}water\PYGZus{}2030}\PYG{o}{/}\PYG{n}{Task\PYGZus{}time}
\PYG{n}{People\PYGZus{}per\PYGZus{}year}
\PYG{c+c1}{\PYGZsh{}The percapita demand for water}
\PYG{n}{Per\PYGZus{}capita\PYGZus{}demand} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Per\PYGZus{}capita\PYGZus{}demand}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{day}\PYG{p}{)}
\PYG{n}{Per\PYGZus{}capita\PYGZus{}demand}
\PYG{n}{Rate\PYGZus{}new\PYGZus{}water\PYGZus{}supply\PYGZus{}capacity} \PYG{o}{=} \PYG{p}{(}\PYG{n}{People\PYGZus{}per\PYGZus{}year} \PYG{o}{*} \PYG{n}{Per\PYGZus{}capita\PYGZus{}demand}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{year}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Rate\PYGZus{}new\PYGZus{}water\PYGZus{}supply\PYGZus{}capacity}
\PYG{n}{NYC\PYGZus{}water\PYGZus{}supply} \PYG{o}{=} \PYG{l+m+mi}{44000} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{NYC\PYGZus{}per\PYGZus{}year} \PYG{o}{=} \PYG{n}{Rate\PYGZus{}new\PYGZus{}water\PYGZus{}supply\PYGZus{}capacity}\PYG{o}{/}\PYG{n}{NYC\PYGZus{}water\PYGZus{}supply}
\PYG{n}{NYC\PYGZus{}per\PYGZus{}year}
\end{sphinxVerbatim}

If we provide 260 L/day per person, then we need to provide the equivalent of 19 water supplies for New York City every year between now and 2030. The planet needs approximately 800,000 L/s of new capacity each year. AguaClara water treatment plants cost approximately \$10,000 per L/s of treatment capacity. Thus the budget for global water treatment needs to be 8 billion USD per year. Note that this doesn’t include any other aspects of supplying water. Managing water sources, transmission lines, storage, and distribution systems are even more expensive than water treatment.

The need for drinking water supplies isn’t limited to the global south. The California Urban Water Agencies \sphinxhref{https://static1.squarespace.com/static/5a565e93b07869c78112e2e5/t/5a5965934192024b3f610be1/1515808194305/CUWA2017\_AnnualReport.pdf}{estimate that 530,000 or more people in rural areas of California are unable to turn on their tap and access clean, safe water}.


\subsection{Why don’t 2 billion people have access to safe water?}
\label{\detokenize{Introduction/Introduction:why-don-t-2-billion-people-have-access-to-safe-water}}\label{\detokenize{Introduction/Introduction:heading-2-billion-without-access-to-safe-water}}
The simple answer is that they are too poor and are unable to afford safe water on tap. But it isn’t that simple! Families without access to safe water on tap often spend more for water than families with safe water on tap. There seem to be two key reasons why those with limited financial resources often have limited access to water, poor quality water, and yet pay a premium for that water.

The first reason for the lack of safe water has been the poor track record of water treatment infrastructure. The frequent failures and high operating costs of municipal scale water treatment systems have led many decision makers to conclude water treatment infrastructure isn’t a worthwhile investment. Politicians who invest political capital to bring water treatment to their community often find that after the initial ribbon cutting there is little political benefit because the system doesn’t deliver the benefits to the community that they had promised.

The second reason for the lack of safe water is the lack of access to capital for municipal scale infrastructure. Even though an AguaClara water treatment plant would pay for itself in a fraction of its useful life, there is not yet a financial mechanisms for communities to access a loan so that they can make the investment. A community would need to save enough money to be able to purchase a water treatment plant (as was the case for Las Vegas, Honduras), a bilateral donor can finance a plant through a donation, or the national government can use sovereign debt or taxes to finance plants. The challenge for a community is to obtain the financial or political power to access the needed funds.

As we work to solve a global challenge that has been plaguing humanity since the dawn of human civilization, then it will serve us well to understand a bit of the history that has led to our current reality. Water treatment history includes amazing successes, persistent failures, fortuitous discoveries, a heavy reliance on empiricism, and an occasional myth. Our goal is learn from and reflect on our history and then create even better solutions.


\section{Introduction to Surface Water Treatment}
\label{\detokenize{Introduction/Introduction:introduction-to-surface-water-treatment}}\label{\detokenize{Introduction/Introduction:heading-introduction-to-surface-water-treatment}}
We treat water because it doesn’t meet the requirements for its intended use. We need to understand the problem so that we can understand existing and novel water treatment technologies.


\subsection{Water Contaminants}
\label{\detokenize{Introduction/Introduction:water-contaminants}}\label{\detokenize{Introduction/Introduction:heading-water-contaminants}}
Many substances are able to dissolve in water. Additionally, water is able to carry suspended solids because of its high density. The substances may be naturally occurring, anthropogenic, benign, or harmful. The types of contaminants are influenced by the water source. Contaminant concentrations are often highly variable over time.

A water treatment system must be able to handle the likely range of contaminant levels and produce treated water that meets the user requirements. In some cases the user may have the option of switching sources or reducing demand when a source becomes excessively contaminated for a limited period of time. For example, a municipal water supplier may be able to shut the plant down for a few hours to avoid having to treat a very dirty water after a rainstorm. This strategy can work well for water sources that have small watersheds and hence a rapid return to better water after the storm passes. In other cases the water treatment processes must be capable of treating the most contaminated water that the water source provides. In any case, selecting the best unit processes to treat a given water source for a particular use case can be challenging. It is common to find water treatment plants that are unable to adequately treat their water source.


\subsubsection{Particles}
\label{\detokenize{Introduction/Introduction:particles}}\label{\detokenize{Introduction/Introduction:heading-particles}}
Surface waters (rivers, streams, lakes) and some ground water (especially ground water under the influence of surface water) inevitable carry some suspended particles. “\sphinxhref{https://www.sciencedirect.com/science/article/pii/S0048969708010103}{Particles transported by rivers are composed of resistant primary minerals (e.g., quartz and zircon), secondary minerals (clays, metallic oxides and oxyhydroxides) and biogenic remains.”} Many of these particles may be harmless, but there is good reason to be hesitant to drink water with a high concentration of suspended particles.


\subsubsection{Pathogens}
\label{\detokenize{Introduction/Introduction:pathogens}}\label{\detokenize{Introduction/Introduction:heading-pathogens}}
Pathogens include viruses (100 nm), bacteria (1 \(\mu m\)), and protozoa (several \(\mu m\)). Pathogens are particles and are removed by processes that remove particles along with other microbes, organic and inorganic particles.


\subsubsection{Turbidity}
\label{\detokenize{Introduction/Introduction:turbidity}}\label{\detokenize{Introduction/Introduction:heading-turbidity}}
Turbidity or cloudiness is an indirect measure of particle concentration. Turbidity is an optical measurement of scattered light. Light scattering by refraction is primarily caused by particles that are smaller than but close to the wavelength of light. Particles that are close to but larger than the wavelength of light can reflect light. Turbidity measures both of these effects by shining a light into a water sample and then measuring the scattered light with a photodetector at 90°. The meter is then calibrated with standard suspensions.

For a given suspension the turbidity can be directly correlated with the suspended solids concentration. However, that relationship is complicated because the amount of scattered light is related to the particle size distribution because given the same mass concentration, smaller particles have more surface area and thus reflect more light.

Although turbidity would seem to be an odd parameter to use to measure water quality, it turns out to be the most widely used water quality measurement. The reasons are simple. First, turbidity is amazingly easy to measure over a very wide range of particle concentrations (perhaps 10 \(\mu g/L\) to 1 \(g/L\)). The test doesn’t require any reagents and it can be done in a flow through sample cell for real time measurements. Second, particle free water is pathogen free water. Third, disinfection processes (chlorination, ozonation, UV light) are all significantly less effective at inactivating pathogens if there are other particles present in the water.


\subsubsection{Dissolved Species}
\label{\detokenize{Introduction/Introduction:dissolved-species}}\label{\detokenize{Introduction/Introduction:heading-dissolved-species}}
The list of dissolved species that can be present in water in the environment is endless and ranges from natural organic matter (from decay of plants) to caffeine to atrazine. Usually the highest concentration class of molecules is dissolved natural organic matter (NOM). NOM has some similarity to inorganic particles in that it isn’t necessarily harmful and yet there are several reasons why removal of NOM is an important water treatment goal.

From an aesthetic perspective, NOM absorbs light at short wavelengths and this results in water that looks yellow or brown. While I enjoy drinking tea with a rich brown color, I’d prefer that my water be clear.
\begin{description}
\item[{NOM plays a supersized role in influencing performance of surface water treatment plants. NOM has three negative effects:}] \leavevmode\begin{enumerate}
\item {} 
It requires higher dosages of coagulant for effective particle removal.

\item {} 
It reduces the disinfection effectiveness of chlorine, ozone, and UV. Chlorine partially oxidizes the NOM and thus more chlorine must be used to maintain a residual level of chlorine.

\item {} 
It can produce disinfection by-products that are toxic.

\end{enumerate}

\end{description}

Thus removal of NOM is a water treatment goal. Fortunately the same coagulants that are used for particle removal also can remove a significant fraction of NOM. The interactions between NOM and coagulants will be discussed in the {\hyperref[\detokenize{Rapid_Mix/RM_Intro:title-rapid-mix-introduction}]{\sphinxcrossref{\DUrole{std,std-ref}{Introduction to Rapid Mix}}}}.

The removal of other dissolved species is beyond the scope of the first release of this textbook. The authors intend to add sections on the removal of some dissolved species in the near future.


\subsection{Chlorine (Might Have) Saved the World}
\label{\detokenize{Introduction/Introduction:chlorine-might-have-saved-the-world}}\label{\detokenize{Introduction/Introduction:heading-chlorine-saved-the-world}}
Chlorine is widely recognized for reducing mortality from water borne disease in the United States. A more careful review of the mortality data and of the ability of chlorine to inactive various pathogens makes it difficult to assess the role of chlorine. A classic graph (see \hyperref[\detokenize{Introduction/Introduction:figure-us-death-rate}]{Fig.\@ \ref{\detokenize{Introduction/Introduction:figure-us-death-rate}}}) has been used to suggest that chlorination of drinking water supplies resulted in a significant reduction in mortality

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{US_infectious_diseases_death_rate}.jpg}
\caption{\sphinxhref{https://www.cdc.gov/mmwr/preview/mmwrhtml/mm4829a1.htm}{Classic graph showing the reduction in the death rate for the United States from 1900 to 1996.}}\label{\detokenize{Introduction/Introduction:id17}}\label{\detokenize{Introduction/Introduction:figure-us-death-rate}}\end{figure}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Surface Water Treatment Technologies}\label{\detokenize{Introduction/Introduction:id18}}\label{\detokenize{Introduction/Introduction:table-surface-water-treatment-technologies}}
\sphinxaftercaption
\begin{tabular}[t]{|*{5}{\X{1}{5}|}}
\hline
\sphinxstyletheadfamily 
Technology
&\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Prerequisite
&\sphinxstyletheadfamily 
Owner
&\sphinxstyletheadfamily 
Year
\\
\hline
Simple sedimentation
&
particles settle
&
none
&
public
&
unknown
\\
\hline
Flocculation
&
aluminum and iron salts
&
none
&
public
&
\sphinxhref{https://www.iwapublishing.com/news/coagulation-and-flocculation-water-and-wastewater-treatment}{1757}
\\
\hline
Sedimentation
&
horizontal flow
&
flocculation
&
public
&
unknown
\\
\hline
Lamellar sedimentation
&
plate or tube settlers
&
flocculation or floc blanket
&
public
&
\sphinxhref{http://www.hydroflotech.com/inclined-plate-clarifier-basic-theory-of-operation}{1904}
\\
\hline
Roughing filter
&
simple sedimentation in a gravel bed
&
none
&
public
&
\sphinxhref{https://www.researchgate.net/publication/237827490\_Roughing\_filter\_for\_water\_pre-treatment\_technology\_in\_developing\_countries\_A\_review?enrichId=rgreq-bb1d04e6613378d626c78cadb6674ae8\&enrichSource=Y292ZXJQYWdlOzIzNzgyNzQ5MDtBUzoyMDAwMDczMDQxMjY0NjdAMTQyNDY5Njg2NTYxMQ\%3D\%3D\&el=1\_x\_2}{unknown}
\\
\hline
Slow sand filtration
&
Roughing filter or single step treatment for low NTU water
&
none
&
public
&
\sphinxhref{https://en.wikipedia.org/wiki/Slow\_sand\_filter}{1829}
\\
\hline
Rapid sand filtration
&
depth filtration
&
sedimentation
&
public
&
\sphinxhref{https://en.wikipedia.org/wiki/RapiD\_sand\_filter}{1920}
\\
\hline
Stacked rapid sand filter
&
gravity powered backwash
&
lamellar sedimentation
&
AguaClara Cornell open source
&
\sphinxhref{https://ascelibrary.org/doi/abs/10.1061/\%28ASCE\%29EE.1943-7870.0000562}{2012}
\\
\hline
Floc blanket
&
upflow fluidized suspension of flocs
&
flocculation
&
public
&
\sphinxhref{https://link.springer.com/chapter/10.1007\%2F978-3-642-61196-4\_2}{1930}
\\
\hline
Jet reverser floc blanket
&
first fully fluidized floc blanket
&
flocculation
&
AguaClara Cornell open source
&
\sphinxhref{http://cuaguaclara.blogspot.com/2012/08/the-floc-blanket-quest.html}{2012}
\\
\hline
Ballasted sedimentation
&
small sand carry particles downward
&\begin{itemize}
\item {} 
\end{itemize}
&
\sphinxhref{http://www.veoliawatertechnologies.com.au/medias/topics/focus\_actiflo.htm}{Actiflo Veolia}
&
\sphinxhref{https://patents.google.com/patent/US5840195}{1995}
\\
\hline
Superpulsator
&
pulsing flow through floc blanket
&
rapid mix
&
\sphinxhref{http://www.degremont-technologies.com/SUPERPULSATOR-R}{Degremont}
&
\sphinxhref{https://patents.google.com/patent/US3038608A}{1958}  \sphinxhref{https://patents.google.com/patent/US5143625}{1991}
\\
\hline
Dissolved air flotation
&
bubbles carry particles upward
&
flocculation
&
Public
&
\sphinxhref{https://iwaponline.com/wst/article-abstract/31/3-4/1/4138/Principles-and-applications-of-dissolved-air}{1905}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

See \sphinxhref{https://www.pnws-awwa.org/uploads/PDFs/conferences/2014/2.\%20PNWS\%20AWWA\%20WTC\%20Precon\%2005\%2007\%202014\%20Pretreatment\%20by\%20B\&V\%201\&2\%20-\%20R1.pdf}{Pretreatment Processes for Potable Water Treatment Plants by Jeff Lindgren for an excellent overview of available technologies, May 2014 (not including AguaClara innovations)}.


\subsection{Treatment Trains}
\label{\detokenize{Introduction/Introduction:treatment-trains}}\label{\detokenize{Introduction/Introduction:heading-treatment-trains}}
The prerequisites for the unit processes in \hyperref[\detokenize{Introduction/Introduction:table-surface-water-treatment-technologies}]{Table \ref{\detokenize{Introduction/Introduction:table-surface-water-treatment-technologies}}} reveal that surface water treatment almost always requires a series of treatment steps. A treatment train is a series of treatment steps (or unit processes) designed to convert a contaminated source water into a purified water meeting the use requirements.
\begin{description}
\item[{Example treatment trains include:}] \leavevmode\begin{itemize}
\item {} 
Conventional mechanized treatment: mechanical flocculation, lamellar sedimentation, rapid sand filtration, disinfection

\item {} 
Superpulsator: rapid mix, floc blanket, lamellar sedimentation, rapid sand filtration

\item {} 
AguaClara: hydraulic flocculation, floc blanket, lamellar sedimentation, stacked rapid sand filtration, disinfection

\item {} 
Membrane filtration: flocculation, sedimentation, rapid sand filtration, granular or powdered activated carbon, pre-oxidation (see \sphinxhref{https://pubs-acs-org.proxy.library.cornell.edu/doi/abs/10.1021\%2Fes802473r}{Review Article})

\end{itemize}

\end{description}


\section{The AguaClara Treatment Train}
\label{\detokenize{Introduction/Introduction:the-aguaclara-treatment-train}}\label{\detokenize{Introduction/Introduction:heading-the-aguaclara-treatment-train}}
Why does flocculation precedes sedimentation?
Which process removes the largest quantity of contaminants?

Sedimentation is the process of particles ‘falling’ because they have a higher density then the water, and its governing equation is:
\begin{equation}\label{equation:Introduction/Introduction:eq_laminar_terminal_velocity}
\begin{split}\bar v_t = \frac{D_{particle}^2 g}{18 \nu} \frac{\rho_p - \rho_w}{\rho_w}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\bar v_t\) = terminal velocity of a particle, its downwards speed if it were in quiescent (still) water
\item[] \(D_{particle}\) = particle diameter
\item[] \(\rho\) = density. The \(p\) subscript stands for particle, while \(w\) stands for water
\end{DUlineblock}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k}{def} \PYG{n+nf}{v\PYGZus{}t}\PYG{p}{(}\PYG{n}{D\PYGZus{}particle}\PYG{p}{,}\PYG{n}{density\PYGZus{}particle}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{D\PYGZus{}particle}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*}\PYG{p}{(}\PYG{n}{density\PYGZus{}particle} \PYG{o}{\PYGZhy{}} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{18}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{clay} \PYG{o}{=} \PYG{l+m+mi}{2650} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{organic} \PYG{o}{=} \PYG{l+m+mi}{1040} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{Temperature} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{D\PYGZus{}particle} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{loglog}\PYG{p}{(}\PYG{n}{D\PYGZus{}particle}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}\PYG{p}{,}\PYG{n}{v\PYGZus{}t}\PYG{p}{(}\PYG{n}{D\PYGZus{}particle}\PYG{p}{,}\PYG{n}{clay}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{loglog}\PYG{p}{(}\PYG{n}{D\PYGZus{}particle}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}\PYG{p}{,}\PYG{n}{v\PYGZus{}t}\PYG{p}{(}\PYG{n}{D\PYGZus{}particle}\PYG{p}{,}\PYG{n}{organic}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Particle diameter (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Terminal velocity (m/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{clay or sand}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{organic particle}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Introduction/Images/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Terminal\PYGZus{}velocity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

The terminal velocities of particles in surface waters range over many orders of magnitude especially if you consider that mountain streams can carry large rocks. But removing rocks from water is easily accomplished, gravity will take care of it for us. Gravity is such a great force for separation of particles from water that we would like to use it to remove small particles too. Unfortunately, gravity becomes rather ineffective at separating pathogens and small inorganic particles such as clay. The terminal velocities (\eqref{equation:Introduction/Introduction:eq_laminar_terminal_velocity}) of these particles is given in \hyperref[\detokenize{Introduction/Introduction:figure-terminal-velocity}]{Fig.\@ \ref{\detokenize{Introduction/Introduction:figure-terminal-velocity}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{Terminal_velocity}.png}
\caption{The terminal velocity of a 1 \(\mu m\) bacteria cell is approximately 20 nanometers per second. The terminal velocity of a 5 \(\mu m\) clay particles is 30 \(\mu m/s\). The velocity estimates for the faster settling particles may be too slow because those particles are transitioning to turbulent flow.}\label{\detokenize{Introduction/Introduction:id19}}\label{\detokenize{Introduction/Introduction:figure-terminal-velocity}}\end{figure}

The low terminal velocities of particles that we need to remove from surface waters reveals that sedimentation alone will not work. The time required for a small particle to settle even a few mm would require excessively large sedimentation tanks. This is why flocculation, the process of sticking particles together so that they can attain higher sedimentation velocities, is perhaps the most important unit process in surface water treatment plants.
\begin{description}
\item[{The AguaClara treatment train consists of the following processes}] \leavevmode\begin{itemize}
\item {} 
flow measurement

\item {} 
metering of the coagulant (and chlorine) that will cause particles to stick together

\item {} 
mixing of the coagulant with the raw water

\item {} 
flocculation where the water is deformed to cause particle collisions

\item {} 
floc blanket where large flocs settle through water that is flowing upward causing collisions between small particles carried by the upward flowing water and the large flocs

\item {} 
lamellar sedimentation where gravity causes particles to settle to an inclined plate and then slide back down into the floc blanket

\item {} 
stacked rapid sand filtration where particles collide with previously deposited particles in a sand filter bed

\item {} 
disinfection with chlorine to inactivate any pathogens that escaped the previous unit processes

\end{itemize}

\end{description}


\subsection{Comparison with Croton Water Treatment Plant}
\label{\detokenize{Introduction/Introduction:comparison-with-croton-water-treatment-plant}}
As AguaClara technologies extend to larger and larger cities one of the criticisms could be that the technologies are somehow limited to small scale facilities. To address this question we will compare AguaClara unit processes with one of the most recent large scale water treatment plants, the \sphinxhref{../\_static/references/Croton-WFP.pdf}{Croton Water Treatment Plant} (CWTP) in NYC.

The CWTP is designed to treat \sphinxhref{https://www.hazenandsawyer.com/work/projects/croton-wtp/}{290 mgd} (million gallons per day) which is equivalent to 12,700 L/s. The final cost of the project was \$3.2bn. The cost per L/s of treatment capacity was thus \$250,000. This is approximately 25 times more expensive than AguaClara water treatments. Of course, AguaClara water treatment plants haven’t been constructed underground in the middle of a major city! Nonetheless, the factor of 25 suggests that AguaClara technologies have a significant cost advantage.

The CWTP has 48 flocculators and 48 dissolved air flotation processes working in parallel. The flow per unit is thus 265 L/s. The current maximum size of the AguaClara Open Stacked Rapid Sand (OStaR) ilter is 20 L/s. It would be possible to design larger OStaR filters by simply including multiple sets of inlet/outlet trunk lines into a single filter box. The CWTP filters appear to have 6 outlet trunk lines per filter and thus the flow per trunk line is 44 L/s.

The CWTP uses 2 stage mechanical flocculators with a total residence time of 4.8 minutes and a velocity gradient of 100 Hz. This residence time is much shorter than conventional design requirements, about half of the residence time used by the AguaClara plants built around 2017, significantly larger than the 90 second residence time used in the AguaClara 1 L/s plants.

CWTP uses dissolved air flotation tanks that are located on top of the rapid sand filters.

The filter approach velocity (the velocity of water before it enters the sand bed) for CWTP is 4.42 mm/s. This is significantly higher than the 1.85 mm/s filtration velocity currently used in StaRS filters. StaRS filters are a stack of 6 filters and the net filtration velocity is 11 mm/s. Thus by that metric the StaRS filters are significantly smaller than the CWTP filters.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}the unit registry has been imported above and does not need to be imported again}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{n}{Q\PYGZus{}Croton} \PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{290} \PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Mgal}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{day}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{Cost\PYGZus{}Croton} \PYG{o}{=} \PYG{l+m+mf}{3.2} \PYG{o}{*} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{9} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{USD}
\PYG{n}{Cost\PYGZus{}per\PYGZus{}Lps} \PYG{o}{=} \PYG{n}{Cost\PYGZus{}Croton}\PYG{o}{/}\PYG{n}{Q\PYGZus{}Croton}
\PYG{n}{Cost\PYGZus{}per\PYGZus{}Lps}
\PYG{n}{N\PYGZus{}DAF} \PYG{o}{=} \PYG{l+m+mi}{48}
\PYG{n}{Q\PYGZus{}per\PYGZus{}unit} \PYG{o}{=} \PYG{n}{Q\PYGZus{}Croton}\PYG{o}{/}\PYG{n}{N\PYGZus{}DAF}
\PYG{n}{Q\PYGZus{}per\PYGZus{}unit}\PYG{o}{/}\PYG{l+m+mi}{6}
\PYG{p}{(}\PYG{l+m+mf}{15.9} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hr}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Design Evolution}
\label{\detokenize{Introduction/Introduction:design-evolution}}
During the later half of the 20th century surface water treatment technologies evolved slowly. The slow evolution was likely a product of the regulatory environment, the high cost of water treatment infrastructure, and the low profit margin. The high cost of municipal scale water treatment infrastructure made experiments at scale infeasible and thus there was no mechanism to introduce disruptive innovations. With little opportunity for a significant return on investment there was little incentive to invest in the research and development that could have advanced the technologies. A final disincentive was the widely held belief that surface water treatment was a mature field with little opportunity for significant advancement. The advances of the latter half of the 20th century focused primarily on mechanization and automation (Supervisory Control and Data Acquisition - SCADA).

Design standards such as the \sphinxhref{http://10statesstandards.com/}{Great Lakes - Upper Mississippi River Board 10 States Standards} are evolving very slowly and retain an empirical approach to design. The empirical design methodology is a direct result of two confounding factors. The physics of particle interactions based on diffusion, fluid shear, and gravity are complex and given the challenges of characterizing surface water particle suspensions it was natural to assume that a mathematical description of the processes would be intractable.

Mechanized and automated water treatment plants performed reasonably well in communities with ready access to technical support services and supply chains that could reliably deliver replacement parts. In the global south municipal water treatment plants haven’t faired as well. In 2012, one of the main water treatment plants serving Kathmandu, Nepal had failed chlorine pumps and were using a red garden hose to siphon chlorine from the stock tank. They crimped the end of the hose to control the flow rate of the chlorine solution.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Kathmandu_chemical_feed_room}.png}
\caption{Failed chlorine dosing system bypassed with a red tube that siphons the chlorine solution at a plant in Kathmandu, Nepal in 2012.}\label{\detokenize{Introduction/Introduction:id20}}\label{\detokenize{Introduction/Introduction:figure-kathmandu-chemical-feed-room}}\end{figure}

The ingenious and simple chemical dosing system that uses a siphon to completely bypass the failed pumps begs the question of whether design engineers could have invented a better option than the short lived pumps that they specified. We will investigate a gravity powered chemical dosing system that is far more reliable than chemical dosing pumps and that borrows from the simplicity of the garden hose solution used by the Nepali plant operators.

Chemical dosing systems are particularly vulnerable and their failures make plant operation very challenging. Providing the right coagulant dose is critical for efficient removal of particle and dissolved organics. Chemical dosing systems commonly rely on pumps and those pumps require regular maintenance and have relatively short mean times between failures.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Kathmandu_alum_dosing}.jpg}
\caption{Alum dosing system based on the rate that 25 kg blocks of alum are placed in the inlet channel of the plant.}\label{\detokenize{Introduction/Introduction:id21}}\label{\detokenize{Introduction/Introduction:figure-kathmandu-alum-dosing}}\end{figure}

The AguaClara Cornell program was founded in 2005 with the goal of creating a new generation of sustainable technologies that would perform well even in the rugged settings of rural communities. The goal wasn’t simply to create technologies that would work for communities with very limited resources. The goal was to create the next generation of technologies that would both perform well in communities with limited resources and would be the highest performing technologies on multiple metrics for all communities.


\subsection{Empirical Design}
\label{\detokenize{Introduction/Introduction:empirical-design}}\label{\detokenize{Introduction/Introduction:heading-empirical-design}}
For the past several decades surface water treatment technologies have been considered “mature” and when I (Monroe) took a design course on drinking water treatment in 1985 I had the impression that there was little room for further innovation. This perspective is remarkable given that with the exception of lamellar sedimentation there were no equations describing the core treatment processes.

Empirical design guidelines don’t provide insight into how designs could be optimized or even what the performance of a water treatment plant will be.


\section{Design for the Financers, Venders, Client, or Context?}
\label{\detokenize{Introduction/Introduction:design-for-the-financers-venders-client-or-context}}\label{\detokenize{Introduction/Introduction:heading-design-for-the-context}}
Tours of water treatment plants suggest that it is common for designs to be driven by the vender goal of a stable revenue stream for replacement parts rather than by a goal of meeting the client’s needs. Mandatory software upgrades, mechanical valves, chemical pumps, mixing units provide a steady demand for proprietary components. Financers often prefer projects that can be implemented quickly either because they have target expenditures for a fiscal year or because loan repayment begins when the facility is turned over to the client.

Design for the client would strive to reduce capital, operating, and maintenance expenses. Clients also place a high value on reliability, ease of maintenance, and the ability to handle repairs with their staff. Design for the context would account for the capabilities of local and national supply chains. A key design consideration is to ensure that the treatment capabilities of the treatment plant match the variable water quality of the proposed water source. There are numerous slow sand filtration plants installed in the global south that are attempting to treat water sources that can not be effectively treated by slow sand filtration. The cost of the failure to consider the client and the context is born by the communities who end up with water treatment systems that aren’t able to provide reliable safe water.

Design for the client requires empathy and a commitment to listen to and learn from plant operators. It also requires attention to detail and watching how plant operators interact with water treatment plants. Empathy leads to the goal of creating a work environment that makes it easy for the plant operators to do their routine tasks. This isn’t just to make the plant operators work easy. A plant that is designed with the plant operator in mind will also engender pride and that pride will lead to better plant performance.

An example of design for the operator is the elevation of the walkways in AguaClara plants. Conventional plants often have walkways that are above the tanks. That places the operator’s eyes several meters above the water surface and makes it difficult to see particles and flocs in the water. AguaClara plants have the walkways approximately 50 cm below the top of the tanks. This makes it easy for the plant operator to look into the tanks for quick visual inspections.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Improvised_ladder_access_to_sed_tank}.jpg}
\caption{A plant operator built a makeshift ladder to enable easier access to the flocculation and sedimentation tanks in a package plant. This ladder considerably shortened the distance between the coagulant dose controls and the flocculator. The ladder also makes it possible to look closely at the water to see the size of the flocs.}\label{\detokenize{Introduction/Introduction:id22}}\label{\detokenize{Introduction/Introduction:figure}}\end{figure}


\section{Design Bifurcations}
\label{\detokenize{Introduction/Introduction:design-bifurcations}}\label{\detokenize{Introduction/Introduction:heading-design-bifurcations}}
Seemingly small decisions can have a profound effect on the evolution of design. Often these decisions have a clear logic and a simple analysis would suggest that the decision must be the right one. It is common for design choices to have multiple consequences that can turn a seemingly great choice into a poor performer.


\subsection{Walls and a Roof}
\label{\detokenize{Introduction/Introduction:walls-and-a-roof}}\label{\detokenize{Introduction/Introduction:heading-walls-and-a-roof}}
Traditionally in tropical and temperate climates, flocculation and sedimentation units are built without an enclosing building because they aren’t in danger of freezing. Without protection from the sun the materials used for plant construction must be UV resistant and thus plastic can’t be used. This requires use of heavier and more expensive materials such stainless steel and aluminum. Metal plate settlers are heavy and thus they can’t be easily removed by the plant operator.

Without the ability to gain access to a sedimentation tank from above, conventional sedimentation tank cleaning must be done by providing operator access below the plate settlers. This in turn requires that the space below the plate settlers be tall enough to accommodate a plant operator. Thus sedimentation tanks that are built in the open have to be deeper than sedimentation tanks that are built under a roof and they are more difficult to maintain because the operator has to enter the tank through a waterproof access port. Operator access to the space below the stainless steel or aluminum plate settlers is through a port in the side of the tank (see the video \hyperref[\detokenize{Introduction/Introduction:figure-cleaning-a-sed-tank-with-fixed-plates}]{Fig.\@ \ref{\detokenize{Introduction/Introduction:figure-cleaning-a-sed-tank-with-fixed-plates}}}).

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{http://www.youtube.com/watch?v=TSh-ZNqaW8Y}{\sphinxincludegraphics[width=300\sphinxpxdimen]{{0}.jpg}}\caption{Plant operators opening hatch below plate settlers in a traditional sedimentation tank.}\label{\detokenize{Introduction/Introduction:id23}}\label{\detokenize{Introduction/Introduction:figure-cleaning-a-sed-tank-with-fixed-plates}}\end{figure}

AguaClara sedimentation tanks are designed to be taken off line one at a time so the water treatment plant can continue to operate during maintenance. Two plant operators can quickly open a sedimentation tank by removing the plastic plate settlers (see the video \hyperref[\detokenize{Introduction/Introduction:figure-removing-plate-settlers}]{Fig.\@ \ref{\detokenize{Introduction/Introduction:figure-removing-plate-settlers}}}). The zero settled sludge design of the AguaClara sedimentation tanks also reduces the need for cleaning.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{http://www.youtube.com/watch?v=vZ2f6mduEls}{\sphinxincludegraphics[width=300\sphinxpxdimen]{{01}.jpg}}\caption{Plant operator removing plate settlers from an AguaClara sedimentation tank.}\label{\detokenize{Introduction/Introduction:id24}}\label{\detokenize{Introduction/Introduction:figure-removing-plate-settlers}}\end{figure}

There is another major consequence of building water treatment plants in a secure enclosed building. Many water treatment plants will operate around the clock and that requires plant operators to spend the night at the facility. Having a secure facility provides improved safety for the plant operator. That improved safety is very important for some potential operators and thus providing that safety will increase potential diversity.


\subsection{Mechanized or Smart Hydraulics}
\label{\detokenize{Introduction/Introduction:mechanized-or-smart-hydraulics}}\label{\detokenize{Introduction/Introduction:heading-mechanized-or-smart-hydraulics}}
Dramatically different designs are also created when we choose gravity power and smart hydraulics rather than mechanical mixers, pumps, and mechanical controls for each of the unit processes. It appears that use of electricity in drinking water treatment plants became the popular choice about 100 years ago. Many gravity powered plants have been converted to use mechanical mixers for rapid mix and flocculation. That choice may not have been well founded from a water quality or performance perspective.

Automated plants often move the controls far away from the critical observation locations in the plant. This might be appropriate or necessary in some cases, but it has the disadvantage of making it more difficult for operators to directly observe what is happening in the plant. Direct observations are critical because even highly mechanized water treatment plants are not yet equipped with enough sensors to enable rapid troubleshooting from the control room.

AguaClara plants have a layout that places the coagulant dose controls within a few steps of the best places to observe floc formation in the flocculator. This provides plant operators with rapid feedback that is critical when the raw water changes rapidly at the beginning of a high runoff event. As operators spend time observing the processes in the plant they begin to associate cause and effect and can make operational changes to improve performance. For example, gas bubbles that carry flocs to the surface can indicate sludge accumulation in a sedimentation tank. Rising flocs without gas bubbles can indicate a poor inlet flow distribution for a sedimentation tank or density differences caused by temperature differences.


\section{AguaClara Inventions}
\label{\detokenize{Introduction/Introduction:aguaclara-inventions}}\label{\detokenize{Introduction/Introduction:heading-aguaclara-innovations}}

\subsection{Plant layout}
\label{\detokenize{Introduction/Introduction:plant-layout}}\begin{enumerate}
\item {} 
Compact layout with processes sharing common walls when possible

\item {} 
Walkways set at optimal elevation for observation and maintenance of processes

\item {} 
Open tanks used whenever possible to simplify maintenance

\item {} 
Building enclosure to protect the entire plant from UV and for security

\end{enumerate}


\subsection{Chemical dosing}
\label{\detokenize{Introduction/Introduction:chemical-dosing}}\begin{enumerate}
\item {} 
Linear flow orifice meter to both measure the plant flow rate and to turn the entrance tank water surface into a flow sensor input for the chemical dosing system.

\item {} 
Gravity powered semi-automated dosing system that delivers a constant dose even when plant flow rate changes.

\item {} 
Slider on a calibrated scale for intuitive changes in chemical dose

\end{enumerate}


\subsection{Rapid mix}
\label{\detokenize{Introduction/Introduction:rapid-mix}}\begin{enumerate}
\item {} 
Simple orifice for hydraulic rapid mix

\end{enumerate}


\subsection{Flocculation}
\label{\detokenize{Introduction/Introduction:flocculation}}\begin{enumerate}
\item {} 
Obstacles between baffles to create a more uniform distribution of energy dissipation rate and a more efficient use of available energy

\item {} 
Plastic modules that can easily be removed from channels for maintenance

\item {} 
Compact vertical flow flocculators for low flow plants

\end{enumerate}


\subsection{Sedimentation}
\label{\detokenize{Introduction/Introduction:sedimentation}}\begin{enumerate}
\item {} 
Four channel inlet/outlet system that enables
\begin{enumerate}
\item {} 
dumping flocculated water that doesn’t meet specifications

\item {} 
taking one sedimentation tank offline by placing a pipe stub in the inlet and a cap on the outlet

\item {} 
dumping settled water that doesn’t meet specifications

\end{enumerate}

\item {} 
Inlet manifold with flow diffusers that straighten the flow into a continuous line jet

\item {} 
Inlet manifold is offset from center to force jet to all go in a consistent direction through the jet reverser

\item {} 
Jet reverser that efficiently reverses the direction of the incoming water to be able to resuspend settled flocs that are sliding down the inclines

\item {} 
Zero settled sludge in the main part of the sedimentation tank

\item {} 
Hydraulically cleaned sedimentation tank with no moving parts

\item {} 
Floc Hopper that consolidates the floc slurry prior to draining.

\item {} 
Floc blanket that is stable due to loss to or gain from settled sludge

\end{enumerate}


\subsection{Filtration}
\label{\detokenize{Introduction/Introduction:filtration}}\begin{enumerate}
\item {} 
Sand drain system to empty sand from filter hydraulically

\item {} 
Wing and orifice system to inject water into the filter bed

\item {} 
Stacked Rapid Sand Filtration system that has the same flow rate for filtration and for backwash

\item {} 
Uses settled water for backwash to eliminate need for pumps and clearwells and to eliminate failure mode of inadequate supply of filtered water for backwash.

\item {} 
Air valve control system to trigger mode change from backwash to filtration and from filtration to backwash

\item {} 
No valves needed on inlet and outlet pipes

\end{enumerate}


\chapter{Python Tutorial}
\label{\detokenize{Introduction/Python_Tutorial:python-tutorial}}\label{\detokenize{Introduction/Python_Tutorial:title-python-tutorial}}\label{\detokenize{Introduction/Python_Tutorial::doc}}

\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Code resources.}\label{\detokenize{Introduction/Python_Tutorial:id1}}\label{\detokenize{Introduction/Python_Tutorial:table-code-resources}}
\sphinxaftercaption
\begin{tabular}[t]{|*{4}{\X{1}{4}|}}
\hline
\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Theme
&\sphinxstyletheadfamily 
Example function
&\sphinxstyletheadfamily 
Function call
\\
\hline
\sphinxhref{http://docs.python.org/3/library/functions.html}{Python functions}
&
low level programming functions
&
open a file
&
open(file, mode=’r’)
\\
\hline
\sphinxhref{https://github.com/hgrecco/pint/blob/master/pint/constants\_en.txt}{Pint universal constants}
&
physical constants with units
&
Avogadro’s number
&
u.avogadro\_number
\\
\hline
\sphinxhref{https://github.com/hgrecco/pint/blob/master/pint/default\_en.txt}{Pint units}
&
units that can be attached to numbers and numpy arrays
&\begin{quote}

5 m/s
\end{quote}
&
5* u.mm/u.s
\\
\hline
aguaclara.core. \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/core/physchem.py}{physchem}
&
pipeflow, orifices, viscosity of water, weirs, manifolds, Kozeny equation
&
total head loss in a straight pipe
&
headloss(FlowRate, Diam, Length, Nu, PipeRough, KMinor)
\\
\hline
aguaclara.research. \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/research/floc\_model.py}{floc\_model}
&
AguaClara flocculation model, velocity gradients, Kolmogorov length scales
&
velocity gradient in a coiled tube
&
g\_coil(FlowPlant, IDTube, RadiusCoil, Temp)
\\
\hline
aguaclara.research. \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/research/environmental\_processes\_analysis.py}{environmental\_processes\_analysis}
&\begin{quote}

carbonate system, CMFR and advection dispersion reactor analysis
\end{quote}
&
extract data from ProCoDA generated Gran analysis file
&
Gran(data\_file\_path)
\\
\hline
aguaclara.research. \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/research/procoda\_parser.py}{procoda\_parser}
&
Extracts data from multiple ProCoDA files based on the state and data column
&
extract a column of data from a ProCoDA data file
&
column\_of\_data(data\_file\_path, start, column)
\\
\hline
\sphinxhref{https://docs.scipy.org/doc/scipy/reference/}{SciPy}
&
computing integrals numerically, solving differential equations, optimization, and sparse matrices
&
root finding
&
root(func, 0.3)
\\
\hline
\sphinxhref{https://docs.scipy.org/doc/numpy/user/quickstart.html}{NumPy}
&
Array manipulation and math functions
&
create an array with linearly spaced elements
&
np. \sphinxhref{https://docs.scipy.org/doc/numpy/reference/generated/numpy.linspace.html\#numpy.linspace}{linspace} (start,stop,num)
\\
\hline
\sphinxhref{https://matplotlib.org/tutorials/index.html}{PyPlot}
&
Graphs!
&
Create beautiful graphs
&
see below
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\section{Import statements}
\label{\detokenize{Introduction/Python_Tutorial:import-statements}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{k+kn}{from} \PYG{n+nn}{scipy} \PYG{k}{import} \PYG{n}{constants}\PYG{p}{,} \PYG{n}{interpolate}
\end{sphinxVerbatim}

Hint: If you are typing a function name and want to know what the options are for completing what you are typing, just hit the tab key for a menu of options.

Hint: If you want to see the source code associated with a function, you
can do the following import inspect inspect.getsource(foo)

Where “foo” is the function that you’d like to learn about.


\section{Markdown}
\label{\detokenize{Introduction/Python_Tutorial:markdown}}
Markdown allow you to mix code, beautiful Latex equations, nicely formatted text, figures, and tables.
\begin{equation}\label{equation:Introduction/Python_Tutorial:Introduction/Python_Tutorial:0}
\begin{split}c = \sqrt{a^2 + b^2}\end{split}
\end{equation}
Markdown does not handle automatic numbering of equations, figures, and tables.

The Python Kernel remembers all definitions (functions and variables) as they are defined based on execution. Thus if you fail to execute a line of code, the parameters defined in that line won’t be available. Similarly, if you define a parameter and then delete that line of code, that parameter remains defined until you reset all runtimes or restart.

Before submitting a file for others to use, you need to verify that all of the dependencies are defined and that you didn’t accidently delete a definition that is required. You can do this by resetting all runtimes (Runtime menu) and then running all.


\section{Transitioning From Matlab To Python}
\label{\detokenize{Introduction/Python_Tutorial:transitioning-from-matlab-to-python}}
\sphinxstylestrong{Indentation} - When writing functions or using statements, Python recognizes code blocks from the way they are indented. A code block is a group of statements that, together, perform a task. A block begins with a header that is followed by one or more statements that are indented with respect to the header. The indentation indicates to the Python interpreter, and to programmers that are reading the code, that the indented statements and the preceding header form a code block.

\sphinxstylestrong{Suppressing Statements} - Unlike Matlab, you do not need a semi-colon to suppress a statement in Python;

\sphinxstylestrong{Indexing} - Matlab starts at index 1 whereas Python starts at index 0.

\sphinxstylestrong{Functions} - In Matlab, functions are written by invoking the keyword “function”, the return parameter(s), the equal to sign, the function name and the input parameters. A function is terminated with “end”.:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{function}
  \PYG{n}{y} \PYG{o}{=} \PYG{n}{average}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
  \PYG{k}{if} \PYG{o}{\PYGZti{}}\PYG{n}{isvector}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
    \PYG{n}{error}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Input must be a vector}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{n}{end}
    \PYG{n}{y} \PYG{o}{=} \PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{o}{/}\PYG{n}{length}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{;}
    \PYG{n}{end}
\end{sphinxVerbatim}

In Python, functions can be written by using the keyword “def”, followed by the function name and then the input parameters in parenthesis followed by a colon. A function is terminated with “return”.:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{average}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{if} \PYG{o}{\PYGZti{}}\PYG{n}{isvector}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
  \PYG{k}{raise} \PYG{n}{VocationError}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Input must be a vector}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
  \PYG{k}{return} \PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}\PYG{o}{/}\PYG{n}{length}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Statements} - for loops and if statements do not require the keyword “end” in Python. The loop header in Matlab varies from that of Python. Check examples below:

Matlab code:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{s} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{p}{;}
\PYG{n}{H} \PYG{o}{=} \PYG{n}{zeros}\PYG{p}{(}\PYG{n}{s}\PYG{p}{)}\PYG{p}{;}
  \PYG{k}{for} \PYG{n}{c} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{s}
    \PYG{k}{for} \PYG{n}{r} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{p}{:}\PYG{n}{s}
    \PYG{n}{H}\PYG{p}{(}\PYG{n}{r}\PYG{p}{,}\PYG{n}{c}\PYG{p}{)} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{n}{r}\PYG{o}{+}\PYG{n}{c}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{;}
    \PYG{n}{end}
  \PYG{n}{end}
\end{sphinxVerbatim}

\sphinxstylestrong{Printing} - Use “print()” in Python instead of “disp” in Matlab.

\sphinxstylestrong{Helpful Documents}
\begin{itemize}
\item {} 
\sphinxhref{https://docs.scipy.org/doc/numpy-dev/user/numpy-for-matlab-users.html}{Numpy for Matlab Users}

\item {} 
\sphinxhref{http://stsievert.com/blog/2015/09/01/matlab-to-python/}{Stepping from Matlab to Python}

\item {} 
\sphinxhref{http://researchcomputing.github.io/meetup\_fall\_2014/pdfs/fall2014\_meetup13\_python\_matlab.pdf}{Python for Matlab Users, UC Boulder}

\end{itemize}


\section{Units}
\label{\detokenize{Introduction/Python_Tutorial:units}}
Engineering requires calculations with units. Prior to modern computer languages engineers used paper and pencil, slide rules, calculators, and more recently spreadsheets to do calculations. All of these methods are prone to calculation errors because units aren’t handled as an essential part of each value. Spreadsheets are especially notorious for calculation errors because unit conversions are buried in formulas that are hidden in the cells.

Operations on values with units follow very clear algebraic rules and thus units can be attached to numerical values and carried through math operations. This capability is implemented in Python using \sphinxhref{https://pint.readthedocs.io/en/latest/}{Pint} . The Pint package includes a host of units and prefixes (such as \(\mu\) for \(10^{-6}\)). As you master using Python and Pint you will say goodbye to mindless unit conversions forever!

Environmental engineers historically described surface loading rates for sedimentation tanks using units of gal/min per square foot. How fast is \(\frac{1 gpm}{ft^2}\) in \(\frac{mm}{s}\)?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{V\PYGZus{}surface\PYGZus{}loading\PYGZus{}rate} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{gal}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{min} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{ft}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The surface loading rate is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{V\PYGZus{}surface\PYGZus{}loading\PYGZus{}rate}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The surface loading rate is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{round\PYGZus{}sig\PYGZus{}figs}\PYG{p}{(}\PYG{n}{V\PYGZus{}surface\PYGZus{}loading\PYGZus{}rate}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The surface loading rate is 0.6791 millimeter / second

After reducing the number of significant digits to 2 we obtain:
The surface loading rate is 0.68 millimeter / second

How long does it take to stop a car that is initially traveling at 60 mph if the coefficient of friction is 0.5?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{v\PYGZus{}0} \PYG{o}{=} \PYG{l+m+mi}{60} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mile}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hr}
\PYG{n}{friction\PYGZus{}coefficient} \PYG{o}{=} \PYG{l+m+mf}{0.5}
\PYG{n}{deceleration} \PYG{o}{=} \PYG{n}{friction\PYGZus{}coefficient} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{standard\PYGZus{}gravity}
\PYG{n}{t\PYGZus{}deceleration} \PYG{o}{=} \PYG{n}{v\PYGZus{}0}\PYG{o}{/}\PYG{n}{deceleration}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The time to stop the car is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{t\PYGZus{}deceleration}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The time to stop the car is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{t\PYGZus{}deceleration}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The time to stop the car is 120 mile / hour / standard\_gravity

We add the .to\_base\_units() directive to force pint to simplify the units.

The time to stop the car is 5.47 second

Many functions written in Python do not yet handle units and thus it is sometimes necessary to remove the units. Examples include graphs (althougth units might be coming to matplotlib), SciPy functions, and the NumPy functions used to populate arrays. For these cases you can strip the units off a number using the .magnitude method. Be careful to make sure you know what the units are before you remove them otherwise you may be confused by the results!

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Q} \PYG{o}{=} \PYG{l+m+mi}{5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{gal}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{min}
\PYG{n}{fill\PYGZus{}time} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hr}
\PYG{n}{Volume} \PYG{o}{=} \PYG{n}{Q} \PYG{o}{*} \PYG{n}{fill\PYGZus{}time}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The volume is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Volume}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The magnitude of the Volume is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Volume}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The units of the flow are}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Volume}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}force pint to display in a selected set of Units}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The volume is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Volume}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kL}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The volume is 15 gallon * hour / minute

The magnitude of the Volume is 15.0

The units of the flow are gallon * hour / minute

The volume is 3.41 kiloliter

It is useful to force pint to display the result in the units of your choice.


\section{Arrays and units}
\label{\detokenize{Introduction/Python_Tutorial:arrays-and-units}}
Use NumPy arrays rather than Python lists to enable math with numbers and units. When creating arrays with units remember that
\begin{itemize}
\item {} 
Array elements don’t have units!

\item {} 
Arrays can have units.

\end{itemize}

Therefore always attach units to the array after the array has been created. This means that array elements should be dimensionless and thus arrays must be created using dimensionless values.

We can use NumPy linspace with a simple change to make it dimensionless. Usually linspace has start and stop elements that would logically have units: np.linspace(start, stop, num). But elements can’t have units! We can make the inputs to linspace be dimensionless to create a dimensionless array and then multiplies it by the final value that includes the units to scale the array correctly. For evenly spaced arrays starting at the end of the first space we have either:
\begin{itemize}
\item {} 
np.linspace(start/stop, 1, num) * stop

\item {} 
np.linspace(1 / num, 1, num) * stop

\end{itemize}

For evenly spaced arrays starting with zero we have:
\begin{itemize}
\item {} 
np.linspace(0, 1, num+1) * stop!

\end{itemize}

The print function can’t currently handle arrays with units. The array can be printed nicely in two steps as shown below.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{n\PYGZus{}rows} \PYG{o}{=} \PYG{l+m+mi}{10}
\PYG{n}{Flow} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Flow\PYGZus{}array} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{/} \PYG{n}{n\PYGZus{}rows}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{n\PYGZus{}rows}\PYG{p}{)} \PYG{o}{*} \PYG{n}{Flow}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The array of flow rates is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Flow\PYGZus{}array}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{n}{Flow\PYGZus{}array}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)}

\PYG{n}{Flow\PYGZus{}array} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{/} \PYG{n}{n\PYGZus{}rows}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{n\PYGZus{}rows}\PYG{p}{)} \PYG{o}{*} \PYG{n}{Flow}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The array of flow rates is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Flow\PYGZus{}array}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{n}{Flow\PYGZus{}array}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)}

\PYG{n}{Flow\PYGZus{}array} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{n\PYGZus{}rows}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{*} \PYG{n}{Flow}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The array of flow rates is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Flow\PYGZus{}array}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{n}{Flow\PYGZus{}array}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)}
\end{sphinxVerbatim}

{[}  2.   4.   6.   8.  10.  12.  14.  16.  18.  20.{]} liter / second


\section{Plotting}
\label{\detokenize{Introduction/Python_Tutorial:plotting}}
We will use this \sphinxhref{https://matplotlib.org/tutorials/introductory/usage.html\#coding-styles}{pyplot coding style} .
\begin{itemize}
\item {} 
fig is a Figure instance—like a blank canvas

\item {} 
ax is an AxesSubplot instance—think of a frame for plotting in

\end{itemize}

Create a graph showing flow rate vs depth for two linear flow orifice meters that have a depth range of 20 cm and flow ranges of 50 and 70 L/s.
\begin{itemize}
\item {} 
\sphinxhref{https://matplotlib.org/api/\_as\_gen/matplotlib.pyplot.legend.html}{Legend location options}

\item {} 
\sphinxhref{https://matplotlib.org/api/colors\_api.html}{Colors}
\begin{itemize}
\item {} 
‘b’, ‘g’, ‘r’, ‘c’, ‘m’, ‘y’, ‘k’, ‘w’

\item {} 
blue, green, red, cyan, magenta, yellow, black, white

\end{itemize}

\item {} 
\sphinxhref{https://matplotlib.org/api/markers\_api.html\#module-matplotlib.markers}{Data markers (if you are plotting data and not a model or curve fit)}

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{H\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{Q\PYGZus{}max1} \PYG{o}{=} \PYG{l+m+mi}{50} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Q\PYGZus{}max2} \PYG{o}{=} \PYG{l+m+mi}{70} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{num} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{a} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{num}\PYG{p}{)}
\PYG{n}{x} \PYG{o}{=} \PYG{n}{a} \PYG{o}{*} \PYG{n}{H\PYGZus{}max}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(} \PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{n}{num}\PYG{p}{)} \PYG{p}{)}
\PYG{n}{y1} \PYG{o}{=} \PYG{n}{a} \PYG{o}{*} \PYG{n}{Q\PYGZus{}max1}
\PYG{n}{y2} \PYG{o}{=} \PYG{n}{a} \PYG{o}{*} \PYG{n}{Q\PYGZus{}max2}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y1}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{Q\PYGZus{}max1}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y2}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{n}{Q\PYGZus{}max2}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{l+m+mf}{0.6}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{water depth (}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)} \PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}ax.set(ylabel=\PYGZsq{}Flow rate (\PYGZsq{}+str(Q\PYGZus{}max1.units)+\PYGZsq{})\PYGZsq{})}
\PYG{c+c1}{\PYGZsh{}Below is the method for using latex to format the units}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flow rate }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{left (}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{frac}\PYG{l+s+si}{\PYGZob{}L\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}s\PYGZcb{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{right )\PYGZdl{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} options: linear or log}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{yscale}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{log}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xscale}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{linear}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}options:}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{loc}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{best}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}alternative method to create a legend instead of using \PYGZdq{}label=Q\PYGZus{}max1 in ax.plot\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{}ax.legend([Q\PYGZus{}max1,Q\PYGZus{}max2])}

\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Introduction/Images/LFOM\PYGZus{}flow\PYGZus{}vs\PYGZus{}height}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{LFOM_flow_vs_height}.png}
\caption{The flow through an LFOM is directly proportional to the height of the water above the bottom of the first row of orifices.}\label{\detokenize{Introduction/Python_Tutorial:id2}}\label{\detokenize{Introduction/Python_Tutorial:figure-lfom-flow-vs-height}}\end{figure}

Indexing is done by row and then by column. To call all of the elements in a row or column, use a colon. As you can see in the following example, indexing in python begins at zero. So \sphinxcode{\sphinxupquote{a{[}:,1{]}}} is calling all rows in the second column

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}create an empty array}
\PYG{n}{a} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{size}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}Given that I\PYGZsq{}m going to using np.array to assign the elements I didn\PYGZsq{}t need to create the empty array first.}
\PYG{n}{a} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{a}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}
\PYG{n}{a}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{a}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n}{a}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{}access the last row by find the shape, selecting the 2nd element in the shape, and then subtracting one}
\PYG{n}{a}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{l+s+sd}{\PYGZsq{}\PYGZsq{}\PYGZsq{}specify a range of values in an array. Use a colon to slice the array, with the number before the colon being the index of the first element, and the number after the colon being **one greater** than the index of the last element\PYGZsq{}\PYGZsq{}\PYGZsq{}}
\PYG{n}{a}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{:}\PYG{l+m+mi}{5}\PYG{p}{]}
\end{sphinxVerbatim}


\section{Example problem}
\label{\detokenize{Introduction/Python_Tutorial:example-problem}}
Calculate the number of moles of methane in a 20 L container at 15 psi above atmospheric pressure with a temperature of 30 C.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} First assign the values given in the problem to variables.}
\PYG{n}{P} \PYG{o}{=} \PYG{l+m+mi}{15} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{psi} \PYG{o}{+} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{atm}
\PYG{n}{T} \PYG{o}{=} \PYG{l+m+mi}{30} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{V} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{c+c1}{\PYGZsh{} Use the equation PV=nRT and solve for n, the number of moles.}
\PYG{c+c1}{\PYGZsh{} The universal gas constant is available in pint.}
\PYG{n}{nmolesmethane} \PYG{o}{=} \PYG{p}{(}\PYG{n}{P}\PYG{o}{*}\PYG{n}{V}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n}{T}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kelvin}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{nmolesmethane}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{There are }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{nmolesmethane} \PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ of methane in the container.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

There are  1.625 mole  of methane in the container.


\section{Functions}
\label{\detokenize{Introduction/Python_Tutorial:functions}}
When it becomes necessary to do the same calculation multiple times, it is useful to create a function to facilitate the calculation in the future.
\begin{itemize}
\item {} 
Function blocks begin with the keyword def followed by the function name and parentheses ( ).

\item {} 
Any input parameters or arguments should be placed within these parentheses.

\item {} 
The code block within every function starts with a colon (:) and is indented.

\item {} 
The statement return {[}expression{]} exits a function and returns an expression to the user. A return statement with no arguments is the same as return None.

\item {} 
(Optional) The first statement of a function can the documentation string of the function or docstring, written with apostrophes .

\end{itemize}

Below is an example of a function that takes three inputs, pressure, volume, and temperature, and returns the number of moles.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Creating a function is easy in Python}
\PYG{k}{def} \PYG{n+nf}{nmoles}\PYG{p}{(}\PYG{n}{P}\PYG{p}{,}\PYG{n}{V}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{P}\PYG{o}{*}\PYG{n}{V}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{R}\PYG{o}{*}\PYG{n}{T}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kelvin}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

Try using the new function to solve the same problem as above. You can reuse the variables. You can use the new function call inside the print statement.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{There are}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{nmoles}\PYG{p}{(}\PYG{n}{P}\PYG{p}{,}\PYG{n}{V}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{of methane in the container.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{There} \PYG{n}{are} \PYG{l+m+mf}{1.62} \PYG{n}{mol} \PYG{n}{of} \PYG{n}{methane} \PYG{o+ow}{in} \PYG{n}{the} \PYG{n}{container}\PYG{o}{.}
\end{sphinxVerbatim}


\section{Pipe Database}
\label{\detokenize{Introduction/Python_Tutorial:pipe-database}}
The \sphinxhref{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/core/pipes.py}{pipes} has many useful functions concerning pipe sizing. It provides functions that calculate actual pipe inner and outer diameters given the nominal diameter of the pipe. Note that nominal diameter just means the diameter that it is called (hence the discriptor “nominal”) and thus a 1 inch nominal diameter pipe might not have any dimensions that are actually 1 inch!

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{pipes} \PYG{k}{as} \PYG{n+nn}{pipe}
\PYG{c+c1}{\PYGZsh{} The OD function in pipedatabase returns the outer diameter of a pipe given the nominal diameter, ND.}
\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{OD}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}
\end{sphinxVerbatim}

6.625 inch

The ND\_SDR\_available function returns the nominal diameter of a pipe that has an inner diameter equal to or greater than the requested inner diameter \sphinxhref{http://www.engineeringtoolbox.com/sdr-standard-dimension-ratio-d\_318.html}{SDR, standard diameter ratio} . Below we find the smallest available pipe that has an inner diameter of at least 7 cm

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{IDmin} \PYG{o}{=} \PYG{l+m+mi}{7} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{SDR} \PYG{o}{=} \PYG{l+m+mi}{26}
\PYG{n}{ND\PYGZus{}my\PYGZus{}pipe} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{ND\PYGZus{}SDR\PYGZus{}available}\PYG{p}{(}\PYG{n}{IDmin}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}
\PYG{n}{ND\PYGZus{}my\PYGZus{}pipe}
\end{sphinxVerbatim}

3.0 inch

The actual inner diameter of this pipe is

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ID\PYGZus{}my\PYGZus{}pipe} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}my\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{ID\PYGZus{}my\PYGZus{}pipe}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mf}{8.2} \PYG{n}{cm}
\end{sphinxVerbatim}

We can display the available nominal pipe sizes that are in our
database.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ac}\PYG{o}{.}\PYG{n}{ND\PYGZus{}all\PYGZus{}available}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\chapter{Review: Fluid Mechanics}
\label{\detokenize{Review/Review_Fluid_Mechanics:review-fluid-mechanics}}\label{\detokenize{Review/Review_Fluid_Mechanics:title-review-fluid-mechanics}}\label{\detokenize{Review/Review_Fluid_Mechanics::doc}}
This document is meant to be a refresher on fluid mechanics. It will only cover the topics in fluids mechanics that will be used heavily in the course.

If you wish to review fluid mechanics in (much) more detail, please refer to \sphinxhref{https://github.com/AguaClara/CEE4540\_Master/wiki/Fluids-Review-Guide}{this guide} Note that to view this link, you will need a Github accounts. If you wish to review from a legitimate textbook, you can find a pdf of good book by Frank White \sphinxhref{https://hellcareers.files.wordpress.com/2016/01/fluid-mechanics-seventh-edition-by-frank-m-white.pdf}{here}.


\section{Important Terms and Equations}
\label{\detokenize{Review/Review_Fluid_Mechanics:important-terms-and-equations}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-fluids-terms-eqs}}
\sphinxstylestrong{Terms:}
\begin{enumerate}
\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-laminar-and-turbulent-flow}]{\sphinxcrossref{\DUrole{std,std-ref}{Laminar}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-laminar-and-turbulent-flow}]{\sphinxcrossref{\DUrole{std,std-ref}{Turbulent}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-laminar-and-turbulent-flow}]{\sphinxcrossref{\DUrole{std,std-ref}{Viscosity}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-streamlines-and-control-volumes}]{\sphinxcrossref{\DUrole{std,std-ref}{Streamline}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-streamlines-and-control-volumes}]{\sphinxcrossref{\DUrole{std,std-ref}{Control Volume}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-bernoulli-equation}]{\sphinxcrossref{\DUrole{std,std-ref}{Head}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-head-loss}]{\sphinxcrossref{\DUrole{std,std-ref}{Head loss}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-head-loss-elevation-difference-trick}]{\sphinxcrossref{\DUrole{std,std-ref}{Driving head}}}}

\item {} 
{\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-what-is-a-vena-contracta}]{\sphinxcrossref{\DUrole{std,std-ref}{Vena Contracta/Coefficient of Contraction}}}}

\end{enumerate}

\sphinxstylestrong{Equations:}
\begin{enumerate}
\item {} 
Continuity equation: \eqref{equation:Review/Review_Fluid_Mechanics:continuity_equation}

\item {} 
Reynolds number \eqref{equation:Review/Review_Fluid_Mechanics:reynolds_number_equation}

\item {} 
Bernoulli equation \eqref{equation:Review/Review_Fluid_Mechanics:bernoulli_equation}

\item {} 
Energy equation \eqref{equation:Review/Review_Fluid_Mechanics:energy_equation}

\item {} 
Darcy-Weisbach equation \eqref{equation:Review/Review_Fluid_Mechanics:darcy_weisbach}

\item {} 
Swamee-Jain equation \eqref{equation:Review/Review_Fluid_Mechanics:swamee_jain}

\item {} 
Hagen-Poiseuille equation \eqref{equation:Review/Review_Fluid_Mechanics:hagen_poiseuille}

\item {} 
Orifice equation \eqref{equation:Review/Review_Fluid_Mechanics:orifice_equation}

\end{enumerate}


\section{Introductory Concepts}
\label{\detokenize{Review/Review_Fluid_Mechanics:introductory-concepts}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-introductory-concepts}}
Before diving in to the rest of this document, there are a few important concepts to focus on which will be the foundation for building your understanding of fluid mechanics. One must walk before they can run, and similarly, the basics of fluid mechanics must be understood before moving on to the more fun (and exciting!) sections of this document.


\subsection{Continuity Equation}
\label{\detokenize{Review/Review_Fluid_Mechanics:continuity-equation}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-continuity-equation}}
Continuity is simply an application of mass balance to fluid mechanics. It states that the cross sectional area \(A\) that a fluid flows through multiplied by the fluid’s average flow velocity \(\bar v\) must equal the fluid’s flow rate \(Q\):
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:continuity_equation}
\begin{split}  Q = \bar v A\end{split}
\end{equation}
\begin{sphinxadmonition}{note}{Note:}
The line above the \(v\) is called a ‘bar,’ and represents an average. Any variable can have a bar. In this case, we are adding the bar to velocity \(v\), turning it into average velocity \(\bar v\). This variable is pronounced ‘v bar.’
\end{sphinxadmonition}

In this course, we deal primarily with flow through pipes. For a circular pipe, \(A = \pi r^2\). Substituting diameter in for radius, \(r = \frac{D}{2}\), we get \(A = \frac{\pi D^2}{4}\). You will often see this form of the continuity equation being used to relate the a pipe’s flow rate to its diameter and the velocity of the fluid flowing through it:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:0}
\begin{split}Q = \bar v \frac{\pi D^2}{4}\end{split}
\end{equation}
The continuity equation is also useful when flow is going from one geometry to another. In this case, the flow in one geometry must be the same as the flow in the other, \(Q_1 = Q_2\), which yields the following equations:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:1}
\begin{split}\bar v_1 A_1 = \bar v_2 A_2\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:2}
\begin{split}\bar v_1 \frac{\pi D_1^2}{4} = \bar v_2 \frac{\pi D_2^2}{4}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(Q =\) fluid flow rate
\item[] \(\bar v =\) fluid average velocity
\item[] \(A =\) pipe area
\item[] \(r =\) pipe radius
\item[] \(D =\) pipe diameter
\end{DUlineblock}

An example of changing flow geometries is when a change in pipe size occurs in a circular piping system, as is demonstrated below. The flow through \({\rm pipe} \, 1\) must be the same as the flow through \({\rm pipe} \, 2\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{continuity_pipes}.png}
\caption{Flow going from a small diameter pipe to a large one. The continuity principle states that the flow through each pipe must be the same.}\label{\detokenize{Review/Review_Fluid_Mechanics:id1}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-continuity-pipes}}\end{figure}


\subsection{Laminar and Turbulent Flow}
\label{\detokenize{Review/Review_Fluid_Mechanics:laminar-and-turbulent-flow}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-laminar-and-turbulent-flow}}
Considering that this class deals with the flow of water through a water treatment plant, understanding the characteristics of the flow is very important. Thus, it is necessary to understand the most common characteristic of fluid flow: whether it is \sphinxstylestrong{laminar} or \sphinxstylestrong{turbulent}. \sphinxhref{https://en.wikipedia.org/wiki/Laminar\_flow}{Laminar} flow is very smooth and highly ordered. \sphinxhref{https://en.wikipedia.org/wiki/Turbulence}{Turbulent} flow is chaotic, messy, and disordered. The best way to understand each flow and what it looks like is visually, like in the Wikipedia figure below \sphinxhref{https://youtu.be/qtvVN2qt968?t=131}{or in this video}. Please ignore the part of the video after the image of the tap.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Wikipedia_laminar_turbulent}.png}
\caption{This is a beautiful example of the difference between ordered and smooth laminar flow and chaotic turbulent flow.}\label{\detokenize{Review/Review_Fluid_Mechanics:id2}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-wikipedia-laminar-turbulent}}\end{figure}

A numeric way to determine whether flow is laminar or turbulent is by finding the \sphinxhref{https://en.wikipedia.org/wiki/Reynolds\_number}{Reynolds number}, \({\rm Re}\). The Reynolds number is a dimensionless parameter that compares inertia, represented by the average flow velocity \(\bar v\) times a length scale \(D\) to \sphinxhref{https://en.wikipedia.org/wiki/Viscosity}{viscosity}, represented by the kinematic viscosity \(\nu\). \sphinxhref{https://www.youtube.com/watch?v=DVQw0svRHZA}{Click here} for a brief video explanation of viscosity. If the Reynolds number is less than 2,100 the flow is considered laminar. If it is more than 2,100, it is considered turbulent.
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:3}
\begin{split}{\rm Re = \frac{inertia}{viscosity}} = \frac{\bar vD}{\nu}\end{split}
\end{equation}
\sphinxhref{https://en.wikipedia.org/wiki/Laminar\%E2\%80\%93turbulent\_transition}{The transition between laminar and turbulent flow is not yet well understood}, which is why the concept of transitional flow is often simplified and neglected to make it possible to code for laminar or turbulent flow, which are better understood. We will assume that the transition occurs at \(\rm{Re} = 2100\). In aguaclara, this parameter shows us as \sphinxcode{\sphinxupquote{pc.RE\_TRANSITION\_PIPE}}.

Fluid can flow through very many different geometries, like a pipe, a rectangular channel, or any other shape. To account for this, the characteristic length scale for the Reynolds number, which was written in the equation above as \(D\), is quantified as the \sphinxhref{https://www.engineeringtoolbox.com/hydraulic-equivalent-diameter-d\_458.html}{hydraulic diameter}, \(D_h\) when considering a general cross-sectional area. For circular pipes, which are the most common geometry you’ll encounter in this class, the hydraulic diameter is simply the pipe’s diameter, \(D_h = D\).

Here are other commonly used forms of the Reynolds number equation \sphinxstyleemphasis{for circular pipes}. They are the same as the one above, just with the substitutions \(Q = \bar v \frac{\pi D^2}{4}\) and \(\nu = \frac{\mu}{\rho}\)
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:reynolds_number_equation}
\begin{split}  {\rm Re} = \frac{\bar vD}{\nu} = \frac{4Q}{\pi D\nu} = \frac{\rho \bar vD}{\mu}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(Q\) = fluid flow rate in pipe
\item[] \(D\) = pipe diameter
\item[] \(\bar v\) = fluid velocity
\item[] \(\nu\) = fluid kinematic viscosity
\item[] \(\mu\) = fluid dynamic viscosity
\end{DUlineblock}


\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara:} \sphinxcode{\sphinxupquote{pc.re\_pipe(FlowRate, Diam, Nu)}} Returns the Reynolds number \sphinxstyleemphasis{in a circular pipe}. Functions for finding the Reynolds number through other flow conduits and geometries can also be found in \sphinxhref{https://github.com/AguaClara/aguaclara}{physchem.py} within aguaclara.



\begin{sphinxadmonition}{note}{Note:}
\sphinxstylestrong{Definition of Flow Regimes:} Laminar and turbulent flow are described as two different \sphinxstylestrong{flow regimes}. When there is a characteristic of flow and different categories of the characteristic, each category is referred to as a flow regime. For example, the Reynolds number describes a flow characteristic, and its categories, referred to as flow regimes, are laminar or turbulent.
\end{sphinxadmonition}


\subsection{Streamlines and Control Volumes}
\label{\detokenize{Review/Review_Fluid_Mechanics:streamlines-and-control-volumes}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-streamlines-and-control-volumes}}
Both \sphinxhref{https://en.wikipedia.org/wiki/Streamlines,\_streaklines,\_and\_pathlines}{streamlines} and \sphinxhref{https://www.engineersedge.com/fluid\_flow/control\_volume.htm}{control volumes} are tools to compare different parts of a system. For this class, this system will always be hydraulic.

Imagine water flowing through a pipe. A streamline is the path that a particle would take if it could be placed in the fluid without changing the original flow of the fluid. A more technical definition is “a line which is everywhere parallel to the local velocity vector.” Computational tools, \sphinxhref{https://www.nuclear-power.net/wp-content/uploads/2016/05/Flow-Regime.png?4b884b}{dyes (in water)}, or \sphinxhref{https://www.youtube.com/watch?v=E9ZSAX56m0E\&t=59s}{smoke (in air)} can be used to visualize streamlines.

A \sphinxstylestrong{control volume} is just an imaginary 3-dimensional shape in space. Its boundaries can be placed anywhere by the person applying the control volume, and once set the boundaries remain fixed in space over time. These boundaries are usually chosen to compare two relevant surfaces to each other. These surfaces are called \sphinxstyleemphasis{Control Surfaces}. The entirety of a control volume is usually not shown, as it is often unnecessary. This is demonstrated in the following image:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{control_volume_simplification}.png}
\caption{While the image on the left indicates a complete control volume, control volumes are usually shortened to only include the relevant control surfaces, in which the control volume intersects the fluid. This is shown in the image on the right.}\label{\detokenize{Review/Review_Fluid_Mechanics:id3}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-control-volume-simplification}}\end{figure}

\begin{sphinxadmonition}{important}{Important:}
Many images will be used over the course of this class to show hydraulic systems. A standardized system of lines will be used throughout them all to distinguish reference elevations from control volumes from streamlines. This system is described in the image below.
\end{sphinxadmonition}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{image_control_volumes}.png}
\caption{On the left, a control volume is applied to a hydraulic system. On the right, a streamline is applied to a hydraulic system. A figure-convention for control volumes and streamlines will be very helpful throughout this course as there will be very, very many figures.}\label{\detokenize{Review/Review_Fluid_Mechanics:id4}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-image-control-volumes}}\end{figure}


\section{The Bernoulli and Energy Equations}
\label{\detokenize{Review/Review_Fluid_Mechanics:the-bernoulli-and-energy-equations}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-bernoulli-and-energy-equations}}
As explained in almost every fluid mechanics class, the Bernoulli and energy equations are incredibly useful in understanding the transfer of the fluid’s energy throughout a streamline or through a control volume. The Bernoulli equation applies to two different points along one streamline, whereas the energy equation applies to fluid entering and exiting a control volume. The energy of a fluid has three forms: pressure, potential (deriving from elevation), and kinetic (deriving from velocity).


\subsection{The Bernoulli Equation}
\label{\detokenize{Review/Review_Fluid_Mechanics:the-bernoulli-equation}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-bernoulli-equation}}
These three forms of energy expressed above make up the Bernoulli equation:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:bernoulli_equation}
\begin{split}  \frac{p_1}{\rho g} + {z_1} + \frac{v_1^2}{2g} = \frac{p_2}{\rho g} + {z_2} + \frac{v_2^2}{2g}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(p\) = pressure
\item[] \(\rho\) = fluid density
\item[] \(g\) = acceleration due to gravity
\item[] \(z\) = elevation relative to a reference
\item[] \(v\) = fluid velocity
\end{DUlineblock}

Notice that each term in this form of the Bernoulli equation has units of \([L]\), even though the terms represent the energy of the fluid, which has units of \(\frac{[M] \cdot [L]^2}{[T]^2}\). When energy of the fluid is described in units of length, the term used is called \sphinxstylestrong{head} and referred to as \(h\).

There are two important distinctions to keep in mind when using head to talk about a fluid’s energy. First is that head is dependent on the density of the fluid under consideration. Take mercury, for example, which is around 13.6 times more dense than water. 1 meter of mercury head is therefore equivalent to around 13.6 meters of water head. Second is that head is independent of the amount of fluid being considered, \sphinxstyleemphasis{as long as all the fluid is the same density}. Thus, raising 1 liter of water up by one meter and raising 100 liters of water up by one meter are both equivalent to giving the water 1 meter of water head, even though it requires 100 times more energy to raise the hundred liters than to raise the single liter. Since we are concerned mainly with water in this class, we will refer to ‘water head’ simply as ‘head’.

Going back to the Bernoulli equation, the \(\frac{p}{\rho g}\) term is called the pressure head, \(z\) is called the elevation head, and \(\frac{v^2}{2g}\) is the velocity head. The following diagram shows these various forms of head via a 1 meter deep bucket (left) and a jet of water shooting out of the ground (right).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{different_forms_of_head}.png}
\caption{The three forms of hydraulic head.}\label{\detokenize{Review/Review_Fluid_Mechanics:id5}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-different-forms-of-head}}\end{figure}


\subsubsection{Assumption in using the Bernoulli equation}
\label{\detokenize{Review/Review_Fluid_Mechanics:assumption-in-using-the-bernoulli-equation}}
Though there are \sphinxhref{https://en.wikipedia.org/wiki/Bernoulli\%27s\_principle\#Incompressible\_flow\_equation}{many assumptions needed to confirm that the Bernoulli equation can be used}, the main one for the purpose of this class is that energy is not gained or lost throughout the streamline being considered. If we consider more precise fluid mechanics terminology, then “friction by viscous forces must be negligible.” What this means is that the fluid along the streamline being considered is not losing energy to viscosity. As a result, using the Bernoulli equation implies that energy can’t be gained or lost. It can only be transferred between its three forms.


\subsubsection{Example problems}
\label{\detokenize{Review/Review_Fluid_Mechanics:example-problems}}
\sphinxhref{https://www.teachengineering.org/content/cub\_/lessons/cub\_bernoulli/cub\_bernoulli\_lesson01\_bepworksheetas\_draft4\_tedl\_dwc.pdf}{Here is a simple worksheet with very straightforward example problems using the Bernoulli equation.} Note that the solutions use the pressure-form of the Bernoulli equation. This just means that every term in the equation is multiplied by \(\rho g\), so the pressure term is just \(P\). The form of the equation does not affect the solution to the problem it helps solved.


\subsection{The Energy Equation}
\label{\detokenize{Review/Review_Fluid_Mechanics:the-energy-equation}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-energy-equation}}
The assumption necessary to use the Bernoulli equation, which is stated above, represents the key difference between the Bernoulli equation and the energy equation for the purpose of this class. The energy equation accounts for the potential addition or loss of fluid energy within the control volume. (L)oss of energy is usually due to viscous friction resisting fluid flow, \(h_L\), or the charging of a (T)urbine, \(h_T\). The most common input of fluid energy into a system is usually caused by a (P)ump within the control volume, \(h_P\).
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:4}
\begin{split}\frac{p_{1}}{\rho g} + z_{1} + \alpha_{1} \frac{\bar v_{1}^2}{2g} + h_P = \frac{p_{2}}{\rho g} + z_{2} + {\alpha_{2}} \frac{\bar v_{2}^2}{2g} + h_T + h_L\end{split}
\end{equation}
You’ll also notice the \(\alpha\) term attached to the velocity head. This is a correction factor for kinetic energy, and will be neglected in this class; we assume that its value is 1. In the Bernoulli equation, the velocity of a streamline of the fluid is considered, \(v\). The energy equation, however compares control surfaces instead of streamlines, and the velocities across a control surface many not all be the same. Hence, \(\bar v\) is used to represent the average velocity. Since AguaClara does not use pumps nor turbines, \(h_P = h_T = 0\). With these simplifications, the energy equation can be written as follows:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:energy_equation}
\begin{split}  \frac{p_{1}}{\rho g} + z_{1} + \frac{\bar v_{1}^2}{2g} = \frac{p_{2}}{\rho g} + z_{2} + \frac{\bar v_{2}^2}{2g} + h_L\end{split}
\end{equation}
\sphinxstylestrong{This is the form of the energy equation that you will see over and over again in this book.} To summarize, the main difference between the Bernoulli equation and the energy equation for the purposes of this class is energy loss. The energy equation accounts for the fluid’s loss of energy over time while the Bernoulli equation does not. So how can the fluid lose energy?


\section{Head\_loss}
\label{\detokenize{Review/Review_Fluid_Mechanics:head-loss}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-head-loss}}
\sphinxstylestrong{Head (L)oss}, \(h_L\) is a term that is ubiquitous in both this class and fluid mechanics in general. Its definition is exactly as it sounds: it refers to the loss of energy of a fluid as it flows through space. There are two components to head loss: major losses caused by (f)riction between the fluid and the surface it’s flowing over, \(h_{\rm{f}}\), and minor losses caused by fluid-fluid internal friction resulting from flow (e)xpansions, \(h_e\). These two components combine such that \(h_L = h_{\rm{f}} + h_e\).


\subsection{Major Losses}
\label{\detokenize{Review/Review_Fluid_Mechanics:major-losses}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-major-losses}}
These losses are the result of friction between the fluid and the surface over which the fluid is flowing. A force acting parallel to a surface is referred to as \sphinxhref{https://en.wikipedia.org/wiki/Shear\_force}{shear}. It can therefore be said that major losses are the result of shear between the fluid and the surface it’s flowing over. To help in understanding major losses, consider the following example: imagine, as you have so often in physics class, pushing a large box across the ground. Friction is what resists your efforts to push the box. The farther you push the box, the more energy you expend pushing against friction. The same is true for water moving through a pipe, where water is analogous to the box you want to move, the pipe is similar to the floor that provides the friction, and the major losses of the water through the pipe is analogous to the energy \sphinxstylestrong{you} expend by pushing the box.

In this class, we will be dealing primarily with major losses in circular pipes, as opposed to channels or pipes with other geometries. Fortunately for us, Henry Darcy and Julius Weisbach came up with a handy equation to determine the major losses in a circular pipe \sphinxstyleemphasis{under both laminar and turbulent flow conditions}. Their equation is logically and unoriginally named the \sphinxhref{https://en.wikipedia.org/wiki/Darcy\%E2\%80\%93Weisbach\_equation}{Darcy-Weisbach equation}. It is shown below:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:darcy_weisbach}
\begin{split}  h_{\rm{f}} \, = \, {\rm{f}} \frac{L}{D} \frac{\bar v^2}{2g}\end{split}
\end{equation}
Substituting the continuity equation \(Q = \bar vA\) in the form of \(\bar v^2 = \frac{16Q^2}{\pi^2 D^4}\) gives another, equivalent form of Darcy-Weisbach which uses flow, \(Q\), instead of velocity, \(\bar v\):
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:5}
\begin{split}h_{\rm{f}} \, = \,{\rm{f}} \frac{8}{g \pi^2} \frac{LQ^2}{D^5}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(h_{\rm{f}}\) = major loss
\item[] \(\rm{f}\) = Darcy friction factor
\item[] \(L\) = pipe length
\item[] \(Q\) = pipe flow rate
\item[] \(D\) = pipe diameter
\end{DUlineblock}


\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara:} \sphinxcode{\sphinxupquote{pc.headloss\_fric(FlowRate, Diam, Length, Nu, PipeRough)}} Returns only major losses. Works for both laminar and turbulent flow. PipeRough describes the pipe roughness \(\epsilon\) described shortly below.



Darcy-Weisbach is wonderful because it applies to both laminar and turbulent flow regimes and contains relatively easy to measure variables. The one exception is the Darcy friction factor, \(\rm{f}\). This parameter is an approximation for the magnitude of friction between the pipe walls and the fluid, and its value changes depending on the whether or not the flow is laminar or turbulent, and varies with the Reynolds number in both flow regimes.

For laminar flow, the friction factor can be determined from the following equation:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:6}
\begin{split}{\rm{f}} = \frac{64}{\rm{Re}}\end{split}
\end{equation}
For turbulent flow, the friction factor is more difficult to determine. In this class, we will use the \sphinxhref{https://en.wikipedia.org/wiki/Darcy\_friction\_factor\_formulae\#Swamee\%E2\%80\%93Jain\_equation}{Swamee-Jain equation}:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:swamee_jain}
\begin{split}  {\rm{f}} = \frac{0.25} {\left[ \log \left( \frac{\epsilon }{3.7D} + \frac{5.74}{{\rm Re}^{0.9}} \right) \right]^2}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\epsilon\) = pipe roughness, \([L]\)
\item[] \(D\) = pipe diameter, \([L]\)
\end{DUlineblock}


\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara:} \sphinxcode{\sphinxupquote{pc.fric(FlowRate, Diam, Nu, PipeRough)}} Returns \(\rm{f}\) for laminar \sphinxstyleemphasis{or} turbulent flow. For laminar flow, use zero for the \sphinxcode{\sphinxupquote{PipeRough}} input.



The simplicity of the equation for \(\rm{f}\) during laminar flow allows for substitutions to create a very useful, simplified equation for major losses during laminar flow. This simplification combines the Darcy-Weisbach equation, the equation for the Darcy friction factor during laminar flow, and the Reynold’s number formula:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:7}
\begin{split}h_{\rm{f}} \, = \,{\rm{f}} \frac{8}{g \pi^2} \frac{LQ^2}{D^5}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:8}
\begin{split}{\rm{f}} = \frac{64}{\rm{Re}}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:9}
\begin{split}{\rm{Re}}=\frac{4Q}{\pi D\nu}\end{split}
\end{equation}
To form the \sphinxhref{https://en.wikipedia.org/wiki/Hagen\%E2\%80\%93Poiseuille\_equation}{Hagen-Poiseuille equation} for major losses during laminar flow, and \sphinxstyleemphasis{only} during laminar flow:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:hagen_poiseuille}
\begin{split}  h_{\rm{f}} = \frac{128\mu L Q}{\rho g\pi D^4}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:10}
\begin{split}h_{\rm{f}} = \frac{32\nu L\bar v}{ g D^2}\end{split}
\end{equation}
The significance of this equation lies in its relationship between \(h_{\rm{f}}\) and \(Q\). Hagen-Poiseuille shows that the terms are directly proportional (\(h_{\rm{f}} \propto Q\)) during laminar flow, while Darcy-Weisbach shows that \(h_{\rm{f}}\) grows with the square of \(Q\) during turbulent flow (\(h_{\rm{f}} \propto Q^2\)). As you will soon see, minor losses, \(h_e\), will grow with the square of \(Q\) in both laminar and turbulent flow. This has implications that will be discussed in a future chapter: {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Design:title-flow-control-design}]{\sphinxcrossref{\DUrole{std,std-ref}{Flow Control and Measurement Design}}}}.

In 1944, Lewis Ferry Moody plotted a ridiculous amount of experimental data, gathered by many people, on the Darcy-Weisbach friction factor to create what we now call the \sphinxhref{https://en.wikipedia.org/wiki/Moody\_chart}{Moody diagram}. This diagram makes it easy to find the friction factor \(f\). \(\rm{f}\) is plotted on the left-hand y-axis, relative pipe roughness \(\frac{\epsilon}{D}\) is on the right-hand y-axis, and Reynolds number \(\rm{Re}\) is on the x-axis. The Moody diagram is an alternative to computational methods for finding \(\rm{f}\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{Moody}.jpg}
\caption{This is the famous and famously useful Moody diagram.}\label{\detokenize{Review/Review_Fluid_Mechanics:id6}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-moody}}\end{figure}


\subsection{Minor Losses}
\label{\detokenize{Review/Review_Fluid_Mechanics:minor-losses}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-minor-losses}}
Unfortunately, there is no simple ‘pushing a box across the ground’ example to explain minor losses. So instead, consider a \sphinxhref{https://www.youtube.com/watch?v=5spXXZX55C8}{hydraulic jump}. In the video, you can see lots of turbulence and eddies in the transition region between the fast, shallow flow and the slow, deep flow. The high amount of mixing of the water in the transition region of the hydraulic jump results in significant friction \sphinxstyleemphasis{between water and water}. This turbulent, eddy-induced, fluid-fluid friction results in  minor losses, much like fluid-pipe friction results in major losses.

As occurs in a hydraulic jump, a flow expansion (from shallow flow to deep flow) creates the turbulent eddies that result in minor losses. This will be a recurring theme in throughout the course: \sphinxstylestrong{minor losses are caused by flow expansions}. Imagine a pipe fitting that connects a small diameter pipe to a large diameter one, as shown in \hyperref[\detokenize{Review/Review_Fluid_Mechanics:figure-minor-loss-pipe-frd}]{Fig.\@ \ref{\detokenize{Review/Review_Fluid_Mechanics:figure-minor-loss-pipe-frd}}} below. The flow must expand to fill up the entire large diameter pipe. This expansion creates turbulent eddies near the union between the small and large pipes, and these eddies result in minor losses. You may already know the equation for minor losses, but understanding where it comes from is very important for effective AguaClara plant design. For this reason, you are strongly recommended to read through its full derivation: {\hyperref[\detokenize{Review/Review_Fluid_Mechanics_Derivations:title-review-fluid-mechanics-derivations}]{\sphinxcrossref{\DUrole{std,std-ref}{Review: Fluid Mechanics Derivations}}}}.

There are three forms of the minor loss equation that you will see in this class:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:11}
\begin{split}{\rm{ \mathbf{First \, form:} }} \quad h_e = \frac{\left( \bar v_{in}  - \bar v_{out} \right)^2}{2g}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:eq_exp_v_in}
\begin{split}{\rm{ \mathbf{Second \, form:} }} \quad h_e = \left( 1 - \frac{A_{in}}{A_{out}} \right)^2 \, \frac{\bar v_{in}^2}{2g} \, \, = \, \, K_e^{'} \frac{\bar v_{in}^2}{2g}, \quad {\rm where} \quad K_e^{'} = \left( 1 - \frac{A_{in}}{A_{out}} \right)^2\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:eq_exp_v_out}
\begin{split}\color{purple}{
{\rm{ \mathbf{Third \, form:} }} \quad h_e = \left(\frac{A_{out}}{A_{in}} -1 \right)^2 \, \frac{\bar  v_{out}^2}{2g} \, \, = \, \, K_e \frac{\bar v_{out}^2}{2g}, \quad {\rm where} \quad K_e = \left( \frac{A_{out}}{A_{in}} - 1 \right)^2
}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(K_e^{'}, \,\, K_e\) = minor loss coefficients, dimensionless
\end{DUlineblock}

\begin{sphinxadmonition}{note}{Note:}
You will most often see \(K_e^{'}\) and \(K_e\) used without the \(e\) subscript,  as \(K^{'}\) and \(K\).
\end{sphinxadmonition}


\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara:} \sphinxcode{\sphinxupquote{pc.headloss\_exp\_general(Vel, KMinor)}} Returns \(h_e\). Can be either the second or third form due to user input of both velocity and minor loss coefficient. It is up to the user to use consistent \(\bar v\) and \(K_e\).




\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara:} \sphinxcode{\sphinxupquote{pc.headloss\_exp(FlowRate, Diam, KMinor)}} Returns \(h_e\). Uses third form, \(K_e\).



\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{minor_loss_pipe}.png}
\caption{The \(in\) and \(out\) subscripts in each of the three forms of the minor loss equation refer to this diagram that was used for the derivation.}\label{\detokenize{Review/Review_Fluid_Mechanics:id7}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-minor-loss-pipe-frd}}\end{figure}

The second and third forms are the ones which you are probably most familiar with. The distinction between them, however, is critical. First, consider the magnitudes of \(A_{in}\) and \(A_{out}\). \(A_{in}\) can never be larger than \(A_{out}\), because the flow is expanding. When flow expands, the cross-sectional area it flows through must increase. As a result, both \(\frac{A_{out}}{A_{in}} > 1\) and \(\frac{A_{in}}{A_{out}} < 1\) must always be true. This means that \(K^{'}\) can never be greater than 1, while \(K\) technically has no upper limit.

If you have taken CEE 3310, you have seen tables of minor loss coefficients \sphinxhref{https://www.engineeringtoolbox.com/minor-loss-coefficients-pipes-d\_626.html}{like this
one}, and they almost all have coefficients greater than 1. This implies that these tables use the third form of the minor loss equation as we have defined it, where the velocity is \(\bar v_{out}\). There is a good reason for using the third form over the second one: \(\bar v_{out}\) is far easier to determine than \(\bar v_{in}\). Consider flow through a pipe elbow, as shown in the image below.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{minor_loss_elbow}.png}
\caption{Flow around a pipe elbow results in a minor loss. ‘Control surface 1’ can be abbreviated as ‘CS 1’}\label{\detokenize{Review/Review_Fluid_Mechanics:id8}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-minor-loss-elbow}}\end{figure}

In order to find \(\bar v_{out}\), we first need to know what (or where) is \(out\) and what is \(in\). A simple way to distinguish the two surfaces is that \(in\) occurs when the flow is most contracted, and \(out\) occurs when the flow has fully expanded after that maximal contraction. Going on these guidelines, Control surface ‘2’ (CS 2) in the figure above would be \(in\), since it represents the most contracted flow in the elbow-pipe system. Therefore, CS 3 would be \(out\), as it represents the flow having fully expanded after its compression at CS 2.

\(\bar v_{out}\) is easy to determine because it is the velocity of the fluid as it flows through the entire area of the pipe. Thus, \(\bar v_{out}\) can be found with the continuity equation, since the flow through the pipe and its diameter are easy to measure, \(\bar v_{out} = \frac{4 Q}{\pi D^2}\). On the other hand, \(\bar v_{in}\) is difficult to find, as the area of the contracted flow is dependent on the exact geometry of the elbow. This is why the third form of the minor loss equation, as we have defined it, is the most common:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:12}
\begin{split}h_e = K \frac{\bar v_{out}^2}{2g} = \,\,\,\, \left( \frac{A_{out}}{A_{in}} -1 \right)^2 \frac{\bar v_{out}^2}{2g}\end{split}
\end{equation}
\begin{sphinxadmonition}{note}{Note:}
When considering a hydraulic system within a control volume, there can be many sources of minor losses. Instead of saying \(h_e = K_1 \frac{\bar v_{out}^2}{2g} + K_2 \frac{\bar v_{out}^2}{2g} + ...\) we can simply lump all of the minor loss coefficients into one: \(\sum K = K_1 + K_2 + ...\). Thus, it is also common to see this form of the minor loss equation when finding the minor loss across control volumes: \(\sum K \frac{v_{out}^2}{2g}\).
\end{sphinxadmonition}


\subsection{Head Loss = Elevation Difference Trick}
\label{\detokenize{Review/Review_Fluid_Mechanics:head-loss-elevation-difference-trick}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-head-loss-elevation-difference-trick}}
This trick, also called the ‘control volume trick,’ or more colloquially, the ‘head loss trick,’ is incredibly useful for simplifying hydraulic systems and is used all the time in this class.

Consider the following figure:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{head_loss_trick}.png}
\caption{A typical hydraulic system can be used to understand the head loss trick.}\label{\detokenize{Review/Review_Fluid_Mechanics:id9}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-head-loss-trick}}\end{figure}

In systems like this, where an elevation difference is causing water to flow, the elevation difference is called the \sphinxstylestrong{driving head}. In the system above, the driving head is the elevation difference between the water level and the end of the tubing. Usually, driving head is written as \(\Delta z\) or \(\Delta h\), though above it is labelled as \(h_L\). Doesn’t \(h_L\) refer to head loss though? Yes it does! Referring to \(\Delta h\) or \(\Delta z\) \sphinxstyleemphasis{IS} the head loss trick, and how it works is explained in the following paragraphs and equations.

The figure is technically violating the energy equation by saying that the elevation difference between the water in the tank and the end of the tube is \(h_L\). It implies that all of the driving head, \(\Delta z\), is lost to head loss. Since all of the energy is gone, there should not be water flowing out of the tubing. But there is. Let’s apply the energy equation across the control surfaces shown in the figure. Pressures at both ends are atmospheric and the velocity of water at the top of tank is negligible.
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:13}
\begin{split}\cancel{ \frac{p_{1}}{\rho g} } + z_{1} + \cancel{ \frac{\bar v_{1}^2}{2g} } = \cancel{ \frac{p_{2}}{\rho g} } + z_{2} + \frac{\bar v_{2}^2}{2g} + h_L\end{split}
\end{equation}
We now get:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:14}
\begin{split}\Delta z = \frac{\bar v_2^2}{2g} + h_L\end{split}
\end{equation}
This equation contradicts the figure above, which says that \(\Delta z = h_L\) and neglects \(\frac{\bar v_2^2}{2g}\). The figure above is correct, however, if you apply the head loss trick. The trick incorporates the \(\frac{\bar v_2^2}{2g}\) term \sphinxstyleemphasis{into} the \(h_L\) term as a minor loss. See the math below:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:15}
\begin{split}\Delta z = \frac{\bar v_2^2}{2g} + h_e + h_f\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:16}
\begin{split}\Delta z = \frac{\bar v_2^2}{2g} + \left( \sum K \right) \frac{\bar v_2^2}{2g} + h_f\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:17}
\begin{split}\Delta z = \left( 1 + \sum K \right) \frac{\bar v_2^2}{2g} + h_f\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:18}
\begin{split}\Delta z = \left( \sum K \right) \frac{\bar v_2^2}{2g} + h_f\end{split}
\end{equation}
This last step incorporated the kinetic energy term of the energy equation, \(\frac{\bar v_2^2}{2g}\), into the minor loss equation by saying that its \(K\) is 1 and incorporating that 1 into \(\sum K\). From here, we reverse our steps to get \(\Delta z = h_L\), starting with \(h_e = \left( \sum K \right) \frac{\bar v_2^2}{2g}\)
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:19}
\begin{split}\Delta z = h_e + h_f\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:20}
\begin{split}\Delta z = h_L\end{split}
\end{equation}
By applying the head loss trick, you are considering the entire flow of the fluid out of a control volume as energy lost via minor losses. This is just an algebraic trick, the only thing to remember when applying this trick is that \(\sum K\) will always be at least 1, even if there are no ‘real’ minor losses in the system.


\section{The Orifice Equation}
\label{\detokenize{Review/Review_Fluid_Mechanics:the-orifice-equation}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-the-orifice-equation}}
This equation is one that you’ll see and use again and again throughout this class. Understanding it now will be invaluable, as future concepts will use and build on this equation.


\subsection{What is a Vena Contracta?}
\label{\detokenize{Review/Review_Fluid_Mechanics:what-is-a-vena-contracta}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-what-is-a-vena-contracta}}
Before describing the equation, we must first understand the concept of a \sphinxhref{https://en.wikipedia.org/wiki/Vena\_contracta}{vena contracta}. Refer to the figure below.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{sluice_gate_vena_contracta}.png}
\caption{This figure shows flow around a sluice gate. Since streamlines can’t make sharp turns, the flow is forced to gradually curve and contract to an area smaller than the area of the gate.}\label{\detokenize{Review/Review_Fluid_Mechanics:id10}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-sluice-gate-vena-contracta}}\end{figure}

The flow contracts as the fluid moves past the gate. This happens because the fluid can’t make a sharp turn as it tries to go around the gate, as indicated by the streamline in the figure. Instead, the most extreme streamline makes a gradual change in direction. As a result of this gradual turn, the flow contracts and the cross-sectional area the fluid is flowing decreases.

The term ‘vena contracta’ describes the phenomenon of contracting flow due to streamlines being unable to make sharp turns. \(\Pi_{vc}\) is a dimensionless ratio comparing the flow area at the point of maximal contraction, \(A_{downstream}\), and the flow area \sphinxstyleemphasis{before} the contraction, \(A_{gate}\). In the figure above, the equation for the vena contracta coefficient would be:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:21}
\begin{split}\Pi_{vc} = \frac{A_{downstream}}{A_{gate}}\end{split}
\end{equation}
When the most extreme turn a streamline must make is 90°, the value of the vena contracta coefficient is close to 0.62. This parameter value, 0.62, is in aguaclara as \sphinxcode{\sphinxupquote{pc.VC\_ORIFICE\_RATIO}}. The vena contracta coefficient value is a function of the flow geometry. Since the ratio always puts the most contracted area over the least contracted area, \(\Pi_{vc}\) is always less than 1.

\begin{sphinxadmonition}{important}{Important:}
\sphinxstylestrong{A vena contracta coefficient is not a minor loss coefficient.} Though the equations for the two both involve contracted and non-contracted areas, these coefficients are not the same. Minor losses coefficients imply energy loss, and vena contractas do not. Minor losses coefficients deal with flow expansions, and vena contracas deal with flow contractions. Confusing the two coefficients is common mistake that this paragraph will hopefully help you to avoid.
\end{sphinxadmonition}

\begin{sphinxadmonition}{note}{Note:}
Note that what this class calls \(\Pi_{vc}\) is often referred to as a ‘Coefficient of Contraction,’ \(C_c\), in other engineering courses and settings.
\end{sphinxadmonition}


\subsection{Origin of the Orifice Equation}
\label{\detokenize{Review/Review_Fluid_Mechanics:origin-of-the-orifice-equation}}
The orifice equation is derived from the Bernoulli equation as applied to the purple points in the following image:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{hole_in_a_bucket}.png}
\caption{Flow through a hole in the bottom of a bucket is a great example of the orifice equation.}\label{\detokenize{Review/Review_Fluid_Mechanics:id11}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-hole-in-a-bucket}}\end{figure}

At point 1, the pressure is atmospheric and the instantaneous velocity is negligible as the water level in the bucket drops slowly. At point 2, the pressure is also atmospheric. We define the difference in elevations between the two points, \(z_1 - z_2\), to be \(\Delta h\). With these simplifications \((p_1 = \bar v_1 = p_2 = 0)\) and assumptions \((z_A - z_B = \Delta h)\), the Bernoulli equation becomes:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:22}
\begin{split}\Delta h = \frac{\bar v_2^2}{2g}\end{split}
\end{equation}
Substituting the continuity equation \(Q = \bar v A\) in the form of \(\bar v_2^2 = \frac{Q^2}{A_{vc}^2}\), the vena contracta coefficient in the form of \(A_{vc} = \Pi_{vc} A_{or}\) yields:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:23}
\begin{split}\Delta h = \frac{Q^2}{2g \Pi_{vc}^2 A_{or}^2}\end{split}
\end{equation}
Which, rearranged to solve for \(Q\) gives \sphinxstylestrong{The Orifice Equation:}
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:orifice_equation}
\begin{split}  Q = \Pi_{vc} A_{or} \sqrt{2g\Delta h}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\Pi_{vc}\) = 0.62 = vena contracta coefficient, as \sphinxcode{\sphinxupquote{pc.VC\_ORIFICE\_RATIO}}
\item[] \(A_{or}\) = orifice area- NOT contracted flow area
\item[] \(\Delta h\) = elevation difference between orifice and water level
\end{DUlineblock}


\sphinxstrong{See also:}


\sphinxstylestrong{Equation in aguaclara:} \sphinxcode{\sphinxupquote{pc.flow\_orifice(Diam, Height, RatioVCOrifice)}} Returns flow through a horizontal orifice.




\sphinxstrong{See also:}


\sphinxstylestrong{Equation in aguaclara:} \sphinxcode{\sphinxupquote{pc.flow\_orifice\_vert(Diam, Height, RatioVCOrifice)}} Returns flow through a vertical orifice. The height parameter refers to height above the center of the orifice.



There are two configurations for an orifice in the tank holding a fluid: horizontal and vertical. These are both displayed in the figure below. The orifice equation written is for a horizontal orifice; the equation for flow through vertical orifice equation requires integration or the orifice equation across its height to return the correct flow. This is explored in the Flow Control and Measurement Examples section.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=650\sphinxpxdimen]{{vertical_and_horizontal_orifices}.png}
\caption{The descriptions ‘vertical’ and ‘horizontal’ \sphinxstylestrong{apply to the orientation of the orifices,} not to the orientation of the fluid coming out of the orifices.}\label{\detokenize{Review/Review_Fluid_Mechanics:id12}}\label{\detokenize{Review/Review_Fluid_Mechanics:figure-vertical-and-horizontal-orifices}}\end{figure}


\section{Section Summary}
\label{\detokenize{Review/Review_Fluid_Mechanics:section-summary}}\label{\detokenize{Review/Review_Fluid_Mechanics:heading-fr-section-summary}}\begin{enumerate}
\item {} 
\sphinxstylestrong{Introductory Concepts:}
\begin{quote}
\begin{itemize}
\item {} 
\sphinxstylestrong{Continuity} means that the mass of a fluid is conserved as it flows, and implies a constant density. The continuity equation has two purposes:
\begin{quote}
\begin{enumerate}
\item {} 
Relating the average velocity of a fluid, \(\bar v\), to its flow rate, \(Q\), via the cross-sectional area, \(A\), that it flows through. When the fluid is flowing in a pipe, we can simply expand this even further to relate the flow rate and velocity to the pipe’s diameter, \(D\). The final equation below is only used for circular pipes, as it includes a pipe diameter.

\end{enumerate}
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:24}
\begin{split}Q = \bar v A = \bar v \frac{\pi D^2}{4}\end{split}
\end{equation}\begin{enumerate}
\item {} 
Finding the average velocity or flow when the geometry of a fluid’s flow changes, as the mass of the fluid must be conserved when it transitions through flow geometries.

\end{enumerate}
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:25}
\begin{split}Q_1 = Q_2\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:26}
\begin{split}\bar v_1 A_1 = \bar v_2 A_2\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:27}
\begin{split}\bar v_1 \frac{\pi D_1^2}{4} = \bar v_2 \frac{\pi D_2^2}{4}\end{split}
\end{equation}\end{quote}

\item {} 
\sphinxstylestrong{Laminar and Turbulent flow} describe the disorder and chaos of fluid flow. The \sphinxstylestrong{Reynolds number,} \({\rm Re}\) is used to distinguish laminar from turbulent flow. For \({\rm Re} < 2100\), flow is considered laminar. For \({\rm Re} > 2100\), flow is considered turbulent. The equations for the Reynolds number are below:

\end{itemize}
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:28}
\begin{split}{\rm Re} = \frac{\bar vD}{\nu} = \frac{4Q}{\pi D\nu} = \frac{\rho \bar vD}{\mu}\end{split}
\end{equation}\begin{itemize}
\item {} 
\sphinxstylestrong{Control volumes vs Streamlines.} This section is quite short, a summary would simply repeat what the sections says. The section is its own summary; read it here: {\hyperref[\detokenize{Review/Review_Fluid_Mechanics:streamlines-and-control-volumes}]{\sphinxcrossref{Streamlines and Control Volumes}}}

\end{itemize}
\end{quote}

\item {} 
\sphinxstylestrong{Bernoulli vs Energy equations:} The Bernoulli equation assumes that energy is conserved throughout a streamline or control volume. The Energy equation assumes that there is energy loss, or head loss \(h_L\). This head loss is composed of major losses, \(h_{\rm{f}}\), and minor losses, \(h_e\).

\end{enumerate}
\begin{quote}

Bernoulli equation:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:29}
\begin{split}\frac{p_1}{\rho g} + {z_1} + \frac{\bar v_1^2}{2g} = \frac{p_2}{\rho g} + {z_2} + \frac{\bar v_2^2}{2g}\end{split}
\end{equation}
Energy equation, simplified to remove pumps, turbines, and \(\alpha\) factors:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:30}
\begin{split}\frac{p_{1}}{\rho g} + z_{1} + \frac{\bar v_{1}^2}{2g} = \frac{p_{2}}{\rho g} + z_{2} + \frac{\bar v_{2}^2}{2g} + h_L\end{split}
\end{equation}\end{quote}
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
\sphinxstylestrong{Major losses:} Defined as the energy loss due to shear between the walls of the pipe/flow conduit and the fluid. The Darcy-Weisbach equation is used to find major losses in both laminar and turbulent flow regimes. The equation for finding the Darcy friction factor, \(\rm{f}\), changes depending on whether the flow is laminar or turbulent. The Moody diagram is a common graphical method for finding \(\rm{f}\). During laminar flow, the Hagen-Poiseuille equation, which is just a combination of Darcy-Weisbach, Reynolds number, and \({\rm{f}} = \frac{64}{\rm{Re}}\), can be used

\end{enumerate}
\begin{quote}

Darcy-Weisbach equation:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:31}
\begin{split}h_{\rm{f}} = {\rm{f}} \frac{L}{D} \frac{\bar v^2}{2g}\end{split}
\end{equation}
For water treatment plant design we tend to use plant flow rate, \(Q\), as our master variable and thus we have.
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:32}
\begin{split}h_{\rm{f}} = {\rm{f}} \frac{8}{g \pi^2} \frac{LQ^2}{D^5}\end{split}
\end{equation}
\(\rm{f}\) for laminar flow:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:33}
\begin{split}{\rm{f}} = \frac{64}{\rm{Re}} = \frac{16 \pi D \nu}{Q} = \frac{64 \nu}{\bar v D}\end{split}
\end{equation}
\(\rm{f}\) for turbulent flow:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:34}
\begin{split}{\rm{f}} = \frac{0.25} {\left[ \log \left( \frac{\epsilon }{3.7D} + \frac{5.74}{{\rm Re}^{0.9}} \right) \right]^2}\end{split}
\end{equation}
Hagen-Poiseuille equation for laminar flow:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:35}
\begin{split}h_{\rm{f}} = \frac{32\mu L \bar v}{\rho gD^2} = \frac{128\mu Q}{\rho g\pi D^4}\end{split}
\end{equation}\end{quote}
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
\sphinxstylestrong{Minor losses:} Defined as the energy loss due to the generation of turbulent eddies when flow expands. Once more: minor losses are caused by flow expansions. There are three forms of the minor loss equation, two of which look the same but use different coefficients (\(K^{'}\) vs \(K\)) and velocities (\(\bar v_{in}\) vs \(\bar v_{out}\)). \sphinxstyleemphasis{Make sure the coefficient you select is consistent with the velocity you use}. The third form, written in purple, is the most commonly used form of the minor loss equation.

\end{enumerate}
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:36}
\begin{split}{\rm{ \mathbf{First \, form:} }} \quad h_e = \frac{\left( \bar v_{in}  - \bar v_{out} \right)^2}{2g}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:37}
\begin{split}{\rm{ \mathbf{Second \, form:} }} \quad h_e = \left( 1 - \frac{A_{in}}{A_{out}} \right)^2 \, \frac{\bar v_{in}^2}{2g} \, \, = \, \, K_e^{'} \frac{\bar v_{in}^2}{2g}, \quad {\rm where} \quad K_e^{'} = \left( 1 - \frac{A_{in}}{A_{out}} \right)^2\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:38}
\begin{split}\color{purple}{
{\rm{ \mathbf{Third \, form:} }} \quad h_e = \left( \frac{A_{out}}{A_{in}} -1 \right)^2 \, \frac{\bar  v_{out}^2}{2g} \, \, = \, \, K_e \frac{\bar v_{out}^2}{2g}, \quad {\rm where} \quad K_e = \left( \frac{A_{out}}{A_{in}} - 1 \right)^2
}\end{split}
\end{equation}\begin{enumerate}
\setcounter{enumi}{4}
\item {} 
\sphinxstylestrong{Major and minor losses vary with flow:} While it is generally important to know how increasing or decreasing flow will affect head loss, it is even more important for this class to understand exactly how flow will affect head loss. As the table below shows, head loss will always be proportional to flow squared during turbulent flow. During laminar flow, however, the exponent on \(Q\) will be between 1 and 2 depending on the proportion of major to minor losses.

\end{enumerate}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Proportionality between head loss \(h_L\) and flow rate \(Q\) for different flow regimes and types of head loss.}\label{\detokenize{Review/Review_Fluid_Mechanics:id13}}\label{\detokenize{Review/Review_Fluid_Mechanics:table-h-q-proportionality}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{10}{30}|\X{10}{30}|\X{10}{30}|}
\hline

\(h_L propto Q^?\)
&\sphinxstyletheadfamily 
Major Losses
&\sphinxstyletheadfamily 
Minor Losses
\\
\hline
Laminar
&
\(Q\)
&
\(Q^2\)
\\
\hline
Turbulent
&
\(Q^2\)
&
\(Q^2\)
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}
\begin{enumerate}
\setcounter{enumi}{5}
\item {} 
The \sphinxstylestrong{head loss trick}, also called the control volume trick, can be used to incorporate the ‘kinetic energy out’ term of the energy equation, \(\frac{\bar v_2^2}{2g}\), into head loss as a minor loss with \(K = 1\), so the minor loss equation becomes \(\left( 1 + \sum K \right) \frac{\bar v^2}{2g}\). This is used to be able to say that \(\Delta z = h_L\) and makes many equation simplifications possible in the future.

\item {} 
\sphinxstylestrong{Orifice equation and vena contractas:} The orifice equation is used to determine the flow out of an orifice given the elevation of water above the orifice. This equation introduces the concept of vena contracta, which describes flow contraction due to the inability of streamlines to make sharp turns. The equation shows that the flow out of an orifice is proportional to the square root of the driving head, \(Q \propto \sqrt{\Delta h}\). Depending on the orientation of the orifice, vertical (like a hole in the side of a bucket) or horizontal (like a hole in the bottom of a bucket), a different equation in AguaClara should be used.

\end{enumerate}
\begin{quote}

The Orifice Equation:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics:Review/Review_Fluid_Mechanics:39}
\begin{split}Q = \Pi_{vc} A_{or} \sqrt{2g\Delta h}\end{split}
\end{equation}\end{quote}


\chapter{Review: Fluid Mechanics Derivations}
\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:review-fluid-mechanics-derivations}}\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:title-review-fluid-mechanics-derivations}}\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations::doc}}

\section{Minor Loss Equation}
\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:minor-loss-equation}}\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:heading-minor-loss-equation-derivation}}
This section contains the derivation of the minor loss equation using the following figure as a reference. The derivation begins with a slightly simplified energy equation across the control volume shown. Our energy equation begins with \(h_P\) and \(h_T\) having been
eliminated.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{minor_loss_pipe}.png}
\caption{This is the system we will use to derive the minor loss equation.}\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:id1}}\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:figure-minor-loss-pipe}}\end{figure}
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:0}
\begin{split}\frac{p_{in}}{\rho g} + {z_{in}} + \frac{\bar v_{in}^2}{2g} = \frac{p_{out}}{\rho g} + z_{out} + \frac{\bar v_{out}^2}{2g} + h_L\end{split}
\end{equation}
Since the elevations at the center of the \(in\) and \(out\) control surfaces are the same, we can eliminate \(z_{in}\) and \(z_{out}\). As we are considering such a small length of pipe, we will neglect the major loss component of head loss. Thus, \(h_L = h_e + \cancel{h_f}\). The following three equations are all the same, simply rearranged to solve for \(h_e\).
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:1}
\begin{split}\frac{p_{in}}{\rho g} + \frac{\bar v_{in}^2}{2g} = \frac{p_{out}}{\rho g} + \frac{\bar v_{out}^2}{2g} + h_e\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:2}
\begin{split}\frac{p_{in} - p_{out}}{\rho g} = \frac{\bar v_{out}^2 - \bar v_{in}^2}{2g} + h_e\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:minor_loss_energy_eq}
\begin{split}  h_e = \frac{p_{in} - p_{out}}{\rho g} + \frac{\bar v_{in}^2 - \bar v_{out}^2}{2g}\end{split}
\end{equation}
This last equation has \(h_e\) as a function of four variables \((p_{in}, \, p_{out}, \, v_{in}\), and \(v_{out})\); we would like it to be a function of only one. Thus, we will invoke conservation of momentum in the horizontal direction across our control volume to remove variables. The difference in momentum from the \(in\) point to the \(out\) point is driven by the pressure difference between each end of the control volume. We will be considering the pressure at the centroid of our control surfaces, and we will neglect shear along the pipe walls. After these assumptions, our momentum equation becomes the following:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:3}
\begin{split}M_{in, \, x} + M_{out, \, x} = F_{p_{in, \, x}} + F_{p_{out, \, x}}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(M_{x}\) = momentum flowing through the control volume in the x-direction
\item[] \(F_{p_x}\) = force due to pressure acting on the boundaries of the control volume in the x-direction
\end{DUlineblock}

Recall that momentum is mass times velocity for solids, \(m v\), with units of \(\frac{[M][L]}{[T]}\). Since we consider water flowing through a pipe, there is not one singular mass or one singular velocity. Instead, there is a mass flow rate, or a mass per time indicated by \(\dot m = \rho Q\), which has units of \(\frac{[M]}{[T]}\). Therefore, the momentum for a fluid is \(\rho Q \bar v\). Applying the continuity equation \(Q = \bar v A\), we get to the following equation for the momentum of a fluid flowing through a pipe which we will use in this derivation, \(M = \rho \bar v^2 A\). The pressure force is simply the pressure at the centroid of the flow multiplied by the area the pressure is acting upon, \(p A\).

To ensure correct sign convention, we will make each side of the equation negative for reasons discussed shortly. Since \(\bar v_{in} > \bar v_{out}\), the left hand side will be \(M_{out} - M_{in}\) in order to be negative. The reduction in velocity from \(in\) to \(out\) causes an increase in pressure, therefore \(p_{in} - p_{out}\) is negative. With these substitutions, the conservation of momentum equation becomes as follows:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:4}
\begin{split}M_{out} - M_{in} = p_{in} - p_{out}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:5}
\begin{split}\rho \bar v_{out}^2 A_{out} - \rho \bar v_{in}^2 A_{in} = p_{in} A_{out} - p_{out} A_{out}\end{split}
\end{equation}
Note that the area term attached to \(p_{in}\) is actually \(A_{out}\) instead of \(A_{in}\), as one might think. This is because \(A_{out} = A_{in}\). We chose our control volume to start a few millimeters into the larger pipe, which means that the cross-sectional area does not change over the course of the control volume.

Dividing both sides of the equation by \(A_{out} \rho g\), we obtain the following equation, which contains the very same pressure term as our adjusted energy equation above, equation \eqref{equation:Review/Review_Fluid_Mechanics_Derivations:minor_loss_energy_eq}. This is why we chose a negative sign convention.
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:6}
\begin{split}\frac{p_{in} - p_{out}}{\rho g} = \frac{\bar v_{out}^2 - \bar v_{in}^2 \frac{A_{in}}{A_{out}}}{g}\end{split}
\end{equation}
Now, we combine the momentum, continuity, and adjusted energy equations:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:7}
\begin{split}{\rm{Energy \, equation:}} \,\,\,  h_e = \frac{p_{in} - p_{out}}{\rho g} + \frac{\bar v_{in}^2 - \bar v_{out}^2}{2g}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:8}
\begin{split}{\rm{Momentum \, equation:}} \,\,\, \frac{p_{in} - p_{out}}{\rho g} = \frac{\bar v_{out}^2 - \bar v_{in}^2 \frac{A_{in}}{A_{out}}}{g}\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:9}
\begin{split}{\rm{Continuity \, equation:}} \,\,\, \frac{A_{in}}{A_{out}} = \frac{\bar v_{out}}{\bar v_{in}}\end{split}
\end{equation}
To obtain an equation for minor losses with just two variables, \(\bar v_{in}\) and \(\bar v_{out}\).
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:10}
\begin{split}h_e = \frac{\bar v_{out}^2 - \bar v_{in}^2\frac{\bar v_{out}}{\bar v_{in}}}{g} + \frac{\bar v_{in}^2 - \bar v_{out}^2}{2g}\end{split}
\end{equation}
Now we will combine the two terms. The numerator and denominator of the first term, \(\frac{\bar v_{out}^2 - \bar v_{in}^2\frac{\bar v_{out}}{\bar v_{in}}}{g}\) will be multiplied by \(2\) to become \(\frac{2 \bar v_{out}^2 - 2 \bar v_{in}^2\frac{\bar v_{out}}{\bar v_{in}}}{2 g}\). The equation then looks like:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:11}
\begin{split}h_e = \frac{\bar v_{out}^2 - 2 \bar v_{in} \bar v_{out} + \bar v_{in}^2}{2g}\end{split}
\end{equation}

\subsection{Final Forms of the Minor Loss Equation}
\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:final-forms-of-the-minor-loss-equation}}\label{\detokenize{Review/Review_Fluid_Mechanics_Derivations:heading-final-minor-loss-equations}}
Factoring the numerator yields to the first ‘final’ form of the minor loss equation:
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:12}
\begin{split}{\rm{ \mathbf{First \, form:} }} \quad h_e = \frac{\left( \bar v_{in}  - \bar v_{out} \right)^2}{2g}\end{split}
\end{equation}
From here, the two other forms of the minor loss equation can be derived by solving for either \(\bar v_{in}\) or \(\bar v_{out}\) using the ubiquitous continuity equation \(\bar v_{in} A_{in} = \bar v_{out} A_{out}\):
\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:Review/Review_Fluid_Mechanics_Derivations:13}
\begin{split}{\rm{ \mathbf{Second \, form:} }} \quad h_e = \left( 1 - \frac{A_{in}}{A_{out}} \right)^2 \, \frac{\bar v_{in}^2}{2g} \, \, = \, \, K_e^{'} \frac{\bar v_{in}^2}{2g}, \quad {\rm where} \quad K_e^{'} = \left( 1 - \frac{A_{in}}{A_{out}} \right)^2\end{split}
\end{equation}\begin{equation}\label{equation:Review/Review_Fluid_Mechanics_Derivations:minor_loss_equation}
\begin{split}   \color{purple}{
   {\rm{ \mathbf{Third \, form:} }} \quad h_e = \left( \frac{A_{out}}{A_{in}} -1 \right)^2 \, \frac{\bar  v_{out}^2}{2g} \, \, = \, \, K_e \frac{\bar v_{out}^2}{2g}, \quad {\rm where} \quad K_e = \left( \frac{A_{out}}{A_{in}} - 1 \right)^2
   }\end{split}
\end{equation}
\begin{sphinxadmonition}{note}{Note:}
You will often see \(K_e^{'}\) and \(K_e\) used without the \(e\) subscript, they will appear as \(K^{'}\) and \(K\).
\end{sphinxadmonition}

Being familiar with these three forms and how they are used will be of great help throughout the class. The third form is the one that is most commonly used.


\chapter{Flow Control and Measurement Introduction}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:flow-control-and-measurement-introduction}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:title-flow-control-intro}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro::doc}}

\section{Tank with a Valve}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:tank-with-a-valve}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:heading-tank-with-a-valve}}

\subsection{Flow \protect\(Q\protect\) and Water Level \protect\(h\protect\) as a Function of Time}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:flow-and-water-level-as-a-function-of-time}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:heading-qh-as-a-function-of-t}}
Our first step is to see if we can get constant head out of a simple system. The most simple flow control system is a bucket or tank with a hole in it. This system is too coarse to provide constant head. One step above that is a bucket or tank with a valve. This is where we begin our search for constant head.

Using the setup described in the image below, we derive the following equation for flow \(Q\) through the valve as a function of time \(t\). The derivation is found here: {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-flow-for-a-tank-with-a-valve}]{\sphinxcrossref{\DUrole{std,std-ref}{ for a Tank with a Valve}}}}. You are advised to read through it if you are at all confused about this equation.
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Intro:Q_tank_with_valve}
\begin{split}  \frac{Q}{Q_0} = 1 - \frac{1}{2} \frac{t}{t_{Design}} \frac{h_{Tank}}{h_0}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(Q\) = \(Q(t)\) = flow of hypochlorite through valve at time \(t\)
\item[] \(Q_0\) = flow of hypochlorite through valve at time \(t = 0\)
\item[] \(t\) = elapsed time
\item[] \(t_{Design}\) = time it \sphinxstyleemphasis{would} take for tank to empty if flow stayed constant at \(Q_0\), which it does not
\item[] \(h_{Tank}\) = elevation of water level with reference to tank bottom at time \(t\) = 0
\item[] \(h_0\) = elevation of water level with reference to the valve at time \(t = 0\)
\end{DUlineblock}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{hypochlorinator_variable_explanation}.png}
\caption{This figure shows the variables that are defined in the equation above.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:id1}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:figure-hypochlorinator-variable-explanation-design}}\end{figure}

This equation has historically give students some trouble, and while its nuances are explained in the derivation, they will be quickly summarized here:
\begin{itemize}
\item {} 
\(t_{Design}\) is \sphinxstylestrong{NOT} the time it takes to drain the tank. It is the time that it \sphinxstyleemphasis{would} take to drain the tank \sphinxstyleemphasis{if} the flow rate at time \(t = 0\), \(Q_0\), were the flow rate forever, which it is not. \(t_{Design}\) was used in the derivation to simplify the equation, which is why this potentially-confusing parameter exists. The actual time it takes to drain the tank lies somewhere between \(t_{Design}\) and \(2 \, t_{Design}\) and depends on the ratio \(\frac{h_{Tank}}{h_0}\).

\item {} 
\(h_{Tank}\) is not the same as \(h_{0}\). \(h_{Tank}\) is the height of water level in the tank with reference to the tank bottom. \(h_{0}\) is the water level in the tank with reference to the valve. Neither change with time, they both refer to the water level at one instance in time, \(t = 0\). Therefore, \(h_{0} \geq h_{Tank}\) is always true. If the tank is elevated far above the valve, then the \(h_{0} > > h_{Tank}\). If the valve is at the same elevation as the bottom of the tank, then \(h_{0} = h_{Tank}\). Please refer to the figure above to clarify \(h_{0}\) and \(h_{Tank}\).

\end{itemize}

We can use the proportionality \(Q \propto \sqrt{h}\), which applies to both minor losses and orifices to form a relationship between water level in the tank \(h\) and time \(t\). This proportionality comes from rearranging the minor loss equation \(h = K \frac{Q^2}{2 g A^2}\) for \(Q\) instead of \(h\). A table of proportionality between \(Q\) and \(h\) can be found in \hyperref[\detokenize{Review/Review_Fluid_Mechanics:table-h-q-proportionality}]{Table \ref{\detokenize{Review/Review_Fluid_Mechanics:table-h-q-proportionality}}}

Using equation \eqref{equation:Flow_Control_and_Measurement/FCM_Intro:Q_tank_with_valve} and this proportionality relationship, we make the following plots. On the left, the valve is at the same elevation as the bottom of the tank, or \(h_{Tank} = h_0\). Our attempt to get a continuous flow rate out of this system is to make \(\frac{h_{Tank}}{h_0}\) very small by elevating the tank far above the valve. On the right, \(\frac{h_{Tank}}{h_0} = \frac{1}{50}\). While the plot looks great and provides essentially constant head, elevating the tank by 50 times its height is not realistic. The ‘tank with a valve’ is not a solution to the constant head problem.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{tank_valve_play}.png}
\caption{These graphs show how manipulation of the variables in the \(Q(t)\) expression can result in effectively constant head.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:id2}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:figure-tank-valve-play}}\end{figure}


\subsection{Drain System for a Tank}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:drain-system-for-a-tank}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:heading-drain-system-for-a-tank}}
While the ‘tank with a valve’ scenario is not a good constant head solution, we can use our understanding of the system to properly design drain systems for AguaClara reactors like flocculators and sedimentation tanks, since they are just tanks with valves. The derivation for the following equation is here, along with more details on AguaClara’s pipe stub method for draining tanks: {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-diameter-and-time-tank-drain-equation}]{\sphinxcrossref{\DUrole{std,std-ref}{ and  for Tank Drain Equation}}}}. The derived ‘Tank Drain’ equation is as follows:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Intro:Flow_Control_and_Measurement/FCM_Intro:0}
\begin{split}D_{Pipe} = \sqrt{ \frac{8 L_{Tank} W_{Tank}}{\pi t_{Drain}}} {\left( \frac{H_{Tank} \sum K }{2g} \right)^{\frac{1}{4}}}\end{split}
\end{equation}
The equation can also be rearranged to solve for the time it would take to drain a tank given its dimensions and a certain drain pipe size:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Intro:Flow_Control_and_Measurement/FCM_Intro:1}
\begin{split}t_{Drain} =  \frac{8 L_{Tank} W_{Tank}}{\pi D_{Pipe}^2} {\left( \frac{H_{Tank} \sum K }{2g} \right)^{\frac{1}{2}}}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(D_{Pipe}\) = Diameter of the drain piping
\item[] \(L_{Tank}, W_{Tank}, H_{Tank}\) = Tank dimensions
\item[] \(t_{Drain}\) = Time it takes to drain the tank
\item[] \(\sum K\) = Sum of all the minor loss coefficients in the system
\end{DUlineblock}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{pipe_stub_drainage_variables}.png}
\caption{Variables for draining a tank}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:id3}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Intro:figure-pipe-stub-drainage-variables-in-derivation}}\end{figure}


\chapter{Flow Control and Measurement Design}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:flow-control-and-measurement-design}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:title-flow-control-design}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design::doc}}
This section explores AguaClara’s search for constant head in chemical dosing. The term \sphinxstylestrong{constant head} means that the driving head of a system, \(\Delta z\) or \(\Delta h\), does not change over time, even as water flows through or out of the system. Constant head implies constant flow, since the energy driving the flow does not change.

The challenge of constant head in chemical dosing for water treatment plants is not \sphinxstyleemphasis{just} providing one continuous flow of chemicals; it is also varying that flow of chemicals as the flow rate through the plant changes, so that the concentration of chemicals in the raw water stays the same.


\section{Important Terms and Equations}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:important-terms-and-equations}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-fcm-terms-eqs}}
\sphinxstylestrong{Terms:}
\begin{enumerate}
\item {} 
Dose

\item {} 
Coagulant

\item {} 
Chlorination

\item {} 
Turbidity

\item {} 
Organic Matter

\item {} 
Constant Head Tank

\item {} 
Sutro weir

\end{enumerate}

\sphinxstylestrong{Equations:}
\begin{enumerate}
\item {} 
Hagen-Poiseuille equation

\end{enumerate}


\section{AguaClara Flow Control and Measurement Technologies}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:aguaclara-flow-control-and-measurement-technologies}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-aguaclara-flow-control-and-measurement-technologies}}
Each technology or component for this section will have five subsections:
\begin{itemize}
\item {} 
\sphinxstylestrong{What it is}

\item {} 
\sphinxstylestrong{What it does and why}

\item {} 
\sphinxstylestrong{How it works}

\item {} 
\sphinxstylestrong{Notes}

\end{itemize}

Before diving into the technologies, recall the purpose of the chemicals that we are seeking to constantly \sphinxstylestrong{dose}, and why it is important to keep a constant, specific dose. Also recall that ‘dose’ means ‘concentration of chemical’ \sphinxstyleemphasis{in the water we are trying to treat}, not in the stock tanks of the chemicals. \sphinxhref{https://en.wikipedia.org/wiki/Coagulation\_(water\_treatment)}{Coagulant} like alum, PAC, and some iron-based chemicals are used to turn small particles into bigger particles, allowing them to be captured more easily. Waters with high \sphinxhref{https://en.wikipedia.org/wiki/Turbidity}{turbidity}, indicative of a lot of particles like clay and bacteria, require more coagulant to treat effectively. Additionally, waters with a lot of \sphinxhref{https://en.wikipedia.org/wiki/Organic\_matter}{organic matter} require significantly more coagulant to treat. \sphinxhref{https://en.wikipedia.org/wiki/Water\_chlorination}{Chlorine} is used to disinfect water that has already been fully treated. A proper and consistent chlorine dose is required, as too low of a dose creates a risk of reintroduction of pathogens in the distribution system and too high of a dose increases the risk of carcinogenic \sphinxhref{https://en.wikipedia.org/wiki/Disinfection\_by-product}{disinfection byproduct} formation.

\begin{sphinxadmonition}{important}{Important:}
This section will often refer to the proportionality between flow \(Q\) and head \(\Delta h\) (recall that \(\Delta h = h_L\) after applying the head loss trick) by using the ‘proportional to’ symbol, \(\propto\). It is important to remember that it doesn’t necessarily matter whether \(Q\) or \(h_L\) goes first, \(Q \propto \sqrt{h_L}\) is equivalent to saying that \(h_L \propto Q^2\).
\end{sphinxadmonition}


\subsection{“Almost Linear” Flow Controller}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:almost-linear-flow-controller}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-almost-linear-flow-controller}}

\subsubsection{What it is}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:what-it-is}}
This device consists of a bottle of chemical solution, called the \sphinxstylestrong{Constant Head Tank} (CHT), a float valve to keep a solution in the CHT at a constant water level, a flexible tube starting at the bottom of the CHT, and many precisely placed and equally spaced holes in a pipes. The holes in the pipe hold the other end of the tube that starts at the CHT.

Chemical solution, either coagulant or chlorine, is stored in a stock tank somewhere above the CHT. A different tube connects the stock tank to the float valve within the CHT.


\subsubsection{What it does and why}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:what-it-does-and-why}}
This flow controller provides a constant flow of chemical solution to the water in the plant. When the end of the flexible tube is placed in a hole, the elevation difference between the water level in the bottle and the hole is set and does not change unless the tube is then placed in another hole. Thus, a constant flow is provided while the end of the tube is not moved.

As has been mentioned previously, the amount of chlorine and coagulant that must be added to the raw water changes depending on the flow rate of the plant; the change is necessary to keep the dose constant. More water flowing through the plant means more chlorine is necessary to maintain the dose of chlorine in the treated water. For coagulant, there are also other factors aside from plant flow rate that impact the required dose, including the turbidity and amount of organic matter in the water. The operator must be able to change the dose of both coagulant and chlorine quickly and easily, and they must be able to know the value of the new dose they set. The “Almost Linear” Flow Controller accomplishes this by having a large number of holes in the flow control pipe next to the CHT. This large number of holes gives the operator many options for adjusting the dose, and let them quickly change the flow of chemicals into the raw water by moving the end of the flexible tube from one hole to another.


\subsubsection{How it works}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:how-it-works}}
The idea behind this flow controller is to have a linear relationship between \(Q\) and \(h_L\) (remember that \(h_L\) is equal to \(\Delta h\) when we apply the head loss trick), which can be written as \(Q \propto h_L\). Here, \(Q\) is the flow of chemicals out of the flexible tube, and \(h_L\) is the elevation difference between the water level in the CHT and the end of the flexible tube.

As you remember from section 1.5, the summary of Fluids Review, \(Q \propto \Delta h\), or \(\Delta h \propto Q\) as it was written in the section summary, is only true for the combination of major losses and laminar flow, which makes applicable the Hagen-Poiseuille equation. Therefore, the flow must always be laminar in the flexible tube that goes between the CHT and the holes, and major losses must far exceed minor losses.

It is easy to design for laminar flow, but the “Almost Linear” Flow Controller was unable to make major losses far exceed minor losses. The bending in the flexible tube caused a lot of minor losses which changed in magnitude depending on exactly how the tube was bent. This made the flow controller “almost linear,” but that wasn’t good enough.


\subsubsection{Notes}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:notes}}\begin{itemize}
\item {} 
This flow controller is \sphinxstylestrong{no longer used by AguaClara.}

\item {} 
The tube connecting the CHT to the outlet of chemicals must be very long and, more importantly, \sphinxstylestrong{straight} to form a linear relationship between driving head and flow. This linear relationship was not true for the “Almost Linear” Flow Controller, and is why it was replaced by the Linear Chemical Dose Controller (CDC). The CDC will be covered in more depth later on in this section.

\end{itemize}


\subsection{Linear Flow Orifice Meter (LFOM)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:linear-flow-orifice-meter-lfom}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-lfom}}

\subsubsection{What it is}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id1}}
The LFOM is a weir shape cut into a pipe. It was meant to imitate \sphinxhref{https://confluence.cornell.edu/display/AGUACLARA/LFOM+sutro+weir+research}{the Sutro Weir} while being far easier to build. The LFOM is a pipe with rows of holes, or orifices, drilled into it. There are progressively fewer holes per row as you move up the LFOM, as the shape is meant to resemble half a parabola on each side. The size of all holes is the same, and the amount of holes per row are precisely calculated. Water in the entrance tank flows into and down the LFOM, towards the rapid mix orifice and flocculator.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{sutro_v_lfom}.png}
\caption{On the left is a sutro weir. On the right is AguaClara’s approximation of the sutro weir’s geometery. This elegant innovation is called a linear flow orifice meter, or LFOM for short.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id9}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:figure-sutro-v-lfom}}\end{figure}


\subsubsection{What it does and why}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id2}}
The LFOM does one thing and serves two purposes.

What it does:

\sphinxstylestrong{The LFOM creates a linear relationship between water level in the entrance tank and the flow out of the entrance tank.} \sphinxstyleemphasis{It does not control the flow through the plant}. If the LFOM were replaced with a hole in the bottom of the entrance tank, the same flow rate would go through the plant, the only difference being that the water level in the entrance tank would scale with flow squared \(h \propto Q^2\) instead of \(h \propto Q\). For example, if an LFOM has 10 rows of holes and has been designed for a plant whose maximum flow rate is 10 L/s, then the operator knows that the number of rows submerged in water is equal to the flow rate of the plant in L/s. So if the water were up to the third row of holes, there would be 3 L/s of water flowing through the plant.

Why it is useful:
\begin{enumerate}
\item {} 
Allows the operator to measure the flow through the plant quickly and easily, explained above.

\item {} 
Allows for the Linear Chemical Dose Controller, which will be explained next, to automatically adjust the flow of coagulant/chlorine into the plant as the plant flow rate changes. This means the operator would only need to adjust the flow of coagulant when there is a change in turbidity or organic matter.

\end{enumerate}


\subsubsection{How it works}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id3}}
This is best understood with examples. By shaping a weir differently, different relationships between \(Q\) and \(h\) are formed:
* In the case of a \sphinxhref{https://swmm5.files.wordpress.com/2016/09/image00124.jpg}{rectangular weir}, \(Q \propto h^{\frac{3}{2}}\)
* In the case of a \sphinxhref{https://swmm5.files.wordpress.com/2016/09/image0096.jpg}{v-notch weir}, \(Q \propto h^{\frac{5}{2}}\)
* In the case of a \sphinxhref{http://www.engineeringexcelspreadsheets.com/wp-content/uploads/2012/11/Sutro-Weir-Diagram1.jpg}{Sutro weir} and thus LFOM, \(Q \propto h\).


\subsubsection{Notes}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id4}}\begin{itemize}
\item {} 
The LFOM is not perfect. Before the water level reaches the second row of holes, the LFOM is simulating a rectangular weir, and thus \(h \not\propto Q\). The Sutro weir also experiences this problem.

\item {} 
If the water level exceeds the topmost row of the LFOM’s orifices, the linearity also breaks down. The entire LFOM begins to act like an orifice, the exponent of \(Q\) in \(h \propto Q\) becomes greater than 1. This is because the LFOM approaches orifice behavior, and for orifices, \(h \propto Q^2\).

\end{itemize}


\subsection{Linear Chemical Dose Controller (CDC)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:linear-chemical-dose-controller-cdc}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-linear-cdc}}
Since the Linear Chemical Dose Controller has become the standard in AguaClara, it is often simply called the Chemical Dose Controller, \sphinxstylestrong{or CDC for short}. It can be confusing to describe with words, so be sure to flip through the slides in the ‘Flow Control and Measurement’ powerpoint, as they contain very, very, helpful diagrams of the CDC.


\subsubsection{What it is}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id5}}
The CDC brings together the LFOM and many improvements to the “Almost Linear” Flow Controller. Let’s break it down, with the image below as a guide.
\begin{enumerate}
\item {} 
Start at the Constant Head Tank (CHT). This is the same set up as the “Almost Linear” Flow Controller. The stock tank feeds into the CHT, and the float valve makes sure that the water level in the constant head tank is always the same.

\end{enumerate}

2. Now the tubes. These fix the linearity problems that were the main problem in the “Almost Linear” Flow Controller.
* The tube connected to the bottom of the CHT is large diameter to minimize any head loss through it.
\begin{itemize}
\item {} 
The three thin, straight tubes are designed to generate a lot of major losses and to minimize any minor losses. This is to make sure that major losses far exceed any minor losses, which will ensure that the Hagen-Poiseuille equation is applicable and that flow will be directly proportional to the head, \(Q \propto \Delta h\). Why are there 3 tubes?
\begin{enumerate}
\item {} 
\sphinxstylestrong{3 short instead of 1 short} Removing 2 of the 3 tubes would mean 3 times the flow through the remaining tube. This means the velocity in the tube would be 3 times as fast. Since minor losses scale with \(v^2\) and major losses only scale with \(v\), this would increase the ratio of \(\rm{\frac{minor \, losses}{major \, losses}}\), which would break the linearity we’re trying to achieve. It would also increase the total head loss through the system, resulting in a lower maximum flow rate than before.

\item {} 
\sphinxstylestrong{1 long instead of 3 short} One tube whose length is equal to the three combined would be inconveniently long, and would suffer from the same problems as above. There would be even more head loss through the tube, since its length would be longer.

\end{enumerate}

\item {} 
The large-diameter tube on the right of the three thin, straight tubes is where the chemicals flow out. The end of the tube is connected to both a slider and a ‘drop tube.’ The drop tube allows for supercritical flow of the chemical leaving the dosing tubes; once the chemical enters the drop tube it falls freely and no longer affects the CDC system.

\end{itemize}
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
The slider rests on a lever. This lever is the critical part of the CDC, it connects the water level in the entrance tank, which is adjusted by the LFOM, to the difference in head between the CHT and the end of the dosing tube. This allows the flow of chemicals to automatically adjust to a change in the plant flow rate, maintaining a constant dose in the plant water. One end of the lever tracks the water level in the entrance tank by using a float. The counterweight on the other side of the lever is to make sure the float ‘floats,’ since this float is usually made of PVC, which is more dense than water.

\item {} 
The slider itself controls the dose of chemicals. For any given plant flow rate, the slider can be adjusted to increase or decrease the amount of chemical flowing through the plant.

\end{enumerate}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{cdc_labelled}.png}
\caption{This is the setup of the chemical dose controller.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id10}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:figure-cdc-labelled}}\end{figure}


\subsubsection{What it does and why}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id6}}
The CDC makes it easy and accurate to dose chemicals. The flow of chemicals automatically adjusts to changes in the plant flow rate to keep a constant dose, set by the operator. When a turbidity event occurs, the operator can change the dose of coagulant by moving the coagulant slider \sphinxstyleemphasis{lower} on the lever to increase the dose. The slider has labelled marks so the operator can record the dose accurately.


\subsubsection{How it works}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id7}}
A lot of design has gone into the CDC. The design equations and their derivations that the following steps are based on can be found here: {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-design-equations-for-the-cdc}]{\sphinxcrossref{\DUrole{std,std-ref}{Design Equations for the Linear Chemical Dose Controller (CDC)}}}}, and you are very, very strongly encouraged to read them.

The CDC can be designed manually using the equations from the derivation linked above or via aguaclara, using the equations found in \sphinxhref{https://github.com/AguaClara/aguaclara}{cdc\_functions.py}. Either way, the design algorithm is roughly the same:
\begin{enumerate}
\item {} 
Calculate the maximum flow rate, \(Q_{Max, \, Tube}\), through each available dosing tube diameter \(D\) that keeps error due to minor losses below 10\% of total head loss. Recall that tubing diameter is an array, as there are many diameters available at hardware stores and suppliers. This means that for each step, there will be as many solutions as there are reasonable diameters available.

\end{enumerate}
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Design:Flow_Control_and_Measurement/FCM_Design:0}
\begin{split}Q_{Max, \, Tube} = \frac{\pi D^2}{4} \sqrt{\frac{2 h_L g \Pi_{Error}}{\sum{K} }}\end{split}
\end{equation}\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
Calculate how much flow of chemical needs to pass through the CDC at maximum plant flow and maximum chemical dose. This depends on the concentration of chemicals in the stock tank.

\end{enumerate}
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Design:Flow_Control_and_Measurement/FCM_Design:1}
\begin{split}Q_{Max, \, CDC} = \frac{Q_{Plant} \cdot C_{Dose, \, Max}}{C_{StockTank}}\end{split}
\end{equation}\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
Calculate the number of dosing tubes required if the tubes flow at  maximum capacity (round up)

\end{enumerate}
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Design:Flow_Control_and_Measurement/FCM_Design:2}
\begin{split}n_{Tubes} = {\rm ceil} \left( \frac{Q_{Max, \, CDC}}{Q_{Max, \, Tube}} \right)\end{split}
\end{equation}\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
Calculate the length of dosing tube(s) that correspond to each available tube diameter.

\end{enumerate}
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Design:Flow_Control_and_Measurement/FCM_Design:3}
\begin{split}L_{Min} = \left( \frac{g h_L \pi D^4}{128 \nu Q_{Max}} - \frac{Q_{Max}}{16 \pi \nu} \sum{K} \right)\end{split}
\end{equation}\begin{enumerate}
\setcounter{enumi}{4}
\item {} 
Select a tube length from your array of solutions. Pick the longest dosing tube that you can, keeping in mind that the tube(s) must be able to fit in the plant and can’t be longer than the length of the plant wall it will be placed along.

\item {} 
Finally, select the dosing tube diameter and flow rate corresponding to the selected tube length.

\end{enumerate}


\subsection{Kinematic Viscosity of Coagulants}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:kinematic-viscosity-of-coagulants}}
AguaClara plants currently use either alum (aluminum sulfate) or PACl (polyaluminum chloride) solutions that are prepared from granular chemicals. The viscosity of solutions created from granular alum and PACl were measured using a SV - 10 Vibro Viscometer. The results are shown below.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{c+c1}{\PYGZsh{} the following concentrations were prepared for each chemical}
\PYG{n}{Measured\PYGZus{}C} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{600}\PYG{p}{,}\PYG{l+m+mi}{13}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{Measured\PYGZus{}C}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{10} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{c+c1}{\PYGZsh{} the following dynamic viscosities were measured}
\PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Dynamic\PYGZus{}Alum} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.00097}\PYG{p}{,} \PYG{l+m+mf}{0.00114}\PYG{p}{,}\PYG{l+m+mf}{0.00143}\PYG{p}{,}\PYG{l+m+mf}{0.00178}\PYG{p}{,}\PYG{l+m+mf}{0.00208}\PYG{p}{,}\PYG{l+m+mf}{0.00253}\PYG{p}{,}\PYG{l+m+mf}{0.00349}\PYG{p}{,}\PYG{l+m+mf}{0.00451}\PYG{p}{,}\PYG{l+m+mf}{0.00532}\PYG{p}{,}\PYG{l+m+mf}{0.00691}\PYG{p}{,}\PYG{l+m+mf}{0.00901}\PYG{p}{,}\PYG{l+m+mf}{0.0117}\PYG{p}{,}\PYG{l+m+mf}{0.0133}\PYG{p}{]}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Dynamic\PYGZus{}PACl} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.001}\PYG{p}{,}\PYG{l+m+mf}{0.00108}\PYG{p}{,}\PYG{l+m+mf}{0.00122}\PYG{p}{,}\PYG{l+m+mf}{0.00145}\PYG{p}{,}\PYG{l+m+mf}{0.00171}\PYG{p}{,}\PYG{l+m+mf}{0.00231}\PYG{p}{,}\PYG{l+m+mf}{0.00256}\PYG{p}{,}\PYG{l+m+mf}{0.00301}\PYG{p}{,}\PYG{l+m+mf}{0.00392}\PYG{p}{,}\PYG{l+m+mf}{0.00378}\PYG{p}{,}\PYG{l+m+mf}{0.00476}\PYG{p}{,}\PYG{l+m+mf}{0.00486}\PYG{p}{,}\PYG{l+m+mf}{0.00768}\PYG{p}{]}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{Density\PYGZus{}PACl\PYGZus{}400gperL} \PYG{o}{=} \PYG{l+m+mf}{58.88} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{50} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{p}{)}
\PYG{n}{Density\PYGZus{}Alum\PYGZus{}600gperL} \PYG{o}{=} \PYG{l+m+mf}{63.2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{50} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{p}{)}
\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mi}{22} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}

\PYG{k}{def} \PYG{n+nf}{Density\PYGZus{}Alum}\PYG{p}{(}\PYG{n}{Alum\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{c+c1}{\PYGZsh{}Alum\PYGZus{}C is concentration of aluminum sulfate with attached waters (not concentration of aluminum)}
  \PYG{k}{return} \PYG{n}{Density\PYGZus{}Alum\PYGZus{}600gperL} \PYG{o}{*} \PYG{n}{Alum\PYGZus{}C}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{600} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)} \PYG{o}{+} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{temperature}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{600} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L} \PYG{o}{\PYGZhy{}} \PYG{n}{Alum\PYGZus{}C}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{600} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{Density\PYGZus{}PACl}\PYG{p}{(}\PYG{n}{PACl\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{c+c1}{\PYGZsh{}PACl\PYGZus{}C is concentration of poly aluminum chloride granules (not concentration of aluminum}
  \PYG{k}{return} \PYG{n}{Density\PYGZus{}PACl\PYGZus{}400gperL} \PYG{o}{*} \PYG{n}{PACl\PYGZus{}C}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{400} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)} \PYG{o}{+} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{temperature}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{400} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L} \PYG{o}{\PYGZhy{}} \PYG{n}{PACl\PYGZus{}C}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{400} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}

\PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Kinematic\PYGZus{}Alum} \PYG{o}{=} \PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Dynamic\PYGZus{}Alum}\PYG{o}{/}\PYG{n}{Density\PYGZus{}Alum}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}
\PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Kinematic\PYGZus{}PACl} \PYG{o}{=} \PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Dynamic\PYGZus{}PACl}\PYG{o}{/}\PYG{n}{Density\PYGZus{}PACl}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}
\PYG{k}{def} \PYG{n+nf}{Alum\PYGZus{}Viscosity\PYGZus{}Kinematic}\PYG{p}{(}\PYG{n}{Alum\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{+} \PYG{p}{(}\PYG{l+m+mf}{4.225} \PYG{o}{*} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{Alum\PYGZus{}C}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mf}{2.289}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{temperature}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{PACl\PYGZus{}Viscosity\PYGZus{}Kinematic}\PYG{p}{(}\PYG{n}{PACl\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{+} \PYG{p}{(}\PYG{l+m+mf}{2.383} \PYG{o}{*} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{PACl\PYGZus{}C}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mf}{1.893}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{temperature}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Kinematic\PYGZus{}Alum}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ro}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{Alum\PYGZus{}Viscosity\PYGZus{}Kinematic}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{Measured\PYGZus{}Viscosity\PYGZus{}Kinematic\PYGZus{}PACl}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{bo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{PACl\PYGZus{}Viscosity\PYGZus{}Kinematic}\PYG{p}{(}\PYG{n}{Measured\PYGZus{}C}\PYG{p}{,} \PYG{n}{temperature}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coagulant concentration prepared from granules }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{left[}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{frac}\PYG{l+s+si}{\PYGZob{}g\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}L\PYGZcb{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{right]\PYGZdl{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kinematic Viscosity }\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{+} \PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{left[}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{frac}\PYG{l+s+s1}{\PYGZob{}}\PYG{l+s+s1}{mm\PYGZca{}2\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}s\PYGZcb{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{right]\PYGZdl{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Alum data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Alum model}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PACl data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PACl model}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flow\PYGZus{}Control\PYGZus{}and\PYGZus{}Measurement/Images/Coagulant\PYGZus{}Viscosity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

The equations for the kinematic viscosities of the two coagulants prepared from granules are given below.
\begin{align}\label{equation:Flow_Control_and_Measurement/FCM_Design:Flow_Control_and_Measurement/FCM_Design:4}\!\begin{aligned}
\nu_{Alum} = \left[ 1 + 4.225 \times {10}^{-6}{\left( \frac{C_{Alum}}{\frac{kg}{m^3}} \right)}^{2.289} \right] \nu_{{H_2}O}\\
\nu_{PACl} = \left[ 1 + 2.383 \times {10}^{-5}\left(\frac{C_{PACl}}{\frac{kg}{m^3}} \right)^{1.893} \right] \nu_{{H_2}O}\\
\end{aligned}\end{align}
This analysis is incomplete in that we don’t know the aluminum concentration of these coagulant solutions.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Coagulant_Viscosity}.png}
\caption{The viscosity of solutions prepared from granular aluminum sulfate and polyaluminum chloride. The concentration is the mass of granules per volume of solution.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id11}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:figure-coagulant-viscosity-kinematic}}\end{figure}


\subsubsection{Notes}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:id8}}
Nothing in life is perfect, and the CDC is no exception. It has a few causes of inaccuracy which go beyond non-zero minor losses:
\begin{itemize}
\item {} 
Float valves are not perfect. There will still be minor fluctuations of the fluid level in the CHT which will result in imperfect dosing.

\item {} 
Surface tension may resist the flow of chemicals from the dosing tube into the drop tube during low flows. Since the CDC design does not consider surface tension, this is a potential source of error.

\item {} 
The lever and everything attached to it are not weightless. Changing the dose of coagulant or chlorine means moving the slider along the lever. Since the slider and tubes attached to it (drop tube, dosing tube) have mass, moving the slider means that the torque of the lever is altered. This means that the depth that the float is submerged is changed, which affects \(\Delta h\) of the system. This can be remedied by making the float’s diameter as large as possible, which makes these fluctuations small. This problem can not be avoided entirely.

\end{itemize}


\section{Section Summary}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:section-summary}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-fcm-section-summary}}\begin{enumerate}
\item {} 
\sphinxstylestrong{Tank with a valve:}

\end{enumerate}
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Design:Flow_Control_and_Measurement/FCM_Design:5}
\begin{split}\frac{Q}{Q_0} = 1 - \frac{1}{2} \frac{t}{t_{Design}} \frac{h_{Tank}}{h_0}\end{split}
\end{equation}
This equation describes flow \(Q\) as a function of time \(t\) of a fluid leaving a tank through a valve. Attempting to get this ‘tank with a valve’ system to yield constant head means raising the tank far, far above the valve that controls the flow. This is unreasonable when designing a flow control system for constant dosing, but can be used to design systems to drain a tank. See the section above for a description of the variables in the equation.
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
\sphinxstylestrong{LFOM:} The LFOM makes the water level in the entrance tank linear with respect to the flow out of the entrance tank. This is useful in measuring the flow and is a critical component in AguaClara’s chemical dosing system. The LFOM \sphinxstyleemphasis{measures} the flow through the plant, it does not \sphinxstyleemphasis{control} the flow through the plant.

\item {} 
\sphinxstylestrong{The Linear Chemical Dose Controller (CDC)} combines the:
* linear relationship between water level and flow in the entrance tank caused by the LFOM,
* linear relationship between elevation difference and flow caused by the Hagen-Poiseuille equation, which is only valid for major losses under laminar flow, and
* a lever to link the two linear relationships

\end{enumerate}

To keep the chemical dose constant by automatically adjusting the addition of coagulant and chlorine as the plant flow rate varies. Two sliders on the lever allows the operator to change the dose of coagulant and chlorine independently of the plant flow rate.


\section{Important Equations}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:important-equations}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-fcm-important-equations}}
Below are a handful of equations relevant to the design of the different flow control and measurement technologies outlined in this chapter. For more context for these equations, please refer to the appropriate section in the chapter above; these equations have been copied verbatim for ease of reference. This list is not exhaustive—if there is an equation missing, please share it in the appropriate \sphinxhref{https://github.com/AguaClara/Textbook/issues/6}{GitHub issue}.
\begin{enumerate}
\item {} 
\sphinxstylestrong{Tank with a valve:}

\end{enumerate}
\begin{itemize}
\item {} 
\(\frac{Q}{Q_0} = 1 - \frac{1}{2} \frac{t}{t_{Design}} \frac{h_{Tank}}{h_0}\)

\end{itemize}
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
\sphinxstylestrong{LFOM:}

\end{enumerate}
\begin{itemize}
\item {} 
\(Q \propto h\)

\end{itemize}
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
\sphinxstylestrong{Linear CDC:}

\end{enumerate}
\begin{itemize}
\item {} 
\(Q_{Max, \, Tube} = \frac{\pi D^2}{4} \sqrt{\frac{2 h_L g \Pi_{Error}}{\sum{K} }}\)

\item {} 
\(Q_{Max, \, CDC} = \frac{Q_{Plant} \cdot C_{Dose, \, Max}}{C_{StockTank}}\)

\item {} 
\(n_{Tubes} = {\rm ceil} \left( \frac{Q_{Max, \, CDC}}{Q_{Max, \, Tube}} \right)\)

\item {} 
\(L_{Min} = \left( \frac{g h_L \pi D^4}{128 \nu Q_{Max}} - \frac{Q_{Max}}{16 \pi \nu} \sum{K} \right)\)

\end{itemize}


\chapter{Flow Control and Measurement Derivations}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:flow-control-and-measurement-derivations}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:title-flow-control-derivations}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations::doc}}

\section{\protect\(Q(t)\protect\) for a Tank with a Valve}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:for-a-tank-with-a-valve}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-flow-for-a-tank-with-a-valve}}
This document contains the derivation of the flow through a tank-with-a-valve over time, \(Q(t)\). Our reference will be a simple hypochlorinator, shown in the following image. In the image, a hypochlorite solution is slowly dripping and mixing with piped source water, thereby disinfecting it. The valve is almost closed to make sure that the hypochlorite solution drips instead of flows. At the end of this document is an image which shows the variables in the final equation.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{drip_hypochlorinator}.png}
\caption{This is a common setup for chlorinating water before distributing it to a nearby community.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id1}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-drip-hypochlorinator}}\end{figure}

This derivation begins by finding two equations for flow, \(Q\), through the hypochlorinator and setting them equal to each other. First, the rate of change of the volume of hypochlorite solution in the tank is equivalent to the flow out of the hypochlorinator. Since the volume of hypochlorite solution in the tank is equal to the tank’s cross-sectional area times it height, we get the following equation:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:0}
\begin{split}Q =  - \frac{d\rlap{--}V}{dt} = - \frac{{A_{Tank}}dh}{dt}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\frac{d\rlap{--}V}{dt}\) = rate of change in volume of solution in the tank
\item[] \(\frac{dh}{dt}\) = rate of change in height of water (hypochlorite solution) level with time
\end{DUlineblock}

Our other equation for flow is the head loss equation. Since major losses are negligible for a short pipe-low flow rate system, we only need to consider minor losses. The only real minor loss in this system occurs in the almost-closed valve that is dripping the hypochlorite solution. However, we will also use the head loss trick. Therefore, the total driving head of the system \(h\) is equal to the minor losses:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:1}
\begin{split}h = h_e = \left( \sum K \right) \frac{Q^2}{2gA_{Valve}^2}\end{split}
\end{equation}
Bear in mind that this is the second form of the minor loss equation as described in {\hyperref[\detokenize{Review/Review_Fluid_Mechanics_Derivations:heading-final-minor-loss-equations}]{\sphinxcrossref{\DUrole{std,std-ref}{this derivation}}}}. Rearranging the minor loss equation to solve for \(Q\), it looks like this:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:2}
\begin{split}Q = A_{Valve} \sqrt{\frac{2 h_e g}{\sum K}}\end{split}
\end{equation}
Now we can set both equations for \(Q\) equal to each other and move them both to one side:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:3}
\begin{split}A_{Tank} \frac{dh}{dt} + A_{Valve} \sqrt{\frac{2gh}{\sum K}} = 0\end{split}
\end{equation}
From here, calculus and equation substitution dominate the derivation. Separating the variables of the equation immediately above, we get the following integral:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:4}
\begin{split}\frac{ -A_{Tank}}{{A_{Valve}} \sqrt{\frac{2g}{\sum K}} }   \int \limits_{h_0}^h \frac{dh}{\sqrt h} = \int \limits_0^t {dt}\end{split}
\end{equation}
Which, when integrated, yields:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:5}
\begin{split}\frac{ -A_{Tank}}{A_{Valve} \sqrt{ \frac{2g}{\sum K}} } \cdot 2 \left( \sqrt{h} - \sqrt{h_0} \right) = t\end{split}
\end{equation}
And solved for \(\sqrt{h}\) returns:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:6}
\begin{split}\sqrt h  = \sqrt{h_0} - t \frac{A_{Valve}}{2 A_{tank}} \sqrt {\frac{2g}{\sum K}}\end{split}
\end{equation}
At this point, the steps and equation substitutions may begin to seem unintuitive. Do not worry if you do not understand why \sphinxstyleemphasis{exactly} a particular substitution is occurring. Since we determined above that \(h_e = h\), our equation above for \(\sqrt{h}\) is also an equation for \(\sqrt{h_e}\). As such, we will plug the equation above back into the minor loss equation solved for \(Q\) from above, \(Q = A_{Valve} \sqrt{\frac{2 h_e g}{\sum K}}\), to produce:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:7}
\begin{split}Q = A_{Valve} \sqrt{\frac{2g}{\sum K}} \left( \sqrt{h_0}  - t \frac{A_{Valve}}{2 A_{tank}} \sqrt{\frac{2g}{\sum K}} \right)\end{split}
\end{equation}
Now we can focus on getting rid of the variables \(A_{Valve}\), \(\sum K\), and \(A_{tank}\). By using the minor loss equation once more, we can remove both \(A_{Valve}\) and \(\sum K\). Consider the initial state of the system, when the hypochlorinator is set up and starts dropping its first few drops of hypochlorite solution into the water. The initial flow rate, \(Q_0\), and elevation difference between the water level and the valve, \(h_0\), can be input into the minor loss equation, which can then be solved for \(A_{Valve}\):
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:8}
\begin{split}A_{Valve} = \frac{Q_{0}}{ \sqrt{ \frac{2 h_0 g}{\sum K}} }\end{split}
\end{equation}
Plugging this equation for \(A_{Valve}\) into the equation for \(Q\) just above, we get the following two equations, in which the second equation is a simplified version of the first:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:9}
\begin{split}Q = Q_0 \frac{1}{\sqrt{h_0}} \left( \sqrt{h_0} - \frac{Q_0 t}{2 A_{Tank} \sqrt{h_0}} \right)\end{split}
\end{equation}\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:10}
\begin{split}\frac{Q}{Q_0} = 1 - \frac{t Q_0}{2 A_{Tank} h_0}\end{split}
\end{equation}
This next step will eliminate \(A_{Tank}\). However, it requires some clever manipulation that has a tendency to cause some confusion. We will define a new parameter, \(t_{Design}\), which represents the time it would take to empty the tank if the initial flow rate through the valve, \(Q_0\), stays constant in time. Of course, the flow \(Q\) through the valve does not stay constant in time, which is why this derivation document exists. But imagining this hypothetical \(t_{Design}\) parameter allows us to form the following equation:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:11}
\begin{split}Q_0 t_{Design} = A_{Tank} h_{Tank}\end{split}
\end{equation}
This equation describes draining all the hypochlorite solution from the tank. The volume of the solution, \(A_{Tank} h_{Tank}\), is drained in \(t_{Design}\). Rearranged, the equation becomes:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:12}
\begin{split}\frac{Q_0}{A_{Tank}} = \frac{h_{Tank}}{t_{Design}}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(h_{Tank}\) = elevation of water level in the tank with reference to tank bottom at the initial state, \(t = 0\)
\end{DUlineblock}

Here lies another common source of confusion. \(h_{Tank}\) is not the same as \(h_{0}\). \(h_{Tank}\) is the height of water level in the tank with reference to the tank bottom. \(h_{0}\) is the water level in the tank with reference to the valve. Therefore, \(h_{0} \geq h_{Tank}\) is true if the valve is located at or below the bottom of the tank. If the tank is elevated far above the valve, then the \(h_{0} > > h_{Tank}\). If the valve is at the same elevation as the bottom of the tank, then \(h_{0} = h_{Tank}\). Please refer to the following image to clarify \(h_{0}\) and \(h_{Tank}\). Also note that both \(h_{Tank}\) and \(h_{0}\) are not variables, they are constants which are defined by the initial state of the hypochlorinator, when the solution just begins to flow.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{hypochlorinator_variable_explanation}.png}
\caption{\(Q_0 =\) initial flow rate of hypochlorite solution at time \(t = 0\), \(t_{Design} =\) time it would take to drain the tank if flow was held constant at \(Q_0\)}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id2}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-hypochlorinator-variable-explanation}}\end{figure}

Finally, our fabricated equivalence, \(\frac{Q_0}{A_{Tank}} = \frac{h_{Tank}}{t_{Design}}\) can be plugged into \(\frac{Q}{Q_0} = 1 - \frac{t Q_0}{2 A_{Tank} h_0}\) to create the highly useful equation for flow rate as a function of time for a drip hypochlorinator:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:13}
\begin{split}\color{purple}{
\frac{Q}{Q_0} = 1 - \frac{1}{2} \frac{t}{t_{Design}} \frac{h_{Tank}}{h_0}
}\end{split}
\end{equation}
Which can be slightly rearranged to yield:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:14}
\begin{split}\color{purple}{
Q(t) = Q_0 \left( 1 - \frac{1}{2} \frac{t}{t_{Design}} \frac{h_{Tank}}{h_0} \right)
}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(Q = Q(t)\) = flow of hypochlorite through valve at time \(t\)
\item[] \(t\) = elapsed time
\item[] \(t_{Design}\) = time it would take for tank to empty \sphinxstyleemphasis{if} flow stayed constant at \(Q_0\), which it does not
\item[] \(h_{Tank}\) = elevation of water level with reference to tank bottom
\item[] \(h_0\) = elevation of water level with reference to the valve
\end{DUlineblock}

“How does this ‘tank with a valve’ scenario differ from the ‘hole in a bucket’ scenario?” some might ask. If you are interested, you may go through the derivation on your own using the orifice equation instead of the minor loss equation for the first step. If you do so you’ll find that the equation remains almost the same, the only difference being that the \(\frac{h_{Tank}}{h_0}\) term drops out for an orifice, as \(h_{Tank} = h_0\). The big difference in the systems lies with the flexibility of having a valve. It can be tightened or loosened to change the flow rate, whereas changing the size of an orifice multiple times in a row is not recommended and is usually irreversible.


\section{\protect\(D(t)\protect\) and \protect\(t(D)\protect\) for Tank Drain Equation}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:and-for-tank-drain-equation}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-diameter-and-time-tank-drain-equation}}
This document contains the derivation of \(D_{Pipe}\), which is the pipe diameter necessary to install in a drain system to entirely drain a tank in time \(t_{Drain}\).

First, it is necessary to understand how AguaClara tank drains work and what they look like. Many tanks, including the flocculator and entrance tank, have a hole in their bottoms which are fitted with pipe couplings. During normal operation, these couplings have pipe stubs in them, and the pipe stubs are tall enough to go above the water level in the tank and not allow water to flow into the drain. When the pipe stub is removed, the water begins to flow out of the drain, as the image below indicates. The drain pipe consists of pipe and one elbow, shown in the image.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{pipe_stub_drainage}.png}
\caption{This is AguaClara’s alternatives to having valves.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id3}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-pipe-stub-drainage}}\end{figure}

While AguaClara sedimentation tanks use valves instead of pipe to begin the process of draining, the actual drain piping system is the same, pipe and an elbow. The equation that will soon be derived applies to both pipe stub and valve drains.

We will start the derivation from the following equation, which is found in an intermediate step from the ‘\(Q(t)\) {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-flow-for-a-tank-with-a-valve}]{\sphinxcrossref{\DUrole{std,std-ref}{ for a Tank with a Valve}}}}.’ While this system does not have a valve, it has other sources of minor loss and therefore the equation is still valid.
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:15}
\begin{split}\sqrt h  = \sqrt{h_0} - t \frac{A_{Valve}}{2 A_{Tank}} \sqrt {\frac{2g}{K}}\end{split}
\end{equation}
We need to make some adjustments to this equation before proceeding, to make it applicable for this new drain-system scenario. First, we want to assume that the tank has fully drained. Thus, \(t = t_{Drain}\) and \(h = 0\). Next, we recall that the tank drain is not actually a valve, but just pipe and an elbow, so \(A_{Valve} = A_{Pipe}\). Additionally, there can be multiple points of minor loss in the drain system: the entrance from the tank into the drain pipe, the elbow, and potentially the exit of the water out of the drain pipe. When considering a sedimentation tank, the open valve required to begin drainage also has a minor loss associated with it. Therefore, it is necessary to substitute \(\sum K\) for \(K\) With these substitutions, the equation becomes:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:16}
\begin{split}\sqrt{h_0}  = t_{Drain} \frac{A_{Pipe}}{2 A_{Tank}} \sqrt {\frac{2g}{\sum K}}\end{split}
\end{equation}
Now, with the knowledge that \(A_{Pipe} = \frac{\pi D_{Pipe}^2}{4}\) and rearranging to solve for \(D_{Pipe}\), we obtain the following equation:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:17}
\begin{split}D_{Pipe} = \sqrt{ \frac{8 A_{Tank}}{\pi t_{Drain}} \sqrt{ \frac{h_0 \sum K}{2g} } }\end{split}
\end{equation}
To get the equation in terms of easily measureable tank parameters, we substitute \(L_{Tank} W_{Tank}\) for \(A_{Tank}\). To maintain consistency in variable names, we substitute \(H_{Tank}\) for \(h_0\).

\begin{sphinxadmonition}{note}{Note:}
By saying that \(h_0 = H_{Tank}\), we are making the assumption that the pipe drain is at the same elevation as the bottom of the tank. The pipe drain is actually a little lower than the bottom of the tank, but that would make the tank drain faster than \(t_{Drain}\), which is preferred. Therefore, we are designing a slight safety factor when we say that \(h_0 = H_{Tank}\).
\end{sphinxadmonition}

Finally, we arrive at the equation for drain pipe sizing:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:18}
\begin{split}\color{purple}{
D_{Pipe} = \sqrt{ \frac{8 L_{Tank} W_{Tank}}{\pi t_{Drain}}} \left( \frac{H_{Tank} \sum K}{2g} \right)^{\frac{1}{4}}
}\end{split}
\end{equation}
We can also easily rearrange to find the time required to drain a tank given a drain diameter:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:19}
\begin{split}\color{purple}{
t_{Drain} = \frac{8 L_{Tank} W_{Tank}}{\pi D_{Pipe}^2} \sqrt{ \frac{H_{Tank} \sum K}{2g} }
}\end{split}
\end{equation}
Such that the variables are as the appear in the image below.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{pipe_stub_drainage_variables}.png}
\caption{\(L_{Tank}\) is the length of the tank which goes the page. \(K\) is the aggregate minor loss coefficient of the drain system.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id4}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-pipe-stub-drainage-variables}}\end{figure}


\section{Design Equations for the Linear Chemical Dose Controller (CDC)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:design-equations-for-the-linear-chemical-dose-controller-cdc}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-design-equations-for-the-cdc}}
This document will include the equation derivations required to design a CDC system. The most important restriction in this design process is maintaining linearity between head \(h\) and flow \(Q\), which is the entire purpose of the CDC. Recall that major losses under laminar flow scale with \(Q\) and minor losses scale with \(Q^2\) Since it is impossible to remove minor losses from the system entirely, we will simply try to make minor losses very small compared to major losses. The CDC does this by including ‘dosing tube(s),’ which are long, straight tubes designed to generate a lot of major losses. There can be one tube or multiple, depending on the design conditions.

We will use the ‘head loss trick’ that was introduced in the Fluids Review section. Therefore, the elevation difference between the water level in the constant head tank (CHT) and the end of the tube connected to the slider, \(\Delta h\), is equal to the head loss between the two points, \(h_L\). Thus, \(\Delta h = h_L = h_e + h_f\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{CDC_derivation}.png}
\caption{Visual representation of CDC.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id5}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-cdc-derivation}}\end{figure}


\subsection{CDC Design Equation Derivation}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:cdc-design-equation-derivation}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:heading-cdc-design-equation-derivations}}
\begin{sphinxadmonition}{important}{Important:}
\sphinxstylestrong{When designing the CDC, there are a few parameters which are picked and set initially, before applying any equations. These parameters are:}
\end{sphinxadmonition}
\begin{enumerate}
\item {} 
\(D\) = tube diameter. only certain tubing diameters are manufactured (like \(\frac{x}{16}\) inch), so an array of available tube diameters is set initially.

\item {} 
\(\sum K\) = sum of minor loss coefficients for the whole system. This is also set initially, it is usually 2.

\item {} 
\(h_{L_{Max}}\) = maximum elevation difference between CHT water level and outlet of solution. This parameter is usually 20 cm.

\end{enumerate}

We begin by defining the head loss through the system \(h_L\), which is equivalent to defining the driving head \(\Delta h\). Major losses will be coded as red.
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:20}
\begin{split}\color{red}{
  h_{\rm{f}} = \frac{128\nu LQ}{g\pi D^4}
  }\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\nu\) = kinematic viscosity \sphinxstyleemphasis{of the solution going through the dosing tube(s)}. This is either coagulant or chlorine
\item[] \(Q\) = flow rate through the dosing tube(s)
\item[] \(L\) = length of the dosing tube(s)
\end{DUlineblock}

\begin{sphinxadmonition}{note}{Note:}
‘Tube(s)’ is used because there may be 1 or more dosing tubes depending on the particular design.
\end{sphinxadmonition}

Minor losses are equal to:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:21}
\begin{split}h_e = \frac{8 Q^2}{g \pi^2 D^4} \sum{K}\end{split}
\end{equation}
Therefore, the total head loss is a function of flow, and is shown in the following equation.
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:22}
\begin{split}h_L(Q) =
{\color{red}{
  \frac{128\nu L Q}{g \pi D^4}}} +
  \frac{8Q^2}{g \pi^2 D^4} \sum K\end{split}
\end{equation}
Blue will be used to reference \sphinxstyleemphasis{actual} head loss from now on. This is the same equation as above.
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:23}
\begin{split}\color{blue}{
  h_L(Q) = \left( \frac{128\nu L}{g \pi D^4} + \frac{8Q}{g \pi ^2 D^4} \sum{K} \right) Q
  }\end{split}
\end{equation}
This equation is not linear with respect to flow. We can make it linear by turning the variable \(Q\) in the \(\frac{8Q}{g \pi ^2 D^4} \sum{K}\) term into a constant. To do this, we pick a maximum flow rate of coagulant/chlorine through the dose controller, \(Q_{Max}\), and put that into the term in place of \(Q\). The term becomes \(\frac{8Q_{Max}}{g \pi ^2 D^4} \sum{K}\), and our linearized model of head loss, coded as green, becomes:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:24}
\begin{split}\color{green}{
  h_{L_{linear}}(Q) = \left( \frac{128\nu L}{g \pi D^4} + \frac{8Q_{Max}}{g \pi ^2 D^4} \sum{K} \right) Q
  }\end{split}
\end{equation}
Here is a plot of the three colored equations above. Our goal is to minimize the minor losses in the system; to bring the red and blue curves as close as possible to the green one.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{CDC_linearity_model}.png}
\caption{MathCAD generated graph for linearity error analysis. TODO: make this in python}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id6}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-cdc-linearity-model}}\end{figure}


\subsubsection{Designing for the error constraint, \protect\(\Pi_{Error}\protect\)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:designing-for-the-error-constraint}}
\begin{sphinxadmonition}{important}{Important:}
The first step in the design is to make sure that major losses far exceed minor losses. This will result in an equation for the maximum velocity that can go through the dosing tube(s), \(\color{purple}{\bar v_{Max} }\).
\end{sphinxadmonition}

Minor losses will never be 0, so how much error in our linearity are we willing to accept? Let’s define a new parameter, \(\Pi_{Error}\), as the maximum amount of error we are willing to accept. We are ok with 10\% error or less, so \(\Pi_{Error} = 0.1\).
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:25}
\begin{split}\Pi_{Error} = \frac{\color{green}{ h_{L_{linear}} } - \color{blue}{ h_L }}{\color{green}{ h_{L_{linear}} }} = 1 - \frac{\color{blue}{ h_L }}{\color{green}{ h_{L_{linear}} }}\end{split}
\end{equation}\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:26}
\begin{split}1 - \Pi_{Error} = \frac{\color{blue}{ h_L }}{\color{green}{ h_{L_{linear}} }}\end{split}
\end{equation}
Now we plug \(\color{blue}{ h_L(Q) }\) and \(\color{green}{ h_{L_{linear}} }\) back into the equation for \(1 - \Pi_{Error}\) and take the limit as \(Q \rightarrow 0\), as that is when the relative difference between actual head loss and our linear model for head loss is the greatest.
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:27}
\begin{split}1 - \Pi_{Error} =
  \frac{ \color{blue}{
  \left( \frac{128 \nu L}{g \pi D^4} +
  \cancel{\frac{8Q}{g \pi^2 D^4} \sum{K}}
  \right) Q
  }}
  {\color{green}{
  \left( \frac{128 \nu L}{g \pi D^4} + \frac{8 Q_{Max}}{g \pi^2 D^4} \sum{K} \right) Q
  }}
  =     \frac{\left( \frac{128 \nu L}{g \pi D^4} \right)}{\left( \frac{128 \nu L}{g \pi D^4} + \frac{8 Q_{Max}}{g \pi^2 D^4} \sum{K} \right)}\end{split}
\end{equation}
The next steps are algebraic rearrangements to solve for \(L\). This \(L\) describes the \sphinxstyleemphasis{minimum} length of dosing tube necessary to meet our error constraint at \sphinxstyleemphasis{maximum} flow. Thus, we will refer to it as \(L_{Min, \, \Pi_{Error}}\).
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:28}
\begin{split}\left( 1 - \Pi_{Error} \right)  \frac{128 \nu L}{g \pi D^4} + \left( 1 - \Pi_{Error} \right) \frac{8 Q_{Max}}{g \pi ^2 D^4} \sum{K}  =  \frac{128 \nu L}{g \pi D^4}\end{split}
\end{equation}\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:29}
\begin{split}- \Pi_{Error} \frac{128 \nu L}{g \pi D^4} + \left( 1 - \Pi_{Error} \right) \frac{8 Q_{Max}}{g \pi^2 D^4} \sum{K}  = 0\end{split}
\end{equation}\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:30}
\begin{split}L = \left( \frac{1 - \Pi_{Error}}{\Pi_{Error}} \right) \frac{Q_{Max}}{16 \nu \pi} \sum{K}\end{split}
\end{equation}\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:31}
\begin{split}L_{Min, \, \Pi_{Error}} = L = \left( \frac{1 - \Pi_{Error}}{\Pi_{Error}} \right) \frac{Q_{Max}}{16 \nu \pi} \sum{K}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Note that this equation is independent of head loss.
\end{DUlineblock}

Unfortunately, both \(L_{Min, \, \Pi_{Error}}\) and \(Q_{Max}\) are unknowns. We can plug this equation for \(L_{Min, \, \Pi_{Error}}\) back into the head loss equation at maximum flow, which is \(h_{L_{Max}} = \left( \frac{128\nu L Q_{Max}}{g \pi D^4} + \frac{8Q_{Max}^2}{g \pi ^2 D^4} \sum{K} \right)\) and rearrange for \(Q_{Max}\) to get:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:32}
\begin{split}Q_{Max} = \frac{\pi D^2}{4} \sqrt{\frac{2 h_{L_{Max}} g \Pi_{Error}}{\sum K }}\end{split}
\end{equation}

\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara} \sphinxcode{\sphinxupquote{cdc.max\_linear\_flow(Diam, HeadlossCDC, Ratio\_Error, KMinor)}} Returns the maximum flow \(Q_{Max}\) that can go through a dosing tube will making sure that linearity between head loss and flow is conserved.



From this equation for \(Q_{Max}\), we can get to our first design equation, \(\color{purple}{\bar v_{Max}}\) by using the continuity equation \(\bar v_{Max} = \frac{Q_{Max}}{\frac{\pi D^2}{4}}\)
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:33}
\begin{split}\color{purple}{
  \bar v_{Max} = \sqrt{ \frac{2 h_L g \Pi_{Error}}{\sum{K} }}
  }\end{split}
\end{equation}

\subsubsection{Designing for the proper amount of head loss, \protect\(h_{L_{Max}}\protect\)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:designing-for-the-proper-amount-of-head-loss}}
\begin{sphinxadmonition}{important}{Important:}
The second step in the design is to make sure that the maximum head loss corresponds to the maximum flow of chemicals. This will result in an equation for the length of the dosing tube(s), \(\color{purple}{L_{Min} }\).
\end{sphinxadmonition}

We previously derived an equation for the minimum length of the dosing tube(s), \(L_{Min, \, \Pi_{Error}}\), which was the minimum length needed to ensure that our linearity constraint was met. This equation is shown again below, in red:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:34}
\begin{split}\color{red}{
  L_{Min, \, \Pi_{Error}} = \left( \frac{1 - \Pi_{Error}}{\Pi_{Error}} \right) \frac{Q_{Max}}{16 \nu \pi} \sum{K}
  }\end{split}
\end{equation}
This equation does not, however, account for getting to the proper amount of head loss. If we were to use this equation to design the dosing tubes, we might not end up with the proper amount of flow \(Q_{Max}\) at the maximum head loss \(h_{L{Max}}\). So we need to double check to make sure that we get our desired head loss.

First, consider the head loss at maximum flow that was used to get the equation for \(Q_{Max}\):
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:35}
\begin{split}h_{L_{Max}} = \left( \frac{128 \nu L{Q_{Max}}}{g \pi D^4} + \frac{8 Q_{Max}^2}{g \pi^2 D^4} \sum{K} \right)\end{split}
\end{equation}
Now that we know all of the parameters in this equation except for \(L\), we can solve the equation for \(L\). This the \sphinxstyleemphasis{shortest} tube that generates our required head loss, \(h_{L_{Max}}\).
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:36}
\begin{split}\color{green}{
   L_{Min, \, head loss} = L = \left( \frac{g h_{L_{Max}} \pi D^4}{128 \nu Q_{Max}} - \frac{Q_{Max}}{16 \pi \nu} \sum{K} \right)
   }\end{split}
\end{equation}

\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara:} \sphinxcode{\sphinxupquote{cdc.\_length\_cdc\_tube\_array(FlowPlant, ConcDoseMax, ConcStock, DiamTubeAvail, HeadlossCDC, temp, en\_chem, KMinor)}} Returns \(\color{purple}{L_{Min}}\), takes in the flow rate input of \sphinxstyleemphasis{plant design flow rate}.




\sphinxstrong{See also:}


\sphinxstylestrong{Function in aguaclara:} \sphinxcode{\sphinxupquote{cdc.\_len\_tube(Flow, Diam, HeadLoss, conc\_chem, temp, en\_chem, KMinor)}} Returns \(\color{purple}{L_{Min}}\), takes in the flow rate input of \sphinxstyleemphasis{max flow rate through the dosing tube(s)}.



If you decrease the max flow \(Q_{Max}\) and hold \(h_{L_{Max}}\) constant, \(\color{green}{L_{Min, \, head loss}}\) becomes larger. This means that a CDC system for a plant of 40 \(\frac{L}{s}\) must be different than one for a plant of 20 \(\frac{L}{s}\). If we want to maintain the same head loss at maximum flow in both plants, then the dosing tube(s) will need to be a lot longer for the 20 \(\frac{L}{s}\) plant.

To visualize the distinction between \(\color{red}{  L_{Min, \, \Pi_{Error}}}\) and \(\color{green}{ L_{Min, \, head loss}}\), see the following plot. \(\color{green}{ L_{Min, \, head loss}}\) is discontinuous because it takes in the smallest allowable tube diameter as an input. As the chemical flow rate through the dosing tube(s) decreases, the dosing tube diameter does as well. Whenever you see a jump in the green points, that means the tubing diameter has changed.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{CDC_length_model}.png}
\caption{CDC length modeling in MathCAD.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id7}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-cdc-length-model}}\end{figure}

As you can see, the head loss constraint is more limiting than the linearity constraint when designing for tube length. Therefore, the design equation for tube length is the one which accounts for head loss. This is the second and final design equation for designing the CDC:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:37}
\begin{split}\color{purple}{
L_{Min} = L_{Min, \, head loss} = \left( \frac{g h_{L_{Max}} \pi D^4}{128 \nu Q_{Max}} - \frac{Q_{Max}}{16 \pi \nu} \sum{K} \right)
}\end{split}
\end{equation}
The equations for \(\color{purple}{\bar v_{Max}}\) and \(\color{purple}{L_{Min}}\) are the only ones you \sphinxstylestrong{need} to manually design a CDC.


\subsubsection{CDC Dosing Tube(s) Diameter \protect\(D_{Min}\protect\) Plots}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:cdc-dosing-tube-s-diameter-plots}}
Below are equations which also govern the CDC and greatly aid in understanding the physics behind it, but are not strictly necessary in design.

By rearranging \(Q_{Max} = \frac{\pi D^2}{4} \sqrt{\frac{2 h_L g \Pi_{Error}}{\sum K }}\), we can solve for \(D\) to get the \sphinxstyleemphasis{minimum} diameter we can use assuming the shortest tube possible that meets the error constraint, \(\color{red}{L_{Min, \, \Pi_{Error}}}\). If we use a diameter smaller than \(D_{Min, \, \Pi_{Error}}\), we will not be able to simultaneously reach \(Q_{Max}\) and meet the error constraint \(\Pi_{Error}\).
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:38}
\begin{split}\color{blue}{
D_{Min, \, \Pi_{Error}} = \left[ \frac{8 Q_{Max}^2 \sum K}{\Pi_{Error} h_l g \pi^2} \right]^{\frac{1}{4}}
}\end{split}
\end{equation}
We can also find the minimum diameter needed to guarantee laminar flow, which is another critical condition in the CDC design. We can do this by combining the equation for Reynolds number at the maximum \(\rm{Re}\) for laminar flow, \({\rm{Re}}_{Max} = 2100\) with the continuity equation at maximum flow:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:39}
\begin{split}{\rm Re}_{Max}  = \frac{\bar v_{Max} D}{\nu}\end{split}
\end{equation}\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:40}
\begin{split}\bar v_{Max} = \frac{4 Q_{Max}}{\pi D^2}\end{split}
\end{equation}
To get:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Derivations:Flow_Control_and_Measurement/FCM_Derivations:41}
\begin{split}\color{red}{
D_{Min, \, Laminar} = \frac{4 Q_{Max}}{\pi \nu {\rm{Re}}_{Max}}
}\end{split}
\end{equation}
Combined with the discrete amount of tubing sizes (shown in dark green), we can create a graph of the three diameter constraints:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{CDC_diameter_model}.png}
\caption{CDC diameter modeling in MathCAD.}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:id8}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Derivations:figure-cdc-diameter-model}}\end{figure}


\chapter{Flow Control and Measurement Solution}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:flow-control-and-measurement-solution}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution::doc}}

\section{A brief programming guide}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:a-brief-programming-guide}}\begin{enumerate}
\item {} 
Do not use a numerical or iterative solution when an analytical solution is easily available.

\item {} 
Whenever a function has the potential to be used multiple times, create a function call that includes the parameters that could potentially change.

\item {} 
Do not break dependency. That means that if I change an input parameter at the top of your worksheet, that I should get the correct answers for the new parameter for all related calculations in the worksheet.

\item {} 
Always use dimensions (units). All calculations involving physical units must include those units.

\item {} 
Document your design process with comments.

\item {} 
Do not redefine your variables in subsequent problems. This loses valuable digits of precision on your numbers and can cause a lot of trouble and frustration.

\item {} 
For everyone’s sake, use logical and reasonable variable names. \sphinxhref{https://github.com/AguaClara/aguaclara/wiki/Design-Variable-Naming-Conventions}{Here is AguaClara variable naming convention}

\end{enumerate}


\section{A brief Design Challenge guide}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:a-brief-design-challenge-guide}}\begin{enumerate}
\item {} 
Read the Problem statement in its entirety before beginning a problem. If you don’t immediately know what to do, read it again, thoroughly. If you are getting stuck, read it a third time. If you have a good understanding of what the problem is asking and are still having trouble, TAs can help through email or office hours.

\item {} 
If you decide to email a TA, make sure the other two are CC’ed. This minimizes the time you will have to wait until one responds.

\item {} 
When in doubt, Kernel -\textgreater{} Restart \& Run All

\item {} 
Play around! Print arrays, test inputs, and ask yourself if your answers are reasonable. Should flow have units of km mg/s?

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}


\section{Vertical orifice equation}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:vertical-orifice-equation}}

\subsection{1)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id1}}
Find the vena contract (VC) coefficient ratio for an orifice in the expert\_inputs and print the result in a sentence. Please display 2 significant figures.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The vena contracta coefficient for an orifice is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{VC\PYGZus{}ORIFICE\PYGZus{}RATIO}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The vena contracta coefficient for an orifice is 0.63.


\subsection{2)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id2}}
The simple orifice equation \(Q = {\Pi _{vc}}{A_{or}}\sqrt {2g\Delta h}\) that we normally use is not applicable for vertically oriented orifices that are partially or barely submerged. The \sphinxhref{https://il.water.usgs.gov/proj/feq/fequtl98.i2h/4\_7aupdate.html}{USGS published a great solution} for flow through partially submerged vertically oriented orifices. AguaClara uses a general solution for a vertically oriented orifice, which is available in the physchem file as \sphinxcode{\sphinxupquote{pc.flow\_orifice\_vert}}. That function handles vertically oriented orifices even if they are only partially submerged.

The vertical orifice equation is based on the concept that the velocity through the orifice at any point is equal to \(\sqrt{2gh}\), where h is the local depth of submergence. The total flow can be obtained by integration of that velocity over the submerged area of the orifice.

For this question, you will create a well formatted graph with two curves to display flow rate through a 5 cm diameter orifice oriented \sphinxstylestrong{vertically and horizontally}.

We want to be able to describe the height of the water in the orifice as relative to the orifice diameter size. The relationship between velocity and orifice diameter is true for orifices of any size, so it is valuable to create a nondimensional model that can be understood for all diameters. The flow rate that you will use for this question is as a function of the normalized depth of water from 1 diameter below the center of the orifice to 2 diameters above the center of the orifice.

The steps for making the graph are as follows:
\begin{itemize}
\item {} 
Use \sphinxcode{\sphinxupquote{np.linspace}} to generate an array of 100 dimensionless water surface elevations. The surface elevations should be normalized (also referred to as nondimensionalized) by the diameter of the orifice, and should range from -1 to 2 orifice diameters.

\item {} 
Create a second array for water elevation (with units) by multiplying the normalized water elevation array by the orifice diameter.

\item {} 
Create two arrays of flow rates through the orifice: one for the horizontal orifice orientation and one for the vertical orifice orientation. Use the two orifice equations \sphinxcode{\sphinxupquote{pc.flow\_orifice}} and \sphinxcode{\sphinxupquote{pc.flow\_orifice\_vert}} in the physchem file, with orifice diameter and the dimensional water elevation array you created as inputs.

\item {} 
Plot the curves for vertical and horizontal orifice flow in L/s as a function of the normalized height of water.

\item {} 
Label the graph with flow rate in L/s as the y-axis and with normalized water elevation above the center of the orifice as the x-axis.

\item {} 
Include a legend for the two curves.

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{WaterElevationNormalized} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}
\PYG{n}{DiamOrifice} \PYG{o}{=} \PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{WaterElevation} \PYG{o}{=} \PYG{n}{WaterElevationNormalized}\PYG{o}{*}\PYG{n}{DiamOrifice}

\PYG{c+c1}{\PYGZsh{}Here we initialize some empty numpy arrays of the same size and type as WaterElevationNormalized}
\PYG{n}{HorizontalOrificeFlows} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty\PYGZus{}like}\PYG{p}{(}\PYG{n}{WaterElevationNormalized}\PYG{p}{)}
\PYG{n}{VerticalOrificeFlows} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty\PYGZus{}like}\PYG{p}{(}\PYG{n}{WaterElevationNormalized}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Here we need to populate the arrays we created above.}
\PYG{c+c1}{\PYGZsh{} Our graphing library, pyplot, cannot handle units, so we need to remove}
\PYG{c+c1}{\PYGZsh{} them from each element as we insert it into the array.}
\PYG{c+c1}{\PYGZsh{} While the code looks somewhat ugly, this is the best place to remove units;}
\PYG{c+c1}{\PYGZsh{} we are removing them after all calculations have been made to minimize the}
\PYG{c+c1}{\PYGZsh{} severity of floating\PYGZhy{}point errors.}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{WaterElevation}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{HorizontalOrificeFlows}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{flow\PYGZus{}orifice}\PYG{p}{(}\PYG{n}{DiamOrifice}\PYG{p}{,} \PYG{n}{WaterElevation}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{VC\PYGZus{}ORIFICE\PYGZus{}RATIO}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}
  \PYG{n}{VerticalOrificeFlows}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{p}{(}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{flow\PYGZus{}orifice\PYGZus{}vert}\PYG{p}{(}\PYG{n}{DiamOrifice}\PYG{p}{,} \PYG{n}{WaterElevation}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{VC\PYGZus{}ORIFICE\PYGZus{}RATIO}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{WaterElevationNormalized}\PYG{p}{,} \PYG{n}{HorizontalOrificeFlows}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{WaterElevationNormalized}\PYG{p}{,} \PYG{n}{VerticalOrificeFlows}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Normalized height of water above center of the orifice}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flow rate through the orifice (L/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Horizontal Orientation}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Vertical orientation}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flow\PYGZus{}Control\PYGZus{}and\PYGZus{}Measurement/Images/Horizontal\PYGZus{}vs\PYGZus{}Vertical\PYGZus{}Orifice\PYGZus{}Orientation}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Horizontal_vs_Vertical_Orifice_Orientation}.png}
\caption{Horizontal vs. Vertical Orifice Orientation}\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id22}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:figure-horizontal-vs-vertical-orifice-orientation}}\end{figure}


\subsection{3)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id3}}
Write a paragraph about what the graph means by explaining the following two items: - Explain why the vertical orifice equation predicts more flow when the water level is below the center of the orifice and predicts less flow when the water level is above the center of the orifice. It might help to draw a picture of what the equations are describing to understand what is happening here! - Explain how the horizontal orifice equation function from \sphinxcode{\sphinxupquote{physchem.py}} predicts the flow rate for submergence depths that are negative. You will need to find the function and look at the code.


\subsubsection{Explanation}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:explanation}}
The vertical orifice has the lower part of the orifice partially submerged before the horizontal orifice has any part submerged. This explains why the vertical orifice has more flow than the horizontal orifice between -0.5 and 0.

The horizontal orifice has higher flow rates between 0 and 0.5 because it is fully submerged when the vertical orifice is still not fully submerged.

At the elevation where the vertical orifice is first fully submerged the flow rate through the vertical orifice is less than the flow rate through the horizontal orifice. This is a result of the nonlinear relationships between depth of submergence and velocity.

The difference between the two equations becomes negligible for submergence greater than 1 diameter.

For negative depths of submergence the horizontal orifice function uses an if statement to set the flow rate through the orifice equal to zero.


\section{Linear Flow Orifice Meter (LFOM)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:linear-flow-orifice-meter-lfom}}
A linear flow orifice meter is used in AguaClara plants to measure the plant flow rate and to provide a linear relationship between flow rate and the depth of water in the entrance tank. Below, we use the LFOM code to obtain a design for a linear flow orifice meter. Your task will be to test this design using the orifice equations to see if it is correct. We have a custom \sphinxhref{https://aguaclara.github.io/aguaclara/design/lfom.html}{LFOM class} that defines the LFOM properties. This code will be updated soon based on the code below. In the meantime, the code below can be used for calculations.

The following questions are all answered in one big block of code to make it easy to change values and then see the resulting graph.


\subsection{4)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id4}}
\sphinxstylestrong{Create a function} that calculates the flow rate through the LFOM as a function of only water elevation using the vertical orifice function. Use the arrays for LFOM key parameters, given above as \sphinxcode{\sphinxupquote{my\_LFOM.orifice\_diameter}}, \sphinxcode{\sphinxupquote{my\_LFOM.n\_orifices\_per\_row}}, and \sphinxcode{\sphinxupquote{my\_LFOM.height\_orifices}}.
\begin{itemize}
\item {} 
Create an array for depth of submergence for each row of orifices at a given a height of water in the LFOM. This array is dependent on the water elevation (which should be your function input) and the height of the LFOM orifices (which is from the LFOM key parameters). Use this submergence depth array as the “height” input to your vertical orifice function. The array should be created within your function.

\item {} 
To calculate the flow rate through the LFOM, multiply the calculated flow for each row of orifices by the number of orifices in that row (\sphinxcode{\sphinxupquote{my\_LFOM.n\_orifices\_per\_row}}) to get an array of flows through each row of orifices. Note: the vertical orifice function will report zero flow for any orifices that aren’t submerged, so you can send the whole array of depth of submergence for each row of orifices.

\item {} 
At the end of your function, sum flows from each row of the LFOM and return that value with the correct units.

\item {} 
Add a comment under the function definition to explain what the function does (see any of the aguaclara design files for examples of descriptive comments).

\end{itemize}


\subsection{5)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id5}}\begin{quote}

Calculate the total flow through the LFOM using the vertical orifice equation for the case when the water level is at the maximum water level for the LFOM, \sphinxcode{\sphinxupquote{HeadlossLfom}}. You are checking to make sure that the LFOM produces the correct target flow (given as \sphinxcode{\sphinxupquote{Flow}}) at the maximum height. Does it?
\end{quote}


\subsection{6)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id6}}\begin{quote}

We want to compare the actual flow rate through the LFOM to the expected flow rate through the elevation as a function of water depth. Create a graph of the normalized actual and expected flow rates, using the following steps:
\begin{itemize}
\item {} 
Create an 100-unit long array of water depths using \sphinxcode{\sphinxupquote{np.linspace}}. Note: the expected flow rate at elevation zero is zero, which makes the normalized flow rate undefined for zero elevation. An undefined normalized flow will not run and Python will report an error. You can solve this by beginning your water depth array at a very small (nonzero) elevation. You can end your water depth array at the maximum water depth. Recall that an array of elevations should have units of length.

\item {} 
Create an array of normalized actual flow rates at each water depth; use the function you created in Problem 4 and a \sphinxcode{\sphinxupquote{for}} loop (the function you created in Problem 4 probably can’t handle an array of depths as input, so you need the \sphinxcode{\sphinxupquote{for}} loop to cycle through each depth value to make your array of flows).
\begin{itemize}
\item {} 
Start by creating an empty array for actual flow rates that is the same shape as the 100-unit water depth array you just created.

\item {} 
In your \sphinxcode{\sphinxupquote{for}} loop, normalize the actual flow rates by using the following relationship: normalized actual flow rate = (actual flow rate)/{[}(water depth * target flow rate)/maximum water level{]}

\end{itemize}

\item {} 
Plot a straight horizontal line at y = 1, which is your normalized expected flow value if the LFOM were perfect.

\end{itemize}
\end{quote}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Normalized_Flow_Rate_vs_Water_Depth}.png}
\caption{Normalized Flow Rate vs. Water Depth}\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id23}}\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:figure-normalized-flow-rate-vs-water-depth}}\end{figure}


\subsection{7)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id7}}
Play with the value for the plant flow rate, \sphinxcode{\sphinxupquote{LFOM\_flow}}, and try a bunch of different flows over the range 1 to 100 L/s. The LFOM isn’t accurate for the first couple of rows.


\subsection{8)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id8}}
DO you observe any failure modes where the design produces very inaccurate flow measurements? If so, then create an issue!


\subsection{9)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id9}}
Explain why all LFOMs perform poorly when the water depth is in the first row of orifices.

The relationship between head and flow is nonlinear for a single row of orifices. Thus it is impossible for the LFOM to be accurate when there is only one row of orifices.


\section{Laminar Flow Based Flow Controller}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:laminar-flow-based-flow-controller}}
You will design (by completing the following questions) a laminar flow controller for chlorine feed for a plant design flow rate of 50 L/s.

For the following steps do NOT use the aguaclara cdc code. Instead, create the functions that you need to solve this problem. At the end, we will compare your solution to the aguaclara cdc solution.

You may assume that the chlorine stock solution kinematic viscosity is approximately the same as water. The dose controller is to have a maximum head loss of 20 cm through the dosing tubes. We will start with commercially available liquid bleach (equivalent to 51.4 gm/L of chlorine gas), which we will use in our chemical stock tanks without dilution. Our goal is to provide a constant chlorine dose of 2 mg/L to the water entering the storage tank. We will be following the guidelines given below.
\begin{enumerate}
\item {} 
Calculate the maximum fow rate through each available dosing tube diameter that keeps error due to minor losses below 10\%.

\item {} 
Calculate the total chemical flow rate that would be required by the treatment system for the maximum chemical dose and the maximum allowable stock concentration.

\item {} 
Calculate the number of dosing tubes required if the tubes flow at maximum capacity (round up).

\item {} 
Calculate the length of the dosing tubes that correspond to each available tube diameter.

\item {} 
Select the longest dosing tube that is shorter than the maximum tube length allowable based on geometric constraints.

\item {} 
Select the dosing tube diameter, flow rate, and stock concentration corresponding to the selected tube length.

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{FlowPlant} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{T} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{NuBleach} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}
\PYG{n}{HeadlossDosingTubeMax} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{n}{StockCl2} \PYG{o}{=} \PYG{l+m+mf}{51.4}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}
\PYG{n}{DoseCl2} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}
\PYG{n}{RatioError} \PYG{o}{=} \PYG{l+m+mf}{0.1}
\PYG{n}{KMinor} \PYG{o}{=} \PYG{l+m+mi}{2}
\end{sphinxVerbatim}


\subsection{11)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id10}}
At the given water treatment plant design flow rate, what is the required flow of bleach (the chlorine stock solution)?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{FlowStockClMax} \PYG{o}{=} \PYG{p}{(}\PYG{n}{FlowPlant} \PYG{o}{*} \PYG{n}{DoseCl2} \PYG{o}{/} \PYG{n}{StockCl2}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The required flow of bleach is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{FlowStockClMax}\PYG{p}{)}
\end{sphinxVerbatim}

The required flow of bleach is 1.95 ml/s


\subsection{12)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id11}}
How many liters of liquid bleach are required in one day? (you can simply change the units on the flow rate!)

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The daily required flow of bleach is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{FlowStockClMax}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{day}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The daily required flow of bleach is 168.09 l/day


\subsection{13)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id12}}
Our next big goal is to choose a tubing size for the dosing tube (or tubes). This requires multiple steps. Begin by first creating a numpy array of tubing sizes between 1/16” and 5/16” with a 1/16” interval. Your list should contain 5 elements. Does \sphinxcode{\sphinxupquote{np.linspace}} work here? What about \sphinxcode{\sphinxupquote{np.arange}}? Remember to always attach the units to the entire array and not to array elements!

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{DiamTubeArray} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{l+m+mi}{16} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{DiamTubeArray}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,} \PYG{n}{DiamTubeArray}\PYG{o}{.}\PYG{n}{units}\PYG{p}{)}
\end{sphinxVerbatim}

{[} 0.0625  0.125   0.1875  0.25    0.3125{]} inch


\subsection{14)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id13}}
What is the maximum average velocity in a dosing tube based on the constraint that minor losses must be small? This means that the minor losses account for \sphinxcode{\sphinxupquote{RatioError}} fraction of the total losses (10\% when \sphinxcode{\sphinxupquote{RatioError}} is 0.1). Note that this velocity is independent of the tube diameter.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{VelTubeMax} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{RatioError} \PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{HeadlossDosingTubeMax} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity}\PYG{p}{)} \PYG{o}{/} \PYG{n}{KMinor}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum average velocity in a dosing tube is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{VelTubeMax}\PYG{p}{)}
\end{sphinxVerbatim}

The maximum average velocity in a dosing tube is 0.443 m/s


\subsection{15)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id14}}
What is the head loss due to minor losses in the tube when the tube is flowing at maximum capacity? Solve for this value algebraically by substituting your equation for the velocity in the tube into the minor loss equation and then calculate the value.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{HeadlossMinorMax} \PYG{o}{=} \PYG{n}{RatioError} \PYG{o}{*} \PYG{n}{HeadlossDosingTubeMax}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The head loss due to minor losses when the tube is at maximum capacity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{HeadlossMinorMax}\PYG{p}{)}
\end{sphinxVerbatim}

The head loss due to minor losses when the tube is at maximum capacity is 2.0 cm


\subsection{16)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id15}}
Create an array of the maximum flow rates corresponding to the array of tubing diameters. The flow rates must meet the error constraint.
\begin{align}\label{equation:Flow_Control_and_Measurement/FCM_Solution:Flow_Control_and_Measurement/FCM_Solution:0}\!\begin{aligned}
Q_{Max} = \frac{\pi D^2}{4}\sqrt{\frac{2h_{L}g \Pi_{error}}{\sum K_{e}}}\\
- First, create a function that uses diameter and velocity as inputs to return flow rate. Note that ``ac.area_circle(diam)`` returns a circle’s area given its diameter, and you have already calculated the maximum average velocity in Problem 14.
- Create the array of maximum flow rates using the array of tubing diameters and the maximum head loss through the dosing tubes.\\
\end{aligned}\end{align}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{flow\PYGZus{}cdc\PYGZus{}max}\PYG{p}{(}\PYG{n}{diam}\PYG{p}{,} \PYG{n}{VelTubeMax}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{Flow} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{diam}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{VelTubeMax}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{Flow}

\PYG{n}{FlowMaxArray} \PYG{o}{=} \PYG{n}{flow\PYGZus{}cdc\PYGZus{}max}\PYG{p}{(}\PYG{n}{DiamTubeArray}\PYG{p}{,} \PYG{n}{VelTubeMax}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{FlowMaxArray}\PYG{p}{)}
\end{sphinxVerbatim}

{[}  0.87658228   3.5063291    7.88924048  14.02531641  21.91455688{]} milliliter / second


\subsection{17)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id16}}
Find the minimum number of tubes for each of the available tube diameters that would be required to deliver the maximum flow of bleach.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{NDosingTubes} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{n}{FlowStockClMax} \PYG{o}{/} \PYG{n}{FlowMaxArray}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of tubes of each diameter is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{NDosingTubes}\PYG{p}{)}
\end{sphinxVerbatim}

The number of tubes of each diameter is {[} 3.  1.  1.  1.  1.{]} dimensionless


\subsection{18)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id17}}
Create an array of the maximum flow rate per tube for each of the available tubing diameters, given the number of tubes that would be used. This will be the flow through each dosing tube at the maximum flow of bleach.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{FlowDosingTubeArray} \PYG{o}{=} \PYG{n}{FlowStockClMax} \PYG{o}{/} \PYG{n}{NDosingTubes}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow rate per tube is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{FlowDosingTubeArray}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{FlowStockClMax}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{The flow rate per tube is {[} 0.64850843  1.94552529  1.94552529  1.94552529  1.94552529{]} milliliter / second}] \leavevmode
1.9455252918287937 milliliter / second

\end{description}


\subsection{19)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id18}}
We now know the target flow in the dosing tubes, the diameter of the tubes, and the target head loss through the tubes. Thus, we can solve for the length of the tube that will deliver that target flow. Write a function to find the length of each tube that could handle the entire flow. Your function should use the following equation:
\begin{equation}\label{equation:Flow_Control_and_Measurement/FCM_Solution:Flow_Control_and_Measurement/FCM_Solution:1}
\begin{split}L = \frac{g h_{L}\pi D^4}{128 \nu Q_{Max}}-\frac{Q_{Max}}{16 \pi \nu}\sum K_{e}\end{split}
\end{equation}
Call your function to return the length of tubing required for each tube
size.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{length\PYGZus{}tube}\PYG{p}{(}\PYG{n}{flow\PYGZus{}max}\PYG{p}{,} \PYG{n}{diam}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}max}\PYG{p}{,} \PYG{n}{nu}\PYG{p}{,} \PYG{n}{k\PYGZus{}minor}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Returns the length of tube necessary to handle the maximum flow.}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{L} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{headloss\PYGZus{}max} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{diam}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{/}
                           \PYG{p}{(}\PYG{l+m+mi}{128} \PYG{o}{*} \PYG{n}{nu} \PYG{o}{*} \PYG{n}{flow\PYGZus{}max}\PYG{p}{)}\PYG{p}{)}\PYG{o}{\PYGZhy{}}
                    \PYG{p}{(}\PYG{p}{(}\PYG{n}{k\PYGZus{}minor} \PYG{o}{*} \PYG{n}{flow\PYGZus{}max}\PYG{p}{)}\PYG{o}{/}
                             \PYG{p}{(}\PYG{l+m+mi}{16} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{L}

\PYG{n}{LengthDosingTube} \PYG{o}{=} \PYG{n}{length\PYGZus{}tube}\PYG{p}{(}\PYG{n}{FlowDosingTubeArray}\PYG{p}{,} \PYG{n}{DiamTubeArray}\PYG{p}{,}
                                 \PYG{n}{HeadlossDosingTubeMax}\PYG{p}{,} \PYG{n}{NuBleach}\PYG{p}{,} \PYG{n}{KMinor}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The length of each dosing tube would be}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{LengthDosingTube}\PYG{p}{)}
\end{sphinxVerbatim}

The length of each dosing tube would be {[}  0.44406171   2.42832361  12.60675229  40.01021413  97.79237081{]} meter


\subsection{20)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id19}}
Which option do you think is best? You can simply set the array index to your choice and then display your solution by using that index value on your arrays for number of tubes, flow rates, tube diameters, and length of tubes.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{MYPICK} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of dosing tubes I will need is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{NDosingTubes}\PYG{p}{[}\PYG{n}{MYPICK}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow through each tube is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{FlowDosingTubeArray}\PYG{p}{[}\PYG{n}{MYPICK}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The inner diameter of the tube is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{DiamTubeArray}\PYG{p}{[}\PYG{n}{MYPICK}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The length of each tube is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{LengthDosingTube}\PYG{p}{[}\PYG{n}{MYPICK}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{The number of dosing tubes I will need is 1}] \leavevmode
The flow through each tube is 1.95 ml/s
The inner diameter of the tube is 0.125 inch
The length of each tube is 2.43 m

\end{description}


\subsection{21)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id20}}
What physical constraints might you use to select the best solution? How did you make your selection in Problem 19?

The ideal solution will have - a “reasonable” number of tubes and thus one possibility is to select the smallest diameter of tubing that uses a single tube. However, this won’t work for plants with high flow rates of chemicals. - tubes that are short enough to mount in the water treatment plant


\subsection{22)}
\label{\detokenize{Flow_Control_and_Measurement/FCM_Solution:id21}}
AguaClara has coded these dosing tube size functions in the CDC Functions (ac.CDC). Find the function calls for the length, diameter, and number of dosing tubes and use those functions to calculate the values for the problem that you solved above. Compare your answers. Your answers should agree!

Pending new solution using updated CDC code.


\chapter{Fluid Deformation and Energy Dissipation Derivations}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:fluid-deformation-and-energy-dissipation-derivations}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:title-fluid-deformation-and-energy-dissipation-introduction}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro::doc}}

\section{Energy Dissipation Rate, Velocity Gradient, and Mixing}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:energy-dissipation-rate-velocity-gradient-and-mixing}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:heading-edr-g-and-mixing}}\begin{description}
\item[{In addition to the general fluids review ({\hyperref[\detokenize{Review/Review_Fluid_Mechanics:title-review-fluid-mechanics}]{\sphinxcrossref{\DUrole{std,std-ref}{Review: Fluid Mechanics}}}}), there are a few extra fluid dynamics concepts that are important to know in order to understand drinking water treatment and AguaClara’s approach to it. These concepts are primarily focused on the relationships between:}] \leavevmode\begin{itemize}
\item {} 
Turbulence

\item {} 
Viscosity

\item {} 
Shear

\item {} 
Velocity Gradients (\(G\)),which serve as a measure of fluid deformation

\item {} 
Energy Dissipation Rate (EDR, \(\varepsilon\))

\end{itemize}

\end{description}

Knowledge of these concepts and how they interact is critical to understand rapid mix, flocculation, filtration, and disinfection. These concepts and their interactions first become relevant in rapid mix, the step in which the coagulant gets added to the raw water.

The two concepts that were not covered in the previous chapter, {\hyperref[\detokenize{Review/Review_Fluid_Mechanics:title-review-fluid-mechanics}]{\sphinxcrossref{\DUrole{std,std-ref}{Review: Fluid Mechanics}}}}, are velocity gradient \(G\) and energy dissipation rate \(\varepsilon\). While these will be very thoroughly described over the course of this introduction, a brief and simple explanation is included to help get the ball rolling.


\subsection{Understanding \protect\(G\protect\) and \protect\(\varepsilon\protect\)}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:understanding-and}}
\(G\), or velocity gradient, is a measure of fluid deformation. It is defined by how quickly one point of water along one streamline moves in comparison to another point on another streamline (\(v_A\) compared to \(v_B\), for example), taking into account the distance between the streamlines, \(\Delta h\). A visual example of a velocity gradient is shown in the image below:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{Velocity_gradient_image}.jpg}
\caption{Velocity gradients cause relative velocities of fluid elements. Those relative velocities form the basis of particle collisions that are essential for the flocculation process.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:id1}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:figure-velocity-gradient-image}}\end{figure}

\sphinxstylestrong{Note on terminology:} “Fluid deformation” is equivalent to “velocity gradient,” and the two terms can be used interchangeably. They are different ways of thinking about the same concept. Thus, \(G\) is the measure of both terms.

\(\varepsilon\), or energy dissipation rate, is the rate that the kinetic energy of the fluid is being converted to heat. EDR is a very useful concept because the last step of converting kinetic energy into heat is accomplished by viscosity (\(\nu\)). This kinetic energy being dissipated by viscosity is the energy associated with velocity gradients (\(G\)). Thus, through EDR there is a direct connection between \(\nu\) and \(G\). This connection will be further covered later on in this introduction.

As mentioned above, EDR and velocity gradients play an important role in mixing and in causing suspended particles to collide with each other, both of which are important topics in flocculation. Their use is not limited to flocculation, they are also helpful in understanding failure modes of plate settlers and terminal head loss of sand filters

We will begin by defining the concept of energy dissipation rate for a control volume. In a control volume that does not include pumps, turbines or other external energy sources or sinks, the mechanical energy lost is indicated by a change in elevation and quantified as \(g h_L\). That mechanical energy is lost in the time, \(\theta\), that the fluid is in the control volume.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:0}
\begin{split}\bar\varepsilon \theta = g h_L\end{split}
\end{equation}
This equation simply states that the average rate of energy dissipation times the time over which that dissipation occurs is equal to the total lost mechanical energy. The dimensions of \(\varepsilon\) are:
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:1}
\begin{split}\varepsilon = \frac{[m^3]}{[s^3]} = {\rm \frac{W}{kg}}\end{split}
\end{equation}
These dimensions can be understood as a velocity squared per time, otherwise known as a rate of kinetic energy loss (recall that kinetic energy is \({\rm Ke} = \frac{\bar v^2}{2g}\), or \({\rm Ke} \propto \bar v^2\)), or as power per unit mass, which would be \({\rm  \frac{W}{kg}}\).

Velocity gradients are central to flocculation because they cause the deformation of the fluid, and this results in particle collisions. Consider a real-world example via the image below: if everyone on a sidewalk is walking in the same direction at exactly the same velocity, then there will never be any collisions between people (top). If, however, people at one side of the sidewalk stand still and people walk progressively faster as a function of how far they are away from the zero velocity side of the sidewalk, then there will be many collisions between the pedestrians (see \hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:figure-pedestrians-on-sidewalk}]{Fig.\@ \ref{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:figure-pedestrians-on-sidewalk}}}). Indeed, the rate of collisions is proportional to the velocity gradient.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{Pedestrians_on_sidewalk}.jpg}
\caption{Pedestrians walking on a sidewalk serve as a model for velocity gradients.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:id2}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:figure-pedestrians-on-sidewalk}}\end{figure}


\section{Common Flow Geometries that Dissipate Energy}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:common-flow-geometries-that-dissipate-energy}}
Water treatment plants at research and municipal scales deploy a wide range of flow geometries. The following list includes the flow geometries that are commonly used for mixing processes.
\begin{itemize}
\item {} 
Straight pipe (wall shear) - {[}uncommon, but included for completeness{]}

\item {} 
Coiled tube (wall shear and expansions) - {[}research scale mixing{]}

\item {} 
Series of expansions (expansions) - {[}hydraulic flocculators{]}

\item {} 
Mechanical mixing - {[}mechanical rapid mix and flocculators{]}

\item {} 
Between flat plates (wall shear) - {[}plate settlers{]}

\item {} 
Round jet (expansion) - {[}hydraulic rapid mix{]}

\item {} 
Plane jet (expansion) - {[}inlet into sedimentation tank{]}

\item {} 
Behind a flat plate (expansion) - {[}mechanical mixers{]}

\end{itemize}

The following tables can serve as a convenient reference to the equations describing head loss, energy dissipation rates, and velocity gradients in various flow geometries that are commonly encountered in water treatment plants. The {\hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-equations-varying-flow-geometries}]{\sphinxcrossref{\DUrole{std,std-ref}{Equations for  and  in Varying Flow Geometries}}}} are available as a reference.


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Equations for control volume averaged values of head loss, energy dissipation rate, and the Camp-Stein velocity gradient.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:id3}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-control-volume-equations}}
\sphinxaftercaption
\begin{tabular}[t]{|*{5}{\X{1}{5}|}}
\hline
\sphinxstyletheadfamily 
Geometry
&
\(h_L\)
&\sphinxstyletheadfamily 
Energy dissipation rate
&
\(G_{CS}(bar v)\)
&
\(G_{CS}(Q)\)
\\
\hline
Straight pipe
&
\(h_{{\rm f}} = {{\rm f}} \frac{L}{D} \frac{\bar v^2}{2g}\)
&
\(\bar\varepsilon = \frac{{\rm f}}{2} \frac{\bar v^3}{D}\)
&
\(G_{CS} = \left(\frac{{\rm f}}{2\nu} \frac{\bar v^3}{D} \right)^\frac{1}{2}\)
&
\(G_{CS} = \left(\frac{\rm{32f}}{ \pi^3\nu} \frac{Q^3}{D^7} \right)^\frac{1}{2}\)
\\
\hline
Straight pipe laminar
&
\(h_{{\rm f}} = \frac{32\nu L\bar v}{ g D^2}\)
&
\(\bar\varepsilon =32\nu \left( \frac{\bar v}{D} \right)^2\)
&
\(G_{CS} =4\sqrt2 \frac{\bar v}{D}\)
&
\(G_{CS} =\frac{16\sqrt2}{\pi} \frac{Q}{D^3}\)
\\
\hline
Parallel plates laminar
&
\(h_{{\rm f}} = 12\frac{ \nu L \bar v }{gS^2}\)
&
\(\bar\varepsilon = 12 \nu \left(\frac{ \bar v}{S} \right)^2\)
&
\(G_{CS} = 2\sqrt{3}\frac{ \bar v}{S}\)
&\begin{itemize}
\item {} 
\end{itemize}
\\
\hline
Coiled tube laminar
&
\(h_{L_{coil}} = \frac{32\nu L\bar v}{ g D^2} \left[ 1 + 0.033\left(log_{10}De\right)^4 \right]\)
&
\(\bar\varepsilon = 32\nu \left( \frac{\bar v}{D} \right)^2 \left[ 1 + 0.033\left(log_{10}De\right)^4 \right]\)
&
\(G_{CS_{coil}} = 4\sqrt2 \frac{\bar v}{D}\left[ 1 + 0.033\left(log_{10}De\right)^4 \right]^\frac{1}{2}\)
&\begin{itemize}
\item {} 
\end{itemize}
\\
\hline
Porous media
&
\(h_f = f_{\phi} \frac{L}{D_{sand}} \frac{v_a^2}{2g} \frac{(1-\phi)}{\phi^3}\)
&
\(\bar\epsilon = \frac{f_{\phi}}{2} \frac{v_a^3}{D_{sand}} \frac{(1-\phi)}{\phi^4}\)
&
\(G_{CS} = \left(\frac{f_{\phi}}{2\nu} \frac{v_a^3}{D_{sand}} \frac{(1-\phi)}{\phi^4}\right)^{\frac{1}{2}}\)
&\begin{itemize}
\item {} 
\end{itemize}
\\
\hline
Expansions
&
\(h_e = K\frac{\bar v_{out}^2}{2g}\)
&
\(\bar\varepsilon = K\frac{\bar v_{out}^3}{2H}\)
&
\(G_{CS} = \bar v_{out}\sqrt{\frac{K\bar v_{out}}{2H\nu}}\)
&\begin{itemize}
\item {} 
\end{itemize}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

The equations used to convert between columns in the table above are:
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:2}
\begin{split}\bar\varepsilon = \frac{gh_{\rm{L}}}{\theta} \qquad\qquad
G_{CS} = \sqrt{\frac{\bar \varepsilon}{\nu}} \qquad\qquad
\bar v=\frac{4Q}{\pi D}\end{split}
\end{equation}
Note that the velocity gradient is independent of viscosity (and hence temperature) for laminar flow. This is because the total amount of fluid deformation is simply based on geometry. The no slip condition, the diameter, and the length of the flow passage set the total fluid deformation. Of course, if temperature decreases and viscosity increases the amount of energy required to push the fluid through the flow passage will increase (head loss is proportional to viscosity for laminar flow).

For turbulent flow and for flow expansions the amount of fluid deformation decreases as the viscosity increases and the total energy required to send the flow through the reactor is almost independent of the viscosity. The “almost” is because for wall shear under turbulent conditions there is a small effect of viscosity that is buried inside the friction factor.


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Equations for maximum (wall) energy dissipation rates and wall velocity gradients.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:id4}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-edr-g-max-equations}}
\sphinxaftercaption
\begin{tabular}[t]{|*{3}{\X{1}{3}|}}
\hline
\sphinxstyletheadfamily 
Geometry
&\sphinxstyletheadfamily 
Energy dissipation rate at the wall
&\sphinxstyletheadfamily 
Velocity gradient at the wall
\\
\hline
Straight pipe
&
\(\varepsilon_{wall} = \frac{1}{\nu}\left({\rm f}  \frac{\bar v^2}{8} \right)^2\)
&
\(G_{wall} ={\rm f}  \frac{\bar v^2}{8\nu}\)
\\
\hline
Straight pipe laminar
&
\(\varepsilon_{wall} = \left(\frac{8\bar v}{D} \right)^2 \nu\)
&
\(G_{wall} =  \frac{8\bar v}{D}\)
\\
\hline
parallel plates laminar
&
\(\varepsilon_{wall} = 36\left( \frac{\bar v}{S}\right)^2 \nu\)
&
\(G_{wall} = \frac{6 \bar v}{S}\)
\\
\hline
Coiled pipe laminar
&\begin{itemize}
\item {} 
\end{itemize}
&
\(G_{CS_{wall_{coil}}} ={\rm f} \left[ 1 + 0.033\left(log_{10}De\right)^4 \right]\frac{\bar v^2}{8\nu}\)
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Equations for maximum energy dissipation rates and velocity gradients for flow expansions.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:id5}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-edr-g-equations}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
Geometry
&
\(Pi_{Jet}\)
&\sphinxstyletheadfamily 
Maximum energy dissipation rate
&\sphinxstyletheadfamily 
Maximum velocity gradient
\\
\hline
Round jet
&
0.08
&
\(\varepsilon_{Max} = \Pi_{JetRound}\frac{   \bar v_{Jet} ^3}{D_{Jet}}\)
&
\(G_{Max} = \bar v_{Jet} \sqrt{\frac{\Pi_{JetRound} \bar v_{Jet} }{\nu D_{Jet}}}\)
\\
\hline
Plane jet
&
0.0124
&
\(\varepsilon_{Max} = \Pi_{JetPlane} \frac{  \bar v_{Jet} ^3}{S_{Jet}}\)
&
\(G_{Max} = \bar v_{Jet}\sqrt{\frac{\Pi_{JetPlane} \bar v_{Jet}}{\nu S_{Jet}}}\)
\\
\hline
Behind a flat plate
&
0.04
&
\(\varepsilon _{Max} = \Pi_{Plate}\frac{\bar v^3}{W_{Plate}}\)
&
\(G_{Max} = \bar v\sqrt{\frac{\Pi_{Plate} \bar v}{\nu W_{Plate}}}\)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

For mechanical mixing where an impeller or other stirring device is adding shaft work to a control volume we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:3}
\begin{split}\bar\varepsilon = \frac{P}{m} = \frac{P}{\rho \rlap{--}V}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] where
\item[] \(P\) = power input into the control volume
\item[] \(m\) = mass of fluid in the control volume
\item[] \(\rlap{--}V\) = volume of the control volume
\item[] \(\rho\) = density of the fluid
\end{DUlineblock}

The Camp-Stein velocity gradient for a mechanically mixed reactor is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:4}
\begin{split}G_{CS} = \sqrt{\frac{P}{\rho \nu \rlap{--}V}}\end{split}
\end{equation}

\chapter{Fluid Deformation and Energy Dissipation Derivations}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:fluid-deformation-and-energy-dissipation-derivations}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:title-fluid-deformation-and-energy-dissipation-derivations}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations::doc}}

\section{Equations for \protect\(\varepsilon\protect\) and \protect\(G\protect\) in Varying Flow Geometries}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:equations-for-and-in-varying-flow-geometries}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-equations-varying-flow-geometries}}
Estimation of velocity gradients for various flow geometries is the basis for the design of rapid mix, flocculators, and plate settlers. Thus, our goal is to define the velocity gradients consistently across a range of possible flow regimes. There are three approaches to calculating the average velocity gradient within a control volume. 1) Use the Navier Stokes equations and solve for the spatially averaged velocity gradient. 1) Use Computational Fluid Dynamics (CFD) to solve for the spatially averaged velocity gradient. 1) Use the total mechanical energy loss in the control volume to calculate the energy dissipation rate. Estimate the velocity gradient directly from the energy dissipation rate, \(G_{CS} = \sqrt{\frac{\bar\varepsilon}{\nu}}\), as defined by Camp and Stein in 1943 (Camp, T. R., and Stein, P. C. (1943) ‘‘Velocity Gradients and Hydraulic Work in Fluid Motion,’’ J. Boston Soc. Civil Eng., 30, 203\textendash{}221.).

The first approach would be ideal but is difficult in practice because Navier Stokes solutions are only available for limited geometries and laminar flow. CFD could be used but is difficult to use as a general engineering design approach given the large number of geometries that are used in drinking water treatment plants. For these reasons we will use the control volume approach to estimate the average velocity gradient. This method incorrectly assumes that the energy dissipation rate is completely uniform in the control volume and hence the velocity gradient is also uniform. This method results in an over estimation of the velocity gradient.
The Camp-Stein estimate of \(G_{CS}\) is based on a control volume where the velocity gradient is uniform. Consider a layer of fluid of depth \(H\) and apply a velocity, \(v\) at the top of the fluid. The velocity gradient, \(G\), is thus \(\frac{v}{H}\) everywhere in the fluid. The force required to move the top of the fluid at velocity v can be obtained from the required shear, \(\tau\). From Newtons Law of Friction we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:tau_of_mu_G}
\begin{split}\tau = \mu \frac{v}{H} = \mu G = \nu\rho G\end{split}
\end{equation}
Where \(\tau\) is the force required per unit plan view area. The power per unit area required to move the fluid at velocity \(v\) is \(\tau v\). The mass per unit area is \(\rho H\). Thus the energy dissipation rate or the power per mass is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:0}
\begin{split}\varepsilon = \frac{P}{m} = \frac{\tau v}{\rho H} = \frac{\nu \rho G v}{\rho H} = \nu G^2\end{split}
\end{equation}
This equation has no approximations, but has one very important assumption. We derived this equation for a control volume where the velocity gradient was \sphinxstylestrong{uniform}. The reactors and control volumes that we will be using as we design water treatment plants will \sphinxstylestrong{not} have uniform velocity gradients. Indeed, several of the water treatment processes will be turbulent and thus the velocity gradients in the fluid will vary in both space and time. Even in laminar flow in a pipe the velocity gradient is far from uniform with high velocity gradients at the wall and zero velocity gradient at the center of the pipe.

We’d like to know if we can apply the previous equation
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:1}
\begin{split}\varepsilon = \nu G^2\end{split}
\end{equation}
to the case where the energy dissipation rate and velocity gradients are nonuniform by simply introducing average values of both quantities.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:2}
\begin{split}\bar\varepsilon \overset{?}{=} \nu \bar G^2\end{split}
\end{equation}
We will test this option with a simple case. Consider a hypothetical reactor (case 2) that is 4 times as large in plan view area as the uniform velocity gradient case explored above (case 1). In addition, assume that 3/4 of the reactor has a velocity gradient of zero. The average energy dissipation rate for case 1 is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:3}
\begin{split}\bar \varepsilon_1 = \frac{P_1}{m_1} =  \nu \bar G_1^2\end{split}
\end{equation}
The average energy dissipation rate for case 2 is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:4}
\begin{split}\bar \varepsilon_2 = \frac{P_1}{4m_1} = \frac{\bar \varepsilon_1}{4}\end{split}
\end{equation}
This makes sense because we are putting in the same amount of energy into a control volume that is 4 times bigger.

Now we calculate the velocity gradients. As previously determined,
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:5}
\begin{split}\bar G_1 = \sqrt{\frac{\bar\varepsilon_1}{\nu}}\end{split}
\end{equation}
The average velocity gradient in the second control volume is simply the volume weighted average
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:6}
\begin{split}\bar G_2 = \bar G_1\frac{1}{4}+ 0 \frac{3}{4}\end{split}
\end{equation}
where 1/4 of the case 2 control volume has the same velocity gradient as the case 1 control volume and 3/4 of the control volume has a velocity gradient of 0. The Camp Stein method would suggest that \(\bar G_2\) is equal to
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:7}
\begin{split}\bar G_2 \overset{?}{=} \sqrt{\frac{\bar\varepsilon_2}{\nu}}= \sqrt{\frac{\bar\varepsilon_1}{4\nu}}\end{split}
\end{equation}
Now we check to see if the Camp Stein method of estimating the average velocity gradient, \(\bar G\), is correct.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:8}
\begin{split}\bar G_2 = \frac{\bar G_1}{4} \neq \sqrt{\frac{\bar\varepsilon_1}{4\nu}} =  \frac{\bar G_1}{2}\end{split}
\end{equation}
Given that the energy dissipation rate is proportional to the square of the velocity gradient the mean of the energy dissipation rate is \sphinxstylestrong{not} proportional to the mean of the velocity gradient. Thus the Camp Stein method of calculating the average velocity gradient is not correct except in the case of uniform velocity gradient. The Camp Stein equation is dimensionally correct and could be corrected by adding a dimensionless constant \(\Pi_{CS}\) that is a function of the energy dissipation rate distribution within the control volume.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:9}
\begin{split}\bar G =\Pi_{CS}\sqrt{\frac{\bar\varepsilon}{\nu}}\end{split}
\end{equation}
where \(\Pi_{CS}\) is 1 for a uniform velocity gradient and is less than one for non uniform velocity gradients. We can think \(\Pi_{CS}\) as a measure of the efficiency of using energy to deform the fluid. We can calculate \(\Pi_{CS}\) for cases where we have either a Navier Stokes or a computation fluid dynamics estimate of \(\bar G\).

The conventional approach to design of flocculators uses the Camp Stein definition of
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:G_Camp_Stein}
\begin{split}G_{CS} = \sqrt{\frac{\bar\varepsilon}{\nu}}\end{split}
\end{equation}
where \(G_{CS}\) is \sphinxstylestrong{not} the average velocity gradient, but is larger than the average velocity gradient by a factor of \(\Pi_{CS}\). Thus we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:10}
\begin{split}G_{CS} = \Pi_{CS}\bar G\end{split}
\end{equation}
Use of the Camp Stein velocity gradient in design of mixing units and flocculators results in an error when applying results from one reactor to another. If the energy dissipation rate distribution within the reactors is different, then \(\Pi_{CS}\) will be different for the two reactors and the actual average velocity gradient, \(\bar G\) will be different for the two reactors.

Given that energy is used more efficiently to produce velocity gradients if the velocity gradients are uniform, our goal is to design mixing and flocculation units that have relatively uniform velocity gradients. If all of our reactors at both research scale and municipal scale have similar values of \(\Pi_{CS}\), then we can use the Camp Stein definition of \(G_{CS}\) and not introduce any significant errors. It will not be reasonable, however, to expect similar performance based on similar values of \(G_{CS}\) if one reactor has relatively uniform energy dissipation rates and the other reactor has zones with very high energy dissipation rates and zones with very low energy dissipation rates.

We will demonstrate later that mechanically mixed reactors typically have a much wider range of energy dissipation rates than do well designed hydraulically mixed reactors. Thus comparisons between mechanically mixed and hydraulically mixed reactors must account for differences in \(\Pi_{CS}\).

We will use the Camp Stein definition \(G_{CS} = \sqrt{\frac{\bar\varepsilon}{\nu}}\) as the design parameter of convenience in this textbook.


\section{Estimates of time required for mixing processes}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:estimates-of-time-required-for-mixing-processes}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-estimates-of-time-required-for-mixing-processes}}

\subsection{Turbulent Large Scale Eddies}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:turbulent-large-scale-eddies}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-turbulent-large-scale-eddies}}
The first step in mixing is at the scale of the largest eddies. The largest eddies are limited in size by the smallest dimension normal to the direction of flow. Thus in a pipe the dimension of the largest eddies is set by the pipe diameter. In a open channel the dimension of the largest eddies is usually the water depth although it could be the width of the channel for the case of a narrow, deep channel.

Eddy turnover time, \(t_{eddy}\), is the time it takes for the eddy to travel a distance equal to its length-scale. Thus the eddy turnover time provides a good estimate of the time required for mixing to occur at the length scale of the eddy. We assume that the energy of the large eddy is dissipated into smaller length scales in the time \(t_{eddy}\):
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:11}
\begin{split}t_{eddy} \approx \frac{L_{eddy}}{v_{eddy}}\end{split}
\end{equation}
The rate of energy loss to smaller scales is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:12}
\begin{split}\bar\varepsilon \approx\frac{v_{eddy}^2}{t_{eddy}}\end{split}
\end{equation}
Combining the two equations
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:13}
\begin{split}\bar\varepsilon \approx\frac{v_{eddy}^3}{L_{eddy}}\end{split}
\end{equation}
We can use this equation to estimate the eddy velocity given an energy dissipation rate.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:14}
\begin{split}v_{eddy} \approx \left( \bar\varepsilon \, L_{eddy} \right)^\frac{1}{3}\end{split}
\end{equation}
Now we can solve for the eddy turnover time which is a measure of the mixing time at the eddy scale.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:15}
\begin{split}t_{eddy} \approx \frac{L_{eddy}}{\left( \bar\varepsilon \, L_{eddy} \right)^\frac{1}{3}} \approx \left( \frac{L_{eddy}^2}{ \bar\varepsilon }\right)^\frac{1}{3}\end{split}
\end{equation}
This provides a simple insight that the time required for an eddy to turn over scales with the size of the eddy raised to the 2/3 power. Thus large eddies take more time to turn over than do small eddies. Thus if we calculate the time required for large scale mixing using the dimension of the eddies, it will provide a reasonable estimate of the total time for mixing because mixing at all smaller scales requires much less time. A notable exception to this is the case of mixing in rivers. Rivers are usually shallow and wide. The largest eddies in a river are limited by the depth of the river. Mixing over the width of the river takes much longer than vertical mixing because multiple eddies are required to transport a substance from one side of the river to the other.

We can use the eddy velocity to estimate how long it will take for an eddy to cross the smallest dimension of flow. Eddy velocity is \(v_{eddy} \approx \left( \bar\varepsilon \, L_{eddy} \right)^\frac{1}{3}\).
The “\(\approx\)” indicates that this relationship is the same order of magnitude.

Chemical injection into the center of a pipe is common in drinking water treatment plants. We can develop equations to estimate the distance required for full mixing with the fluid in the pipe. In a pipe we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:16}
\begin{split}v_{eddy} \approx \left( \bar\varepsilon \, D \right)^\frac{1}{3}\end{split}
\end{equation}
For a long straight pipe
\(\bar\varepsilon = \frac{{\rm f}}{2} \frac{\bar v^3}{D}\) (Equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_EDR_straight_pipe}) and thus we can obtain the ratio between mean velocity and the velocity of the large scale eddies.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:17}
\begin{split}v_{eddy} \approx \left( \frac{{\rm f}}{2} \frac{\bar v^3}{D} \, D \right)^\frac{1}{3}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:18}
\begin{split}\frac{v_{eddy}}{\bar v} \approx \left( \frac{{\rm f}}{2}   \right)^\frac{1}{3}\end{split}
\end{equation}
Given a friction factor of 0.02, the eddy velocity is approximately 20\% of the mean velocity. We can use this ratio to estimate how many pipe diameters downstream from an injection point will the coagulant be mixed across the diameter of the pipe.
\begin{align}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:19}\!\begin{aligned}
:label: mixing_pipe_diameters\\
N_{D_{pipe}} \approx \frac{\bar v}{v_{eddy}} \approx \left(\frac{2}{{\rm f}} \right)^\frac{1}{3}\\
\end{aligned}\end{align}
Where \(N_{D_{pipe}}\) is the distance in number of pipe diameters downstream of the injection point where complete mixing will have occurred. This estimate is a minimum distance and a factor of safety of 2 or more would reasonably be applied. In addition it is best practice to inject the coagulant in the center of the pipe. Injecting the coagulant at the side of the pipe will require considerably greater distance downstream for mixing across the pipe.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mf}{0.02}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Inner Viscous Length Scale}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:inner-viscous-length-scale}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-inner-viscous-length-scale}}
The smallest scale at which inertia containing eddies causes mixing is set by the final damping of inertia by viscosity. Turbulence occurs when fluid inertia is too large to be damped by viscosity. The ratio of inertia to viscosity is given by the Reynolds number, \(\rm Re\):
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:20}
\begin{split}{\rm{Re}} = \frac{\bar vD}{\nu}\end{split}
\end{equation}
Flows with high Reynolds numbers are turbulent (inertia dominated) and with low Reynolds are laminar (viscosity dominated). The transition Reynolds number is a function of the flow geometry and the velocity and length scale that are used to characterize the flow. In all turbulent flows there is a length scale at which inertia finally loses to viscosity. The scale where viscosity wins is some multiple of the Kolmogorov length scale, which is defined as:
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:21}
\begin{split}\eta_K = \left( \frac{\nu^3}{\varepsilon} \right)^{\frac{1}{4}}\end{split}
\end{equation}
where \(\eta_K\) is the Kolmogorov length scale. At the Kolmogorov length scale viscosity completely dampens the inertia of the eddies and effectively “kills” the turbulence.

The length scale at which most of the kinetic energy contained in the small eddies is dissipated by viscosity is the inner viscous length scale, \(\lambda_v\), which according to Dimotakis (2000) is about \sphinxhref{https://doi.org/10.1017/S0022112099007946}{50 times larger than}
Thus we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_inner_viscous_length}
\begin{split}\lambda_\nu = \Pi_{K\nu}\left( \frac{\nu^3}{\varepsilon} \right)^{\frac{1}{4}}\end{split}
\end{equation}
where \(\Pi_{K\nu} = 50\)

At length scales larger than the inner viscous length scale, \(\lambda_v\), the dominant transport mechanism is by turbulent eddies. At length scales smaller than \(\lambda_v\) the dominant transport mechanism is fluid deformation due to shear. If the flow regime is completely laminar such as in a small diameter tube flocculator, then the dominant transport mechanism is fluid deformation due to shear at length scales all the way up to the diameter of the tubing.

The dividing line between eddy transport and fluid deformation controlled by viscosity can be calculated as a function of the energy dissipation rate using \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_inner_viscous_length}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} importing \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{utility} \PYG{k}{as} \PYG{n+nn}{ut}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{from} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{ticker} \PYG{k}{import} \PYG{n}{FormatStrFormatter}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{EDR\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{n}{num}\PYG{o}{=}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}
\PYG{n}{Temperature} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{k}{def} \PYG{n+nf}{Inner\PYGZus{}viscous}\PYG{p}{(}\PYG{n}{EDR}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{RATIO\PYGZus{}KOLMOGOROV} \PYG{o}{*} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{eta\PYGZus{}kolmogorov}\PYG{p}{(}\PYG{n}{EDR}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{EDR\PYGZus{}array}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}\PYG{p}{,}\PYG{n}{Inner\PYGZus{}viscous}\PYG{p}{(}\PYG{n}{EDR\PYGZus{}array}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{FormatStrFormatter}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{.f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{xaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{FormatStrFormatter}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{.f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Energy dissipation rate (W/kg)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Inner viscous length scale (mm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{30}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Eddies cause mixing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{n}{rotation}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{30}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Shear and diffusion cause mixing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{n}{rotation}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{30}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Inner\PYGZus{}viscous\PYGZus{}vs\PYGZus{}EDR}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Inner_viscous_vs_EDR}.png}
\caption{Eddies can cause fluid mixing down to the scale of a few millimeters for energy dissipation rates used in rapid mix units and flocculators.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id3}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-inner-viscous-vs-edr}}\end{figure}


\subsection{Turbulent Mixing Time as a Function of Scale}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:turbulent-mixing-time-as-a-function-of-scale}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-mixing-time-as-a-function-of-scale}}
We are searching for the rate limiting step in the mixing process as we transition from the scale of the flow down to the scale of the coagulant nanoparticles. We can estimate the time required for eddies to mix at their length scales by assuming that the eddies pass all of their energy to smaller scales in the time it takes for an eddy to travel the distance equal to the length scale of the eddy. This time is known as the \sphinxstylestrong{{}`eddy turnover time \textless{}http://ceeserver.cee.cornell.edu/eac20/cee637/handouts/TURBFLOW\_1.pdf\textgreater{}{}`\_\_},
\(t_{eddy}\). {\hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-estimates-of-time-required-for-mixing-processes}]{\sphinxcrossref{\DUrole{std,std-ref}{The derivation for the equation below is found here}}}}.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_t_eddy}
\begin{split}t_{eddy} \approx \left( \frac{L_{eddy}^2}{ \bar\varepsilon }\right)^\frac{1}{3}\end{split}
\end{equation}
We can plot the eddy turnover time as a function of scale from the inner viscous length scale up to the scale of the flow. We will discover whether large scale mixing by eddies is faster or slower than small scale mixing by eddies.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{utility} \PYG{k}{as} \PYG{n+nn}{ut}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}
\PYG{n}{EDR\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,}\PYG{l+m+mf}{0.1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{10} \PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{W}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Use the highest EDR to estimate the smallest length scale\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{Inner\PYGZus{}viscous\PYGZus{}graph} \PYG{o}{=} \PYG{n}{Inner\PYGZus{}viscous}\PYG{p}{(}\PYG{n}{EDR\PYGZus{}graph}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{)}
\PYG{n}{Inner\PYGZus{}viscous\PYGZus{}graph}
\PYG{n}{L\PYGZus{}flow} \PYG{o}{=} \PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{L\PYGZus{}scale} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{Inner\PYGZus{}viscous\PYGZus{}graph}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{L\PYGZus{}flow}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{)}
\PYG{n}{L\PYGZus{}scale}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{EDR\PYGZus{}graph}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{L\PYGZus{}scale}\PYG{p}{,}\PYG{p}{(}\PYG{p}{(}\PYG{n}{L\PYGZus{}scale}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{EDR\PYGZus{}graph}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{EDR\PYGZus{}graph}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}ax.yaxis.set\PYGZus{}major\PYGZus{}formatter(FormatStrFormatter(\PYGZsq{}\PYGZpc{}.f\PYGZsq{}))}
\PYG{c+c1}{\PYGZsh{}ax.xaxis.set\PYGZus{}major\PYGZus{}formatter(FormatStrFormatter(\PYGZsq{}\PYGZpc{}.f\PYGZsq{}))}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Length (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Eddy turnover time (s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Eddy\PYGZus{}turnover\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Eddy_turnover_time}.png}
\caption{Small eddies turn in less time than large eddies. This is why the mixing at the largest scale dominates the mixing time.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id4}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-eddy-turnover-time}}\end{figure}


\subsection{Shear-Diffusion Transport}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:shear-diffusion-transport}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-shear-diffusion-transport}}
After the first few seconds in which mixing occurs from the length scale of the flow down to the inner viscous length scale the next step in the transport process is blending of the coagulant uniformly with the raw water. At the end of the turbulent transport the coagulant stock has been stretched out into thin bands throughout the raw water, but the two fluids are not actually blended together by turbulence. The blending is accomplished by a combination of fluid deformation controlled by viscous shear and then by molecular diffusion.


\subsection{Fluid Deformation by Shear}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:fluid-deformation-by-shear}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-fluid-deformation-by-shear}}
The time scale for fluid deformation is \(1/G\) where \(G\) is the velocity gradient. This simple relationship is because the velocity of fluid deformation is proportional to the length scale and thus the time to travel any given distance in a linear velocity gradient is always the same. Velocity gradients in conventional mechanized rapid mix units are order 1000 Hz and thus the time for fluid deformation to blur concentration gradients is approximately 1 ms. This confirms the idea that blending the coagulant with the raw water is actually a very fast process with the slowest phase being the transport by turbulent eddies at the scale of reactor.

The full time required for fluid deformation to achieve blending down to the scale where molecular diffusion takes over is likely a multiple of 1/G where the multiple is determined by the number of different directions that the fluid must be sheared in to reach close to uniform blending. However, even multiplying 1/G by a factor of 10 still results in very rapid mixing.


\subsection{Einstein’s Diffusion Equation}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:einsteins-diffusion-equation}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-einstein-diffusion-equation}}
The final step of mixing is mediated by molecular diffusion. We can estimate the length scale at which fluid shear and diffusion provide transport at the same rate. Einstein’s diffusion equation is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:22}
\begin{split}D_{Diffusion} = \frac{k_B T}{3 \pi \mu d_P}\end{split}
\end{equation}
where \(k_B\) is the Boltzmann constant and \(d_P\) is the diameter of the particle that is diffusion in a fluid with viscosity \(\nu\) and density \(\rho\). The diffusion coefficient \(D_{Diffusion}\) has dimensions of \(\frac{[L^2]}{[T]}\) and can be understood as the velocity of the particle multiplied by the length of the mean free path. From dimensional analysis the time for diffusion to blur a concentration gradient over a length scale, \(L_{Diffusion}\) is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:23}
\begin{split}t_{Diffusion} \approx \frac{L_{Diffusion}^2}{D_{Diffusion}}\end{split}
\end{equation}
The shear time scale is \(1/G\) and thus we can solve for the length scale at which diffusion and shear have equivalent transport rates.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:24}
\begin{split}1/G \approx t_{Diffusion} \approx \frac{L_{Diffusion}^2}{D_{Diffusion}}\end{split}
\end{equation}
Substitute Einstein’s diffusion equation and solve for the length scale that transitions between shear and diffusion transport.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:25}
\begin{split}L_{Diffusion}^{Shear} \approx \sqrt{\frac{k_B T}{3 G \pi \mu  d_P}}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}
\PYG{k}{def} \PYG{n+nf}{L\PYGZus{}Shear\PYGZus{}Diffusion}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{,}\PYG{n}{d\PYGZus{}particle}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{boltzmann\PYGZus{}constant}\PYG{o}{*}\PYG{n}{Temperature}\PYG{o}{/}
  \PYG{p}{(}\PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{G} \PYG{o}{*}  \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}dynamic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*} \PYG{n}{d\PYGZus{}particle}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{G} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{5000}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}
\PYG{n}{d\PYGZus{}particle} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{o}{.}\PYG{n}{Diameter}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{Temperature}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{x} \PYG{o}{=} \PYG{p}{(}\PYG{n}{L\PYGZus{}Shear\PYGZus{}Diffusion}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{,}\PYG{n}{d\PYGZus{}particle}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{nm}\PYG{p}{)}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,}\PYG{n}{x}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Velocity gradient (Hz)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Length scale (nm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Shear\PYGZus{}diffusion\PYGZus{}length\PYGZus{}scale}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Shear_diffusion_length_scale}.png}
\caption{The length scale at which diffusion becomes the dominant transport mechanism for coagulant nanoparticles as a function of the velocity gradient. The time scale for the final diffusion to achieve blending of the nanoparticles with the water is simply 1/G.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id5}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-shear-diffusion-length-scale}}\end{figure}

Molecular diffusion finishes the blending process by transporting the coagulant nanoparticles the last few hundred nanometers. The entire mixing process from the coagulant injection point to uniform blending with the raw water takes only a few seconds.
\begin{description}
\item[{We have demonstrated that all of the steps for mixing of the coagulant nanoparticles with the raw water are very fast. Compared with the time required for flocculation, 10s to 1000s of seconds, the time required for this mixing (blending the nanoparticles uniformly with the water) is insignificant. The remaining steps are:}] \leavevmode
1. Molecular diffusion causes some dissolved species and Al nanoparticles to aggregate.
1. Fluid shear and molecular diffusion cause Al nanoparticles with attached formerly dissolved species to collide with inorganic particles (such as clay) and organic particles (such as viruses, bacteria, and protozoans).

\end{description}

The time scale for the fluid shear and molecular diffusion to cause coagulant nanoparticles to collide with particles is estimated in {\hyperref[\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-diffusion-and-shear-transport-coagulant-nanoparticles-to-clay}]{\sphinxcrossref{\DUrole{std,std-ref}{Diffusion and Shear Transport Coagulant Nanoparticles to Clay}}}}.

Below are the derivations for the equations that appear in \hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-control-volume-equations}]{Table \ref{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-control-volume-equations}}} containing equations for \(G\), \(\varepsilon\), and \(h_L\).


\subsection{Straight pipe (wall shear)}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:straight-pipe-wall-shear}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-straight-pipe-wall-shear}}
The average energy dissipation rate, \(\bar\varepsilon\), in a control volume with residence time \(\theta\) is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_EDR_straight_pipe}
\begin{split}\bar\varepsilon = \frac{gh_{\rm{L}}}{\theta}\end{split}
\end{equation}
The residence time can be expressed as a function of length and average velocity.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:26}
\begin{split}\theta = \frac{L}{\bar v}\end{split}
\end{equation}
For straight pipe flow the only head loss is due to wall shear and thus we have the Darcy Weisbach equation.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:27}
\begin{split}h_{{\rm f}} = {{\rm f}} \frac{L}{D} \frac{\bar v^2}{2g}\end{split}
\end{equation}
Combining the 3 previous equations we obtain the energy dissipation rate for pipe flow
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:28}
\begin{split}\bar\varepsilon = \frac{{\rm f}}{2} \frac{\bar v^3}{D}\end{split}
\end{equation}
The average velocity gradient was defined by Camp and Stein as
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:29}
\begin{split}G_{CS} = \sqrt{\frac{\bar \varepsilon}{\nu}}\end{split}
\end{equation}
where this approximation neglects the fact that square root of an average is not the same as the average of the square roots.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:30}
\begin{split}G_{CS} = \left(\frac{{\rm f}}{2\nu} \frac{\bar v^3}{D} \right)^\frac{1}{2}\end{split}
\end{equation}
or in terms of flow rate, we have:
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:31}
\begin{split}G_{CS} = \left(\frac{\rm{32f}}{ \pi^3\nu} \frac{Q^3}{D^7} \right)^\frac{1}{2}\end{split}
\end{equation}

\subsection{Straight Pipe Laminar}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:straight-pipe-laminar}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-straight-pipe-laminar}}
Laboratory scale apparatus is often limited to laminar flow where viscosity effects dominate. The equations describing laminar flow conditions always include viscosity. For the case of laminar flow in a straight pipe, we have:
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:32}
\begin{split}{\rm f} = \frac{64}{Re}\end{split}
\end{equation}
Reynolds number is defined as
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:33}
\begin{split}Re= \frac{\bar vD}{\nu}\end{split}
\end{equation}
The Darcy Weisbach head loss equation simplifies to the Hagen\textendash{}Poiseuille equation for the case of laminar flow.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:34}
\begin{split}h_{{\rm f}} = \frac{32\nu L\bar v}{gD^2}\end{split}
\end{equation}
and thus the energy dissipation rate in a straight pipe under conditions of laminar flow is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:35}
\begin{split}\bar\varepsilon =32\nu \left( \frac{\bar v}{D} \right)^2\end{split}
\end{equation}
The Camp-Stein velocity gradient in a long straight laminar flow tube is thus
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:36}
\begin{split}G_{CS}^2 =32 \left( \frac{\bar v}{D} \right)^2\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:37}
\begin{split}G_{CS} =4\sqrt2 \frac{\bar v}{D}\end{split}
\end{equation}
Our estimate of \(G_{CS}\) based on \(\bar \varepsilon\) is an overestimate because it assumes that the energy dissipation is completely uniform through the control volume. The true spatial average velocity gradient, \(\bar G\), for laminar flow in a pipe is (\sphinxhref{https://doi.org/10.1016/0009-2509(81)80126-1}{Gregory, 1981}),
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:38}
\begin{split}\bar G = \frac{8}{3}\frac{\bar v}{D}\end{split}
\end{equation}
Our estimate of \(G_{CS}\) for the case of laminar flow in a pipe is too high by a factor of \(\frac{3}{\sqrt2}\).

As a function of flow rate we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:39}
\begin{split}\bar v=\frac{Q}{A} = \frac{4Q}{\pi D^2}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:40}
\begin{split}G_{CS} =\frac{16\sqrt2}{\pi} \frac{Q}{D^3}\end{split}
\end{equation}

\subsection{Parallel Plates Laminar}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:parallel-plates-laminar}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-parallel-plates-laminar}}
Flow between parallel plates occurs in plate settlers in the sedimentation tank. We will derive the velocity gradient at the wall using the Navier Stokes equation.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{Parallel_Plate_schematic}.png}
\caption{A fluid flowing from left to right due to a pressure gradient results in wall shear on the parallel plates. This flow profile is for the case when the pressure gradient is negative.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id6}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-parallel-plate-schematic}}\end{figure}

We start with the Navier-Stokes equation written for flow in the x direction.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:41}
\begin{split}\frac{y^2}{2} \frac{dp}{dx} + Ay + B = \mu u\end{split}
\end{equation}
where \(u\) is the velocity in the x direction.

Apply the no slip condition at bottom plate.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:42}
\begin{split}u=0 \quad at \quad y=0\end{split}
\end{equation}
Thus the constant \(B=0\).

Apply the no slip condition at top plate.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:43}
\begin{split}u=0 \quad at \quad y=S\end{split}
\end{equation}
Thus the constant \(A = \frac{- S}{2} \frac{dp}{dx}\)

Substitute the values for constants \(A\) and \(B\) into the original equation.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:44}
\begin{split}\frac{y^2}{2} \frac{dp}{dx} - \frac{S}{2} \frac{dp}{dx} y = \mu \,u\end{split}
\end{equation}
Simply the equation to obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:45}
\begin{split}u = \frac{y \left( y - S \right)}{2 \mu} \frac{dp}{dx}\end{split}
\end{equation}
We need a relationship between average velocity and \(\frac{dp}{dx}\). We can obtain this by integrating from 0 to
\(S\).
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:46}
\begin{split}{\bar v } = \frac{q}{S}
= \frac{1}{S}\int\limits_0^S u dy
= \frac{1}{S} \int\limits_0^S
\left(
  \frac{y^2 - S y}{2 \mu} \left( \frac{dp}{dx} \right)
\right) dy\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:47}
\begin{split}\bar v = - \frac{S^2}{12 \mu} \frac{dp}{dx}\end{split}
\end{equation}
Solving for \(\frac{dp}{dx}\)
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:48}
\begin{split}\frac{dp}{dx} = - \frac{12 \mu \bar v}{S^2}\end{split}
\end{equation}
From the Navier Stokes equation after integrating once we get
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:49}
\begin{split}\mu \,\left( \frac{du}{dy} \right) = y \frac{dp}{dx} + A\end{split}
\end{equation}
Substituting our boundary condition,
\(A = \frac{- S}{2} \frac{dp}{dx}\) we obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:50}
\begin{split}\frac{du}{dy}_{y = 0} = - \frac{S}{2 \mu} \frac{dp}{dx}\end{split}
\end{equation}
Substituting the result for \(\frac{dp}{dx}\) we obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:51}
\begin{split}\frac{du}{dy}_{y = 0} = \frac{6 \bar v}{S}\end{split}
\end{equation}
Therefore in velocity gradient notation we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:52}
\begin{split}G_{wall} = \frac{6 \bar v}{S}\end{split}
\end{equation}
The energy dissipation rate at the wall
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:53}
\begin{split}\varepsilon_{wall} = G_{wall}^2 \nu\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:54}
\begin{split}\varepsilon_{wall} = \left( \frac{6 \bar v}{S}\right)^2 \nu\end{split}
\end{equation}
Head loss due to shear on the plates is obtained from a force balance on a control volume between two parallel plates as shown in \hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-parallel-plate-schematic}]{Fig.\@ \ref{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-parallel-plate-schematic}}}.

A force balance on a control volume gives
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:55}
\begin{split}2 \tau L W = -\Delta P W S\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:56}
\begin{split}\Delta P = -\frac{2 \tau L}{S}\end{split}
\end{equation}
The equation relating shear and velocity gradient is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:57}
\begin{split}\tau = \nu \rho \frac{du}{dy} = \nu \rho G\end{split}
\end{equation}
The velocity gradient at the wall is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:58}
\begin{split}G_{wall} = \frac{6 \bar v}{S}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:59}
\begin{split}\tau  = \nu \rho \frac{6 \bar v}{S}\end{split}
\end{equation}
Substituting into the force balance equation
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:60}
\begin{split}\Delta P = -\frac{2 \nu \rho 6 \bar v L}{S^2}\end{split}
\end{equation}
The head loss for horizontal flow at uniform velocity simplifies too
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:61}
\begin{split}h_{{\rm f}} = \frac{-\Delta P}{\rho g}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:62}
\begin{split}h_{{\rm f}} = 12\frac{ \nu \bar v L}{gS^2}\end{split}
\end{equation}
The average energy dissipation rate is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:63}
\begin{split}\bar\varepsilon = \frac{gh_{\rm{L}}}{\theta}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:64}
\begin{split}\bar\varepsilon = 12 \nu \left(\frac{  \bar v}{S} \right)^2\end{split}
\end{equation}
The Camp-Stein velocity gradient for laminar flow between parallel plates is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:65}
\begin{split}G_{CS} = 2\sqrt{3}\frac{  \bar v}{S}\end{split}
\end{equation}

\subsection{Coiled tubes (laminar flow)}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:coiled-tubes-laminar-flow}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-coiled-tubes-laminar-flow}}
Coiled tubes are used as flocculators at laboratory scale. The one shown below is a doubled coil. A single coil would only go around one cylinder

{}` \textless{}\sphinxurl{https://confluence.cornell.edu/display/AGUACLARA/Laminar+Tube+Floc?preview=/10422268/258146480/ReportLaminarTubeFlocSpring2014.pdf}\textgreater{}{}`\_\_

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=500\sphinxpxdimen]{{Coiled_tube_flocculator}.jpg}
\caption{The double coiled laminar flow flocculator creates secondary currents that oscillate in direction. This may be helpful in creating much more mixing than would occur in a straight laminar flow pipe.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id7}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-coiled-tube-flocculator}}\end{figure}

The ratio of the coiled to straight friction factors is given by \sphinxhref{https://doi.org/10.1021/i260069a017}{Mishra and Gupta}

The Dean number is defined as:
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:66}
\begin{split}De = Re\left(\frac{D}{D_c}\right)^\frac{1}{2}\end{split}
\end{equation}
where \(D\) is the inner diameter of the tube and \(D_c\) is the diameter of the coil. Note that the tubing coils are actually helixes and that for the tubing diameters and coil diameters used for flocculators that the helix doesn’t significantly change the radius of curvature.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:67}
\begin{split}\frac{{\rm f}_{coil}}{{\rm f}} = 1 + 0.033\left(log_{10}De\right)^4\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:68}
\begin{split}h_{L_{coil}} = h_{{\rm f}} \left[ 1 + 0.033\left(log_{10}De\right)^4 \right]\end{split}
\end{equation}
where \(h_{{\rm f}} = \frac{32\nu L\bar v}{ g D^2}\). Note that we switch from major losses to total head loss here because the head loss from flowing around the coil is no longer simply due to shear on the
wall.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:69}
\begin{split}h_{L_{coil}} = \frac{32\nu L\bar v}{ g D^2} \left[ 1 + 0.033\left(log_{10}De\right)^4 \right]\end{split}
\end{equation}
The average energy dissipation rate is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:70}
\begin{split}\bar\varepsilon = 32\nu \left( \frac{\bar v}{D} \right)^2 \left[ 1 + 0.033\left(log_{10}De\right)^4 \right]\end{split}
\end{equation}
The average velocity gradient is proportional to the square root of the head loss and thus we obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:71}
\begin{split}G_{CS_{coil}} = G_{CS}\left[ 1 + 0.033\left(log_{10}De\right)^4  \right]^\frac{1}{2}\end{split}
\end{equation}
where \(G_{CS} =4\sqrt2 \frac{\bar v}{D}\) for laminar flow in a straight pipe.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:72}
\begin{split}G_{CS_{coil}} = 4\sqrt2 \frac{\bar v}{D}\left[ 1 + 0.033\left(log_{10}De\right)^4  \right]^\frac{1}{2}\end{split}
\end{equation}

\subsection{Flow in porous media}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:flow-in-porous-media}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-flow-in-porous-media}}
The \sphinxhref{https://neutrium.net/fluid\_flow/pressure-drop-through-a-packed-bed/}{Ergun equation} applies to both laminar and turbulent flow through packed beds.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_Ergun}
\begin{split}h_f = \frac{L}{2g D_{sand}} \left( 300 \frac{\nu v_a (1-\phi)^2}{D_{sand} \phi^3} + 3.5 \frac{v_a^2 (1-\phi) }{\phi^3} \right)\end{split}
\end{equation}
The Ergun equation can be rewritten to be consistent with the format of the Darcy-Weisbach equation. To do this we add a factor of 2 to the definition of the Ergun friction factor and will divide by the factor of 2 in a subsequent equation. The modified Ergun friction factor is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_f_porous_media}
\begin{split}f_{\phi} = \frac{300}{Re_{\phi}} + 3.5\end{split}
\end{equation}
where the \(Re_{\phi}\) includes the porosity effect on the velocity and is given by
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_Re_porous_media}
\begin{split}Re_{\phi} = \frac{v_a D_{sand}}{\nu(1-\phi)}\end{split}
\end{equation}
I added a factor of two into the denominator to be consistent with the Darcy-Weisbach equation to obtain the modified Ergun equation.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_Ergun_of_f}
\begin{split}h_f = f_{\phi} \frac{L}{D_{sand}} \frac{v_a^2}{2g} \frac{(1-\phi)}{\phi^3}\end{split}
\end{equation}
The residence time in a porous media bed is given by
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:73}
\begin{split}\theta = \frac{L\phi} {v_a}\end{split}
\end{equation}
Now we can calculate the average energy dissipation rate in porous media.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:74}
\begin{split}\bar\varepsilon = \frac{g h_f}{\theta}\end{split}
\end{equation}
Substituting the equations for head loss and residence times we obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_EDR_CS_porous_media}
\begin{split}\bar\varepsilon = \frac{f_{\phi}}{2} \frac{v_a^3}{D_{sand}} \frac{(1-\phi)}{\phi^4}\end{split}
\end{equation}
The Camp Stein velocity gradient for flow in porous media is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_G_CS_porous_media}
\begin{split}G_{CS} = \left(\frac{f_{\phi}}{2\nu} \frac{v_a^3}{D_{sand}} \frac{(1-\phi)}{\phi^4}\right)^{\frac{1}{2}}\end{split}
\end{equation}

\subsection{Expansions}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:expansions}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-expansions}}
The average energy dissipation rate for a flow expansion really only has meaning if there is a defined control volume where the mechanical energy is lost. Hydraulic flocculators provide such a case because the same flow expansion is repeated and thus the mechanical energy loss can be assumed to happen in the volume associated with one flow expansion. In this case we have
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:75}
\begin{split}h_e =  K\frac{\bar v_{out}^2}{2g}\end{split}
\end{equation}
In this equation \(K\) represents the fraction of the kinetic energy that is dissipated.

If we define the length of the control volume (in the direction of flow) as \(H\) then the residence time is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:76}
\begin{split}\theta = \frac{H}{\bar v}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:77}
\begin{split}\bar\varepsilon = \frac{gh_{\rm{e}}}{\theta}\end{split}
\end{equation}
Combining the previous equations we obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:78}
\begin{split}\bar\varepsilon = K\frac{\bar v_{out}^3}{2H}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:79}
\begin{split}G_{CS} = \sqrt{\frac{\bar \varepsilon}{\nu}}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:80}
\begin{split}G_{CS} = \bar v_{out}\sqrt{\frac{K\bar v_{out}}{2H\nu}}\end{split}
\end{equation}

\section{Maximum velocity gradients}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:maximum-velocity-gradients}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-maximum-velocity-gradients}}

\subsection{Straight pipe (major losses)}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:straight-pipe-major-losses}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-straight-pipe-major-losses}}
The maximum velocity gradient in pipe flow occurs at the wall. This is true for both laminar and turbulent flow. In either case a force balance on a control volume of pipe gives us the wall shear and the wall shear can then be used to estimate the velocity gradient at the wall.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{pipe_pressure_shear_force_balance}.png}
\caption{A fluid flowing from left to right due to a pressure gradient results in wall shear.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id8}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-pipe-pressure-shear-force-balance}}\end{figure}

A force balance for the case of steady flow in a round pipe requires that sum of the forces in the x direction must equal zero. Given a pipe with diameter, D, and length, L, we obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:81}
\begin{split}\left(P_{in}- P_{out}\right)\frac{\pi D^2}{4} = \tau_{wall} \pi D L\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:82}
\begin{split}-\Delta P\frac{D}{4} = \tau_{wall} L\end{split}
\end{equation}
For this control volume the energy equation simplifies to
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:83}
\begin{split}-\Delta P=\rho g h_{{\rm f}}\end{split}
\end{equation}
The relationship between shear and velocity gradient is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:84}
\begin{split}\tau_{wall} = \mu \frac{du}{dy}_{wall} = \nu \rho G_{wall}\end{split}
\end{equation}
Combining the energy equation, the force balance, and the relationship between shear and velocity gradient we obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:85}
\begin{split}\rho g h_{{\rm f}}\frac{D}{4} = \nu \rho G_{wall} L\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:86}
\begin{split}G_{wall} = \frac{g h_{{\rm f}}D}{4\nu L}\end{split}
\end{equation}
This equation is valid for both laminar flow. For turbulent flow it is necessary to make the approximation that wall shear perpendicular to the direction of flow is insignificant in increasing the magnitude of the wall shear. We can substitute the Darcy Weisbach equation for head loss to obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:87}
\begin{split}G_{wall} ={\rm f}  \frac{\bar v^2}{8\nu}\end{split}
\end{equation}
The energy dissipation rate at the wall is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:88}
\begin{split}\varepsilon_{wall} = G_{wall}^2 \nu\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:89}
\begin{split}\varepsilon_{wall} = \frac{1}{\nu}\left({\rm f}  \frac{\bar v^2}{8} \right)^2\end{split}
\end{equation}
For laminar flow we can substitute \({\rm f} = \frac{64}{{\rm Re}}\) and the definition of the Reynolds number to obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:90}
\begin{split}G_{wall} =  \frac{8\bar v}{D}\end{split}
\end{equation}
This equation is useful for finding the velocity gradient at the wall of a tube settler.

The energy dissipation rate at the wall is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:91}
\begin{split}\varepsilon_{wall} = G_{wall}^2 \nu\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:92}
\begin{split}\varepsilon_{wall} = \left(\frac{8\bar v}{D} \right)^2 \nu\end{split}
\end{equation}

\subsection{Coiled tubes (laminar flow)}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-coiled-tubes-laminar-flow-1}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id1}}
The shear on the wall of a coiled tube is not uniform. The outside of the curve has a higher velocity gradient than the inside of the curve and there are secondary currents that results in wall shear that is not purely in the locally defined upstream direction. We do not have a precise equation for the wall shear. The best we can do currently is define an average wall shear in the locally defined direction of flow by combining
\(G_{{CS}_{wall_{coil}}} =\rm{f_{coil}} \frac{\bar v^2}{8\nu}\) and
\({\rm f}_{coil} = {\rm f} \left[ 1 + 0.033\left(log_{10}De\right)^4 \right]\)
to obtain
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:93}
\begin{split}G_{{CS}_{wall_{coil}}} ={\rm f} \left[ 1 + 0.033 \left(log_{10}De \right)^4 \right]  \frac{\bar v^2}{8\nu}\end{split}
\end{equation}

\subsection{Expansions}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-expansions-1}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id2}}
Flow expansions are used intentionally or unavoidable in multiple locations in hydraulically optimized water treatment plants. Rapid mix and hydraulic flocculation use flow expansions to generate fluid mixing and collisions between particles.


\subsection{Round Jet}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:round-jet}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-round-jet}}
\sphinxhref{https://doi.org/10.1016/0009-2509(95)00049-B}{Baldyga, et al. 1995}
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:94}
\begin{split}\varepsilon_{Centerline} = \frac{50 D_{Jet}^3 \bar v_{Jet}^3}{ \left( x - 2 D_{Jet} \right)^4}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:95}
\begin{split}\varepsilon_{Max} = \frac{\left( \frac{50}{\left( 5 \right)^4} \right) \bar v_{Jet}^3}{D_{Jet}}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:96}
\begin{split}\varepsilon_{Max} = \Pi_{JetRound} \frac{\bar v_{Jet} ^3}{D_{Jet}}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:97}
\begin{split}\Pi_{JetRound} = 0.08\end{split}
\end{equation}
The maximum velocity gradient in a jet is thus
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:98}
\begin{split}G_{Max} = \bar v_{Jet} \sqrt{\frac{\Pi_{JetRound} \bar v_{Jet} }{\nu D_{Jet}}}\end{split}
\end{equation}
Below we plot the Baldyga et al. equation for the energy dissipation rate as a function of distance from the discharge location for the case of a round jet that is discharging into a large tank.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Jet_centerline_EDR}.png}
\caption{The centerline energy dissipation rate downstream from a round jet. The distance downstream is measured in units of jet diameters. The energy dissipation rate between the jet and 7 jet diameters is developing as the shear between the stationary fluid and the jet propagates toward the center of the jet and turbulence is generated.}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id9}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-jet-centerline-edr}}\end{figure}


\subsection{Plane Jet}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:plane-jet}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-plane-jet}}
Plane jets occur in hydraulic flocculators and in the sedimentation tank inlet jet system. We haven’t been able to find a literature estimate of the maximum energy dissipation rate in a plane jet. Original measurements of a plane turbulent jet have been made by \sphinxhref{http://dx.doi.org/10.1115/1.3627309}{Heskestad in 1965} and it may be possible to use that data to get a better estimate of \(\Pi_{JetPlane}\) from that source.
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:99}
\begin{split}\Pi_{\bar \varepsilon}^{\varepsilon_{Max}} = \frac{\varepsilon_{Max}}{\bar \varepsilon}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:EDR_JetPlane}
\begin{split}\varepsilon_{Max} = \Pi_{JetPlane}  \frac{  \bar v_{Jet} ^3}{S_{Jet}}\end{split}
\end{equation}
The maximum velocity gradient is thus
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_G_JetPlane}
\begin{split}G_{Max} = \bar v_{Jet}\sqrt{\frac{\Pi_{JetPlane} \bar v_{Jet}}{\nu S_{Jet}}}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:100}
\begin{split}\bar v = \frac{Q}{SW}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:101}
\begin{split}\bar v_{Jet} = \frac{\bar v}{\Pi_{VCBaffle}}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:102}
\begin{split}S_{Jet} = S \Pi_{VCBaffle}\end{split}
\end{equation}
The average hydraulic residence time for the fluid between two baffles
is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:103}
\begin{split}\theta_B = \frac{H}{\bar v}\end{split}
\end{equation}
where \(H\) is the depth of water. Substituting into the equation for \(\varepsilon_{Max}\) to get the equation in terms of the average velocity \(\bar v\) and flow dimension \(S\)
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:104}
\begin{split}\varepsilon_{Max}= \frac{\Pi_{JetPlane}}{S \Pi_{VCBaffle}} \left( \frac{ \bar v}{\Pi_{VCBaffle}} \right)^3\end{split}
\end{equation}
From the control volume analysis the average energy dissipation rate is
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:105}
\begin{split}\bar \varepsilon = K \frac{\bar v^2}{2} \frac{1}{\theta_B} = \frac{K}{2} \frac{\bar v^3}{H_e}\end{split}
\end{equation}
where \(K\) is the minor loss coefficient for flow around the end of a baffle with a \(180^\circ\) turn.

Substitute the values for \(\bar \varepsilon\) and
\(\varepsilon_{Max}\) to obtain the ratio,
\(\Pi_{\bar \varepsilon}^{\varepsilon_{Max}}\)
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:106}
\begin{split}\Pi_{\bar \varepsilon}^{\varepsilon_{Max}} = \frac{\Pi_{JetPlane}}{\Pi_{VCBaffle}^4} \frac{2 H_e}{K S}\end{split}
\end{equation}
\(\Pi_{\bar \varepsilon}^{\varepsilon_{Max}}\) has a value of 2 for
\(H_e/S <5\) (CFD analysis and \sphinxhref{https://search-proquest-com.proxy.library.cornell.edu/docview/1943098053?accountid=10267}{Haarhoff, 2001})
The transition value for \(H_e/S\) is at 5 (from CFD analysis, our weakest assumption).

We also have that \(\Pi_{\bar \varepsilon}^{\varepsilon_{Max}}\) has a value of
\(\frac{\Pi_{JetPlane}}{\Pi_{VCBaffle}^4} \frac{2 H_e}{K S}\) for
\(H_e/S>5\). Thus we can solve for \(\Pi_{JetPlane}\) at
\(H_e/S=5\)
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:107}
\begin{split}\Pi_{JetPlane} = \left(
  \Pi_{\bar \varepsilon}^{\varepsilon_{Max}} \Pi_{VCBaffle}^4 \frac{K}{2} \frac{S}{H_e}
  \right)\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:108}
\begin{split}\Pi_{JetPlane} = 0.0124\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{constants} \PYG{k}{as} \PYG{n+nn}{con}
\PYG{n}{VC\PYGZus{}BAFFLE\PYGZus{}RATIO}\PYG{o}{=}\PYG{n}{con}\PYG{o}{.}\PYG{n}{VC\PYGZus{}ORIFICE\PYGZus{}RATIO}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
\PYG{n}{K\PYGZus{}MINOR\PYGZus{}FLOC\PYGZus{}BAFFLE} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{VC\PYGZus{}BAFFLE\PYGZus{}RATIO} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
\PYG{n}{Ratio\PYGZus{}Jet\PYGZus{}Plane} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{con}\PYG{o}{.}\PYG{n}{VC\PYGZus{}ORIFICE\PYGZus{}RATIO}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{8} \PYG{o}{*} \PYG{n}{K\PYGZus{}MINOR\PYGZus{}FLOC\PYGZus{}BAFFLE}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{5}
\PYG{n}{Ratio\PYGZus{}Jet\PYGZus{}Plane}

\PYG{n}{VC\PYGZus{}BAFFLE\PYGZus{}RATIO}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{K\PYGZus{}MINOR\PYGZus{}FLOC\PYGZus{}BAFFLE}\PYG{o}{/}\PYG{n}{Ratio\PYGZus{}Jet\PYGZus{}Plane}
\end{sphinxVerbatim}


\subsection{Behind a flat plate}
\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:behind-a-flat-plate}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-behind-a-flat-plate}}
A flat plate normal to the direction of flow could be used in a hydraulic flocculator. In vertical flow flocculators it would create a space where flocs can settle and thus it is not a recommended design.

The impellers used in mechanical flocculators could be modeled as a rotating flat plate. The energy dissipation rate in the wake behind the flat plate is often quite high in mechanical flocculators and this may be responsible for breaking previously formed flocs.

Ariane Walker-Horn modeled the flat plate using Fluent in 2015.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{CFD_Flat_Plate}.png}
\caption{The energy dissipation rate and streamlines for a 1 m wide plate in two dimensional flow with an approach velocity of \(1 m/s\). The maximum energy dissipation rate was approximately \(0.04 W/kg\).}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:id10}}\label{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:figure-cfd-flat-plate}}\end{figure}
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:109}
\begin{split}\varepsilon _{Max} = \Pi_{Plate}\frac{\bar v^3}{W_{Plate}}\end{split}
\end{equation}
The maximum velocity gradient is thus
\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:110}
\begin{split}G_{Max} = \bar v\sqrt{\frac{\Pi_{Plate} \bar v}{\nu W_{Plate}}}\end{split}
\end{equation}\begin{equation}\label{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:111}
\begin{split}\Pi_{Plate} = \frac{ \left( \varepsilon_{Max} W_{Plate} \right)}{\bar v^3}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}CFD analysis setup used by Ariane Walker\PYGZhy{}Horn in 2015\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{EDR\PYGZus{}Max} \PYG{o}{=} \PYG{l+m+mf}{0.04}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{W}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}
\PYG{n}{v} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{W} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{Ratio\PYGZus{}Jet\PYGZus{}Plate} \PYG{o}{=} \PYG{p}{(}\PYG{n}{EDR\PYGZus{}Max} \PYG{o}{*} \PYG{n}{W}\PYG{o}{/}\PYG{n}{v}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{Ratio\PYGZus{}Jet\PYGZus{}Plate}\PYG{p}{)}
\end{sphinxVerbatim}

The flat plate \(\Pi_{Plate}\) has a value of 0.04.


\chapter{Chemistry of Water Treatment Introduction}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:chemistry-of-water-treatment-introduction}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:title-chemistry-of-water-treatment-introduction}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro::doc}}

\section{Chemistry of Coagulant Nanoparticles}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:chemistry-of-coagulant-nanoparticles}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:heading-chemistry-of-coagulant-nanoparticles}}\begin{description}
\item[{Aluminum based coagulants are commonly used in drinking water treatment plants. Less frequently iron based coagulants are used. These metals precipitate in water at neutral pH as \(Al(OH)_3\) or \(Fe(OH)_3\). These precipitates form nanoparticles that are sticky. The origin of that stickiness is not well known, but one significant property of both precipitates is that they are both highly polar molecules. The \sphinxhref{https://en.wikipedia.org/wiki/Electronegativity}{difference in electronegativity} (Pauling scale) between}] \leavevmode\begin{itemize}
\item {} 
Aluminum (1.61) and Oxygen (3.44) is 1.83

\item {} 
Iron (1.83) and Oxygen (3.44) is 1.61

\item {} 
Hydrogen (2.20) and Oxygen (3.44) is 1.24

\end{itemize}

\end{description}

Thus both aluminum and iron coagulants are more polar than water. It is possible that their strong polarity enables them to displace the water that is bound to particles’ surfaces and then form bonds with those surfaces. In order to displace water molecules that are bound to the particles surfaces, the coagulants must have stronger bonds to particles surfaces than the polar water molecules and thus it seems likely that coagulants must be more polar than water.


\subsection{pH Effects of Adding Coagulant}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:ph-effects-of-adding-coagulant}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:heading-ph-effects-of-adding-coagulant}}
The coagulants used for drinking water treatment are acidic and thus result in a lowering of the pH of the treated water. The optimal pH for aluminum coagulant nanoparticle formation is between pH of 6.5 and 8.5. This is also the \sphinxhref{https://www.epa.gov/dwstandardsregulations/secondary-drinking-water-standards-guidance-nuisance-chemicals}{pH range set by the EPA secondary standards for drinking water}. Although many water sources are within this pH range, there are some waters with more extreme values of pH. The aluminum and iron based coagulants are also acidic and in some waters the pH may drop below the ideal range when adding the coagulant. When the pH is outside the acceptable range it is necessary to adjust the pH by adding either a base or an acid.

When aluminum sulfate (alum) is added to water it dissociates and then precipitates as \(Al(OH)_3\). In the process, protons (\(H^+\)) are released and thus the pH (\(-log[H^+]\)) decreases.
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Intro:Chemistry_of_Water_Treatment/Chemistry_Intro:0}
\begin{split}Al_2(SO_4)_3 (aq) + 6H_2O (l) \rightarrow 2Al(OH)_3 (s) + 6H^+ (aq) + 3SO_4^{-2} (aq)\end{split}
\end{equation}
The release of these protons reduces the acid neutralizing capacity, ANC, (also known as alkalinity) of the water. ANC is traditionally measured with units of mg/L of \(CaCO_3\) rather than eq/L.  \hyperref[\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:table-anc-consumed-by-alum}]{Table \ref{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:table-anc-consumed-by-alum}}} shows the relationship between ANC measured as mg/L of \(CaCO_3\) and alum (\(Al_2(SO_4)_3 \cdot 14H_2O\))


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Reduction in ANC caused by addition of alum.}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:id1}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:table-anc-consumed-by-alum}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily &\sphinxstyletheadfamily 
Alum
&\sphinxstyletheadfamily 
Calcium Carbonate
\\
\hline
Molecular Formula
&
\(Al_2(SO_4)_3 \cdot 14.3H_2O\)
&
\(CaCO_3\)
\\
\hline
Molecular mass
&
600 g/mole
&
100 g/mole
\\
\hline
eq/mole
&
6
&
2
\\
\hline
Molecular mass/eq
&
100 g/eq
&
50 g/eq
\\
\hline
Simple guide
&
1 mg/L alum consumes
&
0.5 mg/L calcium carbonate ANC
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

Low ANC waters (See section on {\hyperref[\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:heading-buffering-capacity-of-natural-waters}]{\sphinxcrossref{\DUrole{std,std-ref}{Buffering Capacity of Natural Waters}}}}.) could have their ANC increased by addition of a base. A simpler approach is often to use a different coagulant that is less acidic.

Polyaluminum chloride (PACl) is another aluminum based coagulant that performs similarly to alum. PACl is manufactured by slowly titrating an acidic solution containing dissolved aluminum with a base (in the chemical plant) to produce a meta-stable and soluble polymeric aluminum. PACl consumes less alkalinity (ANC) because it is partially neutralized by the titration with a base. In addition, the aluminum mass fraction of PACl is higher than in alum because there are no attached water molecules. The mass of PACl required for flocculation is less the mass of alum required. This is due largely to the higher aluminum fraction. The lower mass of PACl required is an economic benefit when shipping is a significant portion of the cost of the coagulant.

There are many different molecular formulas given for PACl. The molecular formulas are either from the perspective of the chemical supplier or represent the composition of the PACl nanoparticles. The molecular formula from the chemical supplier represents the extent of neutralization and hence the replacement of chloride with hydroxide. In that case the PACl molecular formula is:
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Intro:Chemistry_of_Water_Treatment/Chemistry_Intro:1}
\begin{split}[Al_n(OH)_mCl_{3n-m}]_x\end{split}
\end{equation}
The extent of the PACl titration with base is defined as basicity. Basicity is the ratio of hydroxyl equivalents to aluminum equivalents. Basicity of 1 would mean that the PACl does not produce any protons when it dissolves in water. Basicity of 0 means it produces 3 protons per Al (like alum). The equation for basicity is:
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Intro:Chemistry_of_Water_Treatment/Chemistry_Intro:2}
\begin{split}Basicity = \left( \frac{m}{3n}\right)\end{split}
\end{equation}
The lowest basicity commercial PACl formulations are about 10\%. Most PACls are in the medium to high basicity range (50-70\%). The highest stable basicity (83\%) is aluminum chlorohydrate (\(Al_2(OH)_5Cl\)) that is useful for treating water with very low ANC.

The ANC of the aluminum coagulant can be obtained from the number of protons it releases:
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Intro:Chemistry_of_Water_Treatment/Chemistry_Intro:3}
\begin{split}ANC_{Al} = 3(Basicity-1)[Al] = \left(\frac{m}{n} - 3\right)[Al] = \Pi_{Al}[Al]\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] where:
\item[] \(\Pi_{Al}=\left(\frac{m}{n} - 3\right)\) is ANC per mole of aluminum for the given coagulant
\end{DUlineblock}

Thus the ANC of alum (with 0 hydroxides) is \(-3[Al]\). The method of calculating the \(ANC_{Al}\) will be used to calculate the amount of base that must be added to achieve a target pH.

The molecular formula of the PACl nanoparticles is always some combination of Al, O, and H. One common molecular structure is a Keggin structure with 13 aluminum atoms. This molecule has a tetrahedral Al atom in the center of the cluster coordinated to 4 oxygen atoms. The molecular formula of the Keggin structured aluminum molecule is
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Intro:Chemistry_of_Water_Treatment/Chemistry_Intro:4}
\begin{split}AlO_4Al_{12}(OH)_{24}(H_2O)_{12}^{7+}\end{split}
\end{equation}
The attached water molecules are sometimes omitted. Coagulant nanoparticles are presumably created by aggregation of these Keggin structure molecules.


\subsection{Buffering Capacity of Natural Waters}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:buffering-capacity-of-natural-waters}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:heading-buffering-capacity-of-natural-waters}}
When acid is added to a water containing bicarbonate, \(HCO_3^-\), one of the potential reactions is for a proton to combine with \(HCO_3^-\) to form carbonic acid, \({H_2}CO_3\). If a base is added to water the reaction will proceed in the opposite direction. Carbonic acid, \({H_2}CO_3\), is indistinguishable from dissolved carbon dioxide, \(CO_{2_{aq}}\) and the total of carbonic acid and dissolved carbon dioxide is represented as \({H_2}CO_3^{\star}\). The reaction of bicarbonate to form carbonic acid removes one proton from solution and thus the concentration of protons doesn’t increase as fast as we might have first expected as acid is added to the water.

The reactions of carbonate species with protons provides pH buffering capacity that must be considered when calculating the effect of acid or base addition. Since carbonates are the dominant buffering agents in natural waters it is essential to account for their influence on pH.

The effect of acid or base addition to a water containing carbonates (or other weak acids and bases) can be modeled using the equation for {\hyperref[\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-acid-neutralizing-capacity-anc-or-alkalinity}]{\sphinxcrossref{\DUrole{std,std-ref}{Acid Neutralizing Capacity}}}}.


\subsection{pH Range for Precipitation of Coagulant Nanoparticles}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:ph-range-for-precipitation-of-coagulant-nanoparticles}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:heading-ph-range-for-precipitation-of-coagulant-nanoparticles}}
A critical property of coagulants is that in order to act as an adhesive between particles they must be solid phase at neutral pH. Both Al(III) and Fe(III) have low solubility at neutral pH and thus meet this requirement. The pH region of low solubility sets the range of pH where flocculation is effective. \hyperref[\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:figure-al-solubility}]{Fig.\@ \ref{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:figure-al-solubility}}} shows the solubilty of aluminum as a function of pH.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Al_solubility}.png}
\caption{Solubility of aluminum as a function of pH. Figure adapted from \sphinxhref{http://dx.doi.org/10.2166/aqua.2006.062}{Pernitsky and Edzwald}.}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:id2}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:figure-al-solubility}}\end{figure}

Research is needed to quantify flocculation performance in continuous flow floc/floc blanket/plate settler systems as a function of pH.

The aluminum concentration range used for flocculation ranges from approximately 0.4 - 10 mg/L and is strongly influenced by the concentration of dissolved organic matter and the concentration of suspended solids. The flocculation and floc blanket capacity to produce collisions between suspended particles also influences the required aluminum concentration.


\subsection{pH Adjustment in Water Treatment Plants}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:ph-adjustment-in-water-treatment-plants}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Intro:heading-ph-adjustment-in-water-treatment-plants}}
In drinking water treatment plant operation it is sometimes necessary to add a base (or acid) to increase (or decrease) the pH of the raw water. The added coagulant tends to reduce the pH. The carbonate system is most important in understanding how the base will adjust the pH because the reaction between carbonic acid and bicarbonate occurs around pH 6.3, the pK (negative log of the dissociation constant is the pH where that reaction is centered) for that reaction. Carbon dioxide exchange with the atmosphere is insignificant in drinking water treatment unit processes unless there is an aeration stage. Thus we can use the ANC equation for the case with no \(CO_2\) exchange with the atmosphere.

In the {\hyperref[\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-ph-adjustment}]{\sphinxcrossref{\DUrole{std,std-ref}{pH Adjustment}}}} section of the textbook, we evaluate the case where we add a base to the influent water. Doing so will increase the ANC of the raw water and it may also increase the total carbonate concentration. We then calculate how much of that base needs to be added to reach a given target pH.


\chapter{Chemistry of Water Treatment Derivations}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:chemistry-of-water-treatment-derivations}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:title-chemistry-of-water-treatment-derivations}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations::doc}}

\section{Carbonate reactions, buffering, and pH}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:carbonate-reactions-buffering-and-ph}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-carbonate-reactions-buffering-and-ph}}
Carbonates provide the majority of the buffering for drinking water as long as the pH is close to neutral. These equations provide a basis to calculate how much base or acid must be added to a natural water to achieve a target pH.


\subsection{Carbonic Acid and Bicarbonate}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:carbonic-acid-and-bicarbonate}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-carbonic-acid-and-bicarbonate}}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:carbonate}
\begin{split}{H_2}CO_3^{\star} \overset {K_1} \longleftrightarrow {H^+} + HCO_3^-\end{split}
\end{equation}\begin{description}
\item[{Where:}] \leavevmode
\begin{DUlineblock}{0em}
\item[] \(K_1\) is the dissociation constant defined below.
\end{DUlineblock}

\end{description}
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:0}
\begin{split}{K_1} = \frac{{\left[ {{H^ + }} \right]\left[ {HCO_3^ - } \right]}}{{\left[ {{H_2}CO_3^{\star} } \right]}}\end{split}
\end{equation}
Where the {[} {]} indicates concentration in mole/L. We will use the p function, \(p(x)=-log_{10}(x)\), to define the dissociation constant.
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:1}
\begin{split}p{K_1} = 6.3\end{split}
\end{equation}
At the point of equal concentrations of bicarbonate and carbonic acid the dissociation constant, \(K_1\), is equal to the hydrogen ion concentration, \(H^ +\). Thus we have equal concentrations at \(p{K_1} = pH\). This reaction is “centered” at pH = 6.3 and thus there is maximum buffering due to this reaction at pH = 6.3.


\subsection{Bicarbonate and Carbonate}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:bicarbonate-and-carbonate}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-bicarbonate-and-carbonate}}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:2}
\begin{split}HCO_3^ - \overset {{K_2}} \longleftrightarrow {H^ + } + CO_3^{ - 2}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:3}
\begin{split}{K_2} = \frac{{\left[ {{H^ + }} \right]\left[ {CO_3^{ - 2}} \right]}}{{\left[ {HCO_3^ - } \right]}}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:4}
\begin{split}p{K_2} = 10.3\end{split}
\end{equation}
Thus the carbonate system also provides buffering around pH 10.3.


\subsection{Total Concentration of Carbonates}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:total-concentration-of-carbonates}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-total-concentration-of-carbonates}}
The total concentration of carbonate species is given by
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:5}
\begin{split}{C_T} = \left[ {{H_2}CO_3^{\star} } \right] + \left[ {HCO_3^ - } \right] + \left[ {CO_3^{ - 2}} \right]\end{split}
\end{equation}
Where: \({C_T}\) is the total concentration of carbonates.

The total concentration of carbonates, \({C_T}\), is useful because it is conservative (in a closed system) even though the individual species concentrations change as pH changes.


\subsection{Alpha Notation}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:alpha-notation}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-alpha-notation}}
The alpha notation is used to show the concentration dependence on pH and to make the equations simpler.
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:6}
\begin{split}\left[ {{H_2}CO_3^{\star} } \right] = {\alpha_0}{C_T}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:7}
\begin{split}\left[ {HCO_3^-} \right] = {\alpha_1}{C_T}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:8}
\begin{split}\left[ {CO_3^{-2}} \right] = {\alpha_2}{C_T}\end{split}
\end{equation}
The alphas sum to 1 because each \(\alpha\) is the fraction of the carbonates corresponding to that species. The alphas are each a function of the proton concentration and the dissociation constants of the carbonate reactions.
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:9}
\begin{split}{\alpha_{\text{0}}} = \frac{1}{{1 + \frac{{{K_1}}}{{[{H^ + }]}} + \frac{{{K_1}{K_2}}}{{{{[{H^ + }]}^2}}}}}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:10}
\begin{split}{\alpha_{\text{0}}} = \frac{1}{{1 + \frac{{{K_1}}}{{[{H^ + }]}}\left( {1 + \frac{{{K_2}}}{{[{H^ + }]}}} \right)}}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:11}
\begin{split}{\alpha_{\text{1}}} = \frac{1}{{\frac{{[{{\rm H}^ + }]}}{{{{\rm K}_1}}} + 1 + \frac{{{{\rm K}_2}}}{{[{{\rm H}^ + }]}}}}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:12}
\begin{split}{\alpha_{\text{2}}} = \frac{1}{{\frac{{{{[{{\rm H}^ + }]}^2}}}{{{{\rm K}_1}{{\rm K}_2}}} + \frac{{[{{\rm H}^ + }]}}{{{{\rm K}_2}}} + 1}}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:13}
\begin{split}{\alpha_{\text{2}}} = \frac{1}{{1 + \frac{{[{{\rm H}^ + }]}}{{{{\rm K}_2}}}\left( {1 + \frac{{[{{\rm H}^ + }]}}{{{{\rm K}_1}}}} \right)}}\end{split}
\end{equation}

\subsection{Acid Neutralizing Capacity (ANC) or Alkalinity}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:acid-neutralizing-capacity-anc-or-alkalinity}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-acid-neutralizing-capacity-anc-or-alkalinity}}
Acid neutralizing capacity or alkalinity is the ability of a water sample to react with and neutralize an input of acid. The units of ANC are equivalents (or protons) per liter. Bicarbonate, \(HCO_3^-\), can react with one proton, \(H^+\), and thus each mole of \(HCO_3^-\) provides one equivalent per liter of ANC. The other terms in the equation have similar explanations.
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:14}
\begin{split}{\text{ANC}} = [HCO_3^ - {\text{] + 2[CO}}_3^{ - 2}{\text{] + [O}}{{\text{H}}^{\text{ - }}}{\text{] - [}}{{\text{H}}^{\text{ + }}}{\text{]}}\end{split}
\end{equation}
Note that carbonic acid and dissolved carbon dioxide are not in the ANC equation because they have no ability to neutralize protons.

We can write the ANC equation using alpha notation
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:15}
\begin{split}ANC = {C_T}({\alpha_1} + 2{\alpha_2}) + \frac{{{K_w}}}{{\left[ {{H^ + }} \right]}} - \left[ {{H^ + }} \right]\end{split}
\end{equation}
For completeness we include acid neutralizing capacity for the case where the system is in equilibrium with atmospheric carbon dioxide,
\(CO_2\).
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:16}
\begin{split}ANC_{atm\,equilibrium} = \frac{{{P{C{O_2}}}{K_H}}}{{{\alpha_0}}}({\alpha_1} + 2{\alpha_2}) + \frac{{{K_w}}}{{\left[ {{H^ + }} \right]}} - \left[ {{H^ + }} \right]\end{split}
\end{equation}

\subsection{pH Adjustment}
\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:ph-adjustment}}\label{\detokenize{Chemistry_of_Water_Treatment/Chemistry_Derivations:heading-ph-adjustment}}
The final ANC, \(ANC_1\), after base addition and aluminum coagulant addition is given by
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:17}
\begin{split}ANC_1 = ANC_0 + \Pi_{base}C_B + \Pi_{Al}C_{Al}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] where:
\item[] \(ANC_0\) is the initial acid neutralizing capacity of the water sample.
\item[] \(ANC_1\) is the final acid neutralizing capacity of the mixture after the base and aluminum coagulant is added.
\item[] \(C_B\) is concentration of base in mole/liter
\item[] \(\Pi_{base}\) is ANC per mole of base
\item[] \(C_{Al}\) is the concentration of coagulant in mole of aluminum/liter
\item[] \(\Pi_{Al}\) is ANC per mole of aluminum
\end{DUlineblock}

The final carbonate concentration is given by
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:18}
\begin{split}C_{T_1} ={C_{T_0}}+ \Pi_{CO_3^{-2}}C_B\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] where:
\item[] \(C_{T_1}\) is the final total carbonate concentration of the mixture after the base is added.
\item[] \(\Pi_{CO_3^{-2}}\) is mole of carbonate per mole of base (0 for \(NaOH\) and 1 for \(Na_2CO_3\))
\end{DUlineblock}

Substituting these values into the ANC equation we obtain
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:19}
\begin{split}ANC_0 + \Pi_{base}C_B + \Pi_{Al}C_{Al} = ({C_{T_0}}+ \Pi_{CO_3^{-2}}C_B)({\alpha_1} + 2{\alpha_2}) +  \frac{{{K_w}}}{{\left[ {{H^ + }} \right]}} - \left[ {{H^ + }} \right]\end{split}
\end{equation}
Now we solve for \(C_B\), the concentration of base that must be added to reach a target pH.
\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Chemistry_of_Water_Treatment/Chemistry_Derivations:20}
\begin{split}(\Pi_{base} -\Pi_{CO_3^{-2}}({\alpha_1} + 2{\alpha_2}) )C_B= {C_{T_0}}({\alpha_1} + 2{\alpha_2}) +  \frac{{{K_w}}}{{\left[ {{H^ + }} \right]}} - \left[ {{H^ + }} \right] - ANC_0 - \Pi_{Al}C_{Al}\end{split}
\end{equation}\begin{equation}\label{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Base_for_pH_Adjust}
\begin{split}C_B= \frac{{C_{T_0}}({\alpha_1} + 2{\alpha_2}) +  \frac{{{K_w}}}{{\left[ {{H^ + }} \right]}} - \left[ {{H^ + }} \right] - ANC_0 - \Pi_{Al}C_{Al}}{\Pi_{base} -\Pi_{CO_3^{-2}}({\alpha_1} + 2{\alpha_2})}\end{split}
\end{equation}
Note that the equations above can also be used for the case where acid is added to reduce the pH. In that case \(\Pi_{base}\) will have a negative value.

An example using this equation to find the required amount of base addition is given in {\hyperref[\detokenize{Rapid_Mix/RM_Examples:heading-example-ph-adjustment}]{\sphinxcrossref{\DUrole{std,std-ref}{Example: pH Adjustment}}}}.


\chapter{Rapid Mix Introduction}
\label{\detokenize{Rapid_Mix/RM_Intro:rapid-mix-introduction}}\label{\detokenize{Rapid_Mix/RM_Intro:title-rapid-mix-introduction}}\label{\detokenize{Rapid_Mix/RM_Intro::doc}}\begin{description}
\item[{This chapter is currently home for the prerequisites of successful flocculation. Those prerequisites include:}] \leavevmode\begin{itemize}
\item {} 
ensuring that the pH is in the correct range for coagulant nanoparticle formation after the coagulant has been added to the raw water.

\item {} 
increasing the coagulant dose to account for the coagulant interactions with dissolved species that effectively cover some of the coagulant nanoparticle surfaces.

\item {} 
increasing the coagulant dose to account for the available surface area of suspended particles to achieve

\item {} 
If there are multiple treatment trains, mixing the coagulant with the raw water so that parallel treatment trains receive the same concentration of coagulant (perhaps the conventional role of rapid mix)

\item {} 
transporting the coagulant nanoparticles to attach to suspended particles

\end{itemize}

\end{description}

Rapid mix is the term commonly used to describe the processes that occur between the coagulant addition to the raw water and the flocculation process. The processes that occur are not well understood and thus design guidelines have been empirical.

“In summary, little is known about rapid mix, much less any sensitivity to scale. However, the models and data reviewed suggest the need to be on the lookout for certain effects. From what is presently known, it can be speculated that since coagulant precipitation is sensitive to both micro- and macro-mixing, scale-up must consider not only energy dissipation rate, but also the reaction injection point and the contacting method.” - \sphinxhref{https://books.google.com/books/about/Mixing\_in\_coagulation\_and\_flocculation.html?id=dkFSAAAAMAAJ}{Mixing in Coagulation and Flocculation 1991 page 292}.

Although the processes have not been well characterized, the energy that is invested for rapid mix processes is significant. In many cases the amount of energy used isn’t practical for gravity powered water treatment plants. The high energy consumption of rapid mix units has led some municipal water treatment plant operators to experiment with turning off rapid mix units. They have found that at least under some conditions there is no indication that the energy used in rapid mix improved plant performance. Thus there is a need to understand the physical and chemical processes that occur when a concentrated liquid coagulant is added to water.

Rapid mix sets the stage for aggregation of both suspended particles and dissolved substances. Particle and dissolve substance aggregation is mediated by coagulant nanoparticles. The nanoparticles attach to raw water particles as well as to some dissolved species. After the nanoparticles have been mixed with the raw water and have attached to raw water particles the next process, flocculation, can begin.  {\hyperref[\detokenize{Flocculation/Floc_Intro:title-flocculation-introduction}]{\sphinxcrossref{\DUrole{std,std-ref}{Flocculation}}}} is the process of producing collisions between particles to create flocs (aggregates of particles).

Coagulant nanoparticle application includes multiple steps that must occur before the raw water particles can begin to aggregate. The sticky nanoparticles can be aluminum \((Al^{+3})\) or iron \((Fe^{+3})\) based and in either case the nanoparticles are formed from precipitated hydroxide species (\(Al(OH)_3\) or \(Fe(OH)_3\)). The series of events that are contained in the broad designation of “rapid mix” are:
\begin{enumerate}
\item {} 
Liquid coagulant stock solution with a low pH is injected into the raw water

\item {} 
Fluid Mixing: Turbulent eddies randomize the fluids (but don’t blend them)
\begin{enumerate}
\item {} 
Large scale eddies mix the coagulant with the raw water by creating large fluid deformations. This stretching and turning of the raw water and coagulant is analogous to shuffling a deck of cards. The cards are randomized, but the cards maintain their identity. The original liquids retain their chemical composition. This step must be completed before any flow splitting for parallel treatment trains.

\item {} 
Turbulent eddies disintegrate into smaller and smaller eddies.

\item {} 
At a very small scale (Inner viscous length scale) viscosity becomes significant and the kinetic energy of the eddies begins to be converted to heat by viscosity.

\end{enumerate}

\item {} 
The coagulant is blended with the raw water by molecular diffusion

\item {} 
The higher pH of the raw water causes the coagulant to begin to precipitate as \(Al_{12}AlO_4(OH)_{24}(H_2O)_{12}^{7+}\), an aluminum, Al, nanoparticle.

\item {} 
The precipitating \(Al_{13}\) molecules aggregates with other nearby \(Al_{13}\) molecules to form aluminum hydroxide nanoparticles. It is also possible that the nanoparticles are already formed in the coagulant stock suspension. Polyaluminum chloride stock solutions turn white in about a year at room temperature and this suggests that nanoparticles form in the stock solution.

\item {} 
The Al nanoparticles attach to other dissolved species and suspended particles.

\item {} 
Molecular diffusion causes some dissolved species and Al nanoparticles to aggregate.

\item {} 
Fluid shear and molecular diffusion cause Al nanoparticles with attached formerly dissolved species to collide with inorganic particles (such as clay) and organic particles (such as viruses, bacteria, and protozoans).

\end{enumerate}

These multiple steps cover a wide range of length scales and it is not clear at the onset which processes might be the rate limiting steps. We will develop time scale estimates for several of these steps to help identify which processes will likely require the most attention to design. Many of these transport processes are presumed to occur in parallel. \hyperref[\detokenize{Rapid_Mix/RM_Intro:figure-transport-length-scales}]{Fig.\@ \ref{\detokenize{Rapid_Mix/RM_Intro:figure-transport-length-scales}}} shows the range of length scales.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{rapid_mix_macro_to_nano_scale}.png}
\caption{Transport of coagulant nanoparticles occurs over length scales ranging from meter to a fraction of a nanometer.}\label{\detokenize{Rapid_Mix/RM_Intro:id2}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-transport-length-scales}}\end{figure}


\section{Fluid Mixing}
\label{\detokenize{Rapid_Mix/RM_Intro:fluid-mixing}}\label{\detokenize{Rapid_Mix/RM_Intro:id1}}
Fluid mixing is the process by which large scale eddies distribute packets of the coagulant stock throughout the raw water. The term “Rapid mix” is probably best used to describe this process. Traditional methods of achieving this fluid mixing include various methods of generating intense turbulence. Fluid mixing is able to rapidly blend the coagulant with the raw water in a matter of a few seconds. The equations describing the fluid mixing process are presented in the section on {\hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:heading-estimates-of-time-required-for-mixing-processes}]{\sphinxcrossref{\DUrole{std,std-ref}{Estimates of time required for mixing processes}}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=200\sphinxpxdimen]{{Backmix}.jpg}
\caption{Backmix: a mechanical rapid mixer that has a relatively long residence time in a completely mixed flow reactor.}\label{\detokenize{Rapid_Mix/RM_Intro:id3}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-backmix}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Inline}.jpg}
\caption{Inline: a mechanical rapid mixer that has a short residence time in a completely mixed flow reactor that is often built into a pipe.}\label{\detokenize{Rapid_Mix/RM_Intro:id4}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-inline}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=200\sphinxpxdimen]{{hydraulic_jump}.jpg}
\caption{Hydraulic jump: a hydraulic rapid mixer uses the flow expansion downstream from supercritical open channel flow.}\label{\detokenize{Rapid_Mix/RM_Intro:id5}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-hydraulic-jump}}\end{figure}

The hydraulic jump in \hyperref[\detokenize{Rapid_Mix/RM_Intro:figure-hydraulic-jump}]{Fig.\@ \ref{\detokenize{Rapid_Mix/RM_Intro:figure-hydraulic-jump}}} uses a flow expansion to generate mixing in an open channel and that suggests that a flow expansion could also be used to generate mixing in a closed conduit. AguaClara rapid mix units consist of an orifice in the bottom of the {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-lfom}]{\sphinxcrossref{\DUrole{std,std-ref}{Linear Flow Orifice Meter (LFOM)}}}} where the water enters the flocculator (see \hyperref[\detokenize{Rapid_Mix/RM_Intro:figure-rapid-mix-orifice}]{Fig.\@ \ref{\detokenize{Rapid_Mix/RM_Intro:figure-rapid-mix-orifice}}}). However, given that fluid mixing is so easy to attain it is unclear if the energy used in the rapid mix orifice is necessary.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Rapid_mix_orifice}.png}
\caption{The orifice creates a high velocity jet that generates mixing as it expands in the contact chamber prior to flocculation.}\label{\detokenize{Rapid_Mix/RM_Intro:id6}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-rapid-mix-orifice}}\end{figure}


\subsection{Conventional Mechanical Rapid Mix}
\label{\detokenize{Rapid_Mix/RM_Intro:conventional-mechanical-rapid-mix}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-conventional-mechanical-rapid-mix}}

\subsection{Maximum Velocity Gradients}
\label{\detokenize{Rapid_Mix/RM_Intro:maximum-velocity-gradients}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-conventional-maximum-velocity-gradients}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{ac}

\PYG{n}{Mix\PYGZus{}HRT} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{25}\PYG{p}{,}\PYG{l+m+mi}{35}\PYG{p}{,}\PYG{l+m+mi}{85}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Mix\PYGZus{}G} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{4000}\PYG{p}{,}\PYG{l+m+mi}{1500}\PYG{p}{,}\PYG{l+m+mi}{950}\PYG{p}{,}\PYG{l+m+mi}{850}\PYG{p}{,}\PYG{l+m+mi}{750}\PYG{p}{]}\PYG{p}{)}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Mix\PYGZus{}CP} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{multiply}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}HRT}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}G}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Mix\PYGZus{}Gt} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{multiply}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}HRT}\PYG{p}{,} \PYG{n}{Mix\PYGZus{}G}\PYG{p}{)}
\PYG{n}{Mix\PYGZus{}EDR} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Mix\PYGZus{}G}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}G}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{n}{Mix\PYGZus{}HRT}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{o}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{FormatStrFormatter}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{.f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{xaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{FormatStrFormatter}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZpc{}}\PYG{l+s+s1}{.f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Velocity gradient (Hz)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Residence time (s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mechanical\PYGZus{}RM\PYGZus{}Gt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Mechanical_RM_Gt}.png}
\caption{Mechanical rapid mix units use a wide range of velocity gradients and residence times.}\label{\detokenize{Rapid_Mix/RM_Intro:id7}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-mechanical-rm-gt}}\end{figure}

Conventional rapid mix units use mechanical or potential energy to generate intense turbulence to begin the mixing process. Conventional design is based on the use of \(\bar G\) (an average velocity gradient) as a design parameter. We don’t yet know what the design objective is for rapid mix and thus it isn’t clear which parameters matter. We hypothesize that both velocity gradients that cause deformation of the fluid and time for molecular diffusion are required to ultimately transport coagulant nanoparticles to the surfaces of clay particles.

The velocity gradient can be obtained from the rate at which mechanical energy is being dissipated and converted to heat by viscosity.
\begin{equation}\label{equation:Rapid_Mix/RM_Intro:Rapid_Mix/RM_Intro:0}
\begin{split}\varepsilon = G^2 \nu\end{split}
\end{equation}
where \(\varepsilon\) is the energy dissipation rate, \(G\) is the velocity gradient, and \(\nu\) is the kinematic viscosity of water. We can estimate the power input required to create a target energy dissipation rate for a conventional design by noting that power is simple the energy dissipation rate times the mass of water in the rapid mix unit.
\begin{equation}\label{equation:Rapid_Mix/RM_Intro:Rapid_Mix/RM_Intro:1}
\begin{split}P = \bar\varepsilon \rlap{--} V \rho\end{split}
\end{equation}\begin{equation}\label{equation:Rapid_Mix/RM_Intro:Rapid_Mix/RM_Intro:2}
\begin{split}P = \bar G^2 \nu \rlap{--} V \rho\end{split}
\end{equation}
We can relate reactor volume to a hydraulic residence time, \(\theta\), and volumetric flow rate, Q.
\begin{equation}\label{equation:Rapid_Mix/RM_Intro:Rapid_Mix/RM_Intro:3}
\begin{split}P = \rho \bar G^2 \nu Q \theta\end{split}
\end{equation}
This equation is perfectly useful for estimating electrical motor sizing requirements for mechanical rapid mix units. For gravity powered hydraulic rapid mix units it would be more intuitive to use the change in water surface elevation, \(\Delta h\) instead of power input.
\begin{equation}\label{equation:Rapid_Mix/RM_Intro:Rapid_Mix/RM_Intro:4}
\begin{split}P = \rho g Q \Delta h\end{split}
\end{equation}
Combining the two equations we obtain.
\begin{equation}\label{equation:Rapid_Mix/RM_Intro:Rapid_Mix/RM_Intro:5}
\begin{split}\Delta h =   \frac{G^2 \nu \theta}{g}\end{split}
\end{equation}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Typical values for conventional rapid mix residence time and average velocity gradients}\label{\detokenize{Rapid_Mix/RM_Intro:id8}}\label{\detokenize{Rapid_Mix/RM_Intro:table-conventional-rapid-mix-design-values}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
Residence Time (s)
&\sphinxstyletheadfamily 
Velocity gradient G (1/s)
&\sphinxstyletheadfamily 
Energy dissipation rate (W/kg)
&\sphinxstyletheadfamily 
Equivalent height (m)
\\
\hline
0.5
&
4000
&
16
&
0.8
\\
\hline
10 - 20
&
1500
&
2.25
&
2.3 - 4.6
\\
\hline
20 - 30
&
950
&
0.9
&
1.8 - 2.8
\\
\hline
30 - 40
&
850
&
0.72
&
2.2 - 2.9
\\
\hline
40 - 130
&
750
&
0.56
&
2.3 - 7.5
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

From Environmental Engineering: A Design Approach by Sincero and
Sincero. 1996. page 267.

Rotating propellers can either be installed in open tanks or enclosed in pipes. From a mixing and fluids perspective it doesn’t make any difference whether the tank is open to the atmosphere or not. The parameters of interest are the rate of fluid deformation and the residence time in the mixing zone.


\subsection{Mixing time}
\label{\detokenize{Rapid_Mix/RM_Intro:mixing-time}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-mixing-time}}
The time required for mixing in a turbulent environment is a function of the rate that kinetic energy is being dissipated as heat (the energy dissipation rate) and the length scale of the eddies. Given that turbulent energy is passed from large eddies to smaller and smaller eddies, the amount of energy that is being transferred at any given length scale is independent of scale. The result (see equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_t_eddy}) is that the time required for mixing is dominated by the time required for the largest eddies to turn over (\hyperref[\detokenize{Rapid_Mix/RM_Intro:figure-eddy-turnover-times}]{Fig.\@ \ref{\detokenize{Rapid_Mix/RM_Intro:figure-eddy-turnover-times}}}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Eddy_turnover_time1}.png}
\caption{Eddy turnover times as a function of length scale for a range of energy dissipation rates.}\label{\detokenize{Rapid_Mix/RM_Intro:id9}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-eddy-turnover-times}}\end{figure}

The eddy turnover times are longest for the largest eddies and this analysis suggests that it only takes a few seconds for turbulent eddies to mix from the scale of the flow down to the inner viscous length scale.

The large scale mixing time is critical for the design of water treatment plants for the case where the flow is split into multiple treatment trains after coagulant addition. In this case it is critical that the coagulant be mixed equally between all of the treatment trains and thus the mixing times shown in the previous graph represent a minimum time between where the coagulant is added and where the flow is divided into the parallel treatment trains.

It is possible that this process of mixing from the scale of the flow down to the inner viscous length scale is referred to as “rapid mix.” Here we showed that this mixing is indeed rapid and is really only a concern in the case where the coagulant injection point is very close to the location where the flow is split into multiple treatment trains.

The time required for mixing the coagulant nanoparticles with the fluid is typically only a few seconds, and will be accomplished whether or not the rapid mix unit is turned on. The turbulent eddies created either from the water flowing in the channel or from the water flowing through the pipe between the coagulant injection point and the flocculator will achieve the required fluid mixing in most cases. However, the step of the {\hyperref[\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-diffusion-and-shear-transport-coagulant-nanoparticles-to-clay}]{\sphinxcrossref{\DUrole{std,std-ref}{coagulant nanoparticles attaching to the suspended particles}}}} may be aided by the high energy of the rapid mix unit.


\section{Coagulant Nanoparticle Interactions}
\label{\detokenize{Rapid_Mix/RM_Intro:coagulant-nanoparticle-interactions}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-coagulant-nanoparticle-interactions}}
Coagulant nanoparticles are sticky and can attach to suspended particles as well as to each other. Some dissolved substances also adsorb to coagulant nanoparticles. The development of models to describe these interactions has been impeded by the widespread acceptance of the \sphinxhref{https://projects.ncsu.edu/project/hubbepaperchem/Defnitns/Neutrlzn.htm}{charge neutralization hypothesis} as the mechanism that governs these interactions. However, this hypothesis fails to account for the size of  coagulant nanoparticles and the various contaminants in the raw water influent. Instead, a simplified the model describing removal of these differently sized contaminants is proposed below; this simplified model posits that it is possible to separate fast and slow processes, which allows for a sequential model.

Interactions between the various suspended and dissolved substances (see \hyperref[\detokenize{Rapid_Mix/RM_Intro:figure-particle-sizes}]{Fig.\@ \ref{\detokenize{Rapid_Mix/RM_Intro:figure-particle-sizes}}}) can occur simultaneously as soon as the coagulant is blended with the raw water. The rates of these interactions are controlled by the transport processes of fluid deformation and molecular diffusion. Molecular diffusion is fastest for small particles and fluid deformation is most effective for larger particles. Thus the fastest process is hypothesized to be the diffusion of low mass molecules to the coagulant nanoparticles. Transport of the coagulant nanoparticles to attach to suspended solids is expected to be a slower process. Transport of suspended particles to collide with other suspended particles (flocculation) is even slower.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Particle_sizes}.png}
\caption{The size range of particles and nanoparticles that are important in drinking water treatment ranges from approximately a nanometer (for example arsenic \(HAsO_4^{2-}\)) to thousands of nanometers for clay and protozoa.}\label{\detokenize{Rapid_Mix/RM_Intro:id10}}\label{\detokenize{Rapid_Mix/RM_Intro:figure-particle-sizes}}\end{figure}


\subsection{Dissolved Organic Matter}
\label{\detokenize{Rapid_Mix/RM_Intro:dissolved-organic-matter}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-dissolved-organic-matter-and-coagulant}}
Dissolved organic matter (DOM) includes humic substances, fulvic acids, and other organic molecules. The distinction between dissolved and particulate organic matter is somewhat arbitrary and often 450 nm is used as the transition.  The dissolved organic matter could also be referred to as macromolecules or as nanoparticles.

Because of its small size the DOM has a large surface per unit mass. Water that contains high DOM concentrations requires much higher coagulant dosages to achieve effective flocculation. Removal of DOM is a high priority for drinking water treatment plants because DOM both interferes with disinfection processes and produces disinfection by products. A significant fraction of DOM can be removed by coagulant nanoparticles.


\subsection{Suspended Solids}
\label{\detokenize{Rapid_Mix/RM_Intro:suspended-solids}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-suspended-solids-and-coagulant}}
Suspended solids include both organic and inorganic particles. Organic particles of concern include virus, bacteria, and protozoa. Inorganic particles include clay and other minerals. Naturally occurring suspended solids tend to have negative surface charge at neutral pH. The negative surface charge effectively prevents particle aggregation and thus these particles can remain suspended for a very long time.


\subsection{Pathogens}
\label{\detokenize{Rapid_Mix/RM_Intro:pathogens}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-pathogens-and-coagulant}}
Virus particles readily attach to coagulant nanoparticles (see \sphinxhref{https://link-springer-com.proxy.library.cornell.edu/chapter/10.1007/978-3-642-76093-8\_5}{“Effects of Floc-Virus Association on Chlorine Disinfection Efficiency by Shinichiro Ohgaki and Prasang Mongkonsiri}) and this attachment makes it possible to efficiently remove virus particles by flocculation followed by sedimentation. Bacteria (cite Yolanda Brook paper when it is published) and protozoans (need reference) are also removed by flocculation by coagulant nanoparticles.


\subsection{Rate Estimates for Coagulant Nanoparticle Transport to Suspended Solids}
\label{\detokenize{Rapid_Mix/RM_Intro:rate-estimates-for-coagulant-nanoparticle-transport-to-suspended-solids}}\label{\detokenize{Rapid_Mix/RM_Intro:heading-rate-estimates-for-coagulant-nanoparticle-transport-to-suspended-solids}}
Coagulant nanoparticles require significant time to attach to the surfaces of suspended solids. The time required is estimated in {\hyperref[\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-diffusion-and-shear-transport-coagulant-nanoparticles-to-clay}]{\sphinxcrossref{\DUrole{std,std-ref}{Diffusion and Shear Transport Coagulant Nanoparticles to Clay}}}}. It is quite possible that this stage of the rapid mix/flocculation process has been overlooked in the past. Transport of the nanoparticles to the suspended solids is accomplished by a combination of fluid deformation and diffusion.


\chapter{Rapid Mix Design}
\label{\detokenize{Rapid_Mix/RM_Design:rapid-mix-design}}\label{\detokenize{Rapid_Mix/RM_Design:title-rapid-mix-design}}\label{\detokenize{Rapid_Mix/RM_Design::doc}}
As of 2018 the design for AguaClara rapid mix units has been based on the goal of achieving a target energy dissipation rate. This in turn was based on the assumption that it was important to rapidly mix the coagulant with the water, perhaps to minimize the self-aggregation of coagulant nanoparticles. We don’t yet have any experimental evidence that rapid mixing is important and it is quite likely that the energy dissipation rate found in the hydraulic flocculator is sufficient to provide the required mixing.

The design requirements for fluid mixing of the coagulant is an area that needs research. If the goal is to reduce the amount of self-aggregation of coagulant nanoparticles, then it is possible that an investment in energy to mix faster could be offset by a reduction in the chemical demand. This tradeoff needs a full economic and resource-use analysis. Regardless of the outcome of that analysis, it is essential that we evaluate options to reduce the energy input required to reduce the mixing time. One excellent option for reducing the energy required is to reduce the length scale of the largest eddies that are required for mixing.

The mixing time is dominated by the turnover time of the largest eddies. Given an energy dissipation rate (or a velocity gradient) the mixing time is reduced if the required length scale of the mixing is reduced.
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:0}
\begin{split}t_{eddy} \approx \left( \frac{L_{eddy}^2}{ \bar\varepsilon }\right)^\frac{1}{3}\end{split}
\end{equation}
We will design a rapid mix unit that has an array of injection ports and couple that with flow expansions that will generate eddies at that same length scale. The reason for creating flow contractions at the same length scale as the distance between injection ports is to immediately create eddies of the right size rather than creating much larger eddies and then waiting for the turbulence cascade of eddies sizes to create the smaller eddies. By creating eddies with dimensions similar to the injection port separation we will dissipate the energy as quickly as possible (at that smaller length scale) and thus decrease the mixing time.

We can use the center to center distance of the contractions (and injection ports) as the eddy length scale. This is because the eddies will need to mix over the length scale of the spacing of the injection ports.

The relationship between head loss and energy dissipation rate is based on conservation of energy with \(\theta\) representing the time required for most of the energy to be dissipated.
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:1}
\begin{split}g h_e = \theta \bar\varepsilon\end{split}
\end{equation}
We will assume that the time for the energy to dissipate, \(\theta\), is \(t_{eddy}\). Eliminate the unknown \(\bar\varepsilon\).
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:2}
\begin{split}t_{eddy} \approx \left( \frac{L_{eddy}^2 t_{eddy}}{ g h_e }\right)^\frac{1}{3}\end{split}
\end{equation}
where \(t_{eddy}\) is the mixing time and \(h_e\) is the head loss that will be used to obtain the mixing. Solve for \(L_{eddy}\) which is the spacing of the contractions and the spacing of the coagulant injection points.
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:3}
\begin{split}L_{eddy} \approx  t_{eddy} \sqrt{g h_e }\end{split}
\end{equation}
The raw water flow rate per injection port is equal to the water velocity upstream from the contractions in the channel or pipe multipled by the area of flow dedicated to one injection port.
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:4}
\begin{split}Q_mixing_zone = L_{eddy}^2 \bar v_{exp}\end{split}
\end{equation}
Substituting the previous equation for the eddy length scale, \(L_{eddy}\), we obtain
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:5}
\begin{split}Q_{mixer} = g h_e t_{eddy}^2 \bar v_{exp}\end{split}
\end{equation}
The flow rate that can be served with a single injection port is a function of how much energy we use for the mixing process.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{n\PYGZus{}points} \PYG{o}{=} \PYG{l+m+mi}{50}
\PYG{n}{h\PYGZus{}e\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{n\PYGZus{}points}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}

\PYG{n}{v\PYGZus{}channel} \PYG{o}{=} \PYG{l+m+mf}{0.45} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{k}{def} \PYG{n+nf}{Q\PYGZus{}per\PYGZus{}mixer}\PYG{p}{(}\PYG{n}{t\PYGZus{}eddy}\PYG{p}{)}\PYG{p}{:}
\PYG{k}{return} \PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{h\PYGZus{}e\PYGZus{}graph} \PYG{o}{*} \PYG{n}{t\PYGZus{}eddy}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{v\PYGZus{}channel}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{h\PYGZus{}e\PYGZus{}graph}\PYG{p}{,}\PYG{n}{Q\PYGZus{}per\PYGZus{}mixer}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{h\PYGZus{}e\PYGZus{}graph}\PYG{p}{,}\PYG{n}{Q\PYGZus{}per\PYGZus{}mixer}\PYG{p}{(}\PYG{l+m+mf}{0.3}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{h\PYGZus{}e\PYGZus{}graph}\PYG{p}{,}\PYG{n}{Q\PYGZus{}per\PYGZus{}mixer}\PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yscale}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{log}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Head loss (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flow rate (L/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{which}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{both}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1 s}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.3 s}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.1 s}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gca}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{yaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{ticker}\PYG{o}{.}\PYG{n}{ScalarFormatter}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{gca}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{xaxis}\PYG{o}{.}\PYG{n}{set\PYGZus{}major\PYGZus{}formatter}\PYG{p}{(}\PYG{n}{ticker}\PYG{o}{.}\PYG{n}{ScalarFormatter}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The flow rate per mixing zone increases rapidly as the mixing time allowed is increased and as the energy input is increased.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{Flow_per_mixing_zone}.png}
\caption{The flow per mixing zone increases with the amount of energy used. The amount of energy used can be decreased by a factor of 100 if multiple injection ports are used.}\label{\detokenize{Rapid_Mix/RM_Design:id1}}\label{\detokenize{Rapid_Mix/RM_Design:figure-flow-per-mixing-zone}}\end{figure}

The rapid mix unit will be created by placing round cylinders vertically in the inlet channel or pipe. The goal is to minimize the number of chemical injection points and thus to use as large a spacing of the cylinders, \(L_{eddy}\), as possible.

The dimensions of the opening between cylinders and the diameter of the cylinders can be obtained by analyzing the head loss through a flow expansion.
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:6}
\begin{split}h_e = \left(\frac{A_{exp}}{A_{con}} -1 \right)^2 \, \frac{\bar  v_{exp}^2}{2g}\end{split}
\end{equation}
where con = contracted control surface and exp = expanded control surface. We can solve the head loss equation for the dimensions of the contractions. First, solve for the area ratio
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:7}
\begin{split}\frac{A_{exp}}{A_{con}}=\frac{\sqrt{2gh_e}}{\bar  v_{exp}} + 1\end{split}
\end{equation}
Here the area ratio is also equal to the width ratio because the depth of flow is the other dimension. We assume here that the depth of flow is large compared with the head loss.
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:8}
\begin{split}\frac{A_{exp}}{A_{con}} = \frac{\bar v_{con}}{\bar v_{exp}}\end{split}
\end{equation}\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:9}
\begin{split}\frac{W_{con}}{W_{exp}} = \frac{A_{con}}{A_{exp}}\end{split}
\end{equation}
The width of the expanded flow, \(W_{exp}\), is equal to the large eddy length scale, \(L_{eddy}\).
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:10}
\begin{split}W_{con} = L_{eddy}\frac{A_{con}}{A_{exp}}\end{split}
\end{equation}
The diameter of the cylinders is equal to
\begin{equation}\label{equation:Rapid_Mix/RM_Design:Rapid_Mix/RM_Design:11}
\begin{split}D_{cylinder}=W_{exp} - W_{con}\end{split}
\end{equation}
Below is an example design for a rapid mix unit that uses 20 cm of head loss and achieves mixing in 0.3 seconds.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Head\PYGZus{}loss\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{t\PYGZus{}eddy} \PYG{o}{=} \PYG{l+m+mf}{0.3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{L\PYGZus{}eddy} \PYG{o}{=} \PYG{p}{(}\PYG{n}{t\PYGZus{}eddy} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{Head\PYGZus{}loss\PYGZus{}max}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The spacing between injection ports is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{L\PYGZus{}eddy}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{}expanded velocity}
\PYG{n}{v\PYGZus{}channel} \PYG{o}{=} \PYG{l+m+mf}{0.45} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Q\PYGZus{}per\PYGZus{}mixer} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}channel} \PYG{o}{*} \PYG{n}{L\PYGZus{}eddy}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow rate of raw water per chemical injection point is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Q\PYGZus{}per\PYGZus{}mixer}\PYG{p}{)}

\PYG{n}{Q}\PYG{o}{=}\PYG{l+m+mi}{20000}\PYG{o}{/}\PYG{l+m+mi}{7} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s} \PYG{c+c1}{\PYGZsh{}Fairmont design}
\PYG{n}{A\PYGZus{}channel} \PYG{o}{=} \PYG{n}{Q}\PYG{o}{/}\PYG{n}{v\PYGZus{}channel}
\PYG{n}{n\PYGZus{}ports} \PYG{o}{=} \PYG{p}{(}\PYG{n}{A\PYGZus{}channel}\PYG{o}{/}\PYG{n}{L\PYGZus{}eddy}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of injection ports is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{n\PYGZus{}ports}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}

\PYG{n}{Pi\PYGZus{}A} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity}\PYG{o}{*}\PYG{n}{Head\PYGZus{}loss\PYGZus{}max}\PYG{p}{)}\PYG{o}{/}\PYG{n}{v\PYGZus{}channel} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The expansion ratio is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}A}\PYG{p}{)}
\PYG{n}{v\PYGZus{}jet} \PYG{o}{=} \PYG{n}{v\PYGZus{}channel} \PYG{o}{*} \PYG{n}{Pi\PYGZus{}A}
\PYG{n}{w\PYGZus{}contraction} \PYG{o}{=} \PYG{n}{L\PYGZus{}eddy}\PYG{o}{/}\PYG{n}{Pi\PYGZus{}A}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The width of the contractions is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{w\PYGZus{}contraction}\PYG{p}{)}

\PYG{n}{D\PYGZus{}cyl} \PYG{o}{=} \PYG{n}{L\PYGZus{}eddy} \PYG{o}{\PYGZhy{}} \PYG{n}{w\PYGZus{}contraction}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The diameter of the cylinder is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{D\PYGZus{}cyl}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
The spacing between injection ports is 0.4201 meter

\item {} 
The flow rate of raw water per chemical injection point is 79.43 liter / second

\item {} 
The number of injection ports is 36.0

\item {} 
The expansion ratio is 5.401 dimensionless

\item {} 
The width of the contractions is 0.07779 meter

\item {} 
The diameter of the cylinder is 0.3424 meter

\end{itemize}


\chapter{Rapid Mix Derivations}
\label{\detokenize{Rapid_Mix/RM_Derivations:rapid-mix-derivations}}\label{\detokenize{Rapid_Mix/RM_Derivations:title-rapid-mix-derivations}}\label{\detokenize{Rapid_Mix/RM_Derivations::doc}}
This will be the eventual home for derivations for conventional wisdom on rapid mix
(in progress)


\chapter{Rapid Mix Appendix C: Examples}
\label{\detokenize{Rapid_Mix/RM_Examples:rapid-mix-appendix-c-examples}}\label{\detokenize{Rapid_Mix/RM_Examples:title-rapid-mix-examples}}\label{\detokenize{Rapid_Mix/RM_Examples::doc}}

\section{Example: pH Adjustment}
\label{\detokenize{Rapid_Mix/RM_Examples:example-ph-adjustment}}\label{\detokenize{Rapid_Mix/RM_Examples:heading-example-ph-adjustment}}
Find the required dose of several bases to raise the pH at the Manzaragua Water Treatment Plant. The Mazaragua AguaClara plant consists of two 1 L/s plants operating in parallel. The plant is located in the municipality of Guinope, the department of El Paraiso, Honduras.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{Manzaragua_WTP}.jpg}
\caption{Manzaragua water treatment plant using two of the AguaClara 1 L/s plants in parallel.}\label{\detokenize{Rapid_Mix/RM_Examples:id1}}\label{\detokenize{Rapid_Mix/RM_Examples:figure-manzaragua-wtp}}\end{figure}

The plant performed very poorly from the first day of operation. The first attempted fix was to double the flocculator residence time by increasing the number of flocculator pipes (3 inch diameter by 1.5 m long) from 12 to 24. This improved performance, but the plant continued to perform poorly. A raw water sample was analyzed on May 30, 2018 and the following results were obtained.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{Manzaragua_Water_Analysis}.jpg}
\caption{Water quality analysis for Manzaragua.}\label{\detokenize{Rapid_Mix/RM_Examples:id2}}\label{\detokenize{Rapid_Mix/RM_Examples:figure-manzaragua-water-analysis}}\end{figure}


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Manzaragua water quality analysis}\label{\detokenize{Rapid_Mix/RM_Examples:id3}}\label{\detokenize{Rapid_Mix/RM_Examples:table-manzaragua-water-quality-analysis}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{80}|\X{20}{80}|\X{20}{80}|\X{20}{80}|}
\hline
\sphinxstyletheadfamily 
Parameter
&\sphinxstyletheadfamily 
Units
&\sphinxstyletheadfamily 
Standard
&\sphinxstyletheadfamily 
Results
\\
\hline
Turbidity
&
NTU
&
5
&
71
\\
\hline
Color
&
color units
&
15
&
150
\\
\hline
pH
&
pH
&
6.5 - 8.5
&
5.91
\\
\hline
Conductivity
&
\(\mu s/cm\)
&
400
&
69.15
\\
\hline
Alkalinity
&
\(mg/L\) as \(CaCO_3\)
&\begin{itemize}
\item {} 
\end{itemize}
&
24.5
\\
\hline
Bicarbonates
&
\(mg/L\) as \(CaCO_3\)
&\begin{itemize}
\item {} 
\end{itemize}
&
24.5
\\
\hline
Carbonates
&
\(mg/L\) as \(CaCO_3\)
&\begin{itemize}
\item {} 
\end{itemize}
&
0
\\
\hline
Hardness
&
\(mg/L\) as \(CaCO_3\)
&
400
&
15.68
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

This water has high color which suggests a high concentration of dissolved organic matter. The pH is a clear problem because the pH is too low for the coagulant nanoparticles to precipitate. As the water sample pH of 5.91 a significant fraction of the coagulant will remain soluble.

Our goal is to determine how much base will need to be added to raise the pH. We do not have data on the \sphinxstyleemphasis{optimal} pH for treating high color water with PACl and so we will use pH 7 as the target.

At circumneutral pH (pH close to 7) the buffering capacity of the water is dominated by carbonate chemistry and specifically by the equilibrium between \({H_2}CO_3^{\star}\) and \(HCO_3^-\) . We will use the acid neutralizing capacity (reported as calcium carbonate alkalinity) and the pH from the sample analysis to estimate the total concentration of carbonates. We will not use the sample analysis carbonate concentrations because they can not be precisely correct.

We will find the amount of base that must be added using \eqref{equation:Chemistry_of_Water_Treatment/Chemistry_Derivations:Base_for_pH_Adjust}.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{ANC and carbonate values for several bases and acids}\label{\detokenize{Rapid_Mix/RM_Examples:id4}}\label{\detokenize{Rapid_Mix/RM_Examples:table-anc-and-carbonate-values-for-several-bases-and-acids}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{60}|\X{20}{60}|\X{20}{60}|}
\hline
\sphinxstyletheadfamily 
Base/Acid
&
\(Pi_{ANC}\)
&
\(Pi_{CO_3^{-2}}\)
\\
\hline
\(Na_2CO_3\) or \(CaCO_3\)
&
2
&
1
\\
\hline
\(NaHCO_3\)
&
1
&
1
\\
\hline
\(NaOH\)
&
1
&
0
\\
\hline
\(HCl\) or \(HNO_3\)
&
-1
&
0
\\
\hline
\(H_2SO_4\)
&
-2
&
0
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

For \(Na_2CO_3\) * \(\Pi_{ANC}\) = 2 because we are adding
\(CO_3^{-2}\) which is multiplied by two in the ANC equation because
\(CO_3^{-2}\) can react with two protons. * \(\Pi_{CO_3^{-2}}\)
= 1 because there is one mole of \(CO_3\) per mole of
\(Na_2CO_3\)

Below is the code used to calculate the required base addition.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{environmental\PYGZus{}processes\PYGZus{}analysis} \PYG{k}{as} \PYG{n+nn}{epa}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}define molecular weights\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{m\PYGZus{}Ca} \PYG{o}{=} \PYG{l+m+mf}{40.078}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mol}
\PYG{n}{m\PYGZus{}C} \PYG{o}{=} \PYG{l+m+mf}{12.011}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mol}
\PYG{n}{m\PYGZus{}O} \PYG{o}{=} \PYG{l+m+mf}{15.999}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mol}
\PYG{n}{m\PYGZus{}Na} \PYG{o}{=} \PYG{l+m+mf}{22.99}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mol}
\PYG{n}{m\PYGZus{}H} \PYG{o}{=} \PYG{l+m+mf}{1.008}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mol}
\PYG{n}{m\PYGZus{}CaCO3} \PYG{o}{=} \PYG{n}{m\PYGZus{}Ca}\PYG{o}{+}\PYG{n}{m\PYGZus{}C}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{m\PYGZus{}O}
\PYG{n}{m\PYGZus{}Na2CO3} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{m\PYGZus{}Na}\PYG{o}{+}\PYG{n}{m\PYGZus{}C}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{m\PYGZus{}O}
\PYG{n}{m\PYGZus{}NaHCO3} \PYG{o}{=} \PYG{n}{m\PYGZus{}Na}\PYG{o}{+}\PYG{n}{m\PYGZus{}H}\PYG{o}{+}\PYG{n}{m\PYGZus{}C}\PYG{o}{+}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{m\PYGZus{}O}
\PYG{n}{m\PYGZus{}NaOH} \PYG{o}{=} \PYG{n}{m\PYGZus{}Na}\PYG{o}{+}\PYG{n}{m\PYGZus{}O}\PYG{o}{+}\PYG{n}{m\PYGZus{}H}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Raw water characteristics\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{pH\PYGZus{}0} \PYG{o}{=} \PYG{l+m+mf}{5.91}
\PYG{n}{ANC\PYGZus{}0} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{24.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{m\PYGZus{}CaCO3}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mmol}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}
\PYG{n}{ANC\PYGZus{}0}

\PYG{k}{def} \PYG{n+nf}{total\PYGZus{}carbonates\PYGZus{}closed}\PYG{p}{(}\PYG{n}{pH}\PYG{p}{,} \PYG{n}{ANC}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}This function calculates total carbonates for a closed system given pH and ANC}

\PYG{l+s+sd}{    Parameters}
\PYG{l+s+sd}{    \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{l+s+sd}{    pH : float}
\PYG{l+s+sd}{        pH of the sample}
\PYG{l+s+sd}{    ANC: float}
\PYG{l+s+sd}{        acid neutralizing capacity of the sample}
\PYG{l+s+sd}{    Returns}
\PYG{l+s+sd}{    \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{l+s+sd}{    The total carbonates of the sample}
\PYG{l+s+sd}{    Examples}
\PYG{l+s+sd}{    \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{l+s+sd}{    \PYGZgt{}\PYGZgt{}\PYGZgt{} total\PYGZus{}carbonates\PYGZus{}closed(1*u.mmol/u.L,8)}
\PYG{l+s+sd}{    1.017 mole/liter}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{ANC} \PYG{o}{\PYGZhy{}} \PYG{n}{epa}\PYG{o}{.}\PYG{n}{Kw}\PYG{o}{/}\PYG{n}{epa}\PYG{o}{.}\PYG{n}{invpH}\PYG{p}{(}\PYG{n}{pH}\PYG{p}{)} \PYG{o}{+} \PYG{n}{epa}\PYG{o}{.}\PYG{n}{invpH}\PYG{p}{(}\PYG{n}{pH}\PYG{p}{)}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{epa}\PYG{o}{.}\PYG{n}{alpha1\PYGZus{}carbonate}\PYG{p}{(}\PYG{n}{pH}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{epa}\PYG{o}{.}\PYG{n}{alpha2\PYGZus{}carbonate}\PYG{p}{(}\PYG{n}{pH}\PYG{p}{)}\PYG{p}{)}


\PYG{n}{CT\PYGZus{}0} \PYG{o}{=} \PYG{n}{total\PYGZus{}carbonates\PYGZus{}closed}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{)}


\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} calculate the amount of base that must be added to reach a target pH\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k}{def} \PYG{n+nf}{pH\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}base}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}CO3}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}Al}\PYG{p}{,}\PYG{n}{C\PYGZus{}Al}\PYG{p}{,}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)}\PYG{p}{:}
  \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}This function calculates the required base (or acid) to adjust the pH to a target value. The buffering capacity is assumed to be completely due to carbonate species. The initial carbonate concentration is calculated based on the initial pH and the initial ANC.}

\PYG{l+s+sd}{  Parameters}
\PYG{l+s+sd}{  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{l+s+sd}{  pH\PYGZus{}0: float}
\PYG{l+s+sd}{      pH of the sample}
\PYG{l+s+sd}{  ANC\PYGZus{}0: float}
\PYG{l+s+sd}{      acid neutralizing capacity (Alkalinity) of the sample in eq/L.}
\PYG{l+s+sd}{  Pi\PYGZus{}base: float}
\PYG{l+s+sd}{    equivalents of ANC per mole of base (or acid)}
\PYG{l+s+sd}{  Pi\PYGZus{}CO3: float}
\PYG{l+s+sd}{    mole of carbonate per mole of base (or acid)}
\PYG{l+s+sd}{  Pi\PYGZus{}Al : float}
\PYG{l+s+sd}{    equivalents of ANC per mole of aluminum coagulant}
\PYG{l+s+sd}{  C\PYGZus{}Al}
\PYG{l+s+sd}{    concentration of aluminum coagulant in moles/L}
\PYG{l+s+sd}{  pH\PYGZus{}target: float}
\PYG{l+s+sd}{    pH goal}
\PYG{l+s+sd}{  Returns}
\PYG{l+s+sd}{  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{l+s+sd}{  The required concentration of base (or acid) in millimoles/L}
\PYG{l+s+sd}{  Examples}
\PYG{l+s+sd}{  \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{l+s+sd}{  \PYGZgt{}\PYGZgt{}\PYGZgt{} pH\PYGZus{}adjust(5.91,0.2*u.mmol/u.L,1,1,0,0,7)}
\PYG{l+s+sd}{  2.2892822041250924 millimole/liter}
\PYG{l+s+sd}{  \PYGZgt{}\PYGZgt{}\PYGZgt{} pH\PYGZus{}adjust(7,0.2*u.mmol/u.L,1,1,0,0,0,0,7)}
\PYG{l+s+sd}{  0.0 millimole/liter}
\PYG{l+s+sd}{  \PYGZgt{}\PYGZgt{}\PYGZgt{} pH\PYGZus{}adjust(7,0*u.mmol/u.L,1,0,\PYGZhy{}3,1*u.mmol/u.L,7)}
\PYG{l+s+sd}{  3.0 millimole/liter}
\PYG{l+s+sd}{  \PYGZdq{}\PYGZdq{}\PYGZdq{}}
  \PYG{n}{CT\PYGZus{}0} \PYG{o}{=} \PYG{n}{total\PYGZus{}carbonates\PYGZus{}closed}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{)}
  \PYG{n}{B\PYGZus{}num} \PYG{o}{=} \PYG{n}{CT\PYGZus{}0} \PYG{o}{*} \PYG{p}{(}\PYG{n}{epa}\PYG{o}{.}\PYG{n}{alpha1\PYGZus{}carbonate}\PYG{p}{(}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{epa}\PYG{o}{.}\PYG{n}{alpha2\PYGZus{}carbonate}\PYG{p}{(}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{epa}\PYG{o}{.}\PYG{n}{Kw}\PYG{o}{/}\PYG{n}{epa}\PYG{o}{.}\PYG{n}{invpH}\PYG{p}{(}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{epa}\PYG{o}{.}\PYG{n}{invpH}\PYG{p}{(}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{ANC\PYGZus{}0} \PYG{o}{\PYGZhy{}} \PYG{n}{Pi\PYGZus{}Al}\PYG{o}{*}\PYG{n}{C\PYGZus{}Al}
  \PYG{n}{B\PYGZus{}den} \PYG{o}{=} \PYG{n}{Pi\PYGZus{}base} \PYG{o}{\PYGZhy{}} \PYG{n}{Pi\PYGZus{}CO3}\PYG{o}{*}\PYG{p}{(}\PYG{n}{epa}\PYG{o}{.}\PYG{n}{alpha1\PYGZus{}carbonate}\PYG{p}{(}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{epa}\PYG{o}{.}\PYG{n}{alpha2\PYGZus{}carbonate}\PYG{p}{(}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)}\PYG{p}{)}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{B\PYGZus{}num}\PYG{o}{/}\PYG{n}{B\PYGZus{}den}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mmol}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}


\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}target pH\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{pH\PYGZus{}target} \PYG{o}{=} \PYG{l+m+mi}{7}

\PYG{n}{Pi\PYGZus{}base\PYGZus{}Na2CO3} \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}Na2CO3} \PYG{o}{=} \PYG{l+m+mi}{1}

\PYG{n}{Pi\PYGZus{}base\PYGZus{}NaHCO3} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}NaHCO3} \PYG{o}{=} \PYG{l+m+mi}{1}

\PYG{n}{Pi\PYGZus{}base\PYGZus{}NaOH} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}NaOH} \PYG{o}{=} \PYG{l+m+mi}{0}

\PYG{n}{C\PYGZus{}Na2CO3} \PYG{o}{=} \PYG{n}{pH\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}base\PYGZus{}Na2CO3}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}Na2CO3}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)}

\PYG{n}{C\PYGZus{}NaHCO3} \PYG{o}{=} \PYG{n}{pH\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}base\PYGZus{}NaHCO3}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}NaHCO3}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)}
\PYG{n}{C\PYGZus{}NaOH} \PYG{o}{=} \PYG{n}{pH\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}base\PYGZus{}NaOH}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}NaOH}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{pH\PYGZus{}target}\PYG{p}{)}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Display results in a pandas table\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{base} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NaOH}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NaHCO3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Na2CO3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{myindex} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{[mmoles/L]}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{[mg/L]}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{row1} \PYG{o}{=} \PYG{p}{[}\PYG{n}{C\PYGZus{}Na2CO3}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{n}{C\PYGZus{}NaHCO3}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{n}{C\PYGZus{}NaOH}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{]}
\PYG{n}{row2} \PYG{o}{=} \PYG{p}{[}\PYG{p}{(}\PYG{n}{C\PYGZus{}Na2CO3}\PYG{o}{*}\PYG{n}{m\PYGZus{}Na2CO3}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{p}{(}\PYG{n}{C\PYGZus{}NaHCO3}\PYG{o}{*}\PYG{n}{m\PYGZus{}NaHCO3}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{p}{(}\PYG{n}{C\PYGZus{}NaOH}\PYG{o}{*}\PYG{n}{m\PYGZus{}NaOH}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{]}
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{[}\PYG{n}{row1}\PYG{p}{,}\PYG{n}{row2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{index}\PYG{o}{=}\PYG{n}{myindex}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{base}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Graph the base concentration required as a function of the target pH\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{pH\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{)}
\PYG{n}{C\PYGZus{}Na2CO3} \PYG{o}{=} \PYG{n}{pH\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}base\PYGZus{}Na2CO3}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}Na2CO3}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{)}
\PYG{n}{C\PYGZus{}NaHCO3} \PYG{o}{=} \PYG{n}{pH\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}base\PYGZus{}NaHCO3}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}NaHCO3}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{)}
\PYG{n}{C\PYGZus{}NaOH} \PYG{o}{=} \PYG{n}{pH\PYGZus{}adjust}\PYG{p}{(}\PYG{n}{pH\PYGZus{}0}\PYG{p}{,}\PYG{n}{ANC\PYGZus{}0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}base\PYGZus{}NaOH}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}CO3\PYGZus{}NaOH}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{,}\PYG{n}{C\PYGZus{}NaHCO3}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{,}\PYG{n}{C\PYGZus{}Na2CO3}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{,}\PYG{n}{C\PYGZus{}NaOH}\PYG{p}{)}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pH target}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Base concentration (mmole/L)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sodium bicarbonate}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sodium carbonate}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sodium hydroxide}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mole\PYGZus{}base\PYGZus{}for\PYGZus{}target\PYGZus{}pH}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{,}\PYG{p}{(}\PYG{n}{C\PYGZus{}Na2CO3}\PYG{o}{*}\PYG{n}{m\PYGZus{}Na2CO3}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{pH\PYGZus{}graph}\PYG{p}{,}\PYG{p}{(}\PYG{n}{C\PYGZus{}NaOH}\PYG{o}{*}\PYG{n}{m\PYGZus{}NaOH}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pH target}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Base concentration (mg/L)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sodium carbonate}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{sodium hydroxide}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mg\PYGZus{}base\PYGZus{}for\PYGZus{}target\PYGZus{}pH}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

The analysis reveals that the choice of base matters. The most efficient (on a mass or mole basis) base is \(NaOH\) because it doesn’t add any carbonates that don’t fully react with the hydrogen ions. The decision about which base to use will be influenced by economics, operator safety, and by whether additional carbonate buffering simplifies plant operation with changing raw water quality.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Calcium base.}\label{\detokenize{Rapid_Mix/RM_Examples:id5}}\label{\detokenize{Rapid_Mix/RM_Examples:table-calcium-bases}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{60}|\X{20}{60}|\X{20}{60}|}
\hline
\sphinxstyletheadfamily 
Chemical name
&\sphinxstyletheadfamily 
common name
&\sphinxstyletheadfamily 
Chemcal formula
\\
\hline
calcium carbonate
&
limestone or chalk
&
\(CaCO_3\)
\\
\hline
calcium hydroxide
&
slaked lime or hydrated lime
&
\(Ca(OH)_2\)
\\
\hline
calcium oxide
&
quicklime
&
\(CaO\)
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

The calcium bases are relatively inexpensive and have the disadvantage of lower solubility than sodium bases. Calcium carbonate has a low solubility, carbon dioxide is present in the atmosphere, and thus calcium carbonate precipitation limits the concentration that can be used for chemical feeds.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{mole_base_for_target_pH}.png}
\caption{Dose of three bases (in mole/L) required to achieve a target pH for the Manzaragua water. Carbonates provide more buffering and less change in the pH compared with \(NaOH\).}\label{\detokenize{Rapid_Mix/RM_Examples:id6}}\label{\detokenize{Rapid_Mix/RM_Examples:figure-mole-base-for-target-ph}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{mg_base_for_target_pH}.png}
\caption{Dose of two bases (in mg/L) required to achieve a target pH for the Manzaragua water. Carbonates provide more buffering and less change in the pH compared with \(NaOH\).}\label{\detokenize{Rapid_Mix/RM_Examples:id7}}\label{\detokenize{Rapid_Mix/RM_Examples:figure-mg-base-for-target-ph}}\end{figure}

The required dose for each of the bases is summarized below.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Dose of each base required to change the pH of the Manzaragua water to 7.}\label{\detokenize{Rapid_Mix/RM_Examples:id8}}\label{\detokenize{Rapid_Mix/RM_Examples:table-base-table}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{80}|\X{20}{80}|\X{20}{80}|\X{20}{80}|}
\hline
\sphinxstyletheadfamily 
units
&
\(NaOH\)
&
\(NaHCO_3\)
&
\(Na_2CO_3\)
\\
\hline
{[}mmoles/L{]}
&
0.45
&
2.8
&
0.53
\\
\hline
{[}mg/L{]}
&
47.21
&
235.0
&
21.19
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\section{LFOM and coagulant injection sizing}
\label{\detokenize{Rapid_Mix/RM_Examples:lfom-and-coagulant-injection-sizing}}\label{\detokenize{Rapid_Mix/RM_Examples:heading-lfom-and-coag-injection-sizing}}
A water treatment plant that is treating 120 L/s of water injects the coagulant into the middle of the pipe that delivers the raw water to the plant and then splits the flow into 2 parallel treatment trains for subsequent flocculation. The pipe is PVC 24 inch nominal pipe diameter SDR 26. The water temperature is \(0^{\circ}C\). Estimate the minimum distance between the injection point and the flow split.

We will use a {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Design:heading-lfom}]{\sphinxcrossref{\DUrole{std,std-ref}{linear flow orifice meter}}}} with 20 cm of head loss. The first step is to determine the diameter of the LFOM.

..todo:: This example needs to be updated once the LFOM OO code is fixed.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{} importing \PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{environmental\PYGZus{}processes\PYGZus{}analysis} \PYG{k}{as} \PYG{n+nn}{epa}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{c+c1}{\PYGZsh{}from matplotlib.ticker import FormatStrFormatter}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AguaClara Water Treatment Plant Design/Rapid Mix/Images/}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{Q\PYGZus{}plant} \PYG{o}{=} \PYG{l+m+mi}{120} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{HL\PYGZus{}LFOM} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{Pi\PYGZus{}LFOM\PYGZus{}safety} \PYG{o}{=} \PYG{l+m+mf}{1.2}
\PYG{n}{SDR\PYGZus{}LFOM} \PYG{o}{=} \PYG{l+m+mi}{26}

\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{design} \PYG{k}{import} \PYG{n}{lfom} \PYG{k}{as} \PYG{n}{lfom}
\PYG{n}{ND\PYGZus{}LFOM} \PYG{o}{=} \PYG{n}{lfom}\PYG{o}{.}\PYG{n}{nom\PYGZus{}diam\PYGZus{}lfom\PYGZus{}pipe}\PYG{p}{(}\PYG{n}{Q\PYGZus{}plant}\PYG{p}{,}\PYG{n}{HL\PYGZus{}LFOM}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{ND\PYGZus{}LFOM}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ND\PYGZus{}LFOM}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{L\PYGZus{}flow} \PYG{o}{=} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}LFOM}\PYG{p}{,}\PYG{n}{SDR\PYGZus{}LFOM}\PYG{p}{)}
\PYG{n}{L\PYGZus{}flow}
\end{sphinxVerbatim}

The LFOM requires a 24 inch diameter pipe.


\section{Example problem: Energy dissipation rate in a straight pipe}
\label{\detokenize{Rapid_Mix/RM_Examples:example-problem-energy-dissipation-rate-in-a-straight-pipe}}\begin{description}
\item[{Solution scheme}] \leavevmode
1) Calculate the friction factor
1) Use \sphinxcode{\sphinxupquote{mixing\_pipe\_diameters}} to estimate the mixing length in pipe diameters
1) Convert to pipe length in meters.

\end{description}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{materials} \PYG{k}{as} \PYG{n+nn}{mat}
\PYG{n}{T\PYGZus{}water}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{Pipe\PYGZus{}roughness} \PYG{o}{=} \PYG{n}{mat}\PYG{o}{.}\PYG{n}{PVC\PYGZus{}PIPE\PYGZus{}ROUGH}
\PYG{n}{Pipe\PYGZus{}roughness}
\PYG{n}{Nu\PYGZus{}water} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}water}\PYG{p}{)}
\PYG{n}{Q\PYGZus{}pipe} \PYG{o}{=} \PYG{l+m+mi}{120} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{ND\PYGZus{}pipe} \PYG{o}{=} \PYG{l+m+mi}{24}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\PYG{n}{SDR\PYGZus{}pipe} \PYG{o}{=} \PYG{l+m+mi}{26}
\PYG{n}{ID\PYGZus{}pipe} \PYG{o}{=} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{SDR\PYGZus{}pipe}\PYG{p}{)}
\PYG{n}{f\PYGZus{}pipe} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{fric}\PYG{p}{(}\PYG{n}{Q\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{Nu\PYGZus{}water}\PYG{p}{,}\PYG{n}{Pipe\PYGZus{}roughness}\PYG{p}{)}
\PYG{n}{N\PYGZus{}pipe\PYGZus{}diameters} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{f\PYGZus{}pipe}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{N\PYGZus{}pipe\PYGZus{}diameters}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}The minimum length for mixing is thus\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{L\PYGZus{}mixing} \PYG{o}{=} \PYG{n}{ID\PYGZus{}pipe}\PYG{o}{*}\PYG{n}{N\PYGZus{}pipe\PYGZus{}diameters}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum distance required for mixing across the diameter of the pipe is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{L\PYGZus{}mixing}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{v\PYGZus{}lfom} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Q\PYGZus{}plant}\PYG{o}{/}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}LFOM}\PYG{p}{,}\PYG{n}{SDR\PYGZus{}LFOM}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{v\PYGZus{}lfom}\PYG{p}{)}
\PYG{n}{t\PYGZus{}mixing} \PYG{o}{=} \PYG{p}{(}\PYG{n}{L\PYGZus{}mixing}\PYG{o}{/}\PYG{n}{v\PYGZus{}lfom}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{t\PYGZus{}mixing}
\end{sphinxVerbatim}

The previous analysis provides a minimum distance for sufficient mixing so that equal mass flux of coagulant will end up in both treatment trains. This assumes that the coagulant was injected in the pipe centerline. Injection at the wall of the pipe is a poor practice and would require many more pipe diameters because it takes significant time for the coagulant to be mixed out of the slower fluid at the wall. The time required for mixing at the scale of the flow in the plant is thus accomplished in a few seconds. This ends up being the fastest part of the transport of the coagulant nanoparticles on their way to attachment to the clay particles.  Next we will determine a typical flow rate of coagulant. \sphinxstylestrong{Aluminum} concentrations for polyaluminum chloride (PACl) typically range from 1 to 10 mg/L. The maximum PACl stock solution concentration is about 70 g/L as \sphinxstylestrong{Al}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{C\PYGZus{}PACl\PYGZus{}stock} \PYG{o}{=} \PYG{l+m+mi}{70} \PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{C\PYGZus{}PACl\PYGZus{}dose\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{10} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{Q\PYGZus{}PACl\PYGZus{}max} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Q\PYGZus{}plant}\PYG{o}{*}\PYG{n}{C\PYGZus{}PACl\PYGZus{}dose\PYGZus{}max}\PYG{o}{/}\PYG{n}{C\PYGZus{}PACl\PYGZus{}stock}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{Q\PYGZus{}PACl\PYGZus{}max}\PYG{p}{)}
\end{sphinxVerbatim}

We can estimate the diameter of the injection port by setting the kinetic energy loss where the coagulant is injected into the main flow to be large enough to exceed the pressure fluctuations downstream of the LFOM. The amount of energy we invest in injecting the coagulant into the raw water is a compromise between having to raise the entire chemical feed system including the stock tanks to increase the potential energy and a goal of not having pressure fluctuations inside the LFOM pipe cause flow oscillations in the chemical dosing tube. Thus our goal is to have the kinetic energy at the injection point be large compared with the expected pressure fluctuations in the LFOM. Given that the head loss through the LFOM is often 20 cm, we expect the pressure fluctuations from turbulence to be a small fraction of that head loss. Thus we set the kinetic energy to be equivalent to 2 cm.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{HL\PYGZus{}Coag\PYGZus{}injection} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{v\PYGZus{}Coag\PYGZus{}injection} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{HL\PYGZus{}Coag\PYGZus{}injection}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{v\PYGZus{}Coag\PYGZus{}injection}\PYG{p}{)}
\PYG{n}{D\PYGZus{}Coag\PYGZus{}injection\PYGZus{}min} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{diam\PYGZus{}circle}\PYG{p}{(}\PYG{n}{Q\PYGZus{}PACl\PYGZus{}max}\PYG{o}{/}\PYG{n}{v\PYGZus{}Coag\PYGZus{}injection}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{D\PYGZus{}Coag\PYGZus{}injection\PYGZus{}min}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\chapter{Rapid Mix Theory and Future Work}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:rapid-mix-theory-and-future-work}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:title-rapid-mix-theory-and-future-work}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work::doc}}
Our understanding of the coagulant nanoparticle attachment to suspended particles and dissolved species is currently quite speculative. This is an area that requires substantial research and modeling because has the potential to significantly influence the design of flocculators. We have anecdotal evidence that the process of transporting coagulant nanoparticles to suspended particle surfaces may be a slow, rate-limiting process, especially when coupled with high rate flocculators. Dissolved organic matter may slow the rate of coagulant nanoparticle transport by effectively increasing the size of the coagulant nanoparticles and thus reducing the diffusion rate.

Developing a fundamental understanding of the mixing and transport processes that occur between coagulant addition and flocculation is a very high priority for the AguaClara program.


\section{Diffusion and Shear Transport Coagulant Nanoparticles to Clay}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:diffusion-and-shear-transport-coagulant-nanoparticles-to-clay}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-diffusion-and-shear-transport-coagulant-nanoparticles-to-clay}}
The time required for shear and diffusion to transport coagulant nanoparticles to clay has previously been assumed to be a rapid process.

Our analysis suggests that this critical step may require significant time especially given our effort to reduce the time allotted for flocculation.
\begin{itemize}
\item {} 
Turbulent eddies, viscous shear, and diffusion blends the coagulant with the raw water sufficiently ({\hyperref[\detokenize{Rapid_Mix/RM_Intro:heading-mixing-time}]{\sphinxcrossref{\DUrole{std,std-ref}{in a few seconds}}}}) so that the coagulant precipitates and forms nanoparticles.

\item {} 
Dissolved organic molecules diffuse to the coagulant nanoparticles and adhere to the nanoparticle surface.

\item {} 
The coagulant nanoparticles are transported to suspended particle surfaces by a combination of diffusion and fluid shear.

\end{itemize}

The following is a very preliminary estimate of the time required for attachment of the nanoparticles to the clay particles. This analysis includes multiple simplifying assumptions and there is a reasonable possibility that some of those assumptions are wrong. However, the core assumption that coagulant nanoparticles are transported to clay particles by a combination of fluid deformation (shear) and molecular diffusion is reasonable.

The following analysis is similar to the collision analysis that was developed in the AguaClara flocculation model. The core idea is that viscous shear dominated fluid deformation causes relative motion between the coagulant nanoparticles and the clay particles (or other suspended particles) with which they eventually will collide. The collision between these particles that are very different in size is difficult to achieve because there is a viscous layer of fluid around the clay particles that the clay particle drags with it as it rotates in deforming fluid. Diffusion helps transport the coagulant nanoparticles through this viscous layer.

The volume of the suspension that is cleared of nanoparticles is proportional to a collision area defined by a ring around the clay particle with width of the diameter of the nanoparticle diffusion band. This diffusion band is the length scale over which diffusion is able to transport coagulant particles to the clay surface during the time that the nanoparticles are sliding past the clay particle.

If we go backwards in time, the ring of fluid around the clay particle would deform into two separate highly distorted volumes of fluid, one located to the left of the clay particle and one to the right (see figure \hyperref[\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:figure-coagulant-nanoparticle-clay-collisions}]{Fig.\@ \ref{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:figure-coagulant-nanoparticle-clay-collisions}}}). This volume of fluid is assumed to receive nanoparticles that are transported in by fluid deformation.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Coagulant_nanoparticle_clay_collisions}.png}
\caption{Fluid deformation moves coagulant nanoparticles close to clay particles and diffusion helps transport the nanoparticles the last nanometers toward a successful collision.}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:id1}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:figure-coagulant-nanoparticle-clay-collisions}}\end{figure}


\subsection{Diffusion band thickness}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:diffusion-band-thickness}}
The time required for shear to transport all of the fluid past the clay so that diffusion can transport the coagulant nanoparticles to the clay surface is significant. The diffusion coefficient for coagulant nanoparticles is given by
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:0}
\begin{split}D_{Diffusion} = \frac{k_B T}{3 \pi \mu d_{CN}}\end{split}
\end{equation}
where \(d_{cn}\) is the diameter of the coagulant nanoparticles. The length scale over which diffusion is occurring can be estimate from the diffusion coefficient and the time allotted.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Diffusion_Length_scale}
\begin{split}L_{Diff} \approx \sqrt{D_{Diffusion} t_{Diffusion}}\end{split}
\end{equation}
The time for coagulant nanoparticles to diffuse through the boundary layer around the clay particle is equal to the distance they travel around the clay particle divided by their velocity. The distance they travel scales with \(d_{Clay}\) and their average velocity scales with the thickness of the diffusion layer/2 * the velocity gradient.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Diffusion_Layer_time}
\begin{split}t_{Diffusion} = \frac{ 2d_{Clay}} {L_{Diff} G}\end{split}
\end{equation}
We can eliminate the diffusion time in equation \eqref{equation:Rapid_Mix/RM_Theory_and_Future_Work:Diffusion_Length_scale} using equation \eqref{equation:Rapid_Mix/RM_Theory_and_Future_Work:Diffusion_Layer_time}.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:1}
\begin{split}L_{Diff} \approx \left( \frac{2k_B T d_{Clay}}{3 \pi \,\mu  \, d_{CN} G}\right)^\frac{1}{3}\end{split}
\end{equation}
This diffusion layer thickness is the length scale over which diffusion becomes the dominant transport mechanism for coagulant nanoparticles. Let’s estimate the thickness of this diffusion layer.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}I needed to attach units to material properties due to a bug in floc\PYGZus{}model. This will need to be fixed when floc\PYGZus{}model is updated.\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{T\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{G} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+m+mi}{5000}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}

\PYG{k}{def} \PYG{n+nf}{L\PYGZus{}Diff}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{,}\PYG{n}{G}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{boltzmann\PYGZus{}constant}\PYG{o}{*}\PYG{n}{Temperature} \PYG{o}{*} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{o}{.}\PYG{n}{Diameter}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}dynamic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*} \PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{o}{.}\PYG{n}{Diameter}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}\PYG{o}{*}\PYG{n}{G}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{T\PYGZus{}graph}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,}\PYG{n}{L\PYGZus{}Diff}\PYG{p}{(}\PYG{n}{T\PYGZus{}graph}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,}\PYG{n}{G}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{nm}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{o}{*}\PYG{n}{T\PYGZus{}graph}\PYG{p}{]}\PYG{p}{)}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}* is used to unpack T\PYGZus{}graph so that units are preserved when adding another legend item.\PYGZdq{}\PYGZdq{}\PYGZdq{}}


\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Velocity gradient (Hz)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Diffusion band thickness (\PYGZdl{}nm\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Diffusion\PYGZus{}band\PYGZus{}thickness}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Diffusion_band_thickness}.png}
\caption{Molecular diffusion band thickness as a function of velocity gradient. This length scale marks the transition between transport by fluid deformation and by diffusion.}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:id2}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:figure-diffusion-band-thickness}}\end{figure}

Diffusion transports the coagulant nanoparticles a relatively short distance, a fraction of a \(\mu m\).

We need to calculate the rate at which coagulant nanoparticles attach to the clay particles. The long range transport is assumed to be the rate limiting step. The volume cleared is proportional to the area of this ring with the ring thickness equal to the molecular diffusion band thickness. Here we assume that the \(L_{Diff_{CN}} << d_{Clay}\)
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:2}
\begin{split}{\rlap{--} V_{\rm{Cleared}}} \propto \pi \, d_{Clay} \, L_{Diff_{CN}}\end{split}
\end{equation}
The volume cleared is proportional to time
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:3}
\begin{split}{\rlap{--} V_{\rm{Cleared}}} \propto t\end{split}
\end{equation}
The volume cleared is proportional to the relative velocity between clay and nanoparticles. This relative velocity is in the viscous layer of fluid in the ring surrounding the clay particle.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:4}
\begin{split}{\rlap{--} V_{\rm{Cleared}}} \propto v_r\end{split}
\end{equation}
We use dimensional analysis to get a relative velocity for the long range transport controlled by shear. The relative velocity between coagulant nanoparticles and clay particle that they will eventually collide with is assumed to be proportional to the average distance between clay particles. This assumption is both critical for the following derivation and is suspect. It is critical because if we were to assume that the relative velocity caused by shear is proportional to the nanoparticle diameter, the clay diameter, or the diffusion length scale, then the velocity would be extremely small and the time to clear the volume of fluid associated with one clay particle would take a very long time. However, wishing for a speedy process doesn’t justify incorrect scaling. The relative velocity is assumed to be the velocity at which coagulant nanoparticles are transported into the two separate fluid volumes that will deform into the ring around the clay particle in the next few seconds.

The assumption that the relative velocity scales with the average distance between clay particles leads to the following steps. The first step is just a proposed functional relationship. We could also have jumped to the assumption that the relative velocity is a function of the length scale and the velocity gradient.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:5}
\begin{split}v_r = f \left( \varepsilon ,\nu ,\Lambda_{Clay} \right)\end{split}
\end{equation}
In a uniform shear environment the velocity gradient is linear. Thus the relative velocity must be proportional to the length scale.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:6}
\begin{split}v_r = \Lambda_{Clay} f \left( \varepsilon ,\nu \right)\end{split}
\end{equation}
The only way to for \(\varepsilon\) and \(\nu\) to produce dimensions of time is to combine to create 1/G.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:7}
\begin{split}v_r \approx \Lambda_{Clay} G\end{split}
\end{equation}
Combining the three equations for \({\rlap{--} V_{\rm{Cleared}}}\) and the equation for \(v_r\) we obtain the volume cleared as a function of time.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:8}
\begin{split}{\rlap{--} V_{\rm{Cleared}}} \approx \pi  d_{Clay} \, L_{Diff_{CN}}  \Lambda_{Clay} G  t_c\end{split}
\end{equation}

\section{Collision Rates}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:collision-rates}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-collision-rates}}
The time for all of the fluid to have had one opportunity for a collision occurs when \({\rlap{--} V_{\rm{Cleared}}} = {\rlap{--} V_{\rm{Occupied}}} = \Lambda_{Clay}^3\)
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:9}
\begin{split}t_c = \frac{\Lambda_{Clay}^3}{\pi d_{Clay} L_{Diff_{CN}} \Lambda_{Clay} G}\end{split}
\end{equation}
The successful collision rate (the attachment rate) is given by
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:10}
\begin{split}\frac{dN_c}{dt} = \frac{1}{t_c}\end{split}
\end{equation}
Substitute the equation for \(t_c\).
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:11}
\begin{split}dN_c = \pi d_{Clay} L_{Diff_{CN}}{\Lambda^{-2}_{Clay}} G dt\end{split}
\end{equation}

\subsection{Collision Rate and Particle Removal}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:collision-rate-and-particle-removal}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-collision-rate-and-particle-removal}}
A fraction of the remaining coagulant nanoparticles are removed during the time required for one sweep past the clay particle.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:12}
\begin{split}\frac{dn_{CN}}{ - k \, n_{CN}} = dN_c\end{split}
\end{equation}\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:13}
\begin{split}\frac{dn_{CN}}{ - k \, n_{CN}} = \pi d_{Clay} L_{Diff_{CN}}{\Lambda^{-2}_{Clay}} G dt\end{split}
\end{equation}

\subsection{Integrate the coagulant transport model}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:integrate-the-coagulant-transport-model}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-integrate-the-coagulant-transport-model}}
Integrate from the initial coagulant nanoparticle concentration to the concentration at time t.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:14}
\begin{split}\int \limits_{n_{CN_0}}^{n_{CN}} n_{CN}^{- 1} \, dn_{CN}  =  - \pi d_{Clay} L_{Diff_{CN}} \Lambda^{-2}_{Clay} G \, k  \int \limits_0^t {dt}\end{split}
\end{equation}
Use pC notation to be consistent with how we describe removal efficiency of other contaminants.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:15}
\begin{split}2.3 p C_{CN} = \pi d_{Clay}\,  L_{Diff_{CN}}\,  \Lambda^{-2}_{Clay}\,  G k  t\end{split}
\end{equation}
Solve for the time required to reach a target efficiency of application of coagulant nanoparticles to clay.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:16}
\begin{split}t_{coagulant, \, application} = \frac{2.3p C_{CN} \Lambda_{Clay}^2}{\pi G k \, d_{Clay}  L_{Diff_{CN}} }\end{split}
\end{equation}

\subsubsection{Coagulant nanoparticle application}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:coagulant-nanoparticle-application}}
If we assume that we are willing to invest a certain amount of energy in the process, then we can estimate the time required to achieve a target coagulant nanoparticle application efficiency. The velocity gradient in the reactor where the coagulant is attaching to the clay particles is related to the head loss or drop in water level, \(\Delta h\), through the reactor.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:17}
\begin{split}\Delta h =   \frac{G^2 \nu \theta}{g}\end{split}
\end{equation}
Replace \(\theta\) with \(t_{coagulant, \, application}\).
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:18}
\begin{split}\Delta h =  \frac{G^2 \nu}{g} \frac{2.3p C_{CN} \, \Lambda_{Clay}^2}{\pi G k \, d_{Clay}\,  L_{Diff_{CN}} }\end{split}
\end{equation}\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:19}
\begin{split}L_{Diff} \approx \left( \frac{2k_B T d_{Clay}}{3 \pi \,\mu  \, d_{CN} G}\right)^\frac{1}{3}\end{split}
\end{equation}\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:20}
\begin{split}\Delta h =  \frac{G^2 \nu}{g} \frac{2.3p C_{CN} \, \Lambda_{Clay}^2}{\pi G k \, d_{Clay}} \left( \frac{3 \pi \,\mu  \, d_{CN} G}{2k_B T d_{Clay}}\right)^\frac{1}{3}\end{split}
\end{equation}
Solve for the velocity gradient.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:21}
\begin{split}\Delta h =  \frac{G^\frac{4}{3} \nu}{g} \frac{2.3p C_{CN} \, \Lambda_{Clay}^2}{\pi k \, d_{Clay}} \left( \frac{3 \pi \,\mu  \, d_{CN} }{2k_B T d_{Clay}}\right)^\frac{1}{3}\end{split}
\end{equation}\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:22}
\begin{split}G_{coagulant, \, application} =  d_{Clay}\left(\frac{\pi k \,g\Delta h }{2.3p C_{CN} \, \Lambda_{Clay}^2 \nu} \right)^\frac{3}{4} \left( \frac{2k_B T }{3 \pi \,\mu  \, d_{CN} }\right)^\frac{1}{4}\end{split}
\end{equation}
Using the equation for \(L_{Diff}\) above, we can solve for  the time required to reach a target efficiency of application of coagulant nanoparticles to clay:
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:23}
\begin{split}t_{coagulant, \, application} = \frac{2.3p C_{CN} \, \Lambda_{Clay}^2}{\pi G k \, d_{Clay}\,  L_{Diff_{CN}} }\end{split}
\end{equation}
The time required for the coagulant to be transported to clay surfaces is strongly dependent on the turbidity as indicated by the average spacing of clay particles, \(\Lambda_{Clay}\). As turbidity increases the spacing between clay particles decreases and the time required for shear to transport coagulant nanoparticles to the clay decreases. Increasing the shear also results in faster transport of the coagulant nanoparticles to clay surfaces. The times required are strongly influenced by the size of the coagulant nanoparticles because larger nanoparticles diffuse more slowly.

Below we estimate the time required to achieve 80\% attachment of nanoparticles in a 10 NTU clay suspension in a reactor with G of 100 Hz.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}I needed to attach units to material properties due to a bug in floc\PYGZus{}model. This will need to be fixed when floc\PYGZus{}model is updated.\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} conventional mechanical design values below}
\PYG{n}{Mix\PYGZus{}HRT} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{25}\PYG{p}{,}\PYG{l+m+mi}{35}\PYG{p}{,}\PYG{l+m+mi}{85}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Mix\PYGZus{}G} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{4000}\PYG{p}{,}\PYG{l+m+mi}{1500}\PYG{p}{,}\PYG{l+m+mi}{950}\PYG{p}{,}\PYG{l+m+mi}{850}\PYG{p}{,}\PYG{l+m+mi}{750}\PYG{p}{]}\PYG{p}{)}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Mix\PYGZus{}CP} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{multiply}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}HRT}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}G}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Mix\PYGZus{}Gt} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{multiply}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}HRT}\PYG{p}{,} \PYG{n}{Mix\PYGZus{}G}\PYG{p}{)}
\PYG{n}{Mix\PYGZus{}EDR} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Mix\PYGZus{}G}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{Nano\PYGZus{}coag\PYGZus{}attach\PYGZus{}time}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}We assume that 70\PYGZpc{} of nanoparticles attach in the average time for one collision.\PYGZdq{}\PYGZdq{}\PYGZdq{}}
  \PYG{n}{k\PYGZus{}nano} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
  \PYG{n}{num}\PYG{o}{=}\PYG{l+m+mf}{2.3}\PYG{o}{*}\PYG{n}{pC\PYGZus{}CN}\PYG{o}{*}\PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{(}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
  \PYG{n}{den} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{G}\PYG{o}{*} \PYG{n}{k\PYGZus{}nano} \PYG{o}{*} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{o}{.}\PYG{n}{Diameter}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{*} \PYG{n}{L\PYGZus{}Diff}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{,}\PYG{n}{G}\PYG{p}{)}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{num}\PYG{o}{/}\PYG{n}{den}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{C\PYGZus{}Al} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{C\PYGZus{}clay} \PYG{o}{=} \PYG{l+m+mi}{10} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{pC\PYGZus{}CN} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.8}\PYG{p}{)}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}apply 80\PYGZpc{} of the coagulant nanoparticles to the clay\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{G} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{50}\PYG{p}{,}\PYG{l+m+mi}{5000}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{T\PYGZus{}graph}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,}\PYG{n}{Nano\PYGZus{}coag\PYGZus{}attach\PYGZus{}time}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{T\PYGZus{}graph}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{Mix\PYGZus{}G}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{n}{Mix\PYGZus{}HRT}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{o}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{o}{*}\PYG{n}{T\PYGZus{}graph}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Conventional rapid mix}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}* is used to unpack T\PYGZus{}graph so that units are preserved when adding another legend item.\PYGZdq{}\PYGZdq{}\PYGZdq{}}


\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Velocity gradient (Hz)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Nanoparticle attachment time (s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coag\PYGZus{}attach\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Coag_attach_time}.png}
\caption{An estimate of the time required for 80\% of the coagulant nanoparticles to attach to clay particles given a raw water turbidity of 10 NTU.}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:id3}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:figure-coag-attach-time}}\end{figure}


\subsection{Energy Tradeoff for Coagulant Transport}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:energy-tradeoff-for-coagulant-transport}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-energy-tradeoff-for-coagulant-transport}}\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:24}
\begin{split}\Delta h =   \frac{G^2 \nu \theta}{g}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{n}{Nano\PYGZus{}attach\PYGZus{}time} \PYG{o}{=} \PYG{n}{Nano\PYGZus{}coag\PYGZus{}attach\PYGZus{}time}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{HL\PYGZus{}coag\PYGZus{}attach}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{G}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*}\PYG{n}{Nano\PYGZus{}attach\PYGZus{}time}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{T\PYGZus{}graph}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{ax}\PYG{o}{.}\PYG{n}{loglog}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,}\PYG{n}{HL\PYGZus{}coag\PYGZus{}attach}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{T\PYGZus{}graph}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{T\PYGZus{}graph}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Velocity gradient (Hz)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Head loss (cm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coag\PYGZus{}attach\PYGZus{}head\PYGZus{}loss}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Coag_attach_head_loss}.png}
\caption{The total energy required to attach coagulant nanoparticles to raw water inorganic particles increases rapidly with the velocity gradient used in the rapid mix process.}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:id4}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:figure-coag-attach-head-loss}}\end{figure}

There is an economic tradeoff between reactor volume and energy input. The reactor volume results in a higher capital cost and the energy input requires both higher operating costs and higher capital costs. This provides an opportunity to optimize rapid mix design once we have a confirmed model characterizing the process.

The total potential energy used to operate an AguaClara plant is approximately 2 m. This represents the difference in elevation between where the raw water enters the plant and where the filtered water exits the plant. If we assume that the rapid mix energy budget is a fraction of that total and thus for subsequent analysis we will assume somewhat arbitrarily that the energy available to attach the coagulant nanoparticles to the raw water particles is 50 cm.

We solve the coagulant transport model,
\(t_{coagulant, \, application} = \frac{2.3p C_{CN} \, \Lambda_{Clay}^2}{\pi G k \, d_{Clay}\, L_{Diff_{CN}} }\),
for G given a head loss.
\begin{equation}\label{equation:Rapid_Mix/RM_Theory_and_Future_Work:Rapid_Mix/RM_Theory_and_Future_Work:25}
\begin{split}G_{coagulant, \, application} =  d_{Clay}\left(\frac{\pi k \,g\Delta h }{2.3p C_{CN} \, \Lambda_{Clay}^2 \nu} \right)^\frac{3}{4} \left( \frac{2k_B T }{3 \pi \,\mu  \, d_{CN} }\right)^\frac{1}{4}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}find G for target head loss\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{HL\PYGZus{}nano\PYGZus{}transport} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{k}{def} \PYG{n+nf}{G\PYGZus{}max\PYGZus{}head\PYGZus{}loss}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{HL\PYGZus{}nano\PYGZus{}transport}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{k\PYGZus{}nano} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
  \PYG{n}{num} \PYG{o}{=} \PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{HL\PYGZus{}nano\PYGZus{}transport} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{k\PYGZus{}nano}
  \PYG{n}{den}\PYG{o}{=} \PYG{l+m+mf}{2.3} \PYG{o}{*} \PYG{n}{pC\PYGZus{}CN} \PYG{o}{*} \PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{(}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}
  \PYG{n}{num2} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{boltzmann\PYGZus{}constant} \PYG{o}{*} \PYG{n}{Temperature}
  \PYG{n}{den2} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}dynamic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{o}{.}\PYG{n}{Diameter}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
  \PYG{k}{return} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{o}{.}\PYG{n}{Diameter}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{num}\PYG{o}{/}\PYG{n}{den}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{num2}\PYG{o}{/}\PYG{n}{den2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Note the use of to\PYGZus{}base\PYGZus{}units BEFORE raising to the fractional power. This prevents a rounding error in the unit exponent.\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{n}{G\PYGZus{}max} \PYG{o}{=} \PYG{n}{G\PYGZus{}max\PYGZus{}head\PYGZus{}loss}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{G\PYGZus{}max}\PYG{p}{)}

\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}The time required?\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{n}{Nano\PYGZus{}attach\PYGZus{}time} \PYG{o}{=} \PYG{n}{Nano\PYGZus{}coag\PYGZus{}attach\PYGZus{}time}\PYG{p}{(}\PYG{n}{pC\PYGZus{}CN}\PYG{p}{,}\PYG{n}{C\PYGZus{}clay}\PYG{p}{,}\PYG{n}{G\PYGZus{}max}\PYG{p}{,}\PYG{n}{Temperature}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{Nano\PYGZus{}attach\PYGZus{}time}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{G\PYGZus{}max}\PYG{o}{*}\PYG{n}{Nano\PYGZus{}attach\PYGZus{}time}\PYG{p}{)}
\end{sphinxVerbatim}

According to the analysis above, the maximum velocity gradient that can be used to achieve 80\% coagulant nanoparticle attachment using 50 cm of head loss is 283 Hz. This requires a residence time of 61 seconds. These model results must be experimentally verified and it is very likely that the model will need to be modified.

The analysis of the time required for shear and diffusion to transport the coagulant nanoparticles the last few millimeters suggests that it is the last step of diffusion to the clay particles that requires the most time. Indeed, the time required for coagulant nanoparticle attachment to raw water particles is comparable to the time that will be required for the next step in the process, flocculation.


\section{Coagulant Attachment Mechanism}
\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:coagulant-attachment-mechanism}}\label{\detokenize{Rapid_Mix/RM_Theory_and_Future_Work:heading-coagulant-attachment-mechanism}}
We do not yet understand the origin of the bonds that form between coagulant nanoparticles, between a coagulant nanoparticle and a suspended particle, and between coagulant nanoparticles and dissolved organic molecules. Historically the role of the coagulant was assumed to be to reduce the repulsive force between particles so that the particles could get close enough for Van der Waals forces to hold the particles together. That neglected the fact that Van der Waals forces were already acting between the water molecules and the suspended particle surfaces. In order for the water molecules to be pushed out of the way it is necessary for the coagulant nanoparticles to have stronger bonds with the suspended particles than the bonds between water molecules and the suspended particles.

The water molecules are subject to Brownian motion and thus it is possible that they are frequently vibrated free from the Van der Waals attractive forces. The coagulant nanoparticles are much larger, less affected by Brownian motion, and thus less likely to be vibrated. The fractal nature of the coagulant nanoparticles may also make it possible for multiple well aligned connections between the two surfaces. The fractal tentacles of the coagulant nanoparticle can align as needed to enable many strong bonding connections to the clay surface.


\chapter{Rapid Mix Mechanical Solution}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:rapid-mix-mechanical-solution}}\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution::doc}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{utility} \PYG{k}{as} \PYG{n+nn}{ut}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}

Numpy, fortunately, understands how to do matrix/array operations index by index. So if you have two length 5 arrays that you want to multiply index by index, you can simply multiply them! This will allow you to focus more on the rest of the code rather than frustrating indexing errors.

\sphinxcode{\sphinxupquote{array3 = array1*array2}}

This is more elegant and easier to troubleshoot than:

\sphinxcode{\sphinxupquote{array3 = np.empty\_like(array1) for i in range (0,len(array1)): array3{[}i{]} = array1{[}i{]}*array2{[}i{]}}}

Numpy can handle addition, subtraction, multiplication, and division between arrays.

This design challenge contains two parts: - In the first section, we will explore the energy requirements and operating costs for conventional mechanized rapid mix. This provides an opportunity to learn about the consequences of failing to design for sustainability. Rapid mix is both poorly understood and potentially very important in determining the successful operation of a water treatment plant. - In the second section, we will explore the energy dissipation rate in a free jet.


\section{Part 1: Temperature effects, energy use, and operating costs}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:part-1-temperature-effects-energy-use-and-operating-costs}}

\subsection{1)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id1}}
Create a graph of the kinematic viscosity of water as a function of temperature. Use the \sphinxcode{\sphinxupquote{pc.viscosity\_kinematic}} function. 1. Create an array of temperatures (0 to 35) using \sphinxcode{\sphinxupquote{np.linspace}} to create a dimensionless array. Then, attach appropriate temperature dimensions to the array by multiplying by the units. You can do this in one line! 1. Pass the entire array of temperatures to the kinematic viscosity function in aguaclara.core.pc to obtain an array of corresponding viscosities. 1. Plot viscosity (mm\textasciicircum{}2/s) as a function of temperature (Celsius).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{GraphTempArray} \PYG{o}{=}  \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{35}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{GraphKinematicViscosity}\PYG{o}{=}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{GraphTempArray}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{GraphTempArray}\PYG{p}{,} \PYG{n}{GraphKinematicViscosity}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature (degrees Celcius)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kinematic viscosity (mm\PYGZca{}2/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/Kinematic\PYGZus{}vs\PYGZus{}T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Kinematic_vs_T}.png}
\caption{Kinematic viscosity decreases rapidly with temperature. This will influence the amount of fluid deformation obtained given an input of energy. It will also influence the flow rate in the AguaClara chemical dosing system.}\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id13}}\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:figure-kinematic-vs-t}}\end{figure}

We will design a mechanized rapid mix unit and then analyze the energy costs of mixing for a conventional water treatment plant. Below is a table of conventional design parameters.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
Residence Time (s)
&\sphinxstyletheadfamily 
Velocity Gradient (G) (1/s)
&\sphinxstyletheadfamily 
Equivalent Height (m)
\\
\hline
0.5
&
4000
&
0.8
\\
\hline
10 - 20
&
1500
&
2.3 - 4.6
\\
\hline
20 - 30
&
950
&
1.8 - 2.8
\\
\hline
30 - 40
&
850
&
2.2 - 2.9
\\
\hline
40 - 130
&
750
&
2.3 - 7.5
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsection{2)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id2}}
\sphinxstylestrong{Define a function} for the power required to run a rapid mix unit. The rapid mix shaft power function should have flow, velocity gradient, residence time (which can be described with t or \(\theta\), as in the equation below), and temperature as its only inputs.
\begin{equation}\label{equation:Rapid_Mix/RM_Mechanical_Solution:Rapid_Mix/RM_Mechanical_Solution:0}
\begin{split}P = G^2Q \theta \nu \rho\end{split}
\end{equation}
Using your function, plot the shaft power (kW) required for a conventional rapid mix unit that has a residence time of t = 15s, a velocity gradient of G = 1500/s, and a flow rate of 50 L/s as a function of temperature (Celsius).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{FlowPlant} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{t} \PYG{o}{=} \PYG{l+m+mi}{15} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{G} \PYG{o}{=} \PYG{l+m+mi}{1500} \PYG{o}{*} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{rapid\PYGZus{}mix\PYGZus{}shaft\PYGZus{}power}\PYG{p}{(}\PYG{n}{Flow}\PYG{p}{,}\PYG{n}{VelocityGradient}\PYG{p}{,}\PYG{n}{time}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{power} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{VelocityGradient}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*} \PYG{n}{Flow} \PYG{o}{*} \PYG{n}{time} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{power}


\PYG{n}{ShaftPower} \PYG{o}{=} \PYG{n}{rapid\PYGZus{}mix\PYGZus{}shaft\PYGZus{}power}\PYG{p}{(}\PYG{n}{FlowPlant}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{t}\PYG{p}{,}\PYG{n}{GraphTempArray}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{GraphTempArray}\PYG{p}{,} \PYG{n}{ShaftPower}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kW}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature (degrees Celcius)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{shaft power required (kW)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/Shaft\PYGZus{}Power}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Shaft_Power}.png}
\caption{Rapid mix shaft power required as a function of temperature. Signfiicantly more power is required at low temperatures to overcome the effects of viscosity. This does assume that the goal for rapid mix is to achieve a target}\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id14}}\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:figure-shaft-power}}\end{figure}


\subsection{3)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id3}}
How would the shaft power for a conventional design be selected? You must consider the fact that temperature changes throughout the year, and temperature impacts the shaft power requirements as defined in your function above. Presumably, you should use the lowest water temperature that you expect to have to treat to make your design because low temperatures require the highest shaft power input (as shown in your graph above) and we want to design for the most conservative option.

Imagine you are designing a rapid mix unit for a water treatment plant in upstate NY. Water freezes in the winter, so the power requirements to run a rapid mix must be based on TempDesign = 0 °C.

What is the required shaft power \sphinxstylestrong{in horsepower} for your water treatment plant in upsstate NY? Calculate the shaft power using the design temperature, and take other necessary parameters from Problem 2.

You can \sphinxhref{https://github.com/hgrecco/pint/blob/c5925bfdab09c75a26bb70cd29fb3d34eed56a5f/pint/default\_en\_0.6.txt}{find pint’s unit registry
here.}. We recommend bookmarking this page!

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{TempDesign} \PYG{o}{=} \PYG{n}{u}\PYG{o}{.}\PYG{n}{Quantity}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}\PYG{p}{)}

\PYG{n}{RapidMixShaftPower} \PYG{o}{=} \PYG{n}{rapid\PYGZus{}mix\PYGZus{}shaft\PYGZus{}power}\PYG{p}{(}\PYG{n}{FlowPlant}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{t}\PYG{p}{,}\PYG{n}{TempDesign}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hp}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The required shaft power is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{RapidMixShaftPower}\PYG{p}{)}
\end{sphinxVerbatim}

The required shaft power is 4.0 hp


\subsection{4)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id4}}
What is the equivalent height in meters that this much shaft power could elevate the water in a pump, assuming the pump is 100\% efficient? Dimensional analysis of units is useful for this question. How do you get from units of power to units of length, and what constants will get you there?

You may assume 100\% efficiency in conversion of shaft power to increased potential energy. For comparison, the difference in water level between the entrance tank and flocculator for an AguaClara plant is less than 40 cm, and 20 cm of that elevation drop is used for flow measurement in the LFOM.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ElevDrop} \PYG{o}{=} \PYG{p}{(}\PYG{n}{RapidMixShaftPower}\PYG{o}{/} \PYG{p}{(}\PYG{n}{FlowPlant} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{TempDesign}\PYG{p}{)} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The equivalent height is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{n}{ElevDrop}\PYG{p}{)}
\end{sphinxVerbatim}

The equivalent height is 6.034 m


\subsection{5a)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:a}}
Our next task is to select a motor that can provide the required shaft power, as calculated in Problem 3.
\begin{itemize}
\item {} 
First, bring in the \sphinxcode{\sphinxupquote{motor\_efficiency.xlsx}} file provided for this design challenge. You imported a similar file in Problem 13 of DC Python Tutorial 2, but this time you will use \sphinxcode{\sphinxupquote{pd.read\_excel('filename.xlsx')}} since the file is .xlsx instead of .csv.

\item {} 
Display the extracted excel data, \sphinxcode{\sphinxupquote{motor\_efficiency.xlsx}}.

\item {} 
Extract the column of available horsepower and the column of premium efficiencies from the excel file and place them within their own 1D numpy arrays.

\item {} 
Apply appropriate units to the two extracted numpy arrays.

\end{itemize}

\sphinxstylestrong{NOTE:} The variable to which you assign the extracted excel document is a special type of data structure called a \sphinxhref{https://pandas.pydata.org/pandas-docs/stable/dsintro.html\#dataframe}{dataframe}. You can call a column of data from a dataframe by ‘indexing’ by the columns title in the original file, like \sphinxcode{\sphinxupquote{dataframe{[}'Horsepower'{]}}}. Make sure the column header is input as a string!

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}We use a pandas dataframe (df) to hold the data from the excel sheet.}
\PYG{n}{MotorEfficiencydf} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}excel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{motor\PYGZus{}efficiency.xlsx}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{MotorEfficiencydf}\PYG{p}{)}

\PYG{n}{MotorHpArray} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{MotorEfficiencydf}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Horsepower}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{horsepower}
\PYG{n}{MotorEfficiencyArray} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{MotorEfficiencydf}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Premium Efficiency}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{100}

\PYG{n}{MotorHpArray}

\PYG{n}{Horsepower}  \PYG{n}{Premium} \PYG{n}{Efficiency}
\PYG{l+m+mi}{0}         \PYG{l+m+mf}{0.25}                  \PYG{l+m+mi}{64}
\PYG{l+m+mi}{1}       \PYG{l+m+mf}{0.3333}                  \PYG{l+m+mi}{68}
\PYG{l+m+mi}{2}          \PYG{l+m+mf}{0.5}                  \PYG{l+m+mi}{71}
\PYG{l+m+mi}{3}         \PYG{l+m+mf}{0.75}                \PYG{l+m+mf}{75.5}
\PYG{l+m+mi}{4}            \PYG{l+m+mi}{1}                \PYG{l+m+mf}{82.5}
\PYG{l+m+mi}{5}          \PYG{l+m+mf}{1.5}                \PYG{l+m+mf}{82.5}
\PYG{l+m+mi}{6}            \PYG{l+m+mi}{2}                  \PYG{l+m+mi}{84}
\PYG{l+m+mi}{7}            \PYG{l+m+mi}{3}                  \PYG{l+m+mi}{86}
\PYG{l+m+mi}{8}            \PYG{l+m+mi}{5}                \PYG{l+m+mf}{89.6}
\PYG{l+m+mi}{9}          \PYG{l+m+mf}{7.5}                  \PYG{l+m+mi}{90}
\PYG{l+m+mi}{10}          \PYG{l+m+mi}{10}                \PYG{l+m+mf}{91.1}
\PYG{l+m+mi}{11}          \PYG{l+m+mi}{15}                \PYG{l+m+mf}{91.7}
\PYG{l+m+mi}{12}          \PYG{l+m+mi}{25}                  \PYG{l+m+mi}{93}
\PYG{l+m+mi}{13}          \PYG{l+m+mi}{50}                \PYG{l+m+mf}{94.1}
\PYG{l+m+mi}{14}         \PYG{l+m+mi}{100}                  \PYG{l+m+mi}{95}
\PYG{l+m+mi}{15}         \PYG{l+m+mi}{250}                \PYG{l+m+mf}{95.8}
\end{sphinxVerbatim}


\subsection{5b)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:b}}
It is common in engineering design to have target design value that must be rounded up to the next available manufactured value. In the Flow Control and Measurement Design Challenge, we used this method to take a minimum pipe size required to deliver a target flow rate and then we rounded up to the nearest commonly available pipe size. We wrote a function, \sphinxcode{\sphinxupquote{ceil\_nearest}} in aguaclara.core.utility, that we used to select pipe sizes. Use that function to find a motor that is large enough to drive the rapid mix impeller (\sphinxhref{https://en.wikipedia.org/wiki/Impeller\#In\_pumps}{What’s an impeller?}).

\sphinxcode{\sphinxupquote{ut.ceil\_nearest}} takes two inputs: the first is the value you are looking to match/exceed. In the pipe sizing example, this would be the smallest pipe that can handle the required flow. The second input is the array through which you are looking to compare the first input. If we continue with the pipe size example, this would be the array of available pipe sizes.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{MotorDesign} \PYG{o}{=} \PYG{n}{ut}\PYG{o}{.}\PYG{n}{ceil\PYGZus{}nearest}\PYG{p}{(}\PYG{n}{RapidMixShaftPower}\PYG{p}{,}\PYG{n}{MotorHpArray}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The rapid mix motor has}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{n}{MotorDesign}\PYG{p}{)}
\end{sphinxVerbatim}

The rapid mix motor has 5 hp


\subsection{6a)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id5}}
Our next goal is to find the efficiency of this motor.

One way to do this is to find the index (row number) of this motor horsepower in the original dataframe (or in your created array) and then use that index to find its corresponding efficiency. Use the \sphinxcode{\sphinxupquote{np.where}} function to find the index of the motor horsepower. The \sphinxcode{\sphinxupquote{where}} function will return an array, so you will need to use indexes on the returned array to extract the index of the motor. If you display the returned results, it will help you figure out how to use indexes to get the desired element.

The input in \sphinxcode{\sphinxupquote{np.where(input)}} is ‘number you’re looking to match == array you’re looking to match it to’. Example: \sphinxcode{\sphinxupquote{np.where(variable == array)}}

It is likely you will get the following output:
\sphinxcode{\sphinxupquote{(array({[}8{]}, dtype=int64),)}}

How to make sense of this? The parentheses around the entire output specify an array (note the comma before the final parentheses, specifying a blank second index). So you can index with square brackets to call the value within the array (Perhaps try index 0?). You should then get another array. How do you extract the value within this new array?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{MotorIndex}\PYG{o}{=}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{where}\PYG{p}{(}\PYG{n}{MotorEfficiencydf}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Horsepower}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{n}{MotorDesign}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{MotorIndex}
\end{sphinxVerbatim}

8


\subsection{6b)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id6}}
You will now use the index of the motor horsepower that you just found to extract the efficiency of the motor. This can be done by calling the index on the array of efficiencies you created or by calling on data from the original dataframe. Dataframes have a method called \sphinxhref{https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.get\_value.html}{get\_value} that can return an element in a dataframe given a row index and a column heading. This is done for you as an example.

For this problem, \sphinxstylestrong{extract the efficiency of the motor by calling the index on the array you created in Problem 5a. Return the motor efficiency as a fraction rather than as a percent}.

Note: it would have been much easier to simply define a variable and type in the efficiency. However, if we did that, it would have broken dependency; the notebook wouldn’t update correctly when you change the flow rate. Our goal is to create designs that scale correctly when the flow rate is changed.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Examplefor how to use .get\PYGZus{}value to return an element by calling on row index and column heading}
\PYG{n}{MotorEfficiency}\PYG{o}{=}\PYG{p}{(}\PYG{n}{MotorEfficiencydf}\PYG{o}{.}\PYG{n}{get\PYGZus{}value}\PYG{p}{(}\PYG{n}{MotorIndex}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Premium Efficiency}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{takeable}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{100}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}Your code below\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{MotorEfficiencyArray}\PYG{p}{[}\PYG{n}{MotorIndex}\PYG{p}{]}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The motor efficiency is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{MotorEfficiency}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{0.896}] \leavevmode
The motor efficiency is 0.896.

\end{description}

You might think that the rapid mix unit will take less electrical power when the water is warmer. But that isn’t the case because the Reynolds number for the rapid mix propeller is quite high and thus the drag coefficient is independent of Re. This means that the torque required to spin the propeller doesn’t change as the viscosity of the water changes. It would be possible to run the propeller slower when the water is warmer because the required energy dissipation rate is lower, but that would require a variable speed drive. You could add a variable speed motor controller to take advantage of this. However, the bigger problem is that we don’t yet have a good model explaining what rapid mix does.


\subsection{7)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id7}}
Now, we want to find a 3 phase, 1800 rpm (approximately!) electric motor that is totally enclosed and fan cooled (TEFC), and that has enough power to operate your rapid mixer at \sphinxhref{https://www.mcmaster.com/}{McMaster Carr}. You can find the link to the CAD drawing if you pretend you are going to select the motor for purchase. This part of the design challenge breaks dependency.

Once you find a sufficient motor, \sphinxstylestrong{display the CAD drawing of the motor and create a hyperlink to the motor specifications}.

Notes: we don’t currently know how to select and link to the correct motor using python, which is why you need to go to the McMaster Carr website to find the correct motor. If you know of an easy way to do this, please let us know!

The motor specifications are given below.

The \sphinxhref{https://www.mcmaster.com/\#5990k314/=19d4hod}{motor specifications} indicate that the efficiency is 89.5\% which is very close to the premium efficiency standard.


\subsection{8)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id8}}
How much does the motor cost? Create a variable showing the cost of the motor in USD. We have added USD to pint, so you will not find it in the original registry linked in Problem 3. The abbreviation for US Dollars is \sphinxcode{\sphinxupquote{u.USD}}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{COST\PYGZus{}MOTOR} \PYG{o}{=} \PYG{l+m+mf}{714.64} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{USD}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The cost of the motor is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{COST\PYGZus{}MOTOR}\PYG{p}{)}
\end{sphinxVerbatim}

The cost of the motor is 714.6 dollar


\subsection{9)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id9}}
Now, we want to determine the cost of electricity to operate the rapid mix unit you sized for your water treatment plant in NY.


\subsection{9a)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id10}}
Find the commercial rate for electricity in NY state at the \sphinxhref{https://www.eia.gov/electricity/data/browser/\#/topic/7?agg=0,1\&geo=0002\&endsec=vg\&linechart=ELEC.PRICE.NY-ALL.M~ELEC.PRICE.NY-RES.M~ELEC.PRICE.NY-COM.M~ELEC.PRICE.NY-IND.M~ELEC.PRICE.NY-TRA.M\&columnchart=ELEC.PRICE.NY-ALL.M\&map=ELEC.PRICE.NY-ALL.M\&freq=M\&start=200101\&end=201706\&chartindexed=0\&ctype=linechart\&ltype=pin\&rtype=s\&maptype=0\&rse=0\&pin=}{U.S. Energy Administration Website}. Download the data file for NY and then import the data file using pandas (\sphinxcode{\sphinxupquote{read\_csv}}). There are two versions of the csv data file on this page. The one you should use in this problem is titled \sphinxcode{\sphinxupquote{Average\_retail\_price\_of\_electricity\_monthly.csv}}.

For this step, simply \sphinxstylestrong{display the resulting data table showing the most recent 12 months of electricity costs in NY}.

Note that this data file has meta information about the data in the first rows. You can \sphinxhref{https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read\_csv.html}{delete those rows by setting header = 4} in the function call to the \sphinxcode{\sphinxupquote{pd.read\_csv}}. You can read exactly one year of data by setting nrows = 12. This will make it easy to calculate the average cost for the past year.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ElectricityCostdata} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Average\PYGZus{}retail\PYGZus{}price\PYGZus{}of\PYGZus{}electricity\PYGZus{}monthly.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{header}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{n}{nrows}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{)}
\PYG{n}{ElectricityCostdata}
\end{sphinxVerbatim}


\subsection{9b)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id11}}
Calculate the average commercial electricity cost for the most recent 12 months. Include the appropriate units. Don’t forget to correct for the fact that the prices are given in cents and not dollars.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ElectricityRate} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{average}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{ElectricityCostdata}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{New York : commercial cents per kilowatthour}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{USD}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kWh}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The New York State commercial electricity cost for the past year was }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ElectricityRate}\PYG{p}{)}
\end{sphinxVerbatim}

The New York State commercial electricity cost for the past year was 0.14622 USD/kWh


\subsection{9c)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:c}}
I think that we should buy electricity in giga Joules. KiloWatt-hr is what you get when someone who loves English units decides they don’t like seconds as the base unit of time that is the standard in the metric system.

How much would a giga Joule cost for the most recent 12 months? All you have to do is change the displayed units!

Look through the pint unit registry. To add orders of magnitude (like kilo, micro, giga, yotta), simply place the appropriate prefix before the usual unit abbreviation. A yotta-meter is \sphinxcode{\sphinxupquote{u.Ym}}, for example, as ‘\sphinxcode{\sphinxupquote{Y}}’ represents yotta- in pint.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The price of electricity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ElectricityRate}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{USD}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{GJ}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The price of electricity is 40.62 USD/GJ


\subsection{9d)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:d}}
Let’s look back to our design of a rapid mix unit for a water treatment plant in New York. Estimate the electricity demand * \sphinxstylestrong{in kilowatts} * for the rapid mix by taking the shaft power required and adjust for the efficiency of the motor that you have selected. Note that when a motor is running it does not necessarily operate at full load and hence at full power. Electric motors maintain their efficiency over a wide range of loads. To calculate the electricity consumption, use the actual shaft power required by the rapid mix and the motor efficiency. Calculate the electrical power required by the motor when the water is at its coldest.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{PowerElectricity} \PYG{o}{=} \PYG{p}{(}\PYG{n}{rapid\PYGZus{}mix\PYGZus{}shaft\PYGZus{}power}\PYG{p}{(}\PYG{n}{FlowPlant}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{t}\PYG{p}{,}\PYG{n}{TempDesign}\PYG{p}{)}\PYG{o}{/}\PYG{n}{MotorEfficiency}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kW}\PYG{p}{)}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The power required by the motor is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{PowerElectricity}\PYG{p}{)}
\end{sphinxVerbatim}

The power required by the motor is 3.30 kW

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rapid\PYGZus{}mix\PYGZus{}shaft\PYGZus{}power}\PYG{p}{(}\PYG{n}{FlowPlant}\PYG{p}{,}\PYG{n}{G}\PYG{p}{,}\PYG{n}{t}\PYG{p}{,}\PYG{n}{TempDesign}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hp}\PYG{p}{)}
\end{sphinxVerbatim}

3.967125458280934 horsepower


\subsection{9e)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:e}}
Calculate the annual cost of electricity in dollars required to operate the rapid mix unit.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{RMElectricityCost} \PYG{o}{=} \PYG{p}{(}\PYG{n}{PowerElectricity}\PYG{o}{*}\PYG{n}{ElectricityRate}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{USD}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{year}\PYG{p}{)}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The cost of electricity to operate the rapid mix unit is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{RMElectricityCost}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{PowerElectricity}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{ElectricityRate}\PYG{p}{)}
\end{sphinxVerbatim}

The cost of electricity to operate the rapid mix unit is 4232 USD/year 3.302 kilowatt 0.1462 dollar / kilowatt\_hour


\subsection{9f)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:f}}
What is the total cumulative energy costs for the rapid mix unit over a period of 25 years? Note that we are not including the projected increase in electricity costs over the next 25 years. That would be a nice addition to this analysis that would make the need for energy efficiency all the more apparent, but we are ignoring that complexity for this problem.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{YR25Electricity} \PYG{o}{=} \PYG{n}{RMElectricityCost}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{25}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{year}\PYG{p}{)}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The cumulative energy costs for a period of 25 years is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{YR25Electricity}\PYG{p}{)}
\end{sphinxVerbatim}

The cumulative energy costs for a period of 25 years is 105794.0 USD


\subsection{10)}
\label{\detokenize{Rapid_Mix/RM_Mechanical_Solution:id12}}
Write a paragraph describing what you learned from this design challenge. Include reflections on the temptation to use a standard design, the low capital cost of energy wasting designs, and the long term implications of engineering that isn’t guided by a goal of sustainability.


\chapter{Rapid Mix Design Solution}
\label{\detokenize{Rapid_Mix/RM_Design_Solution:rapid-mix-design-solution}}\label{\detokenize{Rapid_Mix/RM_Design_Solution::doc}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{constants} \PYG{k}{as} \PYG{n+nn}{con}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}


\section{1)}
\label{\detokenize{Rapid_Mix/RM_Design_Solution:id1}}
Create a function to return maximum energy dissipation rate along the centerline of a free jet given inputs of distance downstream of the jet (along the centerline), jet velocity, and initial jet diameter. You will find the Rapid Mix powerpoint useful in finding a relationship between these variables.

Use your function to create a graph of the centerline (maximum) energy dissipation rate as a function of distance from jet origin. * Use an initial diameter of DiamJet = 10 cm and a velocity of VelJet = 1 m/s. * Use a range of 7 to 20 jet diameters when creating the graph. * Use units of meters for the x-axis and W/kg for the y-axis. Make sure to label your axes correctly.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{DiamJet} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{VelJet} \PYG{o}{=} \PYG{l+m+mi}{1}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{energy\PYGZus{}dissipation\PYGZus{}rate}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{Diam}\PYG{p}{,} \PYG{n}{Velocity}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{dissipation} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{50} \PYG{o}{*} \PYG{n}{Diam}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{Velocity}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{/} \PYG{p}{(}\PYG{p}{(}\PYG{n}{x} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{Diam}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{dissipation}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}

\PYG{n}{DistanceDownstream} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{7}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{DiamJet}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{energy\PYGZus{}dissipation\PYGZus{}rate}\PYG{p}{(}\PYG{n}{DistanceDownstream}\PYG{p}{,} \PYG{n}{DiamJet}\PYG{p}{,} \PYG{n}{VelJet}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{DistanceDownstream}\PYG{p}{,} \PYG{n}{energy\PYGZus{}dissipation\PYGZus{}rate}\PYG{p}{(}\PYG{n}{DistanceDownstream}\PYG{p}{,} \PYG{n}{DiamJet}\PYG{p}{,} \PYG{n}{VelJet}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Distance from jet origin (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Energy dissipation rate (W/kg)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Rapid\PYGZus{}Mix/Images/Energy\PYGZus{}dissipation\PYGZus{}rate\PYGZus{}vs\PYGZus{}Distance\PYGZus{}from\PYGZus{}jet\PYGZus{}origin}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

0.7212 meter ** 2 / second ** 3

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Energy_dissipation_rate_vs_Distance_from_jet_origin}.png}
\caption{Energy dissipation rate vs Distance from jet origin}\label{\detokenize{Rapid_Mix/RM_Design_Solution:id2}}\label{\detokenize{Rapid_Mix/RM_Design_Solution:figure-energy-dissipation-rate-vs-distance-from-jet-origin}}\end{figure}


\chapter{Flocculation Introduction}
\label{\detokenize{Flocculation/Floc_Intro:flocculation-introduction}}\label{\detokenize{Flocculation/Floc_Intro:title-flocculation-introduction}}\label{\detokenize{Flocculation/Floc_Intro::doc}}
Flocculation transform inorganic (clays such as \sphinxhref{https://www.sciencedirect.com/science/article/pii/S0048969708010103}{kaolinite, smectite, etc. and metallic oxy-hydroxides such as goethite and gibbsite}) and organic (viruses, bacteria and protozoa) primary particles into flocs (particle aggregates). Flocculation doesn’t remove any particles from suspension. Instead it causes particle aggregation and then floc blankets, lamellar sedimentation, and sand filtration will be used to separate those flocs from the water. Sedimentation can remove flocs more easily than it can remove primary particles because flocs have a higher terminal sedimentation velocity. Floc blankets and sand filtration rely primarily on capture based on interception and interception is much more efficient when the particles are larger. Thus the purpose of flocculation is to join \sphinxstylestrong{all} of the primary particles together into flocs (See movie in \hyperref[\detokenize{Flocculation/Floc_Intro:figure-collisions-in-sequence}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Intro:figure-collisions-in-sequence}}}).

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/NIgP56htShw}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{Collisions_in_Sequence}.png}}\caption{Clay particles with attached coagulant nanoparticles collide due to fluid deformation. They grow in size quickly. The challenge is to catch the last few primary particles that failed to participate in the aggregation process.}\label{\detokenize{Flocculation/Floc_Intro:id1}}\label{\detokenize{Flocculation/Floc_Intro:figure-collisions-in-sequence}}\end{figure}


\section{Flocculation History}
\label{\detokenize{Flocculation/Floc_Intro:flocculation-history}}
Historically flocculation was assumed to involve collisions between all particles in the suspension. The Smoluchowski coagulation equation was published in 1916 and uses a population balance approach to track the number of particles of each size based on the probability of collisions between all possible combinations of particle sizes. The Smoluchowski equation is a statement of the conservation of mass and as such it certainly applies to flocculation in drinking water treatment plants. The challenge is that the probability of collisions between all possible combinations of particle sizes must be somehow known in order to use the model. The complexity of obtaining the collision probabilities and the complexity of solving the equation have preventing use of the Smoluchowski equation for design or operation of flocculators.

For most of the past century there have been two explanations for the particle interactions during flocculation based on the addition of a coagulant. The first explanation was that the positive charge of the coagulant neutralizes the negative charge of naturally occurring particles and thus eliminates the electrostatic repulsion that was preventing aggregation. The second explanation was called sweep flocculation and was the catch all explanation that was used to describe observations that didn’t fit the charge neutralization explanation. Particles were presumed to be swept into a mesh of coagulant precipitate at coagulant dosages that are typically used in drinking water treatment.


\subsection{Surface Charge and Sweep Floc}
\label{\detokenize{Flocculation/Floc_Intro:surface-charge-and-sweep-floc}}
The mechanism of particle-particle aggregation was thought to be controlled by the average surface charge. Unfortunately no one was able to develop a model of how that mechanism would influence particle attachment efficiency and no predictive models for flocculation were developed. Indeed, there were several observations that were at odds with the charge neutralization hypothesis.
\begin{enumerate}
\item {} 
Flocculation was observed to be efficient even at coagulant dosages that led to positive surface charge. This unexpected result was attributed to “sweep floc”.

\item {} 
Flocculation began to be effective even when the surface charge was still negative.

\item {} 
Flocculation time for highly turbid suspensions was expected to proceed very rapidly and produce very low turbidity settled water. This expectation was not observed and led to the hypothesis that flocs were continually breaking up and producing primary particles or at least very small flocs.

\item {} 
The floc break up hypotheses led to the expectation that high turbidity suspensions would have significantly higher settled water turbidity than low turbidity suspensions. This expectation was also not observed.

\item {} 
The coagulant precipitate self aggregates \textendash{} this is inconsistent with the positive charge that the electrostatic hypothesis asserts will prevent aggregation

\item {} 
Electrostatic repulsion extends only a few nm from the surface of a particle \textendash{} and the coagulant nanoparticles are many times larger than the reach of the repulsive electrostatic force. Thus there is no need to neutralize surface charge when using coagulant nanoparticles.

\item {} 
Charge neutralization explanation neglects to fully account for the presence of water in the system. Water molecules will also be attracted to surfaces by London van der Waals forces and thus there will be competition between particle-particle bonds and water-particle bonds. Thus eliminating repulsion is NOT sufficient to produce a bond between the particles. It is also necessary for the particle-particle bonds to be stronger than the water-particle bonds. (see \sphinxhref{https://vtechworks.lib.vt.edu/bitstream/handle/10919/30137/Chapter1.pdf?sequence=9}{hydration repulsion, page 21}) {}` “The theory of DLP was a great step forward in that it appeared to circumvent the whole intractable problem of many body forces through its use of measured bulk dielectric response functions. However, it must be stressed again that it is a perturbation theory. That is, it depends on the assumption that an intervening liquid between interacting surfaces has bulk liquid properties up to a molecular distance from the surfaces. This is thermodynamically inconsistent, being equivalent to the statement that surface energies (or alternatively, the positions of the Gibbs dividing surfaces) are changed infinitesimally with distance of separation. This limits the theory to large distances (Young\textendash{}Laplace vs. Poisson again) where large is undefined.” \textless{}\sphinxurl{https://doi.org/10.1016/S0001-8686(99)00008-1}\textgreater{}{}`\_\_

\end{enumerate}

Evidence that the charge neutralization hypothesis doesn’t explain flocculation of surface waters has been accumulating for decades. \sphinxstyleemphasis{Sweep} flocculation has been proposed as an alternative “mechanism” that described common observations that didn’t fit the charge neutralization hypothesis. However, similar to the charge neutralization hypothesis, the \sphinxstyleemphasis{sweep} hypothesis didn’t result in the development of predictive equations to describe the process.

For example, in 1992 Ching, Tanaka, and Elimelech published their research on \sphinxhref{https://doi.org/10.1016/0043-1354(94)90007-8}{Dynamics of coagulation of kaolin particles with ferric chloride}. They found that the electrophoretic mobility, a measure of the clay particle surface charge, was never neutralized at pH 7.8 and was neutralized at \(10\mu M\) at pH 6.0. The results were interpreted by the authors to mean that some combination of sweep floc and charge patchiness was responsible for the observed results.

See \hyperref[\detokenize{Flocculation/Floc_Intro:figure-ching-electrophoretic-mobility-vs-ferric-chloride}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Intro:figure-ching-electrophoretic-mobility-vs-ferric-chloride}}} showing that at pH 7.8 the ferric chloride was still negatively charged and yet succeeded in flocculating the suspension to almost the same extent as the ferric chloride at ph 6.0 that was positively charged (see \hyperref[\detokenize{Flocculation/Floc_Intro:figure-ching-residual-turbidity-vs-ferric-chloride}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Intro:figure-ching-residual-turbidity-vs-ferric-chloride}}}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Ching_Electrophoretic_Mobility_vs_Ferric_Chloride}.png}
\caption{\sphinxhref{https://doi.org/10.1016/0043-1354(94)90007-8}{Electrophoretic Mobility for final pH} (after coagulant addition) of 6.0 and 7.8 as a function of \(FeCl_3\) dose}\label{\detokenize{Flocculation/Floc_Intro:id2}}\label{\detokenize{Flocculation/Floc_Intro:figure-ching-electrophoretic-mobility-vs-ferric-chloride}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Ching_Residual_Turbidity_vs_Ferric_Chloride}.png}
\caption{\sphinxhref{https://doi.org/10.1016/0043-1354(94)90007-8}{The settled water turbidity was almost independent of pH even though the electrophoretic mobility was quite different for the two pH values tested}.}\label{\detokenize{Flocculation/Floc_Intro:id3}}\label{\detokenize{Flocculation/Floc_Intro:figure-ching-residual-turbidity-vs-ferric-chloride}}\end{figure}

\sphinxhref{https://doi.org/10.1016/0043-1354(94)90007-8}{At pH 6.0 the ferric hydroxide precipitates are positively charged and at pH 7.8 they are close to neutral}. Thus it is apparent that neutralization of the clay surface charge can not explain these results.


\section{Polymers}
\label{\detokenize{Flocculation/Floc_Intro:polymers}}
Synthetic polymers often made with repeating units of acrylic acid and its derivatives are used to aid flocculation by bridging between particles. For polymer bridging to occur the polymer chains must be able to span the length scale of double-layer repulsion. The thickness of the diffuse layer is about 10 nm at an ionic strength of 1 mM (Coagulants and Flocculants: Theory \& Practice by Yong Kim, 1995). The length of linear polymers ranges from 100 to 1500 nm (\sphinxhref{https://doi.org/10.1021/ma00168a023}{Table 3 of Ying and Chu, 1987}) and thus both synthetic polymers and coagulant nanoparticles can easily span the length scale of double-layer repulsion.

The shortest synthetic polymers are similar in size to the coagulant nanoparticles and the longest synthetic polymers are similar in length to bacteria. These polymers could create additional connections between primary particles and coagulant nanoparticles or they could connect primary particles. In either case the polymers can add connections (more bonds!) that likely have some elasticity and thus there can be more than 3 bonds connecting two particles.

Polymers undoubtedly increase the connections that bind flocs together and thus enable flocs to grow larger. The stronger flocs created by polymer addition may have unintended consequences in subsequent treatment steps. Large strong flocs are great for improved removal in plate or tube settlers. In sedimentation tanks with floc blankets they may form sludge that is more difficult to suspend after a brief shutdown. In filters it is possible that large flocs are more rigid and fail to enter the pore spaces of the filter. Thus the use of polymers may require using large media size for depth filtration. The polymers may also form mudballs in granular filters and thus require more aggressive washing.


\section{Shear Forces and Chemical Bonds}
\label{\detokenize{Flocculation/Floc_Intro:shear-forces-and-chemical-bonds}}
The hydrodynamic force caused by a velocity gradient for two identically sized particles is given by \sphinxhref{https://doi.org/10.1016/0021-9797(71)90244-X}{Goren, 1971}
\begin{equation}\label{equation:Flocculation/Floc_Intro:shear_force_on_doublet}
\begin{split} F_{shear_{max}} = \frac{3 \pi}{4} \mu d_{floc}^2 G\end{split}
\end{equation}
where \(d_{floc}\) is the diameter of each of the two flocs that have joined and \(G\) is the uniform velocity gradient.

The chemical bonds formed by the polymers or the coagulant nanoparticles could be strong, intramolecular bonds such as covalent bonds in which valence electrons are shared, or a non-covalent bond that does not involve sharing electrons. Non-covalent bonds include hydrogen bonding, and Van der Waals forces.

The strength of a polymer chain with carbon-carbon bonds is of the order of 1 to 10 nN (\sphinxhref{https://doi.org/10.1016/S0022-2836(61)80030-2}{Levinthal and Davison, 1961}). Covalent bonds rupture at approximately 1600 pN, noncovalent bonds break at about 160 pN, and hydrogen bonds break at about 4 pN (\sphinxhref{http://www.picotwist.com/index.php?content=smb\&option=odg}{Forces involved at the biological level}).

If we assume that the flocs are joined by 3 bonds to create a constrained connection then we can compare the fluid shear forces that are pulling flocs apart to the strength of potential bonds. The result of this force comparison is shown in \hyperref[\detokenize{Flocculation/Floc_Intro:figure-shear-force-and-bond-strength}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Intro:figure-shear-force-and-bond-strength}}}.

Given that flocs grow to be approximately 1 mm in a 100 Hz flocculator it suggests that the bonds holding the flocs together are either covalent bonds or noncovalent bonds that are stronger than hydrogen bonds. Van der Waals interactions are weaker than hydrogen bonds and thus Van der Waals interactions are not significant for flocculation when using coagulants.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Shear_force_and_bond_strength}.png}
\caption{Fluid forces at two uniform velocity gradients compared with the strength of 3 covalent, noncovalent, or hydrogen bonds. Floc growth in a shear environment is limited by the strength of the chemical bonds that can form as two particles collide.}\label{\detokenize{Flocculation/Floc_Intro:id4}}\label{\detokenize{Flocculation/Floc_Intro:figure-shear-force-and-bond-strength}}\end{figure}

Van der Waals forces have traditionally been viewed as the primary force responsible for holding flocs together after the repulsive electrostatic force was neutralized. The analysis of the forces shown above reveals that Van der Waals forces are too weak to allow the formation of large easily settled flocs in the shear environment of a flocculator. Instead flocculation is based on stronger noncovalent bonds or perhaps even covalent bonds.

Hydrated oxides of polyvalent metals like Fe(III), Al(III), Ti(IV) and Zr(IV) exhibit ligand sorption properties by forming inner-sphere complexes (\sphinxhref{https://doi.org/10.1016/j.reactfunctpolym.2007.07.047}{Sarkar et al, 2007}). In inner-sphere complexes the coagulant nanoparticle forms covalent bonds with the molecules in the surface of the raw water particles. Inner sphere bonds are strong and stable. In contrast, outer sphere bonds include a molecule of water between the two surfaces and form a transient bond.

Given that
1) aluminum and iron coagulant nanoparticles form covalent bonds with arsenic
1) outer sphere complexes are transient
1) the shear forces acting on flocs suggest strong bonds
we conclude that the coagulant nanoparticles likely form covalent bonds with inorganic particles present in raw water.


\section{AguaClara Hydraulic Flocculation Model}
\label{\detokenize{Flocculation/Floc_Intro:aguaclara-hydraulic-flocculation-model}}
The AguaClara hydraulic flocculation model was developed over 15 years of extensive laboratory and field research and is based on the physics of interactions between particles in the raw water, dissolved organic molecules, and coagulant nanoparticles in a shear flow. The AguaClara model is based on the physics of these interactions and is the first non-empirical flocculation model. The AguaClara Hydraulic Flocculation model is described in detail in {\hyperref[\detokenize{Flocculation/Floc_Model:title-flocculation-model}]{\sphinxcrossref{\DUrole{std,std-ref}{Flocculation Model}}}}.


\subsection{Collisions in Shear Flow}
\label{\detokenize{Flocculation/Floc_Intro:collisions-in-shear-flow}}
Given that hydraulic flocculators approach plug flow conditions it is reasonable to assume that at any given location in the flocculator there is a predominance of one size of flocs. Thus collisions between similar sized flocs are most likely because that is what is present. There is also a hydrodynamic reason why collisions between similar sized flocs are favored.

In a shear flow the particles rotate and a boundary layer is created all around the rotating particles. The boundary layer prevents collisions between different sized particles (see \hyperref[\detokenize{Flocculation/Floc_Intro:figure-no-dissimilar-collisions-in-shear}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Intro:figure-no-dissimilar-collisions-in-shear}}}) because the smaller of the two particles is unable to extend through the boundary layer of the larger particle. Only particles that are large enough to extend through each other’s boundary layers can collide (see \hyperref[\detokenize{Flocculation/Floc_Intro:figure-similar-size-collisions-in-shear}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Intro:figure-similar-size-collisions-in-shear}}}). Thus the particles must be similar in size because the boundary layer also scales with the diameter of the particle.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/f095r0Tvgoc}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{no_collisions_when_different_sizes}.png}}\caption{Particles that are very different in size don’t even get close enough to make contact because of the boundary layer around the larger particle. This is because the thickness of the boundary layer also scales with the diameter of the particle.}\label{\detokenize{Flocculation/Floc_Intro:id5}}\label{\detokenize{Flocculation/Floc_Intro:figure-no-dissimilar-collisions-in-shear}}\end{figure}

Collisions between similar sized particles are possible because the particles are able to extend through the boundary layers.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/zP-CK5fNH6Y}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{Similar_Size_Collisions_in_Shear}.png}}\caption{In a shear flow the particles rotate and a boundary layer is created all around the rotating particle. Similar sized particles are able to extend through the boundary layers and make contact.}\label{\detokenize{Flocculation/Floc_Intro:id6}}\label{\detokenize{Flocculation/Floc_Intro:figure-similar-size-collisions-in-shear}}\end{figure}

The rotating boundary layers in a shear flow limit collisions to similar sized particles. Given that flocculation is an environment specifically designed to create fluid shear it is reasonable to assume that only collisions between similar sized particles are able to occur. This simplifies the Smoluchowski equation tremendously.


\section{Number of particles in a floc}
\label{\detokenize{Flocculation/Floc_Intro:number-of-particles-in-a-floc}}
For simplicity of modeling let’s assume that flocs repeatedly double in size as suggested by the movie in \hyperref[\detokenize{Flocculation/Floc_Intro:figure-collisions-in-sequence}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Intro:figure-collisions-in-sequence}}}. In that case, the number of primary particles in a floc is given by
\begin{equation}\label{equation:Flocculation/Floc_Intro:eq_n_primary_of_n_collisions}
\begin{split} n_{primary} = 2^{n_{collisions}}\end{split}
\end{equation}
If we assume (and we will show this assumption to be wrong in the next step) that the floc volume is directly proportional to the total volume of the primary particles in the floc, then we can rearrange \eqref{equation:Flocculation/Floc_Intro:eq_n_primary_of_n_collisions} to solve for the number of sequential collisions required to increase the number of primary particles by a factor of 1000,000,000.
\begin{equation}\label{equation:Flocculation/Floc_Intro:n_collisions_not_fractal}
\begin{split} n_{collisions} = \frac{log(n_{primary})}{log(2)}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{n\PYGZus{}primary} \PYG{o}{=} \PYG{l+m+mi}{1000000000}
\PYG{n}{n\PYGZus{}collisions} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{n\PYGZus{}primary}\PYG{p}{)}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{n\PYGZus{}collisions}\PYG{p}{)}
\end{sphinxVerbatim}

30 sequential collisions would be required to produce a floc that contains 1 billion primary particles.


\section{Flocs are Fractals}
\label{\detokenize{Flocculation/Floc_Intro:flocs-are-fractals}}
As flocs combine they don’t coalesce like mist turning into rain drops. Instead they form loose aggregates that contain a higher and higher fraction of water in the voids between the solid primary particles.

Although the obvious flocculation advantage is that it produces larger aggregates that are easier to remove, it is also \sphinxstylestrong{possible} (this is a hypothesis that needs testing) that a difference in a physical property between primary particles and flocs plays a role in enhanced removal of flocs in floc blankets and filters. For example, the many relatively weak connection points between the primary particles in the flocs enables the flocs to deform. It is possible that deformation plays an important role right at the moment of collision. Presumably the bond strength required to lock the colliding particles together is less if the particles can deform as they are colliding.

The size change produced by flocculation is dramatic. Clay particles and pathogens have sizes that are order \(\mu m\) and they combine to form flocs that are order \(mm\). A thousand fold increase in diameter suggests a billion fold increase in volume.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/tAAC-KY8ZgA}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{Flocs_are_fractals}.png}}\caption{The amount of water contained within a volume defined by the floc increases as the flocs grows.}\label{\detokenize{Flocculation/Floc_Intro:id7}}\label{\detokenize{Flocculation/Floc_Intro:figure-flocs-are-fractals}}\end{figure}


\section{Flocculation is (or used to be) a Slow Process}
\label{\detokenize{Flocculation/Floc_Intro:flocculation-is-or-used-to-be-a-slow-process}}
One of the mysteries of flocculation has been why it is such a slow process, requiring 30 minutes according to conventional design, and yet it appears to be a very rapid process. Plant operators observe that with high raw water turbidities that they can see flocculation progressing after about 0.5 minutes of flocculation. We can estimate the collision potential, \(G\theta\) that corresponds to making visible flocs.
\begin{equation}\label{equation:Flocculation/Floc_Intro:Flocculation/Floc_Intro:0}
\begin{split}\bar G = \sqrt{ \frac{g h_e}{\theta \nu}}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara} \PYG{k}{as} \PYG{n+nn}{sc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{HL\PYGZus{}floc} \PYG{o}{=} \PYG{l+m+mi}{43}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{HRT} \PYG{o}{=} \PYG{l+m+mi}{8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{min}
\PYG{n}{Temperature} \PYG{o}{=}\PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{G\PYGZus{}floc} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity}\PYG{o}{*}\PYG{n}{HL\PYGZus{}floc}\PYG{o}{/}\PYG{p}{(}\PYG{n}{HRT}\PYG{o}{*}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{G\PYGZus{}floc}\PYG{p}{)}
\PYG{n}{Gt\PYGZus{}floc} \PYG{o}{=} \PYG{n}{G\PYGZus{}floc}\PYG{o}{*}\PYG{n}{HRT}
\PYG{n}{HRT\PYGZus{}floc\PYGZus{}visible} \PYG{o}{=} \PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{min}
\PYG{n}{Gt\PYGZus{}floc\PYGZus{}visible} \PYG{o}{=} \PYG{p}{(}\PYG{n}{G\PYGZus{}floc}\PYG{o}{*}\PYG{n}{HRT\PYGZus{}floc\PYGZus{}visible}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{Gt\PYGZus{}floc\PYGZus{}visible}\PYG{p}{)}
\end{sphinxVerbatim}

Here initial flocculation is visible at a \(G\theta\) of less than 3000. Given that flocculation is visible at this low collision potential, it is unclear why recommended \(G\theta\) are as high as 100,000. This is one of the great mysteries that motivated the search for a flocculation model that is based on physics and consistent with laboratory and field observations.


\section{AguaClara Flocculation History}
\label{\detokenize{Flocculation/Floc_Intro:aguaclara-flocculation-history}}
2005 - We used conventional guidelines based on velocity gradient to design the first low flow vertical flocculator

2010 - We designed using energy dissipation rate and accounted for the nonuniformity of the energy dissipation rate (\(\theta\) = 15 minutes)

2015 \textendash{} We added obstacles to decrease the distance between expansions to make all of our flocculators have maximum collision efficiency (\(\theta\) = 8 minutes)

2016 \textendash{} Learned that particle/floc collisions are dominated by viscous shear (not by turbulent eddies). Began designing flocculators based on a target head loss of 40 cm. Used a \(G\theta\) of 37,000.

2017 - Designed a pipe flocculator for the 1 L/s plant with a \(G\theta\) of 20,000 and a residence time of about 100 s.


\section{Conventional vs AguaClara flocculation}
\label{\detokenize{Flocculation/Floc_Intro:conventional-vs-aguaclara-flocculation}}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Conventional vs AguaClara flocculation}\label{\detokenize{Flocculation/Floc_Intro:id8}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
Characteristic
&\sphinxstyletheadfamily 
Conventional - Mechanical
&\sphinxstyletheadfamily 
AguaClara - Hydraulic
\\
\hline
Goal
&
produce large flocs to be captured by sedimentation
&
reduce the concentration of primary particles
\\
\hline
Residence time (min)
&
30
&
2 to 7.5
\\
\hline
Velocity gradient (Hz)
&
20 - 180
&
100+
\\
\hline
\(G\theta\)
&
50,000 - 250,000
&
20,000 - 37,000
\\
\hline
Velocity gradient variability
&
approximately 8
&
approximately 1.4
\\
\hline
reactor type
&
approaching completely mixed
&
approaching plug flow
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\#references \sphinxhref{https://www.iwapublishing.com/news/coagulation-and-flocculation-water-and-wastewater-treatment}{Coagulation and Flocculation in Water and Wastewater Treatment},
iwapublishing


\chapter{Flocculation Model}
\label{\detokenize{Flocculation/Floc_Model:flocculation-model}}\label{\detokenize{Flocculation/Floc_Model:title-flocculation-model}}\label{\detokenize{Flocculation/Floc_Model::doc}}
Particle aggregation is the fundamental mechanism that facilitates ultra low energy and low cost removal of particles and pathogens from water. Aggregation requires successful collisions. Success is defined by particles  attaching when they collide.


\section{Model assumptions}
\label{\detokenize{Flocculation/Floc_Model:model-assumptions}}

\subsection{Key understanding: coagulant nanoparticles are sticky}
\label{\detokenize{Flocculation/Floc_Model:key-understanding-coagulant-nanoparticles-are-sticky}}
Prior to the AguaClara flocculation model it was widely assumed that attachment was made possible by reducing the net surface charge of the particles. The AguaClara flocculation model is based on the understanding that coagulant nanoparticles are sticky and are much larger than the length scale of the repulsive forces due to surface charges. Thus surface charge is largely irrelevant and this explains why particle aggregation begins even with very low dosages of coagulant.


\subsection{Key understanding: Particles follow the fluid}
\label{\detokenize{Flocculation/Floc_Model:key-understanding-particles-follow-the-fluid}}
The collisions are caused by particles having relative motion due to fluid deformation. Particle trajectories can be different from the fluid trajectory if the density of the fluid and the particle are significantly different and if the viscous effects are small compared with inertial effects (the Stokes number). The motion of primary particles and small flocs in surface water treatment have low Stokes numbers and follow the fluid trajectory.


\subsection{Key understanding: Long range transport is the slow part of the collision process}
\label{\detokenize{Flocculation/Floc_Model:key-understanding-long-range-transport-is-the-slow-part-of-the-collision-process}}
We need to calculate the rate of primary particle collisions. In turbulent flow flocculators the fluid deformation is caused by turbulent eddies that lose their energy to viscosity. The relative motion of particles would appear somewhat random as the small eddies have ever changing orientation and intensity. The result is that primary particles take a long meandering path before they finally approach each other and connect in a final collision. The path of relative motion prior to the collision can be thought of as having two distinct components.
\begin{itemize}
\item {} 
The first component is long range transport when the particles are far apart with a separation distance that is proportional to the average distance between particles.

\item {} 
The second component is the short range transport at length scales less than the average particle separation distance to the final collision

\end{itemize}

The AguaClara flocculation model assumes a relatively high velocity and long distance random walk clearing a volume of fluid equal to the volume occupied by a single particle. This is followed by a slow, short, straight walk toward a collision. The insight that the long range transport is the rate limiting step will be used to estimate the time required for particle collisions.


\subsection{Key understanding: Primary particles can’t attach to large flocs during Flocculation}
\label{\detokenize{Flocculation/Floc_Model:key-understanding-primary-particles-can-t-attach-to-large-flocs-during-flocculation}}
In our early modeling work we assumed that collisions between primary particles and large flocs were favorable. This assumption led to the prediction that the highest quality water should be obtained when the raw water has the highest turbidity. That prediction is inconsistent with observations and led to the insight that during flocculation, primary particles are only able to collide successfully with other primary particles (or potentially with other very small flocs).

The only transport mechanism that could cause a clay particle to collide with a large floc is the fluid deformation caused by the linear velocity gradient. In our flocculators that linear velocity gradient is caused by turbulent eddies at much larger scales of the flow. We hypothesize that primary particles can not attach to large flocs because primary particles can not collide with large flocs! To understand why this collision is impossible, we need a simple insight.

The insight is that the large flocs drag fluid around as they rotate (due to the linear velocity gradient). The viscous layer around the large flocs creates a flow field in which there is no location far from the flocs that will eventually approach the surface of the flocs or even approach within the clay particle radius. If this is correct, then clay particles never collide with large flocs in a linear velocity gradient flow field.


\subsection{Key understanding: Relative velocities between particles are dominated by viscous shear}
\label{\detokenize{Flocculation/Floc_Model:key-understanding-relative-velocities-between-particles-are-dominated-by-viscous-shear}}
Relative velocities between particles are dominated by viscous shear because the separation distances are smaller than the inner viscous length scale. The average particle separation distance is given by
\begin{equation}\label{equation:Flocculation/Floc_Model:eq_spacing_of_number_concentration}
\begin{split} \bar \Lambda  = \frac{1}{n_P^{\frac{1}{3}}} = {\rlap{--} V_{\rm{Surround}}}^\frac{1}{3}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(\bar \Lambda\) is the average separation distance
\item[] \(n_P\) is the number of particles per volume of suspension
\item[] \({\rlap{--} V_{\rm{Surround}}}\) is the suspension volume occupied by one particle
\end{DUlineblock}

The number concentration of particles is given by
\begin{equation}\label{equation:Flocculation/Floc_Model:eq_number_concentration_of_diameter}
\begin{split}n_P = \frac{C_P}{\rlap{--} V_P \rho_P} = \frac{6}{\pi \bar{d_P}^3} \frac{C_P}{\rho_P}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(C_P\) is the particle concentration
\item[] \(\rlap{--} V_P\) is the volume of a single particle
\item[] \(\rho_P\) is the particle density
\item[] \(\bar{d_P}\) is the average particle diameter
\end{DUlineblock}

Equations \eqref{equation:Flocculation/Floc_Model:eq_spacing_of_number_concentration} and \eqref{equation:Flocculation/Floc_Model:eq_number_concentration_of_diameter} can be combined to obtain the relationship between separation distance and particle diameter.
\begin{equation}\label{equation:Flocculation/Floc_Model:eq_spacing_of_diameter}
\begin{split} \bar \Lambda  = \frac{1}{n_P^{\frac{1}{3}}} =  \bar{d_P} \left(\frac{\pi}{6}\frac{\rho_P}{C_P}\right)^{\frac{1}{3}}\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=200\sphinxpxdimen]{{Particle_separation}.png}
\caption{The average particle separation distance is defined as the distance between centers of cubes that each contain the volume of the suspension occupied by a single particle.}\label{\detokenize{Flocculation/Floc_Model:id30}}\label{\detokenize{Flocculation/Floc_Model:figure-particle-separation}}\end{figure}

Particle separation distance matters because it determines which transport mechanisms are at play when two particles approach for a collision. The particle separation distance is a function of the particle concentration. Surface water treatment plants commonly treat water with turbidity between 1 and 1000 NTU. We will first find the number of clay particles per liter in typical raw water suspensions.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{constants} \PYG{k}{as} \PYG{n+nn}{con}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{environmental\PYGZus{}processes\PYGZus{}analysis} \PYG{k}{as} \PYG{n+nn}{epa}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{n}{C\PYGZus{}Clay} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{n\PYGZus{}Clay} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{num\PYGZus{}clay}\PYG{p}{(}\PYG{n}{C\PYGZus{}Clay}\PYG{p}{,}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{loglog}\PYG{p}{(}\PYG{n}{C\PYGZus{}Clay}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}\PYG{p}{)}\PYG{p}{,}\PYG{n}{n\PYGZus{}Clay}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Clay concentration (\PYGZdl{}NTU\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Number of clay per liter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/NClay\PYGZus{}vs\PYGZus{}CClay}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{NClay_vs_CClay}.png}
\caption{Diagram of number of clay particles per liter as a function of the clay concentration. Note that even 1 NTU water has millions of primary particles per liter.}\label{\detokenize{Flocculation/Floc_Model:id31}}\label{\detokenize{Flocculation/Floc_Model:figure-nclay-vs-cclay}}\end{figure}

The next step is to calculate the separation distance between the clay particles over this range of clay concentrations using equation \eqref{equation:Flocculation/Floc_Model:eq_spacing_of_diameter}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{constants} \PYG{k}{as} \PYG{n+nn}{con}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{environmental\PYGZus{}processes\PYGZus{}analysis} \PYG{k}{as} \PYG{n+nn}{epa}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{n}{lamda\PYGZus{}Clay} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{(}\PYG{n}{C\PYGZus{}Clay}\PYG{p}{,}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{C\PYGZus{}Clay}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}\PYG{p}{)}\PYG{p}{,}\PYG{n}{lamda\PYGZus{}Clay}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Clay concentration (\PYGZdl{}NTU\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Clay separation distance (\PYGZdl{}mm\PYGZdl{})}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/LambdaClay\PYGZus{}vs\PYGZus{}CClay}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{LambdaClay_vs_CClay}.png}
\caption{The clay separation distance varies with the cube root of the concentration and thus varies over a relatively narrow range (0.07 mm to 0.7 mm) while the turbidity varies from 1 to 1000 NTU.}\label{\detokenize{Flocculation/Floc_Model:id32}}\label{\detokenize{Flocculation/Floc_Model:figure-lambdaclay-vs-cclay}}\end{figure}

Given this range of particle separation distances the next question is whether transport of these particles relative to each other is driven by inertial or viscous dominated processes. Turbulent eddies devolve into smaller and smaller eddies until viscosity finally kills them. Viscosity damps out the effects of inertia at the inner viscous length scale.  Higher intensity turbulence can generate more energetic small eddies and can resist the effects of viscosity longer. Thus the inner viscous length scale decreases as the turbulent energy dissipation rate increases.

The Camp-Stein velocity gradient used for flocculators varies from about 20 to 300 Hz. We will convert the Camp-Stein velocity gradient to an energy dissipation rate using
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:0}
\begin{split}G_{CS} = \sqrt{\frac{\bar \varepsilon}{\nu}}\end{split}
\end{equation}
Solving for the average energy dissipation rate, \(\bar \varepsilon\), we obtain
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:1}
\begin{split}\bar \varepsilon = \nu G_{CS}^2\end{split}
\end{equation}
We will use the inner viscous length scale, equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_inner_viscous_length} to determine whether viscous or inertial transport dominates particle collisions in surface water treatment given the range of particle separation distances (see \hyperref[\detokenize{Flocculation/Floc_Model:figure-lambdaclay-vs-cclay}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-lambdaclay-vs-cclay}}}).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{constants} \PYG{k}{as} \PYG{n+nn}{con}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{environmental\PYGZus{}processes\PYGZus{}analysis} \PYG{k}{as} \PYG{n+nn}{epa}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{n}{Temperature} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{G}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}
\PYG{n}{EDR} \PYG{o}{=} \PYG{n}{G}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}
\PYG{n}{Inner\PYGZus{}viscous} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{lambda\PYGZus{}vel}\PYG{p}{(}\PYG{n}{EDR}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{semilogx}\PYG{p}{(}\PYG{n}{G}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}\PYG{p}{)}\PYG{p}{,}\PYG{n}{Inner\PYGZus{}viscous}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Velocity gradient (Hz)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Inner viscous length scale (mm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{30}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Eddies cause mixing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{n}{rotation}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{30}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{text}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{14}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Viscous shear}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fontsize}\PYG{o}{=}\PYG{l+m+mi}{12}\PYG{p}{,}\PYG{n}{rotation}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{30}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/innerviscous\PYGZus{}vs\PYGZus{}G}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{innerviscous_vs_G}.png}
\caption{The inner viscous length scale is approximately 3 to 10 mm for velocity gradients that are typically used in flocculators. Clay separation distances are smaller than the inner viscous length scale and thus viscous shear dominates particle collisions in flocculation.}\label{\detokenize{Flocculation/Floc_Model:id33}}\label{\detokenize{Flocculation/Floc_Model:figure-innerviscous-vs-g}}\end{figure}

By comparing \hyperref[\detokenize{Flocculation/Floc_Model:figure-lambdaclay-vs-cclay}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-lambdaclay-vs-cclay}}} and \hyperref[\detokenize{Flocculation/Floc_Model:figure-innerviscous-vs-g}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-innerviscous-vs-g}}} it is apparent that the particle separation distances commonly found in surface water treatment plants are much smaller than the inner viscous length scale for all practical flocculation velocity gradients. Thus viscosity will dominate the flocculation process. This key insight reveals why turbulent flow flocculators have been designed using the dimensionless grouping \(G \theta\) which is fundamentally \(\sqrt\frac{\epsilon}{\nu} \theta\). Given that flocculation is viscous dominated implies that the flocculation process will slow down as the temperature increases and the viscosity increases.


\subsection{Collision time estimate}
\label{\detokenize{Flocculation/Floc_Model:collision-time-estimate}}
Now that we know that the collisions are controlled by viscosity we can begin formulating a model that describes the long distance random walk. The long range transport is assumed to be the rate limiting step. We model a system of two particles where one particle is held fixed and we observe the second particle’s random motion. It may be helpful to visualize this by playing the video inside your mind in reverse starting from the moment of the collision. That way you know which two particles to follow! The random walk is illustrated in the video in \hyperref[\detokenize{Flocculation/Floc_Model:figure-random-walk}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-random-walk}}}.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/I9sEOJ-kB3A}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{Random_walk}.png}}\caption{The red volume represents the potential end zone of the random walk that will slide into a collision with a short straight slow walk. The wandering particle sweeps through a volume of water equal to the volume occupied by a single particle.}\label{\detokenize{Flocculation/Floc_Model:id34}}\label{\detokenize{Flocculation/Floc_Model:figure-random-walk}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/BtG-IxCGAUk}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{Final_approach}.png}}\caption{The final approach is the slow, straight path to the collision.}\label{\detokenize{Flocculation/Floc_Model:id35}}\label{\detokenize{Flocculation/Floc_Model:figure-final-approach}}\end{figure}

The volume cleared by the wandering particle is proportional to the area defined by a circle with diameter = sum of the particle diameters. This is because the wandering particle with strike the stationary particle if the wandering particle’s center is anywhere within a diameter of the center of the stationary particle.
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:2}
\begin{split}{\rlap{--} V_{\rm{Cleared}}} \propto \pi \bar d_P^2\end{split}
\end{equation}
The volume cleared is proportional to time
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:3}
\begin{split}{\rlap{--} V_{\rm{Cleared}}} \propto t\end{split}
\end{equation}
The volume cleared is proportional to the relative velocity between the two particles.
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:4}
\begin{split}{\rlap{--} V_{\rm{Cleared}}} \propto \bar v_r\end{split}
\end{equation}
We use dimensional analysis to get a relative velocity for the long range transport controlled by shear. The relative velocity between the two particles that will eventually collide is assumed to be proportional to the average distance between the two particles.

The assumption that the relative velocity scales with the average distance between clay particles leads to the following steps. The first step is just a proposed functional relationship. We could also have jumped to the assumption that the relative velocity is a function of the length scale and the velocity gradient.
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:5}
\begin{split}\bar v_r = f \left( \bar \varepsilon ,\nu ,\bar \Lambda \right)\end{split}
\end{equation}
In a uniform shear environment the velocity gradient is linear. Thus the relative velocity must be proportional to the length scale.
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:6}
\begin{split}\bar v_r = \bar \Lambda f \left( \bar \varepsilon ,\nu \right)\end{split}
\end{equation}
The only way to for \(\bar \varepsilon\) and \(\nu\) to produce dimensions of time is to combine to create \(1/\bar G_{CS}\).
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:7}
\begin{split}\bar v_r \approx \bar \Lambda \bar G_{CS}\end{split}
\end{equation}
The volume cleared, \({\rlap{--} V_{\rm{Cleared}}}\) must equal the volume occupied by one particle, \({\rlap{--} V_{\rm{Surround}}}\) for a collision to occur. Combining the three equations for \({\rlap{--} V_{\rm{Cleared}}}\) and the equation for \(v_r\) we obtain the volume cleared as a function of time.
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:8}
\begin{split}\bar \Lambda^3 = {\rlap{--} V_{\rm{Surround}}} = {\rlap{--} V_{\rm{Cleared}}} \approx \pi \bar d_P^2 \bar \Lambda \bar G_{CS} \bar t_c\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(\bar t_c\) is the average time required for a collision between two particles
\end{DUlineblock}

Solving for the collision time we obtain
\begin{equation}\label{equation:Flocculation/Floc_Model:tc}
\begin{split}\bar t_c \approx \frac{\bar \Lambda^2}{\pi \bar d_P^2 \bar G_{CS}}\end{split}
\end{equation}
In summary, a relationship for the mean time between collisions \(\bar{t_{c}}\) was found by proposing an average condition for a collision, successful or unsuccessful, to occur. To define this condition, it was assumed that each primary particle on average occupies a fraction of the reactor volume, \(\bar{V}_{Surround}\), inversely proportional to the number concentration of particles. Furthermore, prior to a collision, a particle on average sweeps a volume, \(\bar{V}_{Cleared}\), proportional to \(\bar{t_c}\) and to the mean relative velocity between approaching particles, \(\bar{v}_r\). As an average condition, it was posited that for each collision, \(\bar{V}_{Cleared}\) must equal \(\bar{V}_{Surround}\). From this, a relationship for a characteristic collision time, \(\bar{t_c}\), was obtained:


\subsection{Collision Rates}
\label{\detokenize{Flocculation/Floc_Model:collision-rates}}\label{\detokenize{Flocculation/Floc_Model:heading-floc-collision-rates}}
The change in the number of successful collisions (from a single particle’s perspective) with respect to time is equal to the mean probability that a collision will result in an attachment, \(\bar{\alpha}\), divided by time for one collision, \(\bar t_c\).
\begin{equation}\label{equation:Flocculation/Floc_Model:dNc}
\begin{split}      \frac{dN_c}{dt}=\frac{\bar{\alpha}}{\bar{t_{c}}},\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where
\item[] \(\frac{dN_c}{dt}\) is the rate of successful collisions between primary particles,
\item[] \(\bar{\alpha}\) is the mean probability that a collision will result in an attachment,
\item[] \(\bar{t_{c}}\) is the mean time between collisions of primary particles.
\end{DUlineblock}

The probability that two primary particles attach is expected to be equal to the probability that at least one of the colliding particles has a precipitated coagulant nanoparticle at the initial contact point. It is simpler to derive the probability of attachment from the probability that neither particle has a coagulant nanoparticle at the point where the two particles collide, since the probability of a successful collision includes the probabilities of one particle and of both particles having a coagulant precipitate. The probability of one particle colliding at a point without a coagulant precipitate is \((1-\bar{\Gamma})\), so the probability of neither particle having a coagulant precipitate at the point of collision is \((1-\bar{\Gamma})^2\). As this is the probability of a failed collision, the probability of a successful collision is \(1-(1-\bar{\Gamma})^2\).

Since the model assumes an initially monodisperse population of primary particles and that collisions between differently-sized particles are unfavorable, differential sedimentation is considered negligible.  Brownian motion is only significant for particles smaller than 1 \(\mu m\) \phantomsection\label{\detokenize{Flocculation/Floc_Model:id1}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-benjamin-water-2013}]{\sphinxcrossref{{[}BL13{]}}}}, and so this model makes the assumption that primary particles are larger than 1 \(\mu m\).

The collision rate \phantomsection\label{\detokenize{Flocculation/Floc_Model:id2}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-pennock-theoretical-2016}]{\sphinxcrossref{{[}PCWSL16{]}}}} can be obtained by substituting equation \eqref{equation:Flocculation/Floc_Model:tc} into equation \eqref{equation:Flocculation/Floc_Model:dNc}.
\begin{equation}\label{equation:Flocculation/Floc_Model:Nclam}
\begin{split}       \frac{dN_{c}}{dt}=\pi\bar{\alpha}\frac{\bar{d}_{P}^2}{\bar \Lambda^2} \bar G_{CS}\end{split}
\end{equation}
where \(\bar G_{CS}\) is the Camp Stein velocity gradient.

Because the flocculation performance equation will ultimately track particle concentration, the concentration of primary particles, \(C_{P}\), was substituted for \(\bar \Lambda\) using
\begin{equation}\label{equation:Flocculation/Floc_Model:Ld}
\begin{split}      \bar \Lambda^3=\frac{\pi}{6}\frac{\rho_{P}}{C_{P}}\bar{d}_P^3,\end{split}
\end{equation}
where \(\rho_{P}\) is the characteristic density of primary particles. Equation \eqref{equation:Flocculation/Floc_Model:Ld} can be substituted into Equation \eqref{equation:Flocculation/Floc_Model:Nclam} to result in:
\begin{equation}\label{equation:Flocculation/Floc_Model:Ncld}
\begin{split}dN_{c}=\pi\bar{\alpha}\left(\frac{6}{\pi}\frac{C_{P}}{\rho_P}\right)^{2/3}\bar G_{CS}dt.\end{split}
\end{equation}
Equation \eqref{equation:Flocculation/Floc_Model:Ncld} reveals that \(\frac{dN_c}{dt}\) increases with \(C_P\) and \(\bar{\Gamma}\). During flocculation
\(C_P\) will decrease and thus \(\frac{dN_c}{dt}\) will also decrease.


\subsection{Coagulant nanoparticle and primary particle Model}
\label{\detokenize{Flocculation/Floc_Model:coagulant-nanoparticle-and-primary-particle-model}}
Continuing from \phantomsection\label{\detokenize{Flocculation/Floc_Model:id3}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-pennock-theoretical-2016}]{\sphinxcrossref{{[}PCWSL16{]}}}}, the above Lagrangian differential relationships are further developed to become integrated performance prediction equations. Equation \eqref{equation:Flocculation/Floc_Model:Ncld} cannot be integrated as written because the concentration of primary particles is expected to change with each collision, and thus that relationship must be specified. During the average time required for one collision it is expected that approximately \(e^{-1}\) of the particles will undergo at least one collision. The time required for a collision will change as flocculation proceeds as the average distance between primary particles increases. The rate of loss of primary particles due to successful collisions will be first order with respect to the number of successful collisions.
\begin{equation}\label{equation:Flocculation/Floc_Model:dCP}
\begin{split}      \frac{dC_{P}}{dN_{c}}=-kC_{P},\end{split}
\end{equation}
where \(k\) is an experimentally-derived constant that physically represents the portion of the primary particles that become settleable particles on average after each collision time, \(\bar{t_c}\), and will depend, in part, upon the design capture velocity, \(\bar v_c\), used for sedimentation. Since \(\bar{t_c}\) increases over time as \(\bar \Lambda\) increases, the above formulation is not proportional to \(\frac{dC_P}{dt}\). Physically, Equation \eqref{equation:Flocculation/Floc_Model:dCP} states that, with each progressive primary particle collision, \(C_P\) decreases by some proportion. Further, Equation \eqref{equation:Flocculation/Floc_Model:dCP} states that this decrease is directly proportional to \(C_P\). With each successive successful collision, the absolute reduction in \(C_P\) is less than the prior one. The value of \(k\) is expected to be less than 1, because not all primary particles will have a collision and grow to a size with a sedimentation velocity greater than \(\bar v_c\) in the average time required for a collision.

Having Equation \eqref{equation:Flocculation/Floc_Model:dCP}, the next step is to substitute it into Equation \eqref{equation:Flocculation/Floc_Model:Ncld} and integrate. Solving Equation \eqref{equation:Flocculation/Floc_Model:dCP} for \(dN_{c}\), substituting it into Equation \eqref{equation:Flocculation/Floc_Model:Ncld} and rewriting the equations in terms of primary particles results in Equation \eqref{equation:Flocculation/Floc_Model:dCPlam},
\begin{equation}\label{equation:Flocculation/Floc_Model:dCPlam}
\begin{split}      \frac{dC_{P}}{-kC_{P}}=\pi\bar{\alpha}\left(\frac{6}{\pi}\frac{C_{P}}{\rho_P}\right)^{2/3}\bar G_{CS}dt,\end{split}
\end{equation}
It is interesting to note that rearranging Equation \eqref{equation:Flocculation/Floc_Model:dCPlam} in terms of \(\frac{dC_P}{dt}\) gives a \(C_P\) exponent of \(\frac{5}{3}\). Previous flocculation rate equations were second-order, but the observed flocculation rate was less than second-order \phantomsection\label{\detokenize{Flocculation/Floc_Model:id4}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-benjamin-water-2013}]{\sphinxcrossref{{[}BL13{]}}}}. The slight deviation from an exponent of two comes from the assumption of \phantomsection\label{\detokenize{Flocculation/Floc_Model:id5}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-pennock-theoretical-2016}]{\sphinxcrossref{{[}PCWSL16{]}}}} that relative velocity between colliding particles scales with \(\Lambda\) rather than \(d_P\). This is to say that, in dilute suspensions characteristic of raw water, where particles are separated by \(\bar \Lambda\gg \bar{d}_P\), the majority of \(\bar{t_c}\) is spent with the distance between particles characterized by \(\bar \Lambda\) instead of \(\bar{d}_P\). The time required for the final approach for a collision is hypothesized to be insignificant compared the time for \(\bar{V}_Cleared\) to equal \(\bar{V}_Surround\).

From Equation \eqref{equation:Flocculation/Floc_Model:dCPlam} it is possible to integrate and obtain equations for flocculation performance. After separation of variables, one side of the equation is integrated with respect to time from the initial time (\(t=0\)) to the time of interest, generally taken to be the mean hydraulic residence time (\(t=\theta\)). The other side of the equation is integrated with respect to the concentration of primary particles from the value at the initial time (\(C_{P_0}\)), equivalent to the initial concentration of primary particles, to the concentration of primary particles at the time of interest (\(C_{P}\)). The integral becomes:
\begin{equation}\label{equation:Flocculation/Floc_Model:intdCPlam}
\begin{split}      \frac{1}{\pi}\left(\rho_{P}\frac{\pi}{6}\right)^{2/3}\int_{C_{P_0}}^{C_{P}}C_{P}^{-5/3}dC_{P}=-k\bar{\alpha}\bar G_{CS}\int_0^\theta dt.\end{split}
\end{equation}
The integral on the left hand side assumes that \(\rho_{P}\) does not change as \(C_P\) changes. One assumption on the right side is that \(\bar{\Gamma}\), of which \(\bar{\alpha}\) is a function, does not vary with \(t\). This requires that adsorption of coagulant to colloidal particles in rapid mix be fast enough to be approximated as completed by the beginning of flocculation. This assumption may not be valid for high rate flocculators especially under conditions of low \(C_{P_0}\). Further work on the rate and efficacy of coagulant nanoparticle attachment to primary particle surfaces is needed.

The other assumption on the right hand side is that the mean velocity gradient, \(\bar G_{CS}\), does not change over the course of the flocculation process. In mechanically-mixed flocculators, the use of a simple spatial average is not reasonable, as the velocity gradient changes dramatically from the bulk flow to the tip of the impeller blade and individual particles follow different paths that expose them to different velocity gradient zones in different sequences and durations \phantomsection\label{\detokenize{Flocculation/Floc_Model:id6}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-boller-particles-1998}]{\sphinxcrossref{{[}BB98{]}}}}. The distribution of residence times in a mechanical flocculator would also need to be taken into account for the integration. For baffled hydraulic flocculators, on the other hand, the use of the spatial average, \(\bar G_{CS}\), and considering it constant with \(t\) is generally a reasonable approximation, as mixing energy in a well-designed hydraulic flocculator is rather uniformly distributed spatially, the zones of higher energy dissipation rate after the baffles do not vary appreciably with time when operating at a constant flow rate, and all particles have similar residence times in the flocculator.

Integration of Equation \eqref{equation:Flocculation/Floc_Model:intdCPlam} gives:
\begin{equation}\label{equation:Flocculation/Floc_Model:CPlamint}
\begin{split}      \frac{3}{2\pi}\left(\rho_{P}\frac{\pi}{6}\right)^{2/3}\left(C_{P}^{-2/3}-C_{P_0}^{-2/3}\right)=k\bar{\alpha}\bar G_{CS}\theta.\end{split}
\end{equation}
This can be put in terms of \(\bar \Lambda\) for simplicity by using Equation \eqref{equation:Flocculation/Floc_Model:Ld} and rearranging in terms of the familiar Camp-Stein parameter, \(\bar G_{CS}\theta\), to be
\begin{equation}\label{equation:Flocculation/Floc_Model:Gtlam}
\begin{split}      \bar G_{CS}\theta = \frac{3}{2}\frac{{\left( {{\bar \Lambda ^2} - \bar \Lambda _0^2} \right)}}{{k\pi\bar{\alpha} \bar{d}_P^2}}.\end{split}
\end{equation}
Equation \eqref{equation:Flocculation/Floc_Model:Gtlam} gives guidance for flocculator design in that higher values of \(\bar G_{CS}\theta\) are needed for flocculators to achieve greater changes in \(\bar \Lambda\) (or \(C_P\)) or to overcome low \(\bar{\Gamma}\). It should be noted that the \(\bar \Lambda_0\) term in Equation \eqref{equation:Flocculation/Floc_Model:Gtlam} will generally be very small compared to the \(\bar \Lambda\) term for most flocculation scenarios. In this case the initial particle separation distance, \(\bar \Lambda_0\) can be considered negligible. While simplifying the equation, this also gives the result that \sphinxstylestrong{flocculators must be designed} not so much for the particle concentrations they will receive but \sphinxstylestrong{for the particle concentrations they are intended to produce}.

Modifying Equation \eqref{equation:Flocculation/Floc_Model:Gtlam} to be in terms of \(C_P\) produces:
\begin{equation}\label{equation:Flocculation/Floc_Model:GtlamSim}
\begin{split}      \bar G_{CS}\theta = \frac{3}{2k\pi\bar{\alpha}}\left(\frac{\pi}{6}\frac{\rho_P}{C_P}\right)^{2/3}.\end{split}
\end{equation}
A desirable way to represent flocculation performance is with the negative log of the fraction of particles remaining (also often referred to as log removal), \(pC^*\), given in \phantomsection\label{\detokenize{Flocculation/Floc_Model:id7}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}]{\sphinxcrossref{{[}SWSL14{]}}}} as:
\begin{equation}\label{equation:Flocculation/Floc_Model:pC}
\begin{split}      p{C^*}=-\log_{10}\left(\frac{C_{P}}{C_{P_0}}\right)\end{split}
\end{equation}
Likewise, a way to simplify Equation \eqref{equation:Flocculation/Floc_Model:CPlamint} is to put it in terms of the particle volume fraction, \(\phi\), defined as:
\begin{equation}\label{equation:Flocculation/Floc_Model:phi}
\begin{split}      \phi=\frac{C_P}{\rho_P}=\frac{\pi}{6}\left(\frac{\bar{d}_P}{\bar \Lambda}\right)^3.\end{split}
\end{equation}
Putting Equation \eqref{equation:Flocculation/Floc_Model:CPlamint} in terms of \(pC^*\) and
\(\phi\) results in:
\begin{equation}\label{equation:Flocculation/Floc_Model:pClam}
\begin{split}      p{C^*}=\frac{3}{2}\log_{10}\left[\frac{2}{3}\left(\frac{6}{\pi}\right)^{2/3}k\pi\bar{\alpha}\bar G_{CS}\theta\phi_0^{2/3}+1\right].\end{split}
\end{equation}
Equation \eqref{equation:Flocculation/Floc_Model:pClam} is a predictive performance model for flocculation in flows with long range particle transport toward collisions dominated by viscous forces. It is proposed as applicable to both laminar and turbulent hydraulic flocculators. Given the properties of the flocculator (\(\bar G_{CS}\) and \(\theta\)) and its influent (\(\phi_0\) and \(\bar{\alpha}\)), flocculation performance can be predicted in terms of \(pC^*\). The development of Equation \eqref{equation:Flocculation/Floc_Model:pClam} was the result of a team effort of Cornell University’s AguaClara program and hence it will be subsequently referred to as the AguaClara flocculation model.


\subsection{Experimental Protocols}
\label{\detokenize{Flocculation/Floc_Model:experimental-protocols}}
Equation \eqref{equation:Flocculation/Floc_Model:pClam} was tested under turbulent conditions. The design scheme chosen to meet these requirements was a tube flocculator, illustrated in \hyperref[\detokenize{Flocculation/Floc_Model:figure-apparatus}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-apparatus}}} and described in \phantomsection\label{\detokenize{Flocculation/Floc_Model:id8}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-pennock-theoretical-2016}]{\sphinxcrossref{{[}PCWSL16{]}}}}. This tube flocculator operated in the turbulent flow regime, which for pipe flow means that \(Re>4,000\) \phantomsection\label{\detokenize{Flocculation/Floc_Model:id9}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-granger-fluid-1995}]{\sphinxcrossref{{[}Gra95{]}}}}. The change in mean energy dissipation rate due to any modification to the system was approximated by
\begin{equation}\label{equation:Flocculation/Floc_Model:EDR}
\begin{split}      \bar{\varepsilon}=\frac{gh_\ell}{\theta},\end{split}
\end{equation}
where \(g\) is the acceleration due to gravitational force and \(h_\ell\) is the head loss across the flocculator. As mentioned previously, the use of \(\bar{\varepsilon}\) assumes that the energy dissipation rate throughout the flocculator is completely uniform so that it can be represented with a simple spatial average rather than a weighted average accounting for the proportion of the flow passing through different zones of energy dissipation rate. This approximation requires that the majority of energy dissipation (represented by head loss) is due to fluid shear (minor loss) in the bulk flow. If the head loss across a flocculator were primarily as a result of shear on the reactor walls (major loss), only a small fraction of the flow would experience this energy dissipation rate in the near-wall zone, and estimating the mean energy dissipation rate by this method would be invalid.

It is hypothesized, however, that the constrictions in the tube flocculator created submerged free jets downstream, generating fluid shear across the cross section of the flow \phantomsection\label{\detokenize{Flocculation/Floc_Model:id10}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-pennock-theoretical-2016}]{\sphinxcrossref{{[}PCWSL16{]}}}}. This hypothesis is supported by a calculation of the head loss due to wall shear using the Darcy-Weisbach equation \phantomsection\label{\detokenize{Flocculation/Floc_Model:id11}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-granger-fluid-1995}]{\sphinxcrossref{{[}Gra95{]}}}}. The turbulent tube flocculator would be expected to have a total head loss of around 7 cm if only wall shear were present, but an average head loss of 90 cm was measured across the flocculator by means of a differential pressure sensor, indicating that significant fluid shear is present.

Referring to Equation \eqref{equation:Flocculation/Floc_Model:EDR}, changing the head loss by changing the constriction of the tubes or changing the water elevation difference across the flocculator would change the energy dissipation rate. Likewise, either of the above two modifications would change the mean hydraulic residence time in the flocculator. This could also be accomplished by changing the length of the flocculator.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{PennockFig1}.png}
\caption{Diagram of Turbulent Tube Flocculator adapted from \label{\detokenize{Flocculation/Floc_Model:id12}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-pennock-theoretical-2016}]{\sphinxcrossref{{[}PCWSL16{]}}}} with modifications made to the outlet weir system and the addition of strong base solution.}\label{\detokenize{Flocculation/Floc_Model:id36}}\label{\detokenize{Flocculation/Floc_Model:figure-apparatus}}\end{figure}

\hyperref[\detokenize{Flocculation/Floc_Model:figure-apparatus}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-apparatus}}} illustrates the process sequence used in this study. At the beginning of the process, tap water from the Cornell University Water Filtration Plant came into the system with, on average, a pH of 7.67, a turbidity of 0.056 nephelometric turbidity units (NTU), a total hardness of 150 mg/L, a total alkalinity of 140 mg/L, and a dissolved organic carbon (DOC) concentration of 1.80 mg/L \phantomsection\label{\detokenize{Flocculation/Floc_Model:id13}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-bp-mws-drinking-2016}]{\sphinxcrossref{{[}BPMWSCIWSCUWS16{]}}}}. This water was temperature-controlled by means of a PID (proportional-integral-derivative) controller, which regulated the relative fractions of hot water and cold water used to maintain the level in the constant head tank. The temperature-controlled water was passed through a granular activated carbon (GAC) filter to reduce the effect of dissolved organic matter (DOM) on experimental results. The water was then sent to the constant head tank, where it was bubbled with air to strip out supersaturated dissolved gases that might come out of solution during the experiment, resulting in formation of bubbles.

From the constant head tank, this conditioned water was delivered to the turbulent tube flocculator. Before entry to the flocculator, the water was set at a constant primary particle concentration by means of a computer-controlled peristaltic pump that introduced a concentrated kaolinite clay suspension (R.T. Vanderbilt Co., Inc., Norwalk, Connecticut) of about 250 g/L. A fraction of the mixed flow was sampled by a peristaltic pump and analyzed for turbidity with an HF Scientific MicroTOL turbidimeter at a distance of greater than ten diameters downstream from the clay input and then reintroduced at the point where clay suspension was added. This turbidity reading was input into a PID control system which determined the speed of the clay pump according to the discrepancy between the influent turbidity and the experimental target value.

Along with the clay, strong base (NaOH) manufactured by Sigma-Aldrich (St. Louis, MO) was added upstream of the flocculator with a peristaltic pump to keep the pH of the water at \(7.5\pm0.5\), which was the criterion set for the pH in these experiments. In the winter, the pH of the tap water dropped close to 7, and so sufficient NaOH was added to account for seasonal variations in the natural base-neutralizing capacity (BNC) of the water and to raise the pH above 7 to around 7.5.  This base addition was also sufficient to neutralize the acidity of the polyaluminum chloride (PACl) coagulant used for this study, which had been found to impact the solubility of PACl at high doses. Base doses were calculated to account for the normality of the PACl solution, based on a titration which found that the PACl solution was approximately 0.025 equivalents of strong acid per gram as Al.

Just prior to entering the flocculator,  PACl coagulant (PCH-180) manufactured by the Holland Company, Inc. (Adams, Massachusetts) was added to the flow by a computer-controlled peristaltic pump which varied the coagulant dose between experiments. After entering the system, the coagulant then entered a small orifice used to accomplish rapid mix by forming a jet downstream. From there, the suspension traveled up through the flocculator made of 3.18 cm (1.25 in) inner diameter tubing. Within the flocculator, the fluid passed through constrictions in the tubing that caused the flow to contract, resulting in flow expansions afterward and achieving increased mixing and energy dissipation.

After leaving the flocculator, the flow passed a vertical tube with a free surface that served as an air release. This removed bubbles in the system so that they would not interfere with settling or analysis of the flocs. A portion of the flow was then diverted for sedimentation by means of a peristaltic pump up a clear one-inch PVC pipe angled at \(60^{\circ}\). The flow rate through the pump was selected based on the dimensions of the tube and its angle to achieve a desired capture velocity, \(\bar v_c\). The supernatant from this tube settler was passed through an HF Scientific MicroTOL nephelometric turbidimeter to record the effluent turbidity for the duration of the experiment. Recording the settled effluent turbidity made it possible to calculate the \(pC^*\) term in Equations \eqref{equation:Flocculation/Floc_Model:pClam} (in terms of primary particles) and also made possible comparison with data from \phantomsection\label{\detokenize{Flocculation/Floc_Model:id14}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}]{\sphinxcrossref{{[}SWSL14{]}}}}.

After data from the settled flocs had been collected, the flow from the effluent turbidimeter was sent to the drain along with the bulk flow. The bulk flow traveled past a second air release before exiting the drain. The air release gave the flow exiting the drain a free surface as it flowed over the exit weir so that the exiting water developed into a supercritical flow. Thus, the flow over the weir was not influenced by the flow downstream of the free surface, and the flow rate could be controlled by adjusting the elevation of the free surface before the drain. The outlet weir was a 1-1/4” PVC pipe within an upright 3” clear pipe, which were joined by a flexible coupling adapter. The effluent water accumulated in the clear outer pipe until it reached the elevation of the top of the inner pipe and flowed down through it. The flow rate could be adjusted by loosening the flexible coupling so that the elevation of the top of the inner pipe could be adjusted. As the bulk flow exited down out of the inner pipe to the drain, it passed over a glass electrode sensor to
measure pH.


\subsection{Results}
\label{\detokenize{Flocculation/Floc_Model:results}}
The above process was used to conduct the experiments to test the applicability of Equation \eqref{equation:Flocculation/Floc_Model:pClam} in turbulent flocculation. The influent turbidity was set at a constant of 900 NTU. The mean energy dissipation rate was about 21.5 mW/kg, which resulted from choosing a flow rate of about 110 mL/s so that the Reynolds number was just above 4,000. These values were chosen to ensure viscous-dominated turbulent initial conditions. For these experiments, coagulant doses ranged from 0.05 to 98 mg/L as Al. A \(\bar v_c\) of 0.12 mm/s was used for all experiments. Data from these nominally viscous experiments are shown in \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig2}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig2}}} as a function of coagulant dose.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{PennockFig2}.png}
\caption{Effluent turbidity as a function of coagulant dose for experiments performed with influent turbidity of 900 NTU, velocity gradient of 147/s, and hydraulic residence time of about 413 s.}\label{\detokenize{Flocculation/Floc_Model:id37}}\label{\detokenize{Flocculation/Floc_Model:figure-pennockfig2}}\end{figure}

The data shown in \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig2}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig2}}} were compared with the viscous model, as shown in \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig3}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig3}}}.
In this graph, the data are plotted in terms of Equation \eqref{equation:Flocculation/Floc_Model:pClam} and its corresponding composite parameter taken from Equation \eqref{equation:Flocculation/Floc_Model:Nclam},
\begin{equation}\label{equation:Flocculation/Floc_Model:Paramlam}
\begin{split}      N_{c}\propto\bar{\alpha}\theta \bar G_{CS}\phi_0^{2/3}.\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{PennockFig3}.png}
\caption{Fit of Equation \eqref{equation:Flocculation/Floc_Model:pClam} to data from \(Re\approx 4,000\) experiments. Hollow points indicate data not used in fitting the model.}\label{\detokenize{Flocculation/Floc_Model:id38}}\label{\detokenize{Flocculation/Floc_Model:figure-pennockfig3}}\end{figure}

At the highest values, however, a marked decrease begins. For these graphs, the model fits were done for all points where increasing performance was seen, because the model does not currently include a mechanism for the decreasing performance. The values for \(k\) were determined by the Levenberg-Marquardt algorithm, and the value for the model was 0.030. The \(R^2\) value for the fit is 0.958 and the sum of squared errors is 0.228 (mean pC* error of 0.128).

From the values given previously, the ratio \(\frac{\bar \Lambda_0}{\bar{\eta}}\) can be calculated for the experimental conditions. Equation \eqref{equation:Flocculation/Floc_Model:Ld} can be used to compute (\(\bar \Lambda_0\)). For these experiments, \(\bar{d}_P\) is taken to be the average diameter of kaolinite clay particles, found by \phantomsection\label{\detokenize{Flocculation/Floc_Model:id15}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-wei-coagulation-2015}]{\sphinxcrossref{{[}WZL+15{]}}}} and \phantomsection\label{\detokenize{Flocculation/Floc_Model:id16}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-sun-characterization-2015}]{\sphinxcrossref{{[}SWSL15{]}}}} to be 7 \(\mu m\). The concentration can be converted from NTU to the necessary mass/volume (mg/L) unit by using as a proportion the measurement reported by \phantomsection\label{\detokenize{Flocculation/Floc_Model:id17}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-wei-coagulation-2015}]{\sphinxcrossref{{[}WZL+15{]}}}} of 68 NTU for 100 mg/L of kaolinite clay. Last, the density was assumed to be 2.65 g/\(cm^3\) for kaolinite.

For flocculation in laminar flows, data were used from the work of \phantomsection\label{\detokenize{Flocculation/Floc_Model:id18}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}]{\sphinxcrossref{{[}SWSL14{]}}}}. \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig5}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig5}}} shows Equation \eqref{equation:Flocculation/Floc_Model:pClam} fit to results for a capture velocity of 0.12 mm/s at two hydraulic residence times, five influent turbidity values and a range of coagulant doses. \phantomsection\label{\detokenize{Flocculation/Floc_Model:id19}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}]{\sphinxcrossref{{[}SWSL14{]}}}} showed that the projected x-axis intercept of the linear region of the data (with a log-log slope of 1 according to her plotting of the data) was proportional to the capture velocity used for sedimentation. Correspondingly, \(k\) is expected to be a function of capture velocity.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{PennockFig5}.png}
\caption{Fit of Equation \eqref{equation:Flocculation/Floc_Model:pClam} to laminar flocculation data from \label{\detokenize{Flocculation/Floc_Model:id20}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}]{\sphinxcrossref{{[}SWSL14{]}}}}.}\label{\detokenize{Flocculation/Floc_Model:id39}}\label{\detokenize{Flocculation/Floc_Model:figure-pennockfig5}}\end{figure}

Referring to \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig5}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig5}}}, Equation \eqref{equation:Flocculation/Floc_Model:pClam} fits the data from \phantomsection\label{\detokenize{Flocculation/Floc_Model:id21}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}]{\sphinxcrossref{{[}SWSL14{]}}}} well with a \(k\) value of 0.027. The resulting \(R^2\) for this fit is 0.844. The sum-squared error is 5.03, giving an average pC* error of 0.034 for the fit.


\subsection{Discussion}
\label{\detokenize{Flocculation/Floc_Model:discussion}}
The goodness of fit seen in \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig3}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig3}}} and \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig5}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig5}}} indicate that the model captures the important mechanisms governing flocculation performance for a wide range of coagulant doses in both laminar and turbulent hydraulic flocculation. One of the challenges in fitting the data pertained to the assumption made for the characteristic diameter of PACl precipitate clusters, \(\bar{d}_C\). This value has significant influence on the value of \(\bar{\Gamma}\), which in turn influences the values of the composite parameter (Equation \eqref{equation:Flocculation/Floc_Model:Paramlam}).

It is known that PACl contains aluminum monomers and oligomers as well as \(\mathrm{Al_{13}}\) and \(\mathrm{Al_{30}}\) nanoclusters, with the larger \(\mathrm{Al_{30}}\) nanoclusters having a diameter of 1 nm and a length of 2 nm \phantomsection\label{\detokenize{Flocculation/Floc_Model:id22}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-mertens-polyaluminum-2012}]{\sphinxcrossref{{[}MCM+12{]}}}}. It has been found, however, that the components of PACl self-aggregate and go on to form larger clusters \phantomsection\label{\detokenize{Flocculation/Floc_Model:id23}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-influence-2013}]{\sphinxcrossref{{[}SWSL13{]}}}}. For these experiments, the value of \(\bar{d}_\mathrm{C}\) was chosen based on sizing experiments performed by Garland (2017) with a Malvern Zetasizer Nano-ZS to analyze a 138.5 mg/L (as Aluminum) solution of PACl.

A limitation of the model can be seen in the data in \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig3}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig3}}} at higher values of the composite parameters. After increasing steadily for all of the preceding range of coagulant doses, the performance began to decline after the dose of 10.9 mg/L as Aluminum. A simple hypothesis for the decline in performance (which corresponds with an effluent turbidity increase over the five data points from 2.7 NTU to 11.1 NTU) is that an increase in free PACl nanoparticles made a significant contribution to the effluent turbidity. As the PACl concentration increased, the coverage of reactor and clay platelet surfaces by coagulant became more complete and the free coagulant concentration also increased. With very high coagulant doses like the ones used in the upper end of the experimental range, it is possible that the formation of PACl self-aggregates was favorable, increasing the turbidity of the suspension. Indeed, calculation of the volume fraction for the 10.9 mg/L experimental PACl dose gives a volume fraction value (for clay and coagulant combined) of \(6.1\times10^{-4}\), while for the highest dose of 98 mg/L as Al, the value was \(8.3\times10^{-4}\), a 37\% increase due solely to the increased contribution of PACl precipitates.

Another possibility is that as \(\bar{\Gamma}\) increases above 0.5, the resulting flocs are increasingly formed by PACl-PACl bonds instead of by PACl-kaolinite bonds. If the PACl-PACl bonds are weaker than PACl-kaolinite bonds, it is possible that attachment efficiency decreases for high \(\bar{\Gamma}\). The weakness of PACl-PACl bonds compared with PACl-kaolinite bonds is suggested by the relative charges of PACl and kaolinite. While PACl precipitate surfaces are positively charged, the surfaces of kaolinite are mostly negatively charged \phantomsection\label{\detokenize{Flocculation/Floc_Model:id24}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-wei-coagulation-2015}]{\sphinxcrossref{{[}WZL+15{]}}}}. Therefore, it follows that PACl precipitates will likely have more affinity for kaolinite surfaces than for other PACl precipitates. The \(\bar{\Gamma}\) calculated for the peak performance was 0.52, and so it is possible that performance decreased past this point because the strength of bonds for experiments at higher doses were weaker.

Applying the AguaClara flocculation model to the design of a hydraulic flocculator indeed gives reasonable results. Assuming that a flocculator is expected to receive sufficiently high turbidities that the influent concentration can be neglected, Equation \eqref{equation:Flocculation/Floc_Model:GtlamSim} can be used. In order for it to treat to a settled effluent of 3 NTU (pre-filtration) with sufficient PACl to achieve a surface area coverage fraction of 0.5, it would need to have a \(\bar G_{CS}\theta\) of 99,600. \phantomsection\label{\detokenize{Flocculation/Floc_Model:id25}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-davis-introduction-2008}]{\sphinxcrossref{{[}DC08{]}}}} give the range of  \(\bar G_{CS}\theta\) values pertinent to flocculation of high turbidities as between 36,000 and 96,000, so this result is reasonable. This analysis does not account for removal of particles in a floc blanket that would enable use of a lower value of \(\bar G_{CS}\theta\).

Regarding flocculator design, recommended values of \(\bar G_{CS}\) in flocculation range from \(10\:\mathrm{\frac{1}{s}}\) to \(100\:\mathrm{\frac{1}{s}}\), which correspond to \(\bar{\varepsilon}\) values of about 0.1 to 10 mW/kg \phantomsection\label{\detokenize{Flocculation/Floc_Model:id26}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-mcconnachie-design-2000}]{\sphinxcrossref{{[}ML00{]}}}}. However, there is evidence that higher velocity gradients are advantageous, as found by \phantomsection\label{\detokenize{Flocculation/Floc_Model:id27}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-garland-revisiting-2016}]{\sphinxcrossref{{[}GWSL16{]}}}} as well as the work done in this study, which made use of energy dissipation rates of about 22 mW/kg. For hydraulic flocculators, at least, designers should consider using higher energy dissipation rates than conventionally used, since they have a much lower ratio of maximum to average energy dissipation rate, leading to less floc breakup at high energy dissipation rates compared to mechanically mixed flocculators.

The assumption that nonsettleable particle removal is proportional to primary particle removal appears to be supported by the goodness of fit supplied by the AguaClara  flocculation model to the data (see \hyperref[\detokenize{Flocculation/Floc_Model:figure-pennockfig3}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-pennockfig3}}}). This assumption is likely included in the values of \(k\) fit by the model. A mechanistic understanding of \(k\) will require that the proportionality between nonsettleable and primary particles be understood explicitly. It is possible that \(k\) is a function of rapid mix effectiveness, and since \(k\) predicts \(pC^*\), it will also be dependent on \(\bar v_c\). Future experiments at varying \(\bar v_c\) are planned. Currently, \(\bar{\alpha}\) is calculated assuming that coagulant nanoparticle attachment to the primary particles was accomplished very early on in the flocculator, but if colloid coating by coagulant nanoparticles is dependent upon diffusion rather than exclusively on hydraulic shear, it will be a function of time in addition to \(\bar G_{CS}\theta\), making flocculation less effective at high flow rates. Additionally, the use of \(\bar{\varepsilon}\) (or \(\bar G_{CS}\)) assumes a uniform energy dissipation rate in the flocculator. Any spatial deviation in the laboratory flocculator from a uniform energy dissipation rate would have had an impact on the values of \(k\) relative to their theoretical values, which are dictated by the rate of conversion of primary particles to flocs.


\subsection{Summaries}
\label{\detokenize{Flocculation/Floc_Model:summaries}}
We developed a model that predicts hydraulic flocculator performance. Regardless of whether the flow is laminar or turbulent, viscous forces control the relative velocities between particles on a collision path, and the performance equation is \(pC^*=\frac{3}{2}\log_{10}\left[\frac{2}{3}\left(\frac{6}{\pi}\right)^{2/3}\pi k\bar{\alpha}\bar G_{CS}\theta\phi_0^{2/3}+1\right]\).

Model predictions were compared with data from \phantomsection\label{\detokenize{Flocculation/Floc_Model:id28}}{\hyperref[\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}]{\sphinxcrossref{{[}SWSL14{]}}}}. To validate the first equation and the second equation in turbulent flow, experiments were conducted in turbulent flow for initial conditions of \(\frac{\bar \Lambda}{\bar{\eta}}<1\). It was found that the viscous equation was slightly more suitable in these conditions. Until further work is done on delineating the relative predominance of viscous and inertial forces over the range of turbulent flocculation conditions, the authors recommend using the AguaClara flocculation model. For design purposes, this model indicates that flocculator design is more sensitive to the desired effluent concentration of particles than the range of influent concentrations that might be encountered. This study also supports the use of higher energy dissipation rates (or velocity gradients) than conventionally recommended for hydraulic flocculators. Further work is needed to characterize the functional dependence of \(k\) on capture velocity and energy dissipation rate, as well as the relationship between the final concentrations of primary and primary
particles.


\section{Geometric Explanation of the Effects of Humic Acid on Flocculation}
\label{\detokenize{Flocculation/Floc_Model:geometric-explanation-of-the-effects-of-humic-acid-on-flocculation}}
Dissolved organic matter (DOM) is ubiquitous in natural waters and has considerable influence on drinking water treatment, since the presence of DOM can create a need for increased coagulant doses in addition to being a precursor of disinfection byproducts (DBPs). This work evaluated use of polyaluminum chloride (PACl) as a coagulant for a synthetic water to determine the effect of DOM on the settled effluent turbidity. The research employed the hydraulic flocculation performance model previously discussed and made additions to the model algorithm to incorporate the effects of humic acid on flocculation of inorganic particulate matter. Data were obtained using a laminar-flow tube flocculator and a lamellar tube settler. Two adjustable model parameters were used to fit data, one related to the capture velocity used for sedimentation, and one that estimated the average size of dissolved humic acid molecules. The modified model that accounted for the presence of humic acid was able to independently predict the experimental results from 60 experiments at a different influent turbidity. This section is based on \sphinxstyleemphasis{Observations and a Geometric Explanation of the Effects of Humic Acid on Flocculation} published in Environmental Engineering Science in 2019 (DOI\#10.1089/ees.2018.0405), and the reader is encouraged to consult this article for more details.


\subsection{Introduction}
\label{\detokenize{Flocculation/Floc_Model:introduction}}
Optimal flocculation conditions for turbidity or pathogen removal are not always the same as those for DOM removal (Hua and Reckhow, 2008). Because of the variable composition of DOM, the mechanisms of removal could be different for different types of DOM in water (Sharp and Jarvis, 2006). Jarvis and Jefferson (2007) state that the mechanisms through which DOM is removed include a combination of charge neutralization, adsorption, entrapment, and complexation with coagulant polycations into suspended particulate aggregates. The hydrophobic fraction of DOM, which includes humic acids, is generally removed in coagulation more effectively than the hydrophilic fraction (Marhaba et al., 2003; Matilainen et al., 2010). For the system considered in this research, the mechanisms of DOM (humic acid) attachment to coagulant (PACl with 10.6\% Al2O3 w/w and basicity, OH/Al, of 2.1), appear to be adsorption (Yan et al., 2008) or complexation (Lin et al., 2014; Xiong et al., 2018).

Prehydrolyzed polymer coagulants, such as polyaluminum chloride (PACl), have several advantages over conventional coagulants, such as alum, but the characteristics of the raw water (e.g., pH, alkalinity, and DOM content) affect the performance of different coagulants. As a result, prehydrolyzed coagulants do not consistently improve the removal efficiency of DOM (Hu et al., 2006).

The research described in this paper builds on the AguaClara hydraulic flocculation model developed by Pennock et al. (2018) and adds detail to the attachment efficiency coefficient describing geometric and probabilistic interactions between clay, coagulant, DOM, and reactor walls. The synthetic raw water used in experiments added one type of DOM, humic acid, to a previously studied synthetic system (Swetland et al., 2014) with the expectation that the resulting system would be sufficiently well-characterized to develop a predictive model.


\subsection{Model Formation}
\label{\detokenize{Flocculation/Floc_Model:model-formation}}
In laminar-flow flocculators, the velocity of one floc relative to another scales with the average separation distance between flocs (Swetland et al., 2014). The time between floc collisions is inversely proportional to both \(\phi\) and the relative velocity between flocs. Because the relative velocity between flocs is proportional to separation distance, the time between collisions is proportional to \({\phi }^{\frac{1}{3}}\), since the average separation distance, \(\overline \Lambda\), is given by
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:9}
\begin{split}\overline \Lambda=d_{\mathrm P}{\left(\frac{\pi }{6\phi }\right)}^{\frac{1}{3}}.\end{split}
\end{equation}
The result is that, for laminar flow, the average time for primary particle collisions scales with \({\phi }^{-\frac{2}{3}}\) (Weber-Shirk and Lion 2010).

A laminar-flow hydraulic flocculator model was developed and validated based on the above analysis in Pennock et al. (2018) with the form
\begin{equation}\label{equation:Flocculation/Floc_Model:eq_AguaClara_Flocculation_Model}
\begin{split}\mathrm{p}C^{*}=\frac{3}{2}{{\log}_{10} \left[\frac{2}{3}{\left(\frac{6}{\pi }\right)}^{\frac{2}{3}}\pi k\overline{\alpha }\overline G_{CS}\theta {\phi }^{\frac{2}{3}}_0+1\right]\ },\end{split}
\end{equation}
where  \(k\) is a fitting parameter dependent on the value of \(V_{\mathrm c}\) used for sedimentation, \(\overline{\alpha }\) is the mean fraction of collisions that are successful (i.e., result in aggregation), and \(\mathrm{p}C^*\) is defined as
\begin{equation}\label{equation:Flocculation/Floc_Model:eq_pC_AguaClara_Flocculation_Model}
\begin{split}\mathrm{p}C^*=-{\log \left(\frac{\mathrm{Effluent\ Turbidity}}{\mathrm{Influent\ Turbidity}}\right)\ }.\end{split}
\end{equation}
Equation \eqref{equation:Flocculation/Floc_Model:eq_AguaClara_Flocculation_Model}, referred to as the AguaClara flocculation model in Pennock et al. (2018), is a Lagrangian hydrodynamic model that assumes that the aggregation of primary particles is rate-limiting. It further assumes that these particles, on average, will collide when the volume of fluid swept out as one particle approaches the other is equal to the average volume occupied by a single particle in the suspension. The time for these collisions to occur increases as flocculation proceeds, since the concentration of primary particles decreases in a way that is assumed to be first order with respect to collisions. Thus, with each successive collision, the average volume occupied by primary particles increases, and it takes longer for the next collision to occur. In Equation \eqref{equation:Flocculation/Floc_Model:eq_AguaClara_Flocculation_Model}, performance is linearly proportional to the logarithm of the effective collision potential, \(\log(\overline{\alpha }\overline G_{CS}\theta {\phi }^{2/3}_0)\).

This group of parameters is the same as the group first described by Swetland et al. (2014), with the exception that they used the estimated fractional coverage of the colloid surface by coagulant, \({\overline{\Gamma}}_{\mathrm{PACl-Clay}}\), as a measure of attachment efficiency instead of \(\overline{\alpha }\). Pennock et al. (2018) recognized that surface coverage of both particles participating in a collision matters, and introduced \(\overline{\alpha }\) to convert the geometric information contained in \({\overline{\Gamma}}_{\mathrm{PACl-Clay}}\) to a probability of a successful collision. Using data gathered by Swetland et al. (2014), Pennock et al. (2018) were able to predict the results of independent laminar flocculation experiments with no adjustable parameters in the absence of added DOM.

Experimental results obtained with added humic acid made clear that the attachment efficiency was adversely affected by the addition of humic acid.  Referencing adsorption measurements by Davis (1982), a minority (his study found 20\%) of added DOM would be adsorbed by kaolinite at the experimental pH of 7.5. Thus, most humic acid macromolecules were available to attach to the added coagulant nanoparticles. The following simplifying assumptions were made to account for the presence of humic acids: 1) humic acid macromolecules attach to coagulant nanoparticles to form nanoaggregates, 2) nanoaggregates attach to clay and to the reactor walls, and 3) the surfaces of precipitated coagulant nanoparticles promote adhesion, while the surfaces of bound humic acids prevent adhesion.

In this study, humic acid macromolecules and PACl nanoparticles were modeled as spheres. Based on the size of coagulant nanoparticles and humic acid macromolecules, their number concentrations, \(N_{\mathrm HA}\) and \(N_{\mathrm PACl}\) respectively, can be estimated by
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:10}
\begin{split}N_{\mathrm HA}=\ \frac{C_{\mathrm HA}}{{\rho }_{\mathrm HA}\frac{\pi }{6}{d_{\mathrm HA}}^3}\end{split}
\end{equation}
and
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:11}
\begin{split}N_{\mathrm PACl}=\ \frac{C_{\mathrm PACl}}{{\rho }_{\mathrm PACl}\frac{\pi }{6}{d_{\mathrm PACl}}^3},\end{split}
\end{equation}
where \(C_{\mathrm PACl}\) is the dose of coagulant in mg/L as Al; \(C_{\mathrm HA}\) is the concentration of humic acid in mg/L; \({\rho }_{\mathrm PACl}\) is the density of the coagulant (Swetland et al. (2013) found \(1,138 \frac{\mathrm kg}{\mathrm m^3}\)); \({\rho }_{\mathrm HA}\) is the density of humic acid, \(1,520\frac{\mathrm kg}{\mathrm m^3}\) (Sigma-Aldrich, 2014); \(d_{\mathrm HA}\) is the diameter of humic acid macromolecules (an adjustable model parameter); and \(d_{\mathrm PACl}\) is the diameter of precipitated PACl coagulant nanoparticles, taken to be 90 nm as found by Dr. Casey Garland (2017).

A key model assumption was that humic acid macromolecules cannot adhere to a coagulant surface that is occupied by a humic acid macromolecule, since humic acid macromolecules are assumed to not appreciably self-aggregate. Li et al. (2018) observed that for humic acid adsorption onto \(\mathrm{Al_2O_3}\) surfaces, the macromolecules adsorbed in a monolayer. The outcome of this assumption is that humic acid macromolecules attach to an uncovered surface of coagulant and do not stack on top of one another. The available surface area of the PACl nanoparticle was modeled as the surface area of an equivalent sphere. The amount of that area that is occupied by an attached humic acid macromolecule was estimated as the projected area of a sphere with volume equivalent to a humic acid macromolecule.  A new variable describing the coverage of coagulant nanoparticle surface area by humic acid macromolecules,
\begin{equation}\label{equation:Flocculation/Floc_Model:eq_Gamma_HA-PACl}
\begin{split}{\overline{\Gamma}_\mathrm{HA-PACl}}=\frac{{{\frac{\pi }{4}d}_\mathrm{HA}}^2}{{{\pi d}_\mathrm{PACl}}^2}\frac{N_\mathrm{HA}}{N_\mathrm{PACl}},\end{split}
\end{equation}
was created to be incorporated into the model (within \(\overline{\alpha }\)) to represent the fraction of the PACl nanoparticle surface area that is covered by humic acid macromolecules.

The first two steps in particle aggregation, where humic acid macromolecules attach to coagulant nanoparticles and then the resulting nanoaggregates attach to clay surfaces, were assumed to be rapid because diffusion is an effective transport process for nanoparticles (Benjamin and Lawler, 2013). Subsequent to rapid mix, the clay particles with attached nanoaggregates undergo collisions during the flocculation process and the aggregation process is governed by fluid shear (Pennock et al., 2018). The success of a collision between clay particles is hypothesized to be dependent on the properties of the contact surfaces at the initial point of contact.

The three types of surfaces (PACl, humic acid, clay) have 6 (3!) potential interactions as illustrated in \hyperref[\detokenize{Flocculation/Floc_Model:figure-du-fig2}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-du-fig2}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Du_Fig2}.png}
\caption{Modes of collision between particles during flocculation.}\label{\detokenize{Flocculation/Floc_Model:id40}}\label{\detokenize{Flocculation/Floc_Model:figure-du-fig2}}\end{figure}

Of these interactions considered in the model, the collisions that will result in attachment are assumed to involve at least one PACl nanoparticle surface (\hyperref[\detokenize{Flocculation/Floc_Model:figure-du-fig2}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-du-fig2}}} A, B, C). The attachment efficiency is hypothesized to be the sum of probability of these three types of collisions, formally expressed as
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:12}
\begin{split}\overline{\alpha }\ ={\overline{\alpha }}_\mathrm{PACl-Clay}+{\overline{\alpha }}_\mathrm{PACl-PACl}+{\overline{\alpha }}_\mathrm{HA-PACl},\end{split}
\end{equation}
where the subscripts define the two surfaces that are interacting. The overbars indicate that all of these represent mean probabilities for an entire suspension rather than the probabilities for specific particles.

The probability of a clay surface colliding with a PACl surface (\hyperref[\detokenize{Flocculation/Floc_Model:figure-du-fig2}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-du-fig2}}} A) is equal to twice the probability that the first surface is clay (\(1-{\overline{\Gamma}}_\mathrm{PACl-Clay}\)) and the second surface is the PACl surface of a PACl-HA nanoaggregate (\(\left(1-{\overline{\Gamma}}_\mathrm{HA-PACl}\right){\overline{\Gamma}}_\mathrm{PACl-Clay}\)), since either of two colliding particles could provide the clay surface or the PACl surface,
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:13}
\begin{split}{\overline{\alpha }}_\mathrm{PACl-Clay}=2\left(1-{\overline{\Gamma}}_\mathrm{PACl-Clay}\right)\left[\left(1-{\overline{\Gamma}}_\mathrm{HA-PACl}\right){\overline{\Gamma}}_\mathrm{PACl-Clay}\right].\end{split}
\end{equation}
The probability of a collision between the PACl surfaces of two PACl-HA nanoaggregates (\(\left(1-{\overline{\Gamma}}_\mathrm{HA-PACl}\right){\overline{\Gamma}}_\mathrm{PACl-Clay}\)) (\hyperref[\detokenize{Flocculation/Floc_Model:figure-du-fig2}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-du-fig2}}} B) is given by
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:14}
\begin{split}{\overline{\alpha}}_\mathrm{PACl-PACl}={\left[\left(1-{\overline{\Gamma}}_\mathrm{HA-PACl}\right){\overline{\Gamma}}_\mathrm{PACl-Clay}\right]}^2.\end{split}
\end{equation}
The probability of a collision between a PACl surface of a PACl-HA nanoaggregate (\(\left(1-{\overline{\Gamma}}_\mathrm{HA-PACl}\right){\overline{\Gamma}}_\mathrm{PACl-Clay}\)) and an HA surface of a PACl-HA nanoaggregate (\({\overline{\Gamma}}_\mathrm{HA-PACl}{\overline{\Gamma}}_\mathrm{PACl-Clay}\)) (\hyperref[\detokenize{Flocculation/Floc_Model:figure-du-fig2}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Model:figure-du-fig2}}} C), or vice versa, is given by
\begin{equation}\label{equation:Flocculation/Floc_Model:Flocculation/Floc_Model:15}
\begin{split}{\overline{\alpha }}_\mathrm{HA-PACl}=2\left[{\overline{\Gamma}}_\mathrm{PACl-Clay}\left(1-{\overline{\Gamma}}_\mathrm{HA-PACl}\right)\right]\left[{\overline{\Gamma}}_\mathrm{HA-PACl}{\overline{\Gamma}}_\mathrm{PACl-Clay}\right],\end{split}
\end{equation}
where the factor of 2 accounts for the possibility that either colliding particle could contribute either surface type.

The model accounting for the presence of humic acids is modified from the Pennock et al. (2018) model by redefining the attachment efficiency, \(\overline{\alpha }\), using Eq. 14 to account for the presence of humic acid.

The physical properties of humic acid vary with composition. The diameter of humic acid macromolecules is estimated to range from 4 nm to 110 nm (“\{O\}sterberg, 1993). Because of the variation in the size of humic acid macromolecules, the characteristic diameter of the humic acid macromolecules was used as a fitting parameter. Thus, there are two adjustable model parameters, \(k`(Equation :eq:`eq_AguaClara_Flocculation_Model\),), which accounts for the sedimentation capture velocity, and \(d_\mathrm{HA}\), which accounts for coagulant precipitate surface coverage by humic acid.  These parameters were fit to results from observations taken with an influent turbidity of 50 NTU; the model was then validated by independently predicting results from experiments with an influent turbidity of 100 NTU.


\subsection{Discussion}
\label{\detokenize{Flocculation/Floc_Model:id29}}
The solubility of humic acid is highly pH-dependent, and additional experimental results are needed to test the applicability of the model approach as a function of varying pH. The experimental conditions were designed to keep the pH relatively constant, and the pH change in the experiments was small (7.5 \(\pm\) 0.3).

The model considered flocculation in the presence of humic acid as a two-step process. Firstly, humic acid macromolecules attached to precipitated coagulant nanoparticles. Then, the partially-coated coagulant nanoaggregates could bind to clay and reactor wall surfaces.  Humic acid and coagulant nanoparticles were treated as spheres when estimating the attachment efficiency based on surface coverage and probability. The diameter of precipitated PACl nanoparticles was experimentally measured to be 90 nm (Garland, 2017), and a humic acid macromolecule diameter of 75 nm best fit the observations. Wall loss of coagulant precipitates with humic acid nanoaggregates was considered while direct wall loss of humic acid macromolecules was not considered.

The characteristic humic acid dimension, \(d_\mathrm{HA}\), has a physical meaning, with the fitted value, 75 nm, falling within the range (4-110 nm) reported by “\{O\}sterberg (1993), and the model fits are well correlated to the observations. The predictive capability of the model was verified by predicting results under different experimental conditions with no additional adjustable parameters.

The flocculation model without the effects of humic acid shows that \(\mathrm{p}C^*\) is directly proportional to the log of the effective collision potential, \(\log(\overline{\alpha }\overline G_{CS}\theta {\phi }^{\frac{2}{3}})\), and this relationship is still present in the model with a modified attachment efficiency, \(\overline{\alpha },\) based on clay surface coverage by coagulant nanoparticles as adjusted for the presence of humic acids.

The form of the flocculation model equation sets the interactions between raw water properties (\({\phi }_0\)), influent particle surface area (which contributes to \({\overline{\Gamma}}_\mathrm{PACl-Clay}\)), coagulant precipitate size and dose (which contributes to \({\overline{\Gamma}}_\mathrm{PACl-Clay}\) and \({\overline{\Gamma}}_\mathrm{HA-PACl}\)) , humic acid molecule size and concentration (which contribute to \({\overline{\Gamma}}_\mathrm{HA-PACl}\)), flocculator design (\(\overline G_{CS}\theta\)), and sedimentation tank design (\(k\)). In a gravity-powered water treatment plant operating at constant flow rate, the flocculator and sedimentation tank parameters are constant. An increase in concentration of humic acid causes an increase in \({\overline{\Gamma}}_\mathrm{HA-PACl}\), which decreases \(\mathrm{p}C^*\) but can be compensated for by increasing coagulant dose.


\section{References}
\label{\detokenize{Flocculation/Floc_Model:references}}
Amin, M., Safari, M., Maleki, A., Ghasemian, M., Rezaee, R., \& Hashemi, H. (2012). Feasibility of humic substances removal by enhanced coagulation process in surface water. International Journal of Environmental Health Engineering. \sphinxurl{http://www.ijehe.org/text.asp?2012/1/1/29/99323}

Benjamin, M. M., \& Lawler, D. F. (2013). Water quality engineering: physical / chemical treatment processes. Hoboken, N.J.: Wiley.

BP-MWS, CIWS, \& CUWS. (2016). Drinking Water Quality Report 2016. Ithaca, NY: Bolton Point Municipal Water System, City of Ithaca Water System, Cornell University Water System. Retrieved from \sphinxurl{https://fcs.cornell.edu/content/water-system-updates-and-water-quality-reports}

Camp, T. R. (1953). Flocculation and Flocculation Basins. American Society of Civil Engineers.

Chow, C. W. K., Fabris, R., Leeuwen, J. van, Wang, D., \& Drikas, M. (2008). Assessing Natural Organic Matter Treatability Using High Performance Size Exclusion Chromatography. Environmental Science \& Technology, 42(17), 6683\textendash{}6689. \sphinxurl{https://doi.org/10.1021/es800794r}

Cleasby, J. (1984). Is Velocity Gradient a Valid Turbulent Flocculation Parameter? Journal of Environmental Engineering, 110(5), 875\textendash{}897. \sphinxurl{https://doi-org.proxy.library.cornell.edu/10.1061/(ASCE)0733-9372(1984)110:5(875})

Davis, J. A. (1982). Adsorption of natural dissolved organic matter at the oxide/water interface. Geochimica et Cosmochimica Acta, 46(11), 2381\textendash{}2393. \sphinxurl{https://doi.org/10.1016/0016-7037(82)90209-5}

Fosso-Kankeu, E., Webster, A., Ntwampe, I. O., \& Waanders, F. B. (2017). Coagulation/Flocculation Potential of Polyaluminium Chloride and Bentonite Clay Tested in the Removal of Methyl Red and Crystal Violet. Arabian Journal for Science and Engineering, 42(4), 1389\textendash{}1397. \sphinxurl{https://doi.org/10.1007/s13369-016-2244-x}

Garland, C. A. (2017). Uncovering the Mysteries of the Floc Blanket: An Exploration with Inlet Jets, Flocculators, and Polyaluminum Chloride Precipitates (Ph.D. thesis). Cornell University, United States \textendash{} New York. Retrieved from \sphinxurl{https://search.proquest.com/docview/1959337645/abstract/A3C1677072644AD5PQ/1}

Granger, R. A. (1995). Fluid Mechanics. New York: Dover Publications.

Hu, C., Liu, H., Qu, J., Wang, D., \& Ru, J. (2006). Coagulation Behavior of Aluminum Salts in Eutrophic Water:  Significance of Al13 Species and pH Control. Environmental Science \& Technology, 40(1), 325\textendash{}331. \sphinxurl{https://doi.org/10.1021/es051423+}

Hua, G., \& Reckhow, D. A. (2008). Relationship between Brominated THMs, HAAs, and Total Organic Bromine during Drinking Water Chlorination. In T. Karanfil, S. W. Krasner, P. Westerhoff, \& Y. Xie (Eds.), Disinfection By-Products in Drinking Water (Vol. 995, pp. 109\textendash{}123). Washington, DC: American Chemical Society. \sphinxurl{https://doi.org/10.1021/bk-2008-0995.ch008}

Integrated design of water treatment facilities: Susumu Kawamura. John Wiley \& Sons, Inc.: New York, NY 1991. (pp. 658, ISBN 0-471-61591-9) \$69.95 hardcover. (1992). Waste Management, 12(1), 101. \sphinxurl{https://doi.org/10.1016/0956-053X(92)90024-D}

Ives, K. J. (1968). Theory of operation of sludge blanket clarifiers. Proceedings of the Institution of Civil Engineers, 39(2), 243\textendash{}260. \sphinxurl{https://doi.org/10.1680/iicep.1968.8090}

Jarvis, P., Jefferson, B., Gregory, J., \& Parsons, S. A. (2005). A review of floc strength and breakage. Water Research, 39(14), 3121\textendash{}3137. \sphinxurl{https://doi.org/10.1016/j.watres.2005.05.022}

Kundu, P. K., \& Cohen, I. M. (2008). Fluid mechanics. Amsterdam; Boston: Academic Press.

Letterman, R. D. (1999). Water quality and treatment: a handbook of community water supplies (5th ed.). New York: McGraw-Hill.

Li, W., Liao, P., Oldham, T., Jiang, Y., Pan, C., Yuan, S., \& Fortner, J. D. (2018). Real-time evaluation of natural organic matter deposition processes onto model environmental surfaces. Water Research, 129, 231\textendash{}239. \sphinxurl{https://doi.org/10.1016/j.watres.2017.11.024}

Lin, J.-L., Huang, C., Dempsey, B., \& Hu, J.-Y. (2014). Fate of hydrolyzed Al species in humic acid coagulation. Water Research, 56, 314\textendash{}324. \sphinxurl{https://doi.org/10.1016/j.watres.2014.03.004}

Matilainen, A., Vepsäläinen, M., \& Sillanpää, M. (2010). Natural organic matter removal by coagulation during drinking water treatment: A review. Advances in Colloid and Interface Science, 159(2), 189\textendash{}197. \sphinxurl{https://doi.org/10.1016/j.cis.2010.06.007}

Marhaba, T. F., Pu, Y., \& Bengraine, K. (2003). Modified dissolved organic matter fractionation technique for natural water. Journal of Hazardous Materials, 101(1), 43\textendash{}53. \sphinxurl{https://doi.org/10.1016/S0304-3894(03)00133-X}

O’Melia, C. R. (1972). Coagulation and flocculation. In W. J. Weber (Ed.), Physicochemical processes for water quality control. New York: Wiley-Interscience.

Österberg, R., Lindovist, I., \& Mortensen, K. (1993). Particle Size of Humic Acid. Soil Science Society of America Journal, 57(1), 283\textendash{}285. \sphinxurl{https://doi.org/10.2136/sssaj1993.03615995005700010048x}

Pennock, William H., Weber-Shirk, Monroe, \& Lion, Leonard W. (2018). A Hydrodynamic and Surface Coverage Model Capable of Predicting Settled Effluent Turbidity Subsequent to Hydraulic Flocculation. Environmental Engineering Science, 35(12). \sphinxurl{https://doi.org/10.1089/ees.2017.0332}

Schulz, C. R., \& Okun, D. A. (1984). Surface water treatment for communities in developing countries. New York: Wiley.

Sharp, E. L., Jarvis, P., Parsons, S. A., \& Jefferson, B. (2006). Impact of fractional character on the coagulation of NOM. Colloids and Surfaces A: Physicochemical and Engineering Aspects, 286(1\textendash{}3), 104\textendash{}111. \sphinxurl{https://doi.org/10.1016/j.colsurfa.2006.03.009}

Sigma-Aldrich. (2014). Humic acid sodium salt (H16752) (Safety Data Sheet) (p. 7). St. Louis, MO. Retrieved from \sphinxurl{https://www.sigmaaldrich.com/MSDS/MSDS/DisplayMSDSPage.do?country=US\&language=en\&productNumber=H16752\&brand=ALDRICH\&PageToGoToURL=https\%3A\%2F\%2Fwww.sigmaaldrich.com\%2Fcatalog\%2Fproduct\%2Faldrich\%2Fh16752\%3Flang\%3Den}

Soh, Y. C., Roddick, F., \& Leeuwen, J. van. (2008). The impact of alum coagulation on the character, biodegradability and disinfection by-product formation potential of reservoir natural organic matter (NOM) fractions. Water Science and Technology; London, 58(6), 1173\textendash{}1179. \sphinxurl{http://dx.doi.org/10.2166/wst.2008.475}

Swetland, K. A., Weber-Shirk, M. L., \& Lion, L. W. (2013). Influence of Polymeric Aluminum Oxyhydroxide Precipitate-Aggregation on Flocculation Performance. Environmental Engineering Science, 30(9), 536\textendash{}545. \sphinxurl{https://doi.org/10.1089/ees.2012.0199}

Swetland, K. A., Weber-Shirk, M. L., \& Lion, L. W. (2014). Flocculation-Sedimentation Performance Model for Laminar-Flow Hydraulic Flocculation with Polyaluminum Chloride and Aluminum Sulfate Coagulants. Journal of Environmental Engineering, 140(3), 04014002. \sphinxurl{https://doi.org/10.1061/(ASCE)EE.1943-7870.0000814}

Tse, I. C., Swetland, K., Weber-Shirk, M. L., \& Lion, L. W. (2011). Method for quantitative analysis of flocculation performance. Water Research, 45(10), 3075\textendash{}3084. \sphinxurl{https://doi.org/10.1016/j.watres.2011.03.021}

Van Benschoten, J. E., \& Edzwald, J. K. (1990). Chemical aspects of coagulation using aluminum salts—I. Hydrolytic reactions of alum and polyaluminum chloride. Water Research, 24(12), 1519\textendash{}1526. \sphinxurl{https://doi.org/10.1016/0043-1354(90)90086-L}

Weber-Shirk, M. L. (2016). ProCoDA: An Automated Method for Testing Process Parameters. Retrieved October 30, 2015, from \sphinxurl{https://confluence.cornell.edu/display/AGUACLARA/ProCoDA}

Weber-Shirk, M. L., \& Lion, L. W. (2010). Flocculation model and collision potential for reactors with flows characterized by high Peclet numbers. Water Research, 44(18), 5180\textendash{}5187. \sphinxurl{https://doi.org/10.1016/j.watres.2010.06.026}

Willis, R. M. (1978). Tubular Settlers—A Technical Review. Journal (American Water Works Association), 70(6), 331\textendash{}335.

Xiong, X., Wu, X., Zhang, B., Xu, H., \& Wang, D. (2018). The interaction between effluent organic matter fractions and Al2(SO4)3 identified by fluorescence parallel factor analysis and FT-IR spectroscopy. Colloids and Surfaces A: Physicochemical and Engineering Aspects, 555, 418\textendash{}428. \sphinxurl{https://doi.org/10.1016/j.colsurfa.2018.07.026}

Yan, M., Wang, D., Ni, J., Qu, J., Chow, C. W. K., \& Liu, H. (2008). Mechanism of natural organic matter removal by polyaluminum chloride: Effect of coagulant particle size and hydrolysis kinetics. Water Research, 42(13), 3361\textendash{}3370. \sphinxurl{https://doi.org/10.1016/j.watres.2008.04.017}




\chapter{Flocculation Design}
\label{\detokenize{Flocculation/Floc_Design:flocculation-design}}\label{\detokenize{Flocculation/Floc_Design:title-flocculation-design}}\label{\detokenize{Flocculation/Floc_Design::doc}}
This chapter will supplement the lectures by going into further detail.

Equations, universal constants, and other helpful goodies can be found in the \sphinxhref{https://github.com/AguaClara/aguaclara/tree/master/aguaclara}{aguaclara code base} . Most equations and constants you find in these summary sheets will already have been coded and will be shown here in the following format:

\begin{DUlineblock}{0em}
\item[] Variable: \sphinxcode{\sphinxupquote{pc.gravity}}
\item[] Function: \sphinxcode{\sphinxupquote{pc.area\_circle(DiamCircle)}}.
\end{DUlineblock}

The letters before the \sphinxcode{\sphinxupquote{.}}, in this case \sphinxcode{\sphinxupquote{pc}}, indicate the file within aguaclara where the variable or function can be found. In the examples above, \sphinxcode{\sphinxupquote{pc.gravity}} and \sphinxcode{\sphinxupquote{pc.area\_circle(DiamCircle)}} show that the variable \sphinxcode{\sphinxupquote{gravity}} and function \sphinxcode{\sphinxupquote{area\_circle(DiamCicle)}} are located inside the \sphinxhref{https://github.com/AguaClara/aguaclara}{physchem.py} (\sphinxcode{\sphinxupquote{pc}}) file. You are strongly recommended to look up any aguaclara equations before using them, even if they are given here in this summary sheet. This is because each equation has comments in its original file describing what the specific conditions are to using it.

\sphinxstylestrong{Important Note:} This chapter introduces uncertainty and empirical design. Some of the parameters used to design AguaClara flocculators are based on what has been shown to work in the field, as opposed to having been derived scientifically. To make sure that the reader is aware of these concepts and parameters that don’t yet have a thorough basis in research, they will be highlighted in red when they appear.


\section{Hydraulic Flocculators, the AguaClara Approach}
\label{\detokenize{Flocculation/Floc_Design:hydraulic-flocculators-the-aguaclara-approach}}\label{\detokenize{Flocculation/Floc_Design:heading-hydraulic-flocculation-design}}

\subsection{Important Terms}
\label{\detokenize{Flocculation/Floc_Design:important-terms}}\begin{enumerate}
\item {} 
Collision potential

\item {} 
Energy dissipation rate

\item {} 
Baffle

\item {} 
Baffle module

\item {} 
Baffle space

\item {} 
Obstacle

\end{enumerate}


\subsection{Important Equations}
\label{\detokenize{Flocculation/Floc_Design:important-equations}}\begin{enumerate}
\item {} 
Minor Loss equation

\end{enumerate}


\section{Introduction to Hydraulic Flocculation}
\label{\detokenize{Flocculation/Floc_Design:introduction-to-hydraulic-flocculation}}
The reason that flocculation is widely used in water treatment is because of sedimentation. Sedimentation is the process that actually removes particles like clay, dirt, organic matter, and bacteria from water. As you learned in the
{\hyperref[\detokenize{Introduction/Introduction:heading-treatment-trains}]{\sphinxcrossref{\DUrole{std,std-ref}{introduction on treatment trains}}}}, sedimentation is the process of particles ‘falling’ because they have a higher density then the water, and its governing equation is:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:0}
\begin{split}\bar v_t = \frac{D_{particle}^2 g}{18 \nu} \frac{\rho_p - \rho_w}{\rho_w}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\bar v_t\) = terminal velocity of a particle, its downwards speed if it were in quiescent (still) water
\item[] \(D_{particle}\) = particle diameter
\item[] \(\rho\) = density. The \(p\) subscript stands for particle, while \(w\) stands for water
\end{DUlineblock}

To increase \(\bar v_t\) and make sedimentation more efficient, flocculation aims to increase the diameter \(d\) of the particles. This is done by applying a coagulant to the dirty water and helping the coagulant to stick evenly to all particles during Rapid Mix \sphinxstylestrong{(DOUBLE CHECK THAT THIS IS IN RAPID MIX ONCE RAPID MIX IS WRITTEN)}. Being covered in coagulant allows the particles to collide, merge, and grow bigger during flocculation.
Our goal in designing a flocculator is to facilitate particle collisions. How can we do this?


\subsection{Collision Potential, \protect\(G_{CS} \theta\protect\), and Energy Dissipation Rate, \protect\(\varepsilon\protect\)}
\label{\detokenize{Flocculation/Floc_Design:collision-potential-and-energy-dissipation-rate}}
Collision potential \((G_{CS} \theta)\) is a term with a very straightforward name. It represents the magnitude of potential particle collisions in a fluid. It is a \sphinxstyleemphasis{dimensionless} parameter which is often used as a performance metric for flocculators; big \(G_{CS} \theta\) values indicate lots of collisions (good) while small values indicate fewer collisions (not so good). AguaClara flocculators usually aim for a collision potential of \((G_{CS} \theta) = 37,000\), which has worked well in AguaClara plants historically. However, this value may change as research continues. The value for collision potential is obtained by multiplying \(G_{CS}\), a parameter for average fluid shear with units of \(\frac{1}{[T]}\), and \(\theta\) , the residence time of water in the flocculator, with units of :\([T]\) . \(\theta\) is intuitive to measure, calculate, and understand. \(G_{CS}\) is a bit more difficult. First, an intuitive explanation. See \hyperref[\detokenize{Flocculation/Floc_Design:figure-g-velocity-profile}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-g-velocity-profile}}}, which shows the velocity profile of flowing water.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=0.500\linewidth]{{G_velocity_profile}.jpg}
\caption{The velocity profile of flowing fluid with uniform shear}\label{\detokenize{Flocculation/Floc_Design:id4}}\label{\detokenize{Flocculation/Floc_Design:figure-g-velocity-profile}}\end{figure}

\(G\) measures the magnitude of shear by using the velocity gradient of a fluid in space, \(\frac{\Delta \bar v}{\Delta h}\). This is essentially the same as the \(\frac{\delta u}{\delta y}\) term in fluid mechanics, which is found in the ubiquitous \sphinxhref{http://polymerdatabase.com/polymer\%20physics/images/Visc.png}{fluid-shear problem} as sourced from \sphinxhref{http://polymerdatabase.com/polymer\%20physics/Viscosity.html}{here.}

\(\bar G\) represents the average \(\frac{\Delta \bar v}{\Delta h}\) for the entire water volume under consideration, and is the parameter we will be using from now on. Unfortunately, it is unrealistic to measure \(\frac{\Delta \bar v}{\Delta h}\) for every parcel of the water in our flocculator and take an average. We need to approximate \(\bar G\) using measureable parameters.

The parameter that serves as the basis for obtaining \(G_{CS}\) is \(\varepsilon\), which represents the \sphinxstylestrong{energy dissipation} rate of a fluid \sphinxstyleemphasis{normalized by its mass}. The units of \(\varepsilon\) are Watts per kilogram:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:1}
\begin{split}\varepsilon = \left[ \frac{W}{Kg} \right] = \left[ \frac{J}{s \cdot Kg} \right] = \left[ \frac{N \cdot m}{s \cdot Kg} \right] = \left[ \frac{kg \cdot m \cdot m}{s^2 \cdot s \cdot Kg} \right] = \left[ \frac{m^2}{s^3} \right] = \left[ \frac{[L]^2}{[T]^3} \right]\end{split}
\end{equation}
There are at least two ways to think about \(\varepsilon\). One is through \(G\). Imagine that a fluid has \sphinxstyleemphasis{no viscosity} ; there is no internal friction caused by fluid flow. No matter how high \(G\) becomes, no energy is dissipated. Now image a honey, which has a very high viscosity. Making honey flow fast requires a lot of energy over a short period of time, which means a high energy dissipation rate. This explanation allows us to understand the equation for \(\varepsilon\) in terms of \(G\) and \(\nu\). \sphinxhref{https://app.knovel.com/web/view/khtml/show.v/rcid:kpMWHWTPD1/cid:kt00AD4KW1/viewerType:khtml/root\_slug:mwh-s-water-treatment/url\_slug:principles-reactor-analysis?\&b-toc-cid=kpMWHWTPD1\&b-toc-url-slug=coagulation-flocculation\&b-toc-title=MWH\%E2\%80\%99s\%20Water\%20Treatment\%20-\%20Principles\%20and\%20Design\%20(3rd\%20Edition)\&page=80\&view=collapsed\&zoom=1)}{See this textbook} for the derivation of the following equation:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:2}
\begin{split}\varepsilon = \nu G^2\end{split}
\end{equation}
Which means we can solve for \(G\):
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:3}
\begin{split}G = \sqrt{\frac{\varepsilon}{\nu}}\end{split}
\end{equation}
Energy dissipation rate is, fortunately, easier to determine than collision potential. This is due to the second way to think about \(\varepsilon\), which is using head loss. In any reactor, a flocculator in this case, the total energy dissipated is simply the head loss, \(h_L\). The amount of time required to dissipate that energy is the residence time of the water in the reactor, \(\theta\). Accounting for the fact that ‘head’ energy is due to gravity \(g\), we have all the parameters needed to determine another equation for energy dissipation rate:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:4}
\begin{split}\bar \varepsilon = \frac{g h_L}{\theta}\end{split}
\end{equation}
Note that the equation above is for \(\bar \varepsilon\), not \(\varepsilon\). Since the head loss term we are using, \(h_L\), occurs over the entire reactor, it can only be used to find an average energy dissipation rate for the entire reactor. Combining the equations above, \(G = \sqrt{\frac{\varepsilon}{\nu}}\) and \(\bar \varepsilon = \frac{g h_L}{\theta}\), we can get an equation for \(G_{CS}\) in terms of easily measureable parameters:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:5}
\begin{split}G_{CS} = \sqrt{\frac{g h_L}{\nu \theta}}\end{split}
\end{equation}
We can use this to obtain a final equation for collision potential of a reactor:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:6}
\begin{split}G_{CS} \theta = \sqrt{\frac{g h_L \theta}{\nu}}\end{split}
\end{equation}
\sphinxstylestrong{Note:} When we say \(G \theta\) we are almost always referring to \(G_{CS} \theta\).


\subsection{Generating Head Loss with Baffles}
\label{\detokenize{Flocculation/Floc_Design:generating-head-loss-with-baffles}}

\subsubsection{\sphinxstylestrong{What are Baffles?}}
\label{\detokenize{Flocculation/Floc_Design:what-are-baffles}}
Now that we know how to measure collision potential with head loss, we need a way to actually generate head loss. While both major or minor losses can be the design basis, it generally makes more sense to use major losses only for very low-flow flocculation (lab-scale) and minor losses for higher flows, as flocculation with minor losses tends to be more space-efficient. Since this book focuses on town and village-scale water treatment (5 L/S to 120 L/S), we will use minor losses as our design basis.

To generate minor losses, we need to create flow expansions. AguaClara does this with \sphinxstylestrong{baffles}, which are obstructions in the channel of a flocculator to force the flow to switch directions by 180°. Baffles in AguaClara plants are plastic sheets, and all of the baffles in one flocculator channel are connected to form a \sphinxstylestrong{baffle module.} \hyperref[\detokenize{Flocculation/Floc_Design:figure-ac-flocculator}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-ac-flocculator}}} shows an AguaClara flocculator and \hyperref[\detokenize{Flocculation/Floc_Design:figure-baffle-module}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-baffle-module}}} shows the assembly of a baffle module.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=1.000\linewidth]{{AC_flocculator}.jpg}
\caption{Clockwise from the top left the images show: the outline of the entire flocculator, some top and bottom baffles in the channels, the 4 flocculator channels in this flocculator, and the flow path of water through the flocculator}\label{\detokenize{Flocculation/Floc_Design:id5}}\label{\detokenize{Flocculation/Floc_Design:figure-ac-flocculator}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=0.500\linewidth]{{Baffle_module}.jpg}
\caption{Before being inserted into the floccualtor channel, the baffle module is constructed as a unit as shown here.}\label{\detokenize{Flocculation/Floc_Design:id6}}\label{\detokenize{Flocculation/Floc_Design:figure-baffle-module}}\end{figure}

AguaClara flocculators, like the one pictured above, are called \sphinxstylestrong{vertical hydraulic flocculators} because the baffles force the flow vertically up and down. If the baffles were instead arranged to force the flow side-to-side, the flocculator would be called a \sphinxstylestrong{horizontal hydraulic flocculator}. AguaClara uses vertical flocculators because they are more efficient when considering plant area. They are deeper than horizontal flocculators, which allows them to have a smaller \sphinxhref{https://simple.wikipedia.org/wiki/Plan\_view}{plan-view area} and thus to be cheaper.


\subsubsection{\sphinxstylestrong{Finding the Minor Loss of a Baffle}}
\label{\detokenize{Flocculation/Floc_Design:finding-the-minor-loss-of-a-baffle}}
Before beginning this section, it is important to understand how water flows through a baffled flocculator. This flow path is shown in \hyperref[\detokenize{Flocculation/Floc_Design:figure-flocculator-flow}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-flocculator-flow}}}. Take note of the thin red arrows; they indicate the compression of the flow around a baffle.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Flocculator_flow}.jpg}
\caption{Flow path through a vertical flow hydraulic flocculator}\label{\detokenize{Flocculation/Floc_Design:id7}}\label{\detokenize{Flocculation/Floc_Design:figure-flocculator-flow}}\end{figure}

Since baffles are the source of head loss via minor losses, we need to find the minor loss coefficient of one baffle if we want to be able to quantify its head loss. To do this, we apply fluid mechanics intuition and check it against a computational fluid dynamics (CFD) simulation. Flow around a 90° bend has a vena contracta value of around \(\Pi_{vc} = 0.62\). Flow around a 180° bend therefore has a value of \(\color{red}{\Pi_{vc, \, baffle} = \Pi_{vc}^2 = 0.384}\). This number is roughly confirmed with CFD, as shown in the image below.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=100\sphinxpxdimen]{{CFD_vc_baffle}.jpg}
\caption{The 180° bend at the end of a baffle results in a dramatic flow contraction with all of the flow passing through less than 40\% of the space between the baffles.}\label{\detokenize{Flocculation/Floc_Design:id8}}\label{\detokenize{Flocculation/Floc_Design:figure-cfd-vc-baffle}}\end{figure}

We can therefore state with reasonable accuracy that, when most contracted, the flow around a baffle goes through 38.4\% of the area it does when expanded, or \(A_{contracted} = \Pi_{vc, \, baffle} A_{expanded}\). Through the \sphinxtitleref{:ref:{}`third form of the minor loss equation \textless{}heading\_minor\_losses\textgreater{}}, \(h_e = K \frac{\bar v_{out}^2}{2g}\) and its definition of the minor loss coefficient, \(K = \left( \frac{A_{out}}{A_{in}} -1 \right)^2\), we can determine a \(k\) for flow around a single baffle:
\begin{align}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:7}\!\begin{aligned}
K_{baffle} = \left( \frac{A_{expanded}}{A_{contracted}} -1 \right)^2\\
K_{baffle} = \left( \frac{\rlap{\Big/} A_{expanded}}{\Pi_{vc, \, baffle} \rlap{\Big/} A_{expanded}} -1 \right)^2\\
K_{baffle} = \left( \frac{1}{0.384} -1 \right)^2\\
\color{red}{K_{baffle} = 2.56}\\
\end{aligned}\end{align}
This \(K_{baffle}\) has been used to design many flocculators in AguaClara plants. However, its value has not yet been rigorously tested for AguaClara plants the field. Therefore it might actually deviate from \(2.56\). Research and testing the \(K\) of a baffle in an AguaClara plant is ongoing, but for now the designs made under the assumption that \(\color{red}{K_{baffle} = 2.56}\) are functioning very well in AguaClara plants. Although research has been done by many academics on the minor loss coefficient, including \sphinxhref{https://iwaponline.com/aqua/article/47/3/142/31711/Design-of-around-the-end-hydraulic-flocculators}{this paper by Haarhoff in 1998}  (DOI: 10.2166/aqua.1998.20), the \(K_{baffle}\) values found are context dependent and empirically based. For AguaClara flocculator parameters, literature suggest a \(K_{baffle}\) value between \(2.5\) and \(4\).


\subsection{Flocculator Efficiency}
\label{\detokenize{Flocculation/Floc_Design:flocculator-efficiency}}
When designing an effective and efficient flocculator, there are two main problems that we seek to avoid:
\begin{enumerate}
\item {} 
Having certain sections in the flocculator with such high local \(G\) values that our big, fluffy flocs are sheared apart into smaller flocs.

\item {} 
Having dead space. Dead space means volume within the flocculator that is not being used to facilitate collisions. Dead space occurs after the flow has fully expanded from flowing around a baffle and before it reaches the next baffle.

\end{enumerate}

Fortunately for us, both problems can be quantified with a single ratio:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:8}
\begin{split}\Pi_{G_{CS}}^{G_{Max}} = \frac{G_{Max}}{G_{CS}}\end{split}
\end{equation}
High values of \(\Pi_{G_{CS}}^{G_{Max}}\) occur when one or both of the previous problems is present. If certain sections in the flocculator have very high local \(G\) values, then \(G_{Max}\) becomes large. If the flocculator has a lot of dead space, then \(G_{CS}\) becomes small. Either way, \(\Pi_{G_{CS}}^{G_{Max}}\) becomes larger.

\sphinxstylestrong{Note:} Recall the relationship between \(G\) and \(\varepsilon\) : \(G = \sqrt{ \frac{\varepsilon}{\nu} }\). From this relationship, we can see that \(G \propto \sqrt{\varepsilon}\). Thus, by defining  \(\Pi_{G_{CS}}^{G_{Max}}\), we can also define a ratio for Max to average energy dissipation rate:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:9}
\begin{split}\Pi_{\bar \varepsilon}^{\varepsilon_{Max}} = \left( \Pi_{G_{CS}}^{G_{Max}} \right)^2\end{split}
\end{equation}
Therefore, by making our \(\Pi_{G_{CS}}^{G_{Max}}\) as small as possible, we can be sure that our flocculator is efficient, and we no longer have to account for the previously mentioned problems. \sphinxhref{https://iwaponline.com/aqua/article/50/3/149/30498/Towards-optimal-design-parameters-for-around-the}{A paper by Haarhoff and van der Walt in 2001} (DOI: 10.2166/aqua.2001.0014) uses CFD to show that the minimum \(\Pi_{G_{CS}}^{G_{Max}}\) attainable in a hydraulic flocculator is \(\Pi_{G_{CS}}^{G_{Max}} = \sqrt{2} \approx 1.4\), which means that \(\Pi_{\bar \varepsilon}^{\varepsilon_{Max}} = \left( \Pi_{G_{CS}}^{G_{Max}} \right)^2 \approx 2\). So how do we optimize an AguaClara flocculator to make sure \(\Pi_{G_{CS}}^{G_{Max}} = \sqrt{2}\)?

We define and optimize a performance metric:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:10}
\begin{split}\frac{H_e}{S} = \Pi_{H_eS}\end{split}
\end{equation}
Where \(H_e\) is the distance between flow expansions in the flocculator and \(S\) is the spacing between baffles. For now, \(H_e\) is approximated as the height of water in the flocculator.

Since \(G_{Max}\) is determined by the fluid mechanics of flow around a baffle, our main concern is eliminating dead space in the flocculator. We do this by placing an upper limit on \(\frac{H_e}{S}\). To determine this upper limit, we need to find the distance it takes for the flow to fully expand after it has contracted around a baffle. We base this on the rule of thumb for flow expansion, a jet doubles its initial diameter/length once it travels 10 times the distance of its original diameter/length. If this is confusing, refer to the equation and image below:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:11}
\begin{split}\frac{x}{10} = D - D_0\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Jet_expansion_flocculator}.jpg}
\caption{A turbulent jet expands in width by one unit for every 10 units downstream.}\label{\detokenize{Flocculation/Floc_Design:id9}}\label{\detokenize{Flocculation/Floc_Design:figure-jet-expansion-flocculator}}\end{figure}

Using the equation and image above, we can find the distance required for the flow to fully expand around a baffle as a function of baffle spacing \(S\). We do this by substituting  \(D_0 = (0.384 S)\) along with \(D = S\) to approximate how much distance, \(x = H_e\), the contracted flow has to cover.
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:12}
\begin{split}\frac{H_e}{10} = S - (0.384 S)
\frac{H_e}{10} = 0.616 S
H_e = 6.16S
\frac{H_e}{S} = 6.16
\Pi_{H_eS_{Max}} = \frac{H_e}{S} = 6.16 \approx 6\end{split}
\end{equation}
This is the highest allowable \(\Pi_{H_eS}\) that we can design while ensuring that there is no dead space in the flocculator.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=0.500\linewidth]{{CFD_baffle_image}.jpg}
\caption{High \(\frac{H_e}{S}\) ratios result in flocculator zones with low velocity gradients that don’t contribute effectively.}\label{\detokenize{Flocculation/Floc_Design:id10}}\label{\detokenize{Flocculation/Floc_Design:figure-cfd-baffle-image}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{CFD_full_channel}.jpg}
\caption{Each bend creates a flow contraction and when the flow expands it converts kinetic energy into turbulent eddies and fluid deformation. The fluid deformation is what ultimately creates collisions between particles.}\label{\detokenize{Flocculation/Floc_Design:id11}}\label{\detokenize{Flocculation/Floc_Design:figure-cfd-full-channel}}\end{figure}

In order to have a robust design process for a baffle module, we need to have some flexibility in the \(\Pi_{H_eS} = \frac{H_e}{S}\) ratio. Since we found \(\Pi_{H_eS_{Max}}\) previously, we must now find the lowest functional \(\frac{H_e}{S}\) ratio, \(\Pi_{H_eS_{Min}}\).

AguaClara uses a fairly straightforward way of setting \(\Pi_{H_eS_{Min}}\). It is based on the distance between the water level and the bottom baffle (which is the same distance between the flocculator floor and a top baffle). This distance is referred to as the slot width (\sphinxhref{http://aqua.iwaponline.com/content/47/3/142}{Haarhoff 1998})  DOI: 10.2166/aqua.1998.20”) and is defined by the slot width ratio, which describes the slot width as a function of baffle spacing \(S\). Slot width is shown in the following image:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Slot_width_description}.jpg}
\caption{The space between the bottom of the upper baffle and the floor of the flocculator is defined as the slot width.}\label{\detokenize{Flocculation/Floc_Design:id12}}\label{\detokenize{Flocculation/Floc_Design:figure-slot-width-description}}\end{figure}

AguaClara uses a slot width ratio of 1 for its flocculators. This number has been the topic of much hydraulic flocculation research, and values between 1 and 1.5 are generally accepted for hydraulic flocculators. See the following paper and book respectively for more data on slot width ratios and other hydraulic flocculator parameters: \phantomsection\label{\detokenize{Flocculation/Floc_Design:id1}}{\hyperref[\detokenize{Flocculation/Floc_Design:floc-haarhoff-design-1998}]{\sphinxcrossref{{[}Haa98{]}}}}, {[}schulz\_surface\_1992{]}. We base our slot width ratio of 1 on research done by \phantomsection\label{\detokenize{Flocculation/Floc_Design:id3}}{\hyperref[\detokenize{Flocculation/Floc_Design:floc-haarhoff-towards-2001}]{\sphinxcrossref{{[}HvdW01{]}}}} on optimizing hydraulic flocculator parameters to maximize flocculator efficiency.

The minimum \(\Pi_{H_eS}\) allowable depends on the slot with ratio. If \(\Pi_{H_eS}\) is less than twice the slot width ratio, the water would flow straight through the flocculator without having to bend around the baffles. This means that the flocculator would not be generating almost any head loss, and the top and bottom of the flocculator will largely be dead space. See the following image for an example:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{HeS_ratio_min}.jpg}
\caption{The minimum \(\frac{H_e}{S}\) ratio is set by the need to prevent short circuiting through the flocculator.}\label{\detokenize{Flocculation/Floc_Design:id13}}\label{\detokenize{Flocculation/Floc_Design:figure-hes-ratio-min}}\end{figure}

Thus, \(\Pi_{H_eS_{Min}}\) should be at least twice the slot width ratio, \(\Pi_{H_eS_{Min}} = 2\). Historically, AguaClara plants have been designed using \(\Pi_{H_eS_{Min}} = 3\). This adds a safety factor of sorts, ensuring that the flow does not short-circuit through the flocculator and also allowing more space for the flow to expand after each contraction.
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:13}
\begin{split}\Pi_{H_eS_{Min}} = \frac{H_e}{S} = 3\end{split}
\end{equation}
Finally, we describe a range of \(\Pi_{H_eS}\) that we can use to design an AguaClara flocculator:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:14}
\begin{split}3 < \Pi_{H_eS} < 6\end{split}
\end{equation}

\subsubsection{Obstacles}
\label{\detokenize{Flocculation/Floc_Design:obstacles}}
Knowing that efficient flocculators require an \(\frac{H_e}{S}\) ratio that lies between 3 and 6, we need to understand how that impacts the flocculator design. Keeping \(\frac{H_e}{S}\) between two specific values limits the options for baffle spacing and quantity, due to the flocculator having certain size constraints before beginning the design of the baffles. This limitation places an upper limit on the amount of head loss that a baffled flocculator can generate, since the number of baffles is limited by space and baffles are what cause head loss. This is unfortunate, it means that baffled flocculators under certain size specifications can’t be designed to generate certain values of \(\bar \varepsilon\) and \(G_{CS}\) \sphinxstyleemphasis{while remaining efficient and maintaining} \(3 < \Pi_{H_eS} < 6\). This problem only arises for low flow plants, usually below \(Q_{Plant} = 20 {\rm \frac{L}{s}}\).

To get around this problem, AguaClara included ‘obstacles,’ or half-pipes to contract the flow after the flow expands around one baffle and before it reaches the next baffle. The purpose of these obstacles is to provide extra head loss in between baffles. They also generate head loss via minor losses, and one obstacle is designed to have the same \(K\) as one baffle. Introducing obstacles slightly alters how we think about \(H_e\). In a flocculator where there are just baffles and no obstacles, then \(H_e = H\), since the height of water in the flocculator is equal to the distance between expansions. When obstacles are added, however, then \(H_e = \frac{H}{1 + n_{obstacles}}\), where \(n_{obstacles}\) is the number of obstacles between two baffles.

\sphinxstylestrong{Baffle space} is the term we use for the space between two baffles. The number of flow expansions per baffle space is \(n_{expansions} = 1 + n_{obstacles}\). The \(1\) is because the baffle itself causes a flow expansion.

These obstacles serve as ‘pseudo-baffles’. They allow for \(\frac{H}{S}`\) to exceed 6, while maintaining maximum flocculator efficiency since, \(\frac{H_e}{S}\) can still be between 3 and 6. Obstacles make it possible to design smaller flocculators without compromising flocculation efficiency. \hyperref[\detokenize{Flocculation/Floc_Design:figure-floc-module-with-obstacles}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-floc-module-with-obstacles}}} and \hyperref[\detokenize{Flocculation/Floc_Design:figure-floc-flow-with-obstacles}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-floc-flow-with-obstacles}}} show these obstacles and how they affect the flow in a flocculator.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=800\sphinxpxdimen]{{Floc_module_with_obstacles}.jpg}
\caption{Obstacles are added so that the flow continually contracts and expands. Additional obstacles are needed for low flow plants where the spacing between baffles is small realtive to the flocculator depth.}\label{\detokenize{Flocculation/Floc_Design:id14}}\label{\detokenize{Flocculation/Floc_Design:figure-floc-module-with-obstacles}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=900\sphinxpxdimen]{{Floc_flow_with_obstacles}.jpg}
\caption{Obstacles ensure that there aren’t any zones with low velocity gradients.}\label{\detokenize{Flocculation/Floc_Design:id15}}\label{\detokenize{Flocculation/Floc_Design:figure-floc-flow-with-obstacles}}\end{figure}


\section{AguaClara Design of Hydraulic, Vertical Flow Flocculators}
\label{\detokenize{Flocculation/Floc_Design:aguaclara-design-of-hydraulic-vertical-flow-flocculators}}
AguaClara’s approach to flocculator design is the same as it is for any other unit process. First, critical design criteria, called inputs, are established. These criteria represent the priorities that the rest of the design will be based around. Once these parameters are established, then the other parameters of the design, which are dependent on the inputs, are calculated based on certain constraints.

Take the CDC as an example of this design process in {\hyperref[\detokenize{Flow_Control_and_Measurement/FCM_Design:title-flow-control-design}]{\sphinxcrossref{\DUrole{std,std-ref}{Flow Control and Measurement Design}}}}; its inputs are \(h_{L_{Max}}\), \(\sum K\), \(\Pi_{Error}\), and the discrete dosing tube diameters  \(D\) that are available at hardware stores or pipe suppliers. Its dependent variables include the number and length of the dosing tubes and the flow through the CDC system.

The flocculator is more complex to design than the CDC, as it has more details and parameters and the equations for those details and parameters are very interdependent. Therefore, there are many ways to design an AguaClara flocculator, and many different sets of critical design criteria to begin with. Enumerated below is the current AguaClara approach.
\begin{enumerate}
\item {} \begin{description}
\item[{Input parameters}] \leavevmode\begin{itemize}
\item {} 
Specify:
- \(h_{L_{floc}}\), head loss
- \(G_{CS} \theta\), collision potential
- \(Q\), plant flow rate
- \(H\), height of water \sphinxstyleemphasis{at the end of the flocculator}
- \(L_{Max, \, sed}\), max length of a flocculator channel based on sedimentation tank length
- \(W_{Min, \, human}\) minimum width of a single channel based on the width of the average human hip (someone’s got to go down there…)

\item {} 
Find:
- \(G_{CS}\), average velocity gradient
- \(\theta\), hydraulic retention time
- \(\rlap{--}V_{floc}\), flocculator volume

\end{itemize}

\end{description}

\item {} \begin{description}
\item[{Physical dimensions}] \leavevmode\begin{itemize}
\item {} 
Calculate:
- \(L_{channel}\), actual channel length
- \(n_{channels}\), amount of channels
- \(W_{channel}\), actual channel width

\end{itemize}

\end{description}

\item {} \begin{description}
\item[{Hydraulic parameters}] \leavevmode\begin{itemize}
\item {} 
Calculate:
- \(H_e\), distance between baffle/obstacle induced flow expansions
- \(n_{obstacles}\), amount of obstacles per baffle space
- \(S\), baffle spacing, distance between baffles

\end{itemize}

\end{description}

\end{enumerate}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Flocculator_physical_parameters}.jpg}
\caption{Flocculator geometry definition including the effect of baffle thickness. Accounting for baffle thickness would be particularly important if \sphinxhref{https://en.wikipedia.org/wiki/Ferrocement}{ferrocement} or wood were used for baffles.}\label{\detokenize{Flocculation/Floc_Design:id16}}\label{\detokenize{Flocculation/Floc_Design:figure-floculator-physical-parameters}}\end{figure}


\subsection{Input Parameters}
\label{\detokenize{Flocculation/Floc_Design:input-parameters}}

\subsubsection{Specify}
\label{\detokenize{Flocculation/Floc_Design:specify}}
We start by making sure that our flocculator will be able to flocculate effectively by defining \(h_{L_{floc}}\) and \(G_{CS} \theta\). Fixing these two parameters initially allows us to easily find all other parameters which determine flocculator performance. Here are the current standards in AguaClara flocculators:
- \(h_{L_{floc}} = 40 \, {\rm cm}\)
- \(G_{CS} \theta = 37,000\)

The plant flow rate \(Q\) is defined by the needs of the community that the plant is being desiged for. Additionally, the height of water \sphinxstyleemphasis{at the end} of the flocculator, \(H\), the \sphinxstyleemphasis{maximum} length of the flocculator based on the length of the sedimentation tank length, \(L_{Max, \, sed}\), and the \sphinxstyleemphasis{minimum} width of a flocculator channel required for a human to fit inside, \(W_{Min, \, human}\), are also defined initially. Ordinarilly in AguaClara plants, the flocculator occupies the same length dimension as the sedimentation tanks, which is why the length constraint exists. See \hyperref[\detokenize{Flocculation/Floc_Design:figure-physical-design-criteria-floc}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-physical-design-criteria-floc}}} for a representation of how the flocculator and sedimentation tanks are placed in a plant.
\begin{itemize}
\item {} 
\(H = 2 \, {\rm m}\)

\item {} 
\(L_{Max, \, sed} = 6 \, {\rm m}\)

\item {} 
\(W_{Min, \, human} = 45 \, {\rm cm}\)

\end{itemize}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Physical_design_criteria}.jpg}
\caption{Layout of flocculator and sedimentation tanks that was adopted starting with the 2nd AguaClara plant in Tamara, Honduras in 2008.}\label{\detokenize{Flocculation/Floc_Design:id17}}\label{\detokenize{Flocculation/Floc_Design:figure-physical-design-criteria-floc}}\end{figure}


\subsubsection{Find}
\label{\detokenize{Flocculation/Floc_Design:find}}
We can rearrange the equation for \(G_{CS}\) from the section on collision potential, \(G_{CS} = \sqrt{\frac{g h_L}{\nu \theta}}\), to solve for \(G_{CS}\) in terms of \(G_{CS} \theta\):
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:15}
\begin{split}G_{CS} = \frac{g h_{L_{floc}}}{\nu (G_{CS} \theta)}\end{split}
\end{equation}
Now that we have \(G_{CS}\), we can very easily find \(theta\):
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:16}
\begin{split}\theta = \frac{G_{CS} \theta}{G_{CS}}\end{split}
\end{equation}
Finally, we take retention time \(\theta\) over plant flow rate \(Q\) to get the required volume of the flocculator:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:17}
\begin{split}\rlap{--} V_{floc} = \frac{\theta}{Q}\end{split}
\end{equation}
Now that we have the basic parameters defined, we can start to design the details of the flocculator, starting from the physical dimensions.


\subsection{Physical Dimensions}
\label{\detokenize{Flocculation/Floc_Design:physical-dimensions}}
Deriving the equations required to find the physical dimensions now and the hydraulic parameters (baffle/obstacle design) in the next section requires many steps. To simplify this design explanation the equation derivations are developed in {\hyperref[\detokenize{Review/Review_Fluid_Mechanics_Derivations:title-review-fluid-mechanics-derivations}]{\sphinxcrossref{\DUrole{std,std-ref}{Review: Fluid Mechanics Derivations}}}}. All complex equations which seemingly came out of nowhere will be derived in the derivation sheet.


\subsubsection{Length}
\label{\detokenize{Flocculation/Floc_Design:length}}
Flocculator length, \(L_{channel}`\) must meet two constraints: it must be less than or equal to the length of the sedimentation tanks, as the flocculator is adjacent to the sed tanks. This constraint is \(L_{Max, \, sed}\). Next, the flocculator must be short enough to make sure the target volume of the flocculator is met, while still allowing for a human to fit inside \(L_{Max, \, \rlap{--} V}\). \sphinxstylestrong{The constraint that wins out is the one that results in the *smaller* length value}.
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:18}
\begin{split}L_{Max, \, sed} = 6 \, {\rm m}
L_{Max, \, \rlap{--}V} = \frac{\rlap{--} V}{n_{Min, \, channels} W_{Min, \, human} H}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(n_{Min, \, channels} = 2\)
\end{DUlineblock}

The reason why \(W_{Min, \, human}\) is used is because it represents the absolute minimum of flocculator channel width. If the width ends up being larger, the length will decrease. \(n_{Min, \, channels} = 2\)  to make sure that the flow ends up on the correct side of the sedimentation tank, as the image below shows. Note that there can only be an even number of flocculator channels, as explained in the image’s caption.

The equation for \sphinxstyleemphasis{actual} flocculator length is therefore:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:19}
\begin{split}L_{channel} = {\rm min}(L_{Max, \, sed}, \, L_{Max, \, \rlap{--} V})\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{Floc_channels}.jpg}
\caption{There are an even amount of flocculator channels to keep the AguaClara plant layout consistent for flows greater than 12 L/s. This ensures that the entrance tank, filter box, and filters can be kept in the same places across plants.}\label{\detokenize{Flocculation/Floc_Design:id18}}\label{\detokenize{Flocculation/Floc_Design:figure-floc-channels}}\end{figure}


\subsubsection{Width and Number of Channels}
\label{\detokenize{Flocculation/Floc_Design:width-and-number-of-channels}}
The width of a single flocculator channel must meet the following conditions:
- Maintain \(G_{CS}\) at the value found in the inputs section
- Allow for \(3 < \frac{H_e}{S} < 6\). Recall that \(\frac{H_e}{S} =  \Pi_{H_eS}\)
- Allow for a human to be able to fit into a flocculator channel

The first two conditions are wrapped up into the following equation, {\hyperref[\detokenize{Flocculation/Floc_Derivations:title-flocculation-derivations}]{\sphinxcrossref{\DUrole{std,std-ref}{which is derived here}}}}
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:20}
\begin{split}W_{Min, \, \Pi_{H_eS}} = \frac{\Pi_{H_eS}Q}{H_e}\left( \frac{K}{2 H_e \nu G_{CS}^2} \right)^\frac{1}{3}\end{split}
\end{equation}
This equation represents the absolute smallest width of a flocculator channel if we consider the lowest value of \(\Pi_{H_eS}\) and the highest possible value of \(H_e\):

\(H_e = H_{e_{Max}} = H = 2 \, {\rm m}\), this implies that there are no obstacles between baffles
\(\Pi_{H_eS} = \Pi_{ {HS}_{Min} } = 3\)

Recall our other width constraint, \(W_{Min, \, human} = 45 \, {\rm cm}\), which is based on our desire to have a human be able to fit into the channels. The governing constraint is the \sphinxstyleemphasis{larger} value of \(W_{Min}\):
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:21}
\begin{split}W_{Min} = {\rm max}(W_{Min, \, \Pi_{H_eS}}, \, W_{Min, \, human})\end{split}
\end{equation}
We can find the number of channels, \(n_{channels}\) and their actual width in one last step, by finding the \sphinxstyleemphasis{total flocculator width} if there were no channels and dividing that by the minimum flocculator width, \(W_{Min}\), found above. The equation for total flocculator width is based on our target volume:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:22}
\begin{split}W_{total} = \frac{\rlap{--} V}{H L_{channel}}\end{split}
\end{equation}
Finally:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:23}
\begin{split}n_{channels} = \frac{W_{total}}{W_{Min}}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(n_{channels}\) is an even number and is not 0. Usually, \(n_{channels}\) is either 2 or 4.
\end{DUlineblock}

Now that we know \(n_{channels}\), we can find the actual width of a channel, \(W_{channel}\).
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:24}
\begin{split}W_{channel} = \frac{W_{total}}{n_{channels}}\end{split}
\end{equation}

\subsection{Hydraulic Parameters}
\label{\detokenize{Flocculation/Floc_Design:hydraulic-parameters}}
Now that the physical dimensions of the flocculator have been defined, the baffle module needs to be designed. The parameter on which most others are based is the distance between flow expansions, \(H_e\). Recall that \(H_e = H\) when there are no obstacles in between baffles.


\subsubsection{Height Between Expansions \protect\(H_e\protect\) and Number of Obstacles per Baffle Space \protect\(n_{obstacles}\protect\)}
\label{\detokenize{Flocculation/Floc_Design:height-between-expansions-and-number-of-obstacles-per-baffle-space}}
We have a range of possible \(H_e\) values based on our window of \(3 < \frac{H_e}{S} < 6\). However, we have a limitation and a preference which shape how we design \(H_e\). Our limitation is that there can only be an integer number of obstacles. Our preference is to have as few obstacles as possible to make the baffle module as easy to fabricate as possible. Therefore, we want \(H_e\) to be closer to \(6\) than it is to \(3\); we are looking for \(H_{e_{Max}}\).

We calculate \(H_{e_{Max}}\) based on the physical flocculator dimensions. The equation for \(H_e\) is obtained by rearranging one of the equations for minimum channel width found above, \(W_{Min, \, \Pi_{H_eS}} = \frac{\Pi_{H_eS}Q}{H_e}\left( \frac{K}{2 H_e \nu G_{CS}^2} \right)^\frac{1}{3}\). Because we have already design the channel width, we substitute \(W_{channel}\) for \(W_{Min, \, \Pi_{H_eS}}\). Since we are looking for \(H_{e_{Max}}\), we also substitute \(\Pi_{{HS}_{Max}}\) for \(\Pi_{H_eS}\). The result is:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:25}
\begin{split}H_{e_{Max}} = \left[ \frac{K}{2 \nu G_{CS}^2} \left( \frac{Q \Pi_{{HS}_{Max}}}{W_{channel}} \right)^3 \right]^\frac{1}{4}\end{split}
\end{equation}
Note that this is the \sphinxstyleemphasis{maximum} distance between flow expansions, and does not account for the limitation that there must be an integer number of obstacles per baffle space. Thus, we need to find the \sphinxstyleemphasis{actual} distance between flow expansions. To do this, we determine and round up the number of expansions per baffle space using the ceiling function:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:26}
\begin{split}n_{expansions} = {\rm ceil}\left( \frac{H}{H_{e_{Max}}} \right)\end{split}
\end{equation}
If we had used the floor() function instead, we would find that \(H_e\) would be larger than our upper bound, \(H_{e_{Max}}\). From here, we can easily get to the actual number of flow expansions per baffle spacing:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:27}
\begin{split}H_e = \frac{H}{n_{expansions}}\end{split}
\end{equation}
Finally, we can obtain the number of obstacles per baffle space. The \(- 1\) in the equation is because the baffles themselves provide one flow expansion per baffle space.
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:28}
\begin{split}n_{obstacles} = \frac{H}{H_e} - 1\end{split}
\end{equation}

\subsubsection{Baffle Spacing}
\label{\detokenize{Flocculation/Floc_Design:baffle-spacing}}
Finally, we can find the space between baffles, \(S\). The equation for \(S\) is taken from an intermediate step in the \(W_{Min, \, \Pi_{H_eS}}\) derivation where we obtained, \(W = \frac{Q}{S}\left( \frac{K}{2 H_e \nu G_{CS}^2} \right)^\frac{1}{3}\). Rearranging for \(S\), we get:
\begin{equation}\label{equation:Flocculation/Floc_Design:Floc_baffle_spacing}
\begin{split}S = \left( \frac{K}{2 H_e G_{CS}^2 \nu } \right)^\frac{1}{3} \frac{Q}{W_{channel}}\end{split}
\end{equation}
Fortunately, we either know or have already designed all the parameters in this equation.


\section{Checking the Flocculator Design}
\label{\detokenize{Flocculation/Floc_Design:checking-the-flocculator-design}}
We then compare \(n_{spaces, \, required}\) to \(n_{spaces, \, actual}\) to make sure that they are equal.


\subsection{Average Velocity in the Flocculator Check}
\label{\detokenize{Flocculation/Floc_Design:average-velocity-in-the-flocculator-check}}
As water flows through the flocculators, the flocs will get larger and larger. As a result, their terminal sedimentation velocity will increase. This is what we want. However, we need to make sure that the flocs don’t settle in the flocculator; that they instead all settle in the sedimentation tank. To make sure of this, we need to make sure that the velocity of water in the flocculator is high enough to scour any flocs that fall to the bottom of the flocculator. The velocity required to scour flocs from the bottom and avoid floc accumulation is around \(v_{scour} = 15 \, {\rm \frac{cm}{s}}\). We need to check our average velocity \(\bar v\) against this value.
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:29}
\begin{split}\bar v = \frac{Q}{W_{channel} S}\end{split}
\end{equation}

\subsection{Residence Time of Water in the Flocculator Check}
\label{\detokenize{Flocculation/Floc_Design:residence-time-of-water-in-the-flocculator-check}}
It is now time to make our final check. We need to make sure that our actual residence time is \sphinxstyleemphasis{at least} as much as we designed for. Fortunately, in our design we did not account for the change in water level throughout the flocculator due to head loss. Therefore, the actual volume of water in the flocculator is actually greater than \(\rlap{--} V_{floc}\). See \hyperref[\detokenize{Flocculation/Floc_Design:figure-flocculator-head-loss}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design:figure-flocculator-head-loss}}} for clarification.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Flocculator_head_loss}.jpg}
\caption{The water level in the flocculator decreases due to head loss. Flocculators may occupy multiple channels, but this extra triangle of water exists in any case.}\label{\detokenize{Flocculation/Floc_Design:id19}}\label{\detokenize{Flocculation/Floc_Design:figure-flocculator-head-loss}}\end{figure}

Thus, the actual average water level in the flocculator is \(H + \frac{h_{L_{floc}}}{2}\). Thus, the actual residence time is:
\begin{equation}\label{equation:Flocculation/Floc_Design:Flocculation/Floc_Design:30}
\begin{split}\theta_{actual} = \frac{n_{channels} L_{channel} W_{channel} \left( H + \frac{h_{L_{floc}}}{2} \right)} {Q}\end{split}
\end{equation}
Check to see if \(\theta_{actual}\) is greater than \(\theta\).




\chapter{Flocculation Derivations}
\label{\detokenize{Flocculation/Floc_Derivations:flocculation-derivations}}\label{\detokenize{Flocculation/Floc_Derivations:title-flocculation-derivations}}\label{\detokenize{Flocculation/Floc_Derivations::doc}}

\section{Design Equations for the Flocculator}
\label{\detokenize{Flocculation/Floc_Derivations:design-equations-for-the-flocculator}}\label{\detokenize{Flocculation/Floc_Derivations:heading-design-equations-for-the-flocculator}}
This document contains the derivation for the minimum allowable width of
a flocculator channel based on the requirements that
\(3 < \Pi_{H_eS} < 6\) and that we maintain the \(\bar G\) that
serves as a basis for design. The final parameter derived is
\(W_{Min, \, \Pi_{H_eS}}\).


\subsection{Width}
\label{\detokenize{Flocculation/Floc_Derivations:width}}
Our two restrictions are: - Ensuring that we maintain the \(\bar G\)
we get based on our input parameters - Ensuring that
\(3 < \frac{H_e}{S} < 6\)

First, we begin by setting the two equations for energy dissipation
rate, \(\bar \varepsilon = \nu \bar G^2\) and
\(\bar \varepsilon = \frac{g h_{L_{floc}}}{\theta}\) equal to each
other to bring \(\bar G\) into the equation.
\begin{equation}\label{equation:Flocculation/Floc_Derivations:Flocculation/Floc_Derivations:0}
\begin{split}\nu \bar G^2 = \frac{g h_{L_{floc}}}{\theta}\end{split}
\end{equation}
\sphinxstylestrong{Very Important Note:}

For the following steps, we will consider the flow through a single
flow expansion \(H_e\), not through the entire flocculator. This
could be from baffle to obstacle, obstacle to baffle, obstacle to
obstacle, or baffle to baffle depending on how many obstacles are in the
design. This means that we are briefly redefining \(\theta\) to be
the time it takes for the flow to fully expand after a flow contraction.
\(\theta\) no longer represents the time it takes for the flow to go
through the entire flocculator.

From here we make three subsequent substitutions: first
\(h_{L_{floc}} = K \frac{\bar v^2}{2g}\), then
\(\theta = \frac{H_e}{\bar v}\), and finally
\(\bar v = \frac{Q}{WS}\)
\begin{equation}\label{equation:Flocculation/Floc_Derivations:Flocculation/Floc_Derivations:1}
\begin{split}\nu \bar G^2 = K \frac{\bar v^2}{2 \theta}\end{split}
\end{equation}\begin{equation}\label{equation:Flocculation/Floc_Derivations:Flocculation/Floc_Derivations:2}
\begin{split}\nu \bar G^2 = K \frac{\bar v^3}{2 H_e}\end{split}
\end{equation}\begin{equation}\label{equation:Flocculation/Floc_Derivations:Flocculation/Floc_Derivations:3}
\begin{split}\nu \bar G^2 = \frac{K}{2 H_e} \left( \frac{Q}{WS} \right)^3\end{split}
\end{equation}
Now we can solve this equation for channel width, \(W\).
\begin{equation}\label{equation:Flocculation/Floc_Derivations:Flocculation/Floc_Derivations:4}
\begin{split}W = \frac{Q}{S}\left( \frac{K}{2 H_e \nu \bar G^2} \right)^\frac{1}{3}\end{split}
\end{equation}
From here, we can define \(\Pi_{H_eS} = \frac{H_e}{S}\) and
substitute \(S = \frac{H_e}{\Pi_{H_eS}}\) into the previous equation
for \(W\) to get \(W_{Min, \, \Pi_{H_eS}}\):
\begin{equation}\label{equation:Flocculation/Floc_Derivations:Flocculation/Floc_Derivations:5}
\begin{split}W_{Min, \, \Pi_{H_eS}} = \frac{\Pi_{H_eS}Q}{H_e}\left( \frac{K}{2 H_e \nu \bar G^2} \right)^\frac{1}{3}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] This equation represents the absolute smallest width of a flocculator
channel if we consider the lowest value of \(\Pi_{H_eS}\) and the
highest possible value of \(H_e\):
\item[] \(H_e = H\), this implies that there are no obstacles between
baffles
\item[] \(\Pi_{H_eS} = 3\)
\end{DUlineblock}


\chapter{Flocculation Theory and Future Work}
\label{\detokenize{Flocculation/Floc_Theory_and_Future_Work:flocculation-theory-and-future-work}}\label{\detokenize{Flocculation/Floc_Theory_and_Future_Work:title-flocculation-theory-and-future-work}}\label{\detokenize{Flocculation/Floc_Theory_and_Future_Work::doc}}

\chapter{Flocculation Examples}
\label{\detokenize{Flocculation/Floc_Examples:flocculation-examples}}\label{\detokenize{Flocculation/Floc_Examples:title-flocculation-examples}}\label{\detokenize{Flocculation/Floc_Examples::doc}}

\section{Pipe flocculator}
\label{\detokenize{Flocculation/Floc_Examples:pipe-flocculator}}
The following analysis requires complete reworking.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} \PYGZpc{}\PYGZpc{}}
\PYG{c+c1}{\PYGZsh{}Assumptions}
\PYG{n}{Pi\PYGZus{}VC} \PYG{o}{=} \PYG{o}{.}\PYG{l+m+mi}{62} \PYG{c+c1}{\PYGZsh{}Vena contracta coefficient of an orifice}
\PYG{n}{Ke} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{Pi\PYGZus{}VC}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{c+c1}{\PYGZsh{}expansion coefficient}

\PYG{c+c1}{\PYGZsh{}Functions to calculate key parameters}

\PYG{k}{def} \PYG{n+nf}{Gave}\PYG{p}{(}\PYG{n}{G\PYGZus{}theta}\PYG{p}{,}\PYG{n}{h\PYGZus{}floc}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Calculates average G given target minimum collision potential, total headloss, and design temperature}
\PYG{l+s+sd}{    equation from flocculation slides\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{G\PYGZus{}ave} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}\PYG{o}{*}\PYG{n}{h\PYGZus{}floc}\PYG{o}{/}\PYG{p}{(}\PYG{n}{G\PYGZus{}theta}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{G\PYGZus{}ave}

\PYG{k}{def} \PYG{n+nf}{restime}\PYG{p}{(}\PYG{n}{G\PYGZus{}theta}\PYG{p}{,}\PYG{n}{G\PYGZus{}ave}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Calculates residence time given collision potential and average G}
\PYG{l+s+sd}{    equation from flocculation slides\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{theta} \PYG{o}{=} \PYG{n}{G\PYGZus{}theta}\PYG{o}{/}\PYG{n}{G\PYGZus{}ave}
    \PYG{k}{return} \PYG{n}{theta}


\PYG{k}{def} \PYG{n+nf}{Dpipe}\PYG{p}{(}\PYG{n}{Ke}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}HS}\PYG{p}{,}\PYG{n}{Q}\PYG{p}{,}\PYG{n}{G\PYGZus{}ave}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Calculates the actual inner diameter of the pipe}
\PYG{l+s+sd}{    equation from flocculation slides\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{D\PYGZus{}pipe} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{Ke}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{Pi\PYGZus{}HS}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)}\PYG{o}{*}\PYG{n}{G\PYGZus{}ave}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{Q}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{7}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{D\PYGZus{}pipe}

\PYG{k}{def} \PYG{n+nf}{Keactual}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{G\PYGZus{}ave}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}HS}\PYG{p}{,}\PYG{n}{Q}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}estimates actual expansion coefficient given the actual inner diameter and other relevant inputs}
\PYG{l+s+sd}{    equation from flocculation slides\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{Ke\PYGZus{}actual} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{ID\PYGZus{}pipe}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{7}\PYG{o}{*}\PYG{n}{G\PYGZus{}ave}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)}\PYG{o}{*}\PYG{n}{Pi\PYGZus{}HS}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{32}\PYG{o}{*}\PYG{n}{Q}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{Ke\PYGZus{}actual}



\PYG{k}{def} \PYG{n+nf}{Aorifice}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{Ke\PYGZus{}actual}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{,}\PYG{n}{Q}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Calculates the orifice area given pipe inner diameter, expansion coefficient, Temperature, and flow\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{A1} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude} \PYG{c+c1}{\PYGZsh{}Pipe area}
    \PYG{n}{Nu} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}kinematic viscocity}
    \PYG{n}{Re} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{re\PYGZus{}pipe}\PYG{p}{(}\PYG{n}{Q}\PYG{p}{,}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{Nu}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}reynolds number}

    \PYG{k}{def} \PYG{n+nf}{f\PYGZus{}orif}\PYG{p}{(}\PYG{n}{A2}\PYG{p}{,}\PYG{n}{A1}\PYG{p}{,}\PYG{n}{Ke\PYGZus{}actual}\PYG{p}{,}\PYG{n}{Re}\PYG{p}{)}\PYG{p}{:} \PYG{c+c1}{\PYGZsh{}root of this function is the orifice area}
        \PYG{k}{return} \PYG{p}{(}\PYG{l+m+mf}{2.72}\PYG{o}{+}\PYG{p}{(}\PYG{n}{A2}\PYG{o}{/}\PYG{n}{A1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{4000}\PYG{o}{/}\PYG{n}{Re}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{A2}\PYG{o}{/}\PYG{n}{A1}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{n}{A1}\PYG{o}{/}\PYG{n}{A2}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{Ke\PYGZus{}actual}

    \PYG{n}{A\PYGZus{}orifice} \PYG{o}{=} \PYG{p}{(}\PYG{n}{brentq}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{A2}\PYG{p}{:} \PYG{n}{f\PYGZus{}orif}\PYG{p}{(}\PYG{n}{A2}\PYG{p}{,}\PYG{n}{A1}\PYG{p}{,}\PYG{n}{Ke\PYGZus{}actual}\PYG{p}{,}\PYG{n}{Re}\PYG{p}{)}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{A1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{c+c1}{\PYGZsh{}numerical optimization}

    \PYG{k}{return} \PYG{n}{A\PYGZus{}orifice}


\PYG{k}{def} \PYG{n+nf}{eave}\PYG{p}{(}\PYG{n}{G\PYGZus{}ave}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Calculates the average energy dissipation rate\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{e\PYGZus{}ave} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)}\PYG{o}{*}\PYG{n}{G\PYGZus{}ave}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{e\PYGZus{}ave}

\PYG{k}{def} \PYG{n+nf}{Hchip}\PYG{p}{(}\PYG{n}{A\PYGZus{}orifice}\PYG{p}{,}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}This function calculates the height of the chip based on the orifice area and pipe diameter}
\PYG{l+s+sd}{    The function uses numerical optimization to solve the transcendental equation\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{A\PYGZus{}flow} \PYG{o}{=} \PYG{n}{A\PYGZus{}orifice}\PYG{o}{.}\PYG{n}{magnitude} \PYG{c+c1}{\PYGZsh{}orifice area stripped of units}
    \PYG{n}{r}\PYG{o}{=}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{.}\PYG{n}{magnitude} \PYG{c+c1}{\PYGZsh{}radius stripped of units}
    \PYG{n}{c} \PYG{o}{=} \PYG{n}{A\PYGZus{}flow}\PYG{o}{/}\PYG{n}{r}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{c+c1}{\PYGZsh{}left hand side of equation}

    \PYG{k}{def} \PYG{n+nf}{f}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,}\PYG{n}{c}\PYG{p}{)}\PYG{p}{:} \PYG{c+c1}{\PYGZsh{}roots of this function are theta}
        \PYG{k}{return} \PYG{n}{a}\PYG{o}{\PYGZhy{}}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}\PYG{o}{*}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{a}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n}{c}

    \PYG{n}{theta} \PYG{o}{=} \PYG{n}{brentq}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{a}\PYG{p}{:} \PYG{n}{f}\PYG{p}{(}\PYG{n}{a}\PYG{p}{,}\PYG{n}{c}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{13}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}numerical optimization}
    \PYG{n}{r\PYGZus{}u} \PYG{o}{=} \PYG{n}{r}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm} \PYG{c+c1}{\PYGZsh{}radius with units}
    \PYG{n}{y} \PYG{o}{=} \PYG{n}{r\PYGZus{}u} \PYG{o}{\PYGZhy{}} \PYG{n}{r\PYGZus{}u}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{theta}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}height of orifice}

    \PYG{n}{H\PYGZus{}chip} \PYG{o}{=} \PYG{n}{ID\PYGZus{}pipe}\PYG{o}{\PYGZhy{}}\PYG{n}{y} \PYG{c+c1}{\PYGZsh{}height of chip}
    \PYG{k}{return} \PYG{n}{H\PYGZus{}chip}

\PYG{k}{def} \PYG{n+nf}{Cost\PYGZus{}Length}\PYG{p}{(}\PYG{n}{L\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{ND\PYGZus{}pipe}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}This function calculates the total cost of the system and the total length of the system\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{c+c1}{\PYGZsh{}Length of pipe and number of fittings needed}
    \PYG{n}{OD\PYGZus{}pipe} \PYG{o}{=} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{OD}\PYG{p}{(}\PYG{n}{ND\PYGZus{}pipe}\PYG{p}{)}
    \PYG{n}{Total\PYGZus{}Pipe} \PYG{o}{=} \PYG{n}{L\PYGZus{}pipe} \PYG{o}{+} \PYG{o}{.}\PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
    \PYG{n}{Number\PYGZus{}T} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{n}{Total\PYGZus{}Pipe}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}
    \PYG{n}{Number\PYGZus{}Elbow} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{n}{Total\PYGZus{}Pipe}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{ND\PYGZus{}pipe}\PYG{o}{.}\PYG{n}{magnitude} \PYG{o}{==} \PYG{l+m+mi}{3}\PYG{p}{:}
        \PYG{n}{Cost\PYGZus{}T} \PYG{o}{=} \PYG{l+m+mf}{3.94}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Cost\PYGZus{}Elbow} \PYG{o}{=} \PYG{l+m+mf}{3.53}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Cost\PYGZus{}Pipe} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{17.14}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{foot}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
        \PYG{n}{Cost\PYGZus{}Valve} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Width\PYGZus{}T} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{3.99}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
        \PYG{n}{Width\PYGZus{}Elbow} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{3.97}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}


    \PYG{k}{if} \PYG{n}{ND\PYGZus{}pipe}\PYG{o}{.}\PYG{n}{magnitude} \PYG{o}{==}\PYG{l+m+mi}{4}\PYG{p}{:}
        \PYG{n}{Cost\PYGZus{}T} \PYG{o}{=} \PYG{l+m+mf}{7.16}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Cost\PYGZus{}Elbow} \PYG{o}{=} \PYG{l+m+mf}{5.40}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Cost\PYGZus{}Pipe} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{21.5}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{foot}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
        \PYG{n}{Cost\PYGZus{}Valve} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Width\PYGZus{}T} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{5.06}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
        \PYG{n}{Width\PYGZus{}Elbow} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{5.06}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

    \PYG{k}{if} \PYG{n}{ND\PYGZus{}pipe}\PYG{o}{.}\PYG{n}{magnitude} \PYG{o}{==}\PYG{l+m+mi}{6}\PYG{p}{:}
        \PYG{n}{Cost\PYGZus{}T} \PYG{o}{=} \PYG{l+m+mf}{7.16}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Cost\PYGZus{}Elbow} \PYG{o}{=} \PYG{l+m+mf}{5.40}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Cost\PYGZus{}Pipe} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{21.5}\PYG{o}{/}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{foot}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
        \PYG{n}{Cost\PYGZus{}Valve} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dollar}
        \PYG{n}{Width\PYGZus{}T} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{5.06}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
        \PYG{n}{Width\PYGZus{}Elbow} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{5.06}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}


    \PYG{n}{Total\PYGZus{}Cost} \PYG{o}{=} \PYG{n}{Cost\PYGZus{}Pipe}\PYG{o}{*}\PYG{n}{Total\PYGZus{}Pipe} \PYG{o}{+} \PYG{n}{Cost\PYGZus{}T}\PYG{o}{*}\PYG{n}{Number\PYGZus{}T} \PYG{o}{+} \PYG{n}{Cost\PYGZus{}Elbow}\PYG{o}{*}\PYG{n}{Number\PYGZus{}Elbow} \PYG{o}{+} \PYG{n}{Cost\PYGZus{}Valve}\PYG{o}{*}\PYG{n}{Number\PYGZus{}Elbow}
    \PYG{n}{Floor\PYGZus{}Length} \PYG{o}{=} \PYG{n}{Number\PYGZus{}T}\PYG{o}{*}\PYG{p}{(}\PYG{n}{Width\PYGZus{}T}\PYG{o}{+}\PYG{n}{Width\PYGZus{}Elbow}\PYG{o}{\PYGZhy{}}\PYG{n}{OD\PYGZus{}pipe}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
    \PYG{n}{Output}\PYG{o}{=}\PYG{p}{[}\PYG{n}{Total\PYGZus{}Cost}\PYG{p}{,}\PYG{n}{Floor\PYGZus{}Length}\PYG{p}{]}
    \PYG{k}{return} \PYG{n}{Output}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Inputs}
\PYG{n}{D\PYGZus{}Sed} \PYG{o}{=} \PYG{l+m+mf}{2.5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{A\PYGZus{}Sed} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{D\PYGZus{}Sed}\PYG{p}{)}
\PYG{n}{v\PYGZus{}Sed} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{Q} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}Sed}\PYG{o}{*}\PYG{n}{A\PYGZus{}Sed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mL}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow rate is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Q}\PYG{p}{)}

\PYG{n}{Temp} \PYG{o}{=} \PYG{l+m+mi}{15}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{h\PYGZus{}floc} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm} \PYG{c+c1}{\PYGZsh{}standard for Aguaclara plants}
\PYG{n}{G\PYGZus{}theta} \PYG{o}{=} \PYG{l+m+mi}{20000} \PYG{c+c1}{\PYGZsh{}standard for Aguaclara plants}
\PYG{n}{Pi\PYGZus{}HS} \PYG{o}{=} \PYG{l+m+mi}{6}  \PYG{c+c1}{\PYGZsh{}\PYGZsh{}3\PYGZhy{}6 is a good range, more research needed}
\PYG{n}{SDR} \PYG{o}{=} \PYG{l+m+mi}{41} \PYG{c+c1}{\PYGZsh{}Standard ratio}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Calculate G average using functions listed above and given inputs}
\PYG{n}{G\PYGZus{}ave} \PYG{o}{=} \PYG{n}{Gave}\PYG{p}{(}\PYG{n}{G\PYGZus{}theta}\PYG{p}{,}\PYG{n}{h\PYGZus{}floc}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{)}
\PYG{n}{theta} \PYG{o}{=} \PYG{n}{restime}\PYG{p}{(}\PYG{n}{G\PYGZus{}theta}\PYG{p}{,}\PYG{n}{G\PYGZus{}ave}\PYG{p}{)}
\PYG{n}{e\PYGZus{}ave} \PYG{o}{=} \PYG{n}{eave}\PYG{p}{(}\PYG{n}{G\PYGZus{}ave}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The average G value is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{G\PYGZus{}ave}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The residence time in the flocculator is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{theta}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The average energy dissipation rate is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{e\PYGZus{}ave}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Calculate the pipe diameter, both inner and nominal and determine area of pipe using inner diameter output}
\PYG{n}{D\PYGZus{}pipe} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Dpipe}\PYG{p}{(}\PYG{n}{Ke}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}HS}\PYG{p}{,}\PYG{n}{Q}\PYG{p}{,}\PYG{n}{G\PYGZus{}ave}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}Calculate nominal diameter of pipe}
\PYG{n}{ND\PYGZus{}pipe} \PYG{o}{=} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ND\PYGZus{}SDR\PYGZus{}available}\PYG{p}{(}\PYG{n}{D\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}Calculate nominal diameter of pipe}
\PYG{n}{ID\PYGZus{}pipe} \PYG{o}{=} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n}{ID\PYGZus{}pipe} \PYG{o}{=} \PYG{l+m+mi}{5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}
\PYG{c+c1}{\PYGZsh{}Calculate inner diameter of pipe}
\PYG{n}{A\PYGZus{}pipe} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The ideal inner diameter of the pipe would be }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{D\PYGZus{}pipe}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The nominal diameter of the pipe is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ND\PYGZus{}pipe}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{, and the inner diameter is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ID\PYGZus{}pipe}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The area of the pipe is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{A\PYGZus{}pipe}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Calculate the actual Ke as a result of the calculated inner pipe diameter}
\PYG{n}{Ke\PYGZus{}actual} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Keactual}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{G\PYGZus{}ave}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}HS}\PYG{p}{,}\PYG{n}{Q}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The initial expansion minor loss coefficient was }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Ke}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The actual expansion minor loss coefficient is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Ke\PYGZus{}actual}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Calculate the orifice area}
\PYG{n}{A\PYGZus{}orifice} \PYG{o}{=} \PYG{n}{Aorifice}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{,}\PYG{n}{Ke\PYGZus{}actual}\PYG{p}{,}\PYG{n}{Temp}\PYG{p}{,}\PYG{n}{Q}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The orifice area is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{A\PYGZus{}orifice}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} The following line of code needs to be removed once the orifice area equation is corrected.}

\PYG{n}{H\PYGZus{}chip} \PYG{o}{=} \PYG{n}{Hchip}\PYG{p}{(}\PYG{n}{A\PYGZus{}orifice}\PYG{p}{,}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The height of the chip is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{H\PYGZus{}chip}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Calculate average velocity}
\PYG{n}{v\PYGZus{}avg} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Q}\PYG{o}{/}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{ID\PYGZus{}pipe}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}first calculate average velocity}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The average velocity is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{v\PYGZus{}avg}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Calculate pipe length}
\PYG{n}{L\PYGZus{}pipe} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}avg}\PYG{o}{*}\PYG{n}{theta}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}then multiply velocity by residence time to get the required length of pipe}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The length of the pipe is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{L\PYGZus{}pipe}\PYG{p}{)}
\end{sphinxVerbatim}


\chapter{Mechanical Flocculator Solution}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:mechanical-flocculator-solution}}\label{\detokenize{Flocculation/Floc_Mechanical_Solution::doc}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}

In this design challenge, you will design a mechanical flocculator and power unit. You will use a flow rate of 50 L/s as your default design value. The coldest temperature that the raw water is expected to have is 10°C.
You will also play with fractal flocculation model equations to get a sense of how fast flocs can aggregate. You will also explore the floc model predictions.

As you define variables, take care not to redefine parameters. One trick is to use a unique name for variables that are estimates. We often add “est” to any variable names that aren’t the final values.

The \sphinxcode{\sphinxupquote{floc\_model.py}} file contains many useful functions which includes clay, coagulant and humic acid material properties, fractal model equations, and flocculation model equations. \sphinxstylestrong{We recommend that you open the {}`{}`floc\_model.py{}`{}` and have it side by side with this design challenge for easy reference.}

The course slides found on the syllabus will be very useful for obtaining and understanding relevant equations for this design challenge and ones in the future.


\section{Conventional Design Guidelines}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:conventional-design-guidelines}}
This table for mechanical flocculators is taken from Sincero and Sincero’s 1996 textbook: \sphinxstyleemphasis{Environmental Engineering: A Design Approach}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
Type
&\sphinxstyletheadfamily 
Velocity
Gradient
(G) (1/s)
&\sphinxstyletheadfamily 
Energy
Dissipation
Rate
&\sphinxstyletheadfamily 
Gt
&\sphinxstyletheadfamily 
t (min)
\\
\hline
Low
turbidity,
color
removal
&
20-70
&
0.4 - 4.9
&
50,000 -
250,000
&
11 - 210
\\
\hline
High
turbidity,
solids
removal
&
70 - 180
&
4.9 - 32
&
80,000 -
190,000
&
7 - 45
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

Dissolved organic matter impacts the color of the water. Perhaps the reason for lower G values for color removal is because flocs created from dissolved organic matter are weaker or less dense. Hence, a lower G is needed to allow them to grow large enough for removal in the sedimentation tank.


\section{Mechanical Flocculator Design}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:mechanical-flocculator-design}}
The conventional design guidelines provide a range of values with little guidance on how to select “velocity gradient” or G values. One approach is to hope for the best and choose a G value in the middle of the range. We will pick the G value that is apparently appropriate for both low and high turbidity waters.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flow\PYGZus{}plant} \PYG{o}{=} \PYG{l+m+mi}{50} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{G\PYGZus{}mech} \PYG{o}{=} \PYG{l+m+mi}{70} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{temp\PYGZus{}design} \PYG{o}{=} \PYG{l+m+mi}{10} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\end{sphinxVerbatim}


\subsection{1)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id1}}
The \sphinxhref{http://10statesstandards.com/}{Ten State Standards} (with the hilarious acronym GLUMRB) requires the residence time in a mechanical flocculator to be 30 minutes. What is the value of Gt if you use the velocity gradient given above as \sphinxcode{\sphinxupquote{G\_mech}}?

Note: \sphinxcode{\sphinxupquote{.to(u.dimensionless)}} ensures you don’t get weird dimensions like kilometer/inch or minute/second for dimensionless parameters.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{time\PYGZus{}mech} \PYG{o}{=} \PYG{l+m+mi}{30} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{min}
\PYG{n}{Gtime\PYGZus{}mech}\PYG{o}{=} \PYG{p}{(}\PYG{n}{G\PYGZus{}mech} \PYG{o}{*} \PYG{n}{time\PYGZus{}mech}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The Gt is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Gtime\PYGZus{}mech}\PYG{p}{)}
\end{sphinxVerbatim}

The Gt is 126000


\subsection{2)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id2}}
Calculate the equivalent average energy dissipation rate (in mW/kg) for the given velocity gradient at the design temperature.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ave} \PYG{o}{=} \PYG{p}{(}\PYG{n}{G\PYGZus{}mech}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The equivalent average energy dissipation rate is}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,} \PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ave}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The equivalent average energy dissipation rate is 6.4 mW/kg


\subsection{3)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id3}}
Create a function to calculate the power requirement for mechanical flocculators. Then, use your function to obtain the power requirement for the design temperature. The equation for power is the same one that we used for mechanical rapid mix units.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{k}{def} \PYG{n+nf}{power\PYGZus{}floc\PYGZus{}shaft}\PYG{p}{(}\PYG{n}{Q}\PYG{p}{,} \PYG{n}{G}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{temp}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{G}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{Q} \PYG{o}{*} \PYG{n}{t} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}dynamic}\PYG{p}{(}\PYG{n}{temp}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kW}\PYG{p}{)}
\PYG{n}{power\PYGZus{}mech\PYGZus{}floc} \PYG{o}{=} \PYG{n}{power\PYGZus{}floc\PYGZus{}shaft}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{G\PYGZus{}mech}\PYG{p}{,}\PYG{n}{time\PYGZus{}mech}\PYG{p}{,}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The power requirement is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{power\PYGZus{}mech\PYGZus{}floc}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The power requirement is 0.57 kW

Fun Fact: although the design guidelines would logically predict that the power requirements are higher for cold water, there is little evidence that mechanical flocculator plants actually increase the power input to their flocculators when the water is cold.


\subsection{4)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id4}}
We hypothesize that the maximum energy dissipation rate in a flocculator determines the size of the flocs, and those flocs may or may not be captured by the sedimentation tank. Sedimentation tank performance will deteriorate if the maximum energy dissipation rate results in flocs that are so small that their sedimentation velocity is lower than the capture velocity of the sedimentation tank. This likely occurs for very high maximum energy dissipation rates. Mechanical flocculators have traditionally been designed without insight into the variability of the energy dissipation rate and the need to keep the maximum energy dissipation rate low enough to prevent the creation of flocs that will avoid capture by the sedimentation tanks. At the same time, the traditional standards likely evolved to produce designs that were at least reasonable even in the absence of an understanding of the fluid mechanics of the mixing process.

According to the Ten State Standards, “Agitators (Flocculators) shall be driven by variable speed drives with the peripheral speed of paddles ranging from 0.5 to 3.0 feet per second.” Note that they do not specify the size of the propeller and yet that is a critical dimension that determines the energy dissipation rate in the wake of the spinning propeller.

The wake behind the propeller or paddle is similar in size to the small dimension of the propeller or paddle normal to the velocity. Thus we can use the propeller height to estimate the energy dissipation rate of the plate wake. The relative velocity between the wake and the surrounding fluid is approximately equal to the propeller velocity.

Calculate the maximum energy dissipation rate that occurs in the wake behind the tip of a propeller which has a height of 3 cm and is moving at 3 ft/s. In this case, assume that the plate ratio for the maximum energy dissipation rate in the wake, \(\Pi_{Plate}\), is 0.04.
\begin{equation}\label{equation:Flocculation/Floc_Mechanical_Solution:Flocculation/Floc_Mechanical_Solution:0}
\begin{split}\epsilon=\Pi_{Plate}\frac{\left ( V  \right )^{3}}{W_{Plate}}\end{split}
\end{equation}
You may assume that the relative velocity between propeller and water is equal to 75\% of the propeller velocity.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{ratio\PYGZus{}prop\PYGZus{}vel} \PYG{o}{=} \PYG{l+m+mf}{0.75}
\PYG{n}{pi\PYGZus{}plate} \PYG{o}{=} \PYG{l+m+mf}{0.04}
\PYG{n}{vel\PYGZus{}prop} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{ft}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{height\PYGZus{}prop} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}

\PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max} \PYG{o}{=} \PYG{n}{pi\PYGZus{}plate} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{ratio\PYGZus{}prop\PYGZus{}vel} \PYG{o}{*}  \PYG{n}{vel\PYGZus{}prop}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{/} \PYG{n}{height\PYGZus{}prop}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum energy dissipation rate behind the propeller tip is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max}\PYG{p}{)}
\end{sphinxVerbatim}

The maximum energy dissipation rate behind the propeller tip is 430 mW/kg


\subsection{5)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id5}}
Calculate the ratio of maximum to average energy dissipation rate (henceforth referred to as Max/Ave EDR) and the ratio of maximum to average velocity gradient (Max/Ave G) for the mechanical flocculator described above. What is the relationship between the two ratios?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ratio} \PYG{o}{=} \PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max} \PYG{o}{/} \PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ave}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The ratio of maximum to average energy dissipation rate is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ratio}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{G\PYGZus{}mech\PYGZus{}ratio} \PYG{o}{=} \PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ratio}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mf}{0.5}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The ratio of maximum to average velocity gradient is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{G\PYGZus{}mech\PYGZus{}ratio}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The ratio of maximum to average energy dissipation rate is 66.3
The ratio of maximum to average velocity gradient is 8.15

SOLUTION NOTE: this information is found on extra slide 48 in the Flocculator Design slides, heading is “Results of the the CFD analysis and our model equations.”

High ratios of Max/Ave for velocity gradients (and therefore also energy dissipation rates) are common in both mechanical and hydraulic flocculators. A high velocity gradient ratio is a poor design for two reasons. - This high Max/Ave G results in significant inefficiency in the use of energy for flocculation. This inefficiency requires longer residence times and/or more energy input to achieve the same extent of flocculation.

The high energy dissipation rate in the propeller wake limits the amount of energy that can be dissipated without causing excessive floc breakup. Excessive floc breakup produces flocs that are too small to be captured by the sedimentation tank.

We hypothesize that the maximum G values specified for mechanical flocculators were likely set by the constraint of not breaking flocs into small sizes. Sedimentation velocity needs to be less than capture velocity for a floc to settle - the smallest floc that will settle is referred to as the threshold floc because that is the smallest size we want to make. Because well-designed hydraulic flocculators have more uniform shear rates (as compared to mechanical flocculators), hydraulic flocculators are less likely to break up flocs. Therefore, the average G values specified for mechanical flocculators are not expected to apply to well designed hydraulic flocculators.

The high energy dissipation rates at the tip of a propeller in a flocculator may be high enough to create flocs that are too small to be captured by the sedimentation tanks. We will determine if the sedimentation tank could capture these flocs in the analysis below.

These results also suggest that the traditional emphasis on maintaining the same or lesser G value for the transport of flocculated water to the sedimentation tank may have missed the more important point of not exceeding a value of G that produces flocs that are too small to be captured by the sedimentation tank.


\subsection{6)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id6}}
A mechanical flocculator is treating high turbidity water, and therefore is using an average G value of 180 Hz.

If the design guidelines for maximum G for mechanical flocculators are correct and are based on floc breakup, then what is the largest average G that could be used for a well designed hydraulic flocculator with a Max/Ave G of \(\sqrt{2}\)?

Note: important distinctions to make are: - maximum G vs average G - mechanical vs hydraulic flocculators. Conceptual thought coupled with pencil and paper are recommended.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{G\PYGZus{}hyd\PYGZus{}ratio} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{G\PYGZus{}mech\PYGZus{}ave\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{180} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}
\PYG{n}{G\PYGZus{}hyd\PYGZus{}ave\PYGZus{}max} \PYG{o}{=} \PYG{n}{G\PYGZus{}mech\PYGZus{}ave\PYGZus{}max} \PYG{o}{*} \PYG{p}{(}\PYG{n}{G\PYGZus{}mech\PYGZus{}ratio}\PYG{o}{/}\PYG{n}{G\PYGZus{}hyd\PYGZus{}ratio}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum G for hydraulic flocculators is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{G\PYGZus{}hyd\PYGZus{}ave\PYGZus{}max}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The maximum G for hydraulic flocculators is 1037 Hz

These extremely high average G values are more like traditional rapid mix. It is possible that energy use constraints (too much elevation difference required to power the flocculation) will prevent use of such high G values. It is also possible that these G values would cause excessive floc break up even though they appear to meet conventional standards. It is also likely that the flocculation time required to achieve a target G \(\theta\) would not be sufficient for the coagulant nanoparticles to be transported to the surfaces of suspended particles.


\subsection{7)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id7}}
How much energy in Joules per liter would be required to treat the water using this mechanical flocculator?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{k}{def} \PYG{n+nf}{energy\PYGZus{}mech}\PYG{p}{(}\PYG{n}{Q}\PYG{p}{,} \PYG{n}{G}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{temp}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{power\PYGZus{}floc\PYGZus{}shaft}\PYG{p}{(}\PYG{n}{Q}\PYG{p}{,} \PYG{n}{G}\PYG{p}{,} \PYG{n}{t}\PYG{p}{,} \PYG{n}{temp}\PYG{p}{)} \PYG{o}{/} \PYG{n}{Q}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{J}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}


\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The energy required using the mechanical flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{energy\PYGZus{}mech}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{G\PYGZus{}mech}\PYG{p}{,}\PYG{n}{time\PYGZus{}mech}\PYG{p}{,}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The energy required using the mechanical flocculator is 11.5 J/l


\subsection{8)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id8}}
How much does the electricity cost to flocculate a million liters? It isn’t necessary to actually size an electric motor for this assignment. Simply use the shaft power and assume a motor efficiency of 80\%. You may assume the price of electricity is 0.15 USD/(kW-hr).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{efficiency\PYGZus{}motor} \PYG{o}{=} \PYG{l+m+mf}{0.8}
\PYG{n}{electricity\PYGZus{}rate} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mf}{0.15} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{USD}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kW} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{hr}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{electricity\PYGZus{}cost\PYGZus{}mech} \PYG{o}{=} \PYG{p}{(}\PYG{n}{electricity\PYGZus{}rate} \PYG{o}{*} \PYG{n}{energy\PYGZus{}mech}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{G\PYGZus{}mech}\PYG{p}{,}\PYG{n}{time\PYGZus{}mech}\PYG{p}{,}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)} \PYG{o}{/} \PYG{n}{efficiency\PYGZus{}motor}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{USD}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{ML}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The cost of electricity for mechanical flocculation is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{electricity\PYGZus{}cost\PYGZus{}mech}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The cost of electricity for mechanical flocculation is 0.58 USD/Ml

It doesn’t actually cost very much to flocculate water using electricity. We will create cost savings over mechanical flocculators by designing smaller, higher performing flocculators that don’t require any moving parts and thus don’t require much maintenance. Our capital costs will also be lower because we use more efficient plug flow reactors to prevent short circuiting of particles through the flocculator. Thus well designed hydraulic flocculators can be smaller than mechanical flocculators.


\subsection{9)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id9}}
What is the equivalent amount of potential energy that is used to operate this mechanical flocculator (the shaft power) expressed as an elevation drop in meters? What is the required shaft power?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{delta\PYGZus{}height} \PYG{o}{=} \PYG{p}{(}\PYG{n}{power\PYGZus{}floc\PYGZus{}shaft}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{G\PYGZus{}mech}\PYG{p}{,}\PYG{n}{time\PYGZus{}mech}\PYG{p}{,}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{flow\PYGZus{}plant} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The equivalent amount of potential energy to run this  mechanical flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{delta\PYGZus{}height}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The shaft power required for this flocculator is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{power\PYGZus{}floc\PYGZus{}shaft}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{G\PYGZus{}mech}\PYG{p}{,}\PYG{n}{time\PYGZus{}mech}\PYG{p}{,}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The equivalent amount of potential energy to run this  mechanical flocculator is 1.17 m 0.5730957660614814 kilowatt


\subsection{10)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id10}}
What is the required reactor volume for the mechanical flocculator?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{vol\PYGZus{}mech} \PYG{o}{=} \PYG{p}{(}\PYG{n}{time\PYGZus{}mech} \PYG{o}{*} \PYG{n}{flow\PYGZus{}plant}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The required reactor volume for the mechanical flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{vol\PYGZus{}mech}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The required reactor volume for the mechanical flocculator is 90.0 meter ** 3


\subsection{11)}
\label{\detokenize{Flocculation/Floc_Mechanical_Solution:id11}}
If this flocculator is 4 m deep, then how many square meters of plan view area are required per L/s of flow capacity? This is a measure of required size of this unit process. For comparison, an AguaClara sedimentation tank requires about \(\frac{1m^{2}}{L/s}\) and are only 2 m deep.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{depth\PYGZus{}mech} \PYG{o}{=} \PYG{l+m+mi}{4} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{area\PYGZus{}mech} \PYG{o}{=} \PYG{p}{(}\PYG{n}{vol\PYGZus{}mech} \PYG{o}{/} \PYG{p}{(}\PYG{n}{depth\PYGZus{}mech} \PYG{o}{*} \PYG{n}{flow\PYGZus{}plant}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The required plan view area is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{area\PYGZus{}mech}\PYG{p}{)}
\end{sphinxVerbatim}

The required plan view area is 0.45 meter ** 2 * second / liter


\chapter{Flocculation Model Solution}
\label{\detokenize{Flocculation/Floc_Model_Solution:flocculation-model-solution}}\label{\detokenize{Flocculation/Floc_Model_Solution::doc}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}

\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}

Many of the fractal floc equations are available in the \sphinxcode{\sphinxupquote{floc\_model.py}} file in the aguaclara repository. Look through \sphinxcode{\sphinxupquote{{}`floc\_model.py}} \textless{}\sphinxurl{https://github.com/AguaClara/aguaclara/blob/master/aguaclara/research/floc\_model.py}\textgreater{}{}`\_ within the aguaclara repository. The following constants are defined in that file. NTU has been defined as an approximate empirical relationship between the concentration of kaolin clay and the turbidity, such that 1 NTU is equivalent to 1.7 mg/L. The diameter of a primary clay particle is assumed to be 7 micrometers. The fractal dimension for flocs is defined as \sphinxcode{\sphinxupquote{DIM\_FRACTAL}} and is equal to 2.3. We are using PACl as a coagulant for this analysis, so you shall call \sphinxcode{\sphinxupquote{fm.PACl}}, when a function within \sphinxcode{\sphinxupquote{floc\_model.py}} requires ‘coag’ as an input.

Whenever possible, use variables defined within \sphinxcode{\sphinxupquote{floc\_model.py}} instead of redefining them. Relevant variables defined in \sphinxcode{\sphinxupquote{floc\_model.py}} include: 1. \sphinxcode{\sphinxupquote{DIM\_FRACTAL}} with an estimated value of 2.3.
\begin{enumerate}
\item {} 
\sphinxcode{\sphinxupquote{PACl}}

\item {} 
\sphinxcode{\sphinxupquote{Clay}}

\end{enumerate}


\section{1)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id1}}
Estimate the diameter of the flocs that interact with the tip of the impeller of the mechanical flocculator analyzed above. We don’t yet have a good model to predict maximum floc size as a function of velocity gradient or energy dissipation rate. We have a rough estimate, \sphinxcode{\sphinxupquote{fm.diam\_floc\_max(EDRmax)}} based on a small amount of data.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ratio\PYGZus{}prop\PYGZus{}vel} \PYG{o}{=} \PYG{l+m+mf}{0.75}
\PYG{n}{pi\PYGZus{}plate} \PYG{o}{=} \PYG{l+m+mf}{0.04}
\PYG{n}{vel\PYGZus{}prop} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{ft}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{height\PYGZus{}prop} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}

\PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max} \PYG{o}{=} \PYG{n}{pi\PYGZus{}plate} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{ratio\PYGZus{}prop\PYGZus{}vel} \PYG{o}{*}  \PYG{n}{vel\PYGZus{}prop}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{/} \PYG{n}{height\PYGZus{}prop}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{diam\PYGZus{}floc\PYGZus{}mech} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{diam\PYGZus{}floc\PYGZus{}max}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{um}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The diameter of the flocs that interact with the impeller is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{diam\PYGZus{}floc\PYGZus{}mech}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{x}\PYG{o}{=}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{DIM\PYGZus{}FRACTAL}
\PYG{n}{x}
\end{sphinxVerbatim}

The diameter of the flocs that interact with the impeller is 127 um.


\section{2)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id2}}
Estimate the terminal sedimentation velocity in mm/s of the flocs that interact with the tip of the impeller of the mechanical flocculator analyzed above. Use the function \sphinxcode{\sphinxupquote{fm.vel\_term\_floc}}. You may assume that the flocs were made from a particle suspension that had 1.5 mg/L of aluminum and 100 NTU of clay.

Note: AguaClara has defined the unit NTU as \sphinxcode{\sphinxupquote{u.NTU}}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{conc\PYGZus{}Al} \PYG{o}{=} \PYG{l+m+mf}{1.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{conc\PYGZus{}clay}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{vel\PYGZus{}term\PYGZus{}floc\PYGZus{}tip} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{vel\PYGZus{}term\PYGZus{}floc}\PYG{p}{(}\PYG{n}{conc\PYGZus{}Al}\PYG{p}{,} \PYG{n}{conc\PYGZus{}clay}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{p}{,}
                                       \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{DIM\PYGZus{}FRACTAL}\PYG{p}{,}
                                       \PYG{n}{diam\PYGZus{}floc\PYGZus{}mech}\PYG{p}{,} \PYG{n}{temp\PYGZus{}design}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The terminal velocity of flocs that interact with the impeller tip is estimated to be}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{vel\PYGZus{}term\PYGZus{}floc\PYGZus{}tip}\PYG{p}{)}
\end{sphinxVerbatim}

The terminal velocity of flocs that interact with the impeller tip is estimated to be 0.738 mm/s


\section{3)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id3}}
Would these flocs be captured by a conventional design for a sedimentation tank \sphinxhref{http://10statesstandards.com/waterrev2012.pdf}{(10 State Standards)} with a capture velocity of 1.2 m/hr? The capture velocity is a property of the sedimentation tank. If the floc settles faster than the capture velocity, then theoretically the floc will be captured by the sedimentation tank.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{vel\PYGZus{}capture\PYGZus{}10\PYGZus{}state} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mf}{1.2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hr}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The 10 State Standards capture velocity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{vel\PYGZus{}capture\PYGZus{}10\PYGZus{}state}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{The 10 State Standards sedimentation tank would capture the flocs that are able to survive the energy dissipation rate at the tip of the propeller. }\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The 10 State Standards capture velocity is 0.333 mm/s
The 10 State Standards sedimentation tank would capture the flocs that are able to survive the energy dissipation rate at the tip of the propeller.

These flocs would be removed easily in an AguaClara sedimentation tank (capture velocity of 0.12 mm/s). However, our use of the empirical equation to predict the size of these flocs is questionable because we are extrapolating way beyond the original data. We need more experiments to characterize the size of flocs as a function of the velocity gradient.


\section{4)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id4}}
Estimate the average distance between primary clay particles at the beginning and end of flocculation given an initial turbidity of 100 NTU and a target effluent unflocculated clay concentration at the end of flocculation of less than 1 NTU. Of course, the clay concentration is actually constant in flocculation since particles are not actually being removed. But here we are referring to the primary clay particles that have escaped aggregation and thus are still unattached.

You can do this by figuring it out empirically (brownie points!) or by looking for a function that finds average distance between particles.

A little extra to think about (not necessary to answer): The AguaClara floccuation model assumes that primary clay particles mostly attach to other primary clay particles and not to larger flocs (aggregates of clay particles). Can you think of why this is?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{init\PYGZus{}sep\PYGZus{}dist\PYGZus{}clay} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{(}\PYG{l+m+mi}{100} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n}{final\PYGZus{}sep\PYGZus{}dist\PYGZus{}clay} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The average distance between clay particles at 100 NTU is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{init\PYGZus{}sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The average distance between clay particles at 1 NTU is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{final\PYGZus{}sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{)}
\end{sphinxVerbatim}

The average distance between clay particles at 100 NTU is 0.141 mm
The average distance between clay particles at 1 NTU is 0.654 mm


\section{5)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id5}}
What is the inner viscous length scale in the mechanical flocculator at the maximum energy dissipation rate? Given that this is a very high energy dissipation rate for flocculation, it corresponds to a very small inner viscous length scale. This means that eddies are able to survive down to a small size before viscosity damps their motion. If the separation distance between clay particles that haven’t turned into flocs is less than this inner viscous scale, then it is reasonable to assume that all flocculation is dominated by viscosity. The function within \sphinxcode{\sphinxupquote{floc\_model.py}} that does this is confusingly named
\sphinxcode{\sphinxupquote{lamba\_vel()}}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The inner viscous length scale is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{lambda\PYGZus{}vel}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max}\PYG{p}{,} \PYG{n}{temp\PYGZus{}design}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The inner viscous length scale is 2.39 mm


\section{6)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id6}}
Below is a graph showing the inner viscous length scale that divides flows that are dominated by inertia (eddies) from flows where viscosity is significant. \sphinxstylestrong{Add the data point} representing the maximum energy dissipation rate vs the maximum clay separation distance at the end of flocculation for the mechanical flocculator you have been designing.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}This code is provided to help you make your graph}

\PYG{c+c1}{\PYGZsh{}Creates the array for energy dissipation rates (EDRs)}
\PYG{n}{x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Inner Viscous Scale}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Inner Viscous Scale vs Energy Dissipation Rate}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Inner Viscous Scale (mm)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Energy Dissipation Rate(mW/kg)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{yscale}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{log}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xscale}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{log}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{b}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{which}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{major}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{grid}\PYG{p}{(}\PYG{n}{b}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{which}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{minor}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{k}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mf}{0.5}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}fm.lambda\PYGZus{}vel, which returns the inner viscous length scale,}
\PYG{c+c1}{\PYGZsh{}is being applied to the array of EDRs for our design temperature}
\PYG{n}{y} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{lambda\PYGZus{}vel}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{temp\PYGZus{}design}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}YOUR CODE BELOW\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{c+c1}{\PYGZsh{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}\PYG{p}{,} \PYG{n}{final\PYGZus{}sep\PYGZus{}dist\PYGZus{}clay}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ko}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}



\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{final\PYGZus{}sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate\PYGZus{}prop\PYGZus{}max}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{0.6541789493547243 millimeter}] \leavevmode
422.57902694348155 milliwatt / kilogram

\end{description}


\section{7)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id7}}
According to the plot and analysis above, are the collisions between clay particles at a concentration of 1 NTU dominated by inertia or by viscosity? Explain why!

The final spacing between clay particles is still smaller than the inner viscous length scale at which eddies are damped by viscosity. This suggests that all collisions in flocculation are dominated by viscosity.


\subsection{Real-world considerations of flocculation}
\label{\detokenize{Flocculation/Floc_Model_Solution:real-world-considerations-of-flocculation}}
Now that you have an augmented understanding of flocculation theory, we can consider a few ways in which the theory applies to real-world flocculators.

In this section, there are no calculations for you to do or code for you to write - everything has been provided for you. This was done to shorten this design challenge while still detailing relevant and important information.
\begin{quote}

\sphinxstylestrong{There are two conceptual questions for you to answer at the end of the section.} Read through and focus on understanding the concepts before you try to answer the questions.
\end{quote}


\subsubsection{Coagulant distribution in a reactor}
\label{\detokenize{Flocculation/Floc_Model_Solution:coagulant-distribution-in-a-reactor}}
The flocculation model accounts for loss of coagulant nanoparticles to the reactor walls. The loss of coagulant nanoparticles is assumed to scale with the area of the flocculator walls divided by the total area of clay and flocculator walls. This loss is significant for low turbidity and small scale flocculators, such as the 1 liter per second flocculator AguaClara recently designed.

Here we will consider a flocculator built out of pipe, not one contained within a rectangular reactor. The \sphinxcode{\sphinxupquote{diam\_tube}} parameter is the flocculator diameter and is needed to estimate how much of the coagulant is lost to the walls of the flocculator. We will assume the flocculator tube is for the 1 L/s plant and has a diameter of 7.5 cm

We will evaluate the situation where the turbidity is 10 NTU and the coagulant dose is 1 mg/L of aluminum. The code below does the following:
\begin{itemize}
\item {} 
Estimates the fraction of coagulant nanoparticles lost to the flocculator walls.

\item {} 
Estimates the fraction of the clay surface area that is coated with nanoparticles.

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{diam\PYGZus{}tube} \PYG{o}{=} \PYG{l+m+mf}{7.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{conc\PYGZus{}clay} \PYG{o}{=} \PYG{l+m+mi}{100}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{conc\PYGZus{}Al} \PYG{o}{=} \PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}


\PYG{c+c1}{\PYGZsh{}fm.ratio\PYGZus{}area\PYGZus{}clay\PYGZus{}total() returns fraction (between 0 and 1) that represents the surface area of}
\PYG{c+c1}{\PYGZsh{}the clay particle over the sum of the surface area of the clay and reactor walls}

\PYG{n}{wall\PYGZus{}loss} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{ratio\PYGZus{}area\PYGZus{}clay\PYGZus{}total}\PYG{p}{(}\PYG{n}{conc\PYGZus{}clay}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{,} \PYG{n}{diam\PYGZus{}tube}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{RATIO\PYGZus{}HEIGHT\PYGZus{}DIAM}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The fraction of the coagulant lost to the walls is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{wall\PYGZus{}loss}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}fm.gamma\PYGZus{}coag() returns the fraction of clay that is covered by coagulant. This is a very hard parameter}
\PYG{c+c1}{\PYGZsh{}to actually measure, so this is just an estimate.}

\PYG{n}{fraction\PYGZus{}coated} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{gamma\PYGZus{}coag}\PYG{p}{(}\PYG{n}{conc\PYGZus{}clay}\PYG{p}{,}\PYG{n}{conc\PYGZus{}Al}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{p}{,}
                                  \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{,} \PYG{n}{diam\PYGZus{}tube}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{RATIO\PYGZus{}HEIGHT\PYGZus{}DIAM}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The fraction of the clay surface area that is is coated is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{fraction\PYGZus{}coated}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Time scale of flocculation}
\label{\detokenize{Flocculation/Floc_Model_Solution:time-scale-of-flocculation}}
Now we want to estimate the average time required for an initial successful collision between two primary clay particles that are partially coated with coagulant nanoclusters. Note that for the first collision, the current floc size is the same as the clay size. We will use the average energy dissipation rate for the mechanical flocculator as found above.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ave} \PYG{o}{=} \PYG{l+m+mf}{6.4}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}

\PYG{n}{time\PYGZus{}first\PYGZus{}collision} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{time\PYGZus{}col\PYGZus{}laminar}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate\PYGZus{}mech\PYGZus{}ave}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}\PYG{p}{,}
                                             \PYG{n}{conc\PYGZus{}Al}\PYG{p}{,} \PYG{n}{conc\PYGZus{}clay}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{p}{,}
                                             \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{o}{.}\PYG{n}{Diameter}\PYG{p}{,} \PYG{n}{diam\PYGZus{}tube}\PYG{p}{,}
                                             \PYG{n}{fm}\PYG{o}{.}\PYG{n}{DIM\PYGZus{}FRACTAL}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{RATIO\PYGZus{}HEIGHT\PYGZus{}DIAM}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The time required for the first succesful collision is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{time\PYGZus{}first\PYGZus{}collision}\PYG{p}{)}
\end{sphinxVerbatim}

This collision time is quite fast and is the origin of the question, “why does flocculation require 30 minutes?” as mandated in the Ten State Standards.


\subsubsection{AguaClara flocculation model}
\label{\detokenize{Flocculation/Floc_Model_Solution:aguaclara-flocculation-model}}
We will now briefly consider an AguaClara flocculator design with an average energy dissipation rate of approximately 11 mW/kg and a residence time of 8.1 minutes. The design temperature is 15 degC.

Below is a calculation for the Gt value of this flocculator.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{ed\PYGZus{}rate\PYGZus{}floc\PYGZus{}aguaclara} \PYG{o}{=} \PYG{l+m+mi}{11}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}
\PYG{n}{time\PYGZus{}floc\PYGZus{}aguaclara} \PYG{o}{=} \PYG{l+m+mf}{8.1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{minute}
\PYG{n}{temp\PYGZus{}design\PYGZus{}aguaclara} \PYG{o}{=} \PYG{l+m+mi}{15}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}

\PYG{c+c1}{\PYGZsh{}This equation for G can be found in the course slides (all equations you see in design challenges can be found in the slides)}
\PYG{n}{G\PYGZus{}floc\PYGZus{}aguaclara} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate\PYGZus{}floc\PYGZus{}aguaclara}\PYG{o}{/}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{temp\PYGZus{}design\PYGZus{}aguaclara}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{Gtime\PYGZus{}floc\PYGZus{}aguaclara} \PYG{o}{=} \PYG{p}{(}\PYG{n}{G\PYGZus{}floc\PYGZus{}aguaclara}\PYG{o}{*}\PYG{n}{time\PYGZus{}floc\PYGZus{}aguaclara}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The AguaClara Gt value is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Gtime\PYGZus{}floc\PYGZus{}aguaclara}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Coagulant coverage fraction of a particle}
\label{\detokenize{Flocculation/Floc_Model_Solution:coagulant-coverage-fraction-of-a-particle}}
This section solves the integrated flocculation model for \(\Gamma\). We simplify the model by recognizing that the spacing between particles at the end of the flocculation process is much greater than the initial particle spacing. This means that the raw water turbidity drops out of the equation. The value of the rate constant for collisions is k = 0.24. We start with the equation below:
\begin{equation}\label{equation:Flocculation/Floc_Model_Solution:Flocculation/Floc_Model_Solution:0}
\begin{split}\Gamma = \frac{3}{2}\cdot \frac{\Lambda^2 }{\mathit{k} \pi d_{p}^2 Gt }\end{split}
\end{equation}
We then estimate the required coagulant coverage of clay, \(\Gamma\), for the AguaClara flocculator to achieve a 2 NTU settled water turbidity when starting with a raw water that is 50 NTU.

Note that the specified flocculation model applies to both hydraulic and mechanical flocculators.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Fitting constant/Sedimentation tank factor}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mf}{0.24}

\PYG{c+c1}{\PYGZsh{}gamma\PYGZus{}aguaclara\PYGZus{}design uses functions in floc\PYGZus{}model.py to solve the equation in the problem statement}
\PYG{n}{conc\PYGZus{}clay\PYGZus{}goal} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{gamma\PYGZus{}aguaclara\PYGZus{}design} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{sep\PYGZus{}dist\PYGZus{}clay}\PYG{p}{(}\PYG{n}{conc\PYGZus{}clay\PYGZus{}goal}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
                           \PYG{o}{/} \PYG{p}{(}\PYG{n}{k} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{o}{.}\PYG{n}{Diameter} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
                              \PYG{o}{*} \PYG{n}{Gtime\PYGZus{}floc\PYGZus{}aguaclara}
                             \PYG{p}{)}
                          \PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The Gamma value is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{gamma\PYGZus{}aguaclara\PYGZus{}design}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Residence time and coagulant coverage}
\label{\detokenize{Flocculation/Floc_Model_Solution:residence-time-and-coagulant-coverage}}
If you doubled the residence time of the flocculator, the required coagulant coverage of clay changes according to the model. By doubling the residence time, the required coagulant coverage is reduced by a factor of 2.


\subsubsection{Modeling flocculation in the presence of humic acid, with pC* as the performance metric}
\label{\detokenize{Flocculation/Floc_Model_Solution:modeling-flocculation-in-the-presence-of-humic-acid-with-pc-as-the-performance-metric}}
The flocculation model predicts the settled water turbidity given the composition of the raw water, the flocculator characteristics, and a fitting parameter that must be a function of the sedimentation tank characteristics. This fitting parameter is k, which is the same as the rate constant for collisions described above. The model is far from complete - it doesn’t yet describe the effects of floc blankets. Below we have created a plot showing model predictions for a range of coagulant and humic acid (dissolved organic matter) concentrations. The plot uses our approximation for pC* described in class and shown below:
\begin{equation}\label{equation:Flocculation/Floc_Model_Solution:Flocculation/Floc_Model_Solution:1}
\begin{split}pC^*=\frac{3}{2}log{(\frac{2}{3}\pi k \frac{d_p^{2}}{\Lambda_0^{2}}Gt\alpha + 1)}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Define the range of coagulant. This is necessary to create plots of pC* as a function of coagulant dose.}
\PYG{n}{coag\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{2.5}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}

\PYG{c+c1}{\PYGZsh{} Graph results of a particular NTU. Note that you can change this value to see how the graph responds.}
\PYG{c+c1}{\PYGZsh{} A change here even changes the graph title changes!}
\PYG{n}{plot\PYGZus{}NTU} \PYG{o}{=} \PYG{l+m+mi}{50}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ Graph for Various Humic Acid Concentrations}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pC*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{coagulant dosage (mg/L)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Create an array of humic acid concentrations}
\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{15}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}

\PYG{c+c1}{\PYGZsh{} Create a function that only has inputs for the values that we will change between plots.}
\PYG{c+c1}{\PYGZsh{}All other variables are taken from predefined values. This simplifies the function call for use in generating the plots.}
\PYG{k}{def} \PYG{n+nf}{plot\PYGZus{}pC}\PYG{p}{(}\PYG{n}{conc\PYGZus{}humic\PYGZus{}acid}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{k} \PYG{o}{=} \PYG{l+m+mf}{0.24}
    \PYG{c+c1}{\PYGZsh{} The energy dissipation rate for aguaclara designs}
    \PYG{n}{ed\PYGZus{}rate} \PYG{o}{=} \PYG{l+m+mi}{11}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}
    \PYG{c+c1}{\PYGZsh{}The inner diameter of the flocculator tube is important because a significant fraction of the}
    \PYG{c+c1}{\PYGZsh{}coagulant ends up attaching to the flocculator walls}
    \PYG{n}{tube\PYGZus{}diam} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
    \PYG{n}{time\PYGZus{}floc} \PYG{o}{=} \PYG{l+m+mf}{8.1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{minute}
    \PYG{n}{temp} \PYG{o}{=} \PYG{l+m+mi}{15} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
    \PYG{c+c1}{\PYGZsh{}pc\PYGZus{}viscous is the solution for the equation in the problem statement. It returns pC*}
    \PYG{n}{plot\PYGZus{}pC} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{pc\PYGZus{}viscous}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate}\PYG{p}{,} \PYG{n}{temp}\PYG{p}{,} \PYG{n}{time\PYGZus{}floc}\PYG{p}{,} \PYG{n}{tube\PYGZus{}diam}\PYG{p}{,}
                            \PYG{n}{plot\PYGZus{}NTU}\PYG{p}{,} \PYG{n}{coag\PYGZus{}graph}\PYG{p}{,} \PYG{n}{conc\PYGZus{}humic\PYGZus{}acid}\PYG{p}{,}
                            \PYG{n}{fm}\PYG{o}{.}\PYG{n}{HumicAcid}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{,}
                            \PYG{n}{k}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{RATIO\PYGZus{}HEIGHT\PYGZus{}DIAM}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{plot\PYGZus{}pC}

\PYG{n}{x} \PYG{o}{=} \PYG{n}{coag\PYGZus{}graph}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}pC}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}pC}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}pC}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{g}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}pC}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}pC}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}pC}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}We can use the array of humic acid concentrations to directly create the legend!}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{,} \PYG{n}{loc} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{best}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

There is a lot to learn from this graph!!!!!! It appears that for any given coagulant dose, humic acid concentration significantly affects pC*. Additionally, notice the diminishing returns of adding more coagulant. This effect appears to be independent of humic acid concentration (see the red curve).


\subsubsection{Modeling flocculation in the presence of humic acid, with settled water turbidity as the performance metric}
\label{\detokenize{Flocculation/Floc_Model_Solution:modeling-flocculation-in-the-presence-of-humic-acid-with-settled-water-turbidity-as-the-performance-metric}}
We will now display a similar plot which shows settled water turbidity instead of pC*. Our initial turbidity is 10 NTU, and we will four curves for separate humic acid concentrations.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}answer}
\PYG{n}{plot\PYGZus{}NTU} \PYG{o}{=} \PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{)}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ Graph}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Settled water turbidity (NTU)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{coagulant dosage (mg/L)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{plot\PYGZus{}conc\PYGZus{}clay}\PYG{p}{(}\PYG{n}{conc\PYGZus{}clay}\PYG{p}{,} \PYG{n}{conc\PYGZus{}nat\PYGZus{}org\PYGZus{}mat}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{k} \PYG{o}{=} \PYG{l+m+mf}{0.24}
    \PYG{n}{ed\PYGZus{}rate} \PYG{o}{=} \PYG{l+m+mi}{11}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}
    \PYG{c+c1}{\PYGZsh{}The inner diameter of the flocculator tube is important because a significant fraction of the}
    \PYG{c+c1}{\PYGZsh{}coagulant ends up attaching to the flocculator walls}
    \PYG{n}{tube\PYGZus{}diam} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
    \PYG{n}{conc\PYGZus{}clay} \PYG{o}{=} \PYG{n}{plot\PYGZus{}NTU}
    \PYG{n}{time\PYGZus{}floc} \PYG{o}{=} \PYG{l+m+mf}{8.1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{minute}
    \PYG{n}{temp} \PYG{o}{=} \PYG{l+m+mi}{15} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
    \PYG{c+c1}{\PYGZsh{}s\PYGZus{}t calls on fm.pc\PYGZus{}viscous() like the previous cell of code, but also uses the fm.invp()}
    \PYG{c+c1}{\PYGZsh{}function to turn pC* back into units of settled water turbididty.}
    \PYG{n}{s\PYGZus{}t} \PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{invp}\PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{pc\PYGZus{}viscous}\PYG{p}{(}\PYG{n}{ed\PYGZus{}rate}\PYG{p}{,} \PYG{n}{temp}\PYG{p}{,} \PYG{n}{time\PYGZus{}floc}\PYG{p}{,} \PYG{n}{tube\PYGZus{}diam}\PYG{p}{,}
               \PYG{n}{conc\PYGZus{}clay}\PYG{p}{,} \PYG{n}{coag\PYGZus{}graph}\PYG{p}{,} \PYG{n}{conc\PYGZus{}nat\PYGZus{}org\PYGZus{}mat}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{HumicAcid}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{,}
                            \PYG{n}{k}\PYG{p}{,} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{RATIO\PYGZus{}HEIGHT\PYGZus{}DIAM}\PYG{p}{)}\PYG{p}{,}\PYG{n}{conc\PYGZus{}clay}\PYG{p}{)}

    \PYG{k}{return} \PYG{n}{s\PYGZus{}t}

\PYG{c+c1}{\PYGZsh{}Creates array of humic acid concentrations. This was done in the previous code cell with np.linspace,}
\PYG{c+c1}{\PYGZsh{}but because we don\PYGZsq{}t want evenly spaced concentrations here we input our desired values manually}
\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}

\PYG{n}{x} \PYG{o}{=} \PYG{n}{coag\PYGZus{}graph}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}conc\PYGZus{}clay}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{,} \PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}conc\PYGZus{}clay}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{,} \PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}conc\PYGZus{}clay}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{,} \PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{g}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
         \PYG{n}{x}\PYG{p}{,} \PYG{n}{plot\PYGZus{}conc\PYGZus{}clay}\PYG{p}{(}\PYG{n}{plot\PYGZus{}NTU}\PYG{p}{,} \PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{n}{plot\PYGZus{}humic\PYGZus{}acid}\PYG{p}{,} \PYG{n}{loc} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{best}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

Looking at the interactions between coagulant, clay, and humic acid from this perspective yields even more fun discoveries! For increasing humic acid concentration, more coagulant is required to even begin the process of flocculation.


\section{8)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id8}}
Why does the AguaClara flocculation model predict that adding 1 mg/L of aluminum has no effect on turbidity when the humic acid concentration is 20 mg/L?

At low concentrations of coagulant every coagulant nanoparticle surface is completely coated with humic acid and thus they aren’t sticky at all.


\section{9)}
\label{\detokenize{Flocculation/Floc_Model_Solution:id9}}
It is tempting to assume that all the coagulant dosed gets attached to clay particles. However, if a plant operator were to make this assumption, their plant would produce low-quality water.

Identify and explain two significant reasons as to why this assumption fails.
\begin{enumerate}
\item {} 
Coagulant is lost to the walls of the reactors

\item {} 
Coagulant is lost to humic acid
(Students need to write more than this)

\end{enumerate}


\chapter{Flocculator Design Solution}
\label{\detokenize{Flocculation/Floc_Design_Solution:flocculator-design-solution}}\label{\detokenize{Flocculation/Floc_Design_Solution::doc}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}import statements have been cleaned up}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{constants} \PYG{k}{as} \PYG{n+nn}{constants}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{c+c1}{\PYGZsh{}plt.switch\PYGZus{}backend(\PYGZsq{}TKAgg\PYGZsq{})}
\end{sphinxVerbatim}

In this design challenge you will design a vertical flow hydraulic flocculator. You will use the flow rate of \sphinxcode{\sphinxupquote{flow\_plant = 20 L/s}} as your default design value.

Although we don’t require that you use the nomenclature from the AguaClara variable naming guide, it provides a reasonable basis for organizing your variable names. We use the convention that the first part of the variable name describes the type of variable and always has a unique dimension. The subsequent parts of the variable name start from the big picture and slowly add more and more detail to arrive at the precise component that you are describing. Thus space\_floc\_baffle is the spacing between baffles in the flocculator and n\_floc\_channel\_baffle should be the number of baffles in a flocculator channel. width\_floc\_channel\_port should be the width of the port connecting two flocculator channels.

\sphinxstylestrong{In this design challenge we will use functions to calculate each step of the design. Whenever we need to access a previously calculated result we will use the function call to access that value. Using this method of nested function calls will make the entire design be only a function of a few input parameters.} This makes it possible to have flexible design code and ease the creation of new plant designs.

The minimum input parameters to define a flocculator are (flow\_plant, headloss\_floc\_BOD, Gt\_BOD, T\_BOD). We could have included a longer list of input parameters (height\_floc\_end, width\_PC\_sheet, K\_e, etc.) to make our functions even more general. But to keep our code more concise we will focus on only 4 of the input parameters. This will make it possible to easily change the input parameters to obtain new designs. We will use this capability to plot the results of varying the design flow rate.


\section{Hydraulic Vertical Flow Flocculator Design}
\label{\detokenize{Flocculation/Floc_Design_Solution:hydraulic-vertical-flow-flocculator-design}}
This challenge is design a hydraulic flocculator using the core concepts of the AguaClara design methodology.

Below are the inputs for the design. BOD stands for Basis Of Design.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} head loss through the flocculator}
\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD} \PYG{o}{=} \PYG{l+m+mi}{40} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}

\PYG{c+c1}{\PYGZsh{} collision potential based on recent designs for AguaClara Plants}
\PYG{n}{Gt\PYGZus{}BOD} \PYG{o}{=} \PYG{l+m+mi}{37000}

\PYG{c+c1}{\PYGZsh{} water depth at the end of flocculator where it flows into the inlet channel of the sedimentation tank}
\PYG{n}{height\PYGZus{}floc\PYGZus{}end} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}

\PYG{n}{flow\PYGZus{}plant} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}

\PYG{c+c1}{\PYGZsh{} This is the estimate for larger plants where the flocculator is as long as the sedimentation tanks.}
\PYG{c+c1}{\PYGZsh{} For lower flow plants we will need to reduce this length because of the constraint that the channels must}
\PYG{c+c1}{\PYGZsh{} be wide enough to construct.}
\PYG{n}{length\PYGZus{}channel\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}

\PYG{c+c1}{\PYGZsh{} minimum and maximum ratios of distance between expansions to baffle spacing}
\PYG{n}{Pi\PYGZus{}HS\PYGZus{}min} \PYG{o}{=} \PYG{l+m+mi}{3}
\PYG{n}{Pi\PYGZus{}HS\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{6}

\PYG{n}{Pi\PYGZus{}vc} \PYG{o}{=} \PYG{n}{constants}\PYG{o}{.}\PYG{n}{VC\PYGZus{}ORIFICE\PYGZus{}RATIO}
\PYG{n}{Pi\PYGZus{}vc\PYGZus{}baffle} \PYG{o}{=} \PYG{n}{Pi\PYGZus{}vc}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}

\PYG{c+c1}{\PYGZsh{} width of the polycarbonate sheets used to make baffles}
\PYG{n}{width\PYGZus{}PC\PYGZus{}sheet} \PYG{o}{=} \PYG{l+m+mf}{1.067}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}

\PYG{c+c1}{\PYGZsh{} this is a reasonable constraint to keep the channel constructable by humans}
\PYG{n}{width\PYGZus{}floc\PYGZus{}min\PYGZus{}BOD} \PYG{o}{=} \PYG{n}{width\PYGZus{}PC\PYGZus{}sheet} \PYG{o}{/} \PYG{l+m+mi}{2}
\PYG{n}{width\PYGZus{}floc\PYGZus{}max\PYGZus{}BOD} \PYG{o}{=} \PYG{n}{width\PYGZus{}PC\PYGZus{}sheet}

\PYG{c+c1}{\PYGZsh{} expansion minor loss coefficient for 180 degree bend}
\PYG{n}{K\PYGZus{}e} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{/} \PYG{n}{Pi\PYGZus{}vc\PYGZus{}baffle} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}

\PYG{c+c1}{\PYGZsh{} this is the minimum temperature of the raw water}
\PYG{n}{T\PYGZus{}BOD} \PYG{o}{=} \PYG{l+m+mi}{15}\PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\end{sphinxVerbatim}


\subsection{Design Algorithm Steps}
\label{\detokenize{Flocculation/Floc_Design_Solution:design-algorithm-steps}}\begin{enumerate}
\item {} 
Calculate the total volume of flocculator given head loss and collision potential

\item {} 
Calculate the number of channels by taking the total width and dividing by the maximum channel width

\item {} 
Calculate the channel width (total width over number of channels)

\item {} 
Calculate the minimum number of obstacles and spacing between obstacles by assuming a maximum H/S ratio

\item {} 
Use the actual H/S ratio based on obstacle spacing to calculate the spacing between baffles

\item {} 
Calculate the obstacle width to obtain the same jet expansion conditions as produced by the 180 degree bend.

\end{enumerate}

This algorithm does not yet handle the integer number of baffles in a channel or the thickness of the baffles

For this assignment \sphinxstylestrong{create functions for each question} and then use those function calls whenever that calculation result is required in a subsequent step. Include flow\_plant, headloss\_floc\_BOD, Gt\_BOD and T\_BOD as the inputs that can be varied for each function.

\sphinxstylestrong{Whenever you reference a previously calculated value in a function, use the function call for that value so that dependency is not broken.}

That way you will be able to easily vary any of the three main input parameters (flow, Gt, head loss) to see their effect on the design.


\subsubsection{1)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id1}}
Estimate the average velocity gradient of a flocculator given head loss and collision potential. I’m going to solve this problem for you so you see how to use function calls.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{G\PYGZus{}avg}\PYG{p}{(}\PYG{n}{hl}\PYG{p}{,} \PYG{n}{Gt}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{G} \PYG{o}{=} \PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{hl}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{Gt} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{G}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The average velocity gradient of flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{G\PYGZus{}avg}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The average velocity gradient of flocculator is 93.24 / second


\subsubsection{2)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id2}}
Estimate the residence time of flocculator given the target head loss and collision potential. (Note that this ignores the decrease in water depth caused by head loss. We hope to improve this design process further in the near future.)

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{t\PYGZus{}floc\PYGZus{}est}\PYG{p}{(}\PYG{n}{hl}\PYG{p}{,} \PYG{n}{Gt}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{theta} \PYG{o}{=} \PYG{n}{Gt} \PYG{o}{/} \PYG{n}{G\PYGZus{}avg}\PYG{p}{(}\PYG{n}{hl}\PYG{p}{,} \PYG{n}{Gt}\PYG{p}{,} \PYG{n}{T}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{theta}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The residence time of flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{t\PYGZus{}floc\PYGZus{}est}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The residence time of flocculator is 396.8 second


\subsubsection{3)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id3}}
Plot \(G\theta\) as a function of the operating temperature given the head loss and residence time for this design. In this step you are assuming that you have built this hydraulic flocculator and you want to see how the collision potential, \(G\theta\), varies with temperature of operation. Vary the temperature from 0°C to 30°C. The following equation makes it clear that the velocity gradient originates from head loss that creates fluid deformation that is limited by viscosity.
\begin{equation}\label{equation:Flocculation/Floc_Design_Solution:Flocculation/Floc_Design_Solution:0}
\begin{split}\bar G\theta =\sqrt {\frac{{g{h_e}\theta }}{\nu }}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Gt\PYGZus{}operation}\PYG{p}{(}\PYG{n}{hl}\PYG{p}{,}\PYG{n}{Gt}\PYG{p}{,}\PYG{n}{T\PYGZus{}BOD}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{Gt\PYGZus{}operation} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{hl} \PYG{o}{*} \PYG{n}{t\PYGZus{}floc\PYGZus{}est}\PYG{p}{(}\PYG{n}{hl}\PYG{p}{,} \PYG{n}{Gt}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{/}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{Gt\PYGZus{}operation}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n}{Temp\PYGZus{}Operation}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{30}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{ypoints}\PYG{o}{=}\PYG{p}{(}\PYG{n}{Gt\PYGZus{}operation}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{,}\PYG{n}{Temp\PYGZus{}Operation}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Temp\PYGZus{}Operation}\PYG{p}{,}\PYG{n}{ypoints}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}Note the use of latex. The r tells matplotlib to interpret the following strings as raw text.}
\PYG{c+c1}{\PYGZsh{}Without the \PYGZdq{}r\PYGZdq{} the \PYGZbs{}theta would be parsed as a tab (\PYGZbs{}t) followed by heta!}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature (\PYGZdl{}\PYGZca{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{circ\PYGZdl{}C)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{G\PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{theta\PYGZdl{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/Gtheta\PYGZus{}vs\PYGZus{}temperature}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Gtheta_vs_temperature}.png}
\caption{The \(\bar G\theta\) delivered by a flocculator increases with temperature. Note that the apparent linearity of this graph is because the inverse of the square root of kinematic viscosity varies linearly with temperature over this range!}\label{\detokenize{Flocculation/Floc_Design_Solution:id25}}\label{\detokenize{Flocculation/Floc_Design_Solution:figure-gtheta-vs-temperature}}\end{figure}


\subsubsection{4)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id4}}
The Equation \eqref{equation:Flocculation/Floc_Model:pClam} creates the link between \(\bar G \theta\) and flocculator performance. What does the floc model and \hyperref[\detokenize{Flocculation/Floc_Design_Solution:figure-gtheta-vs-temperature}]{Fig.\@ \ref{\detokenize{Flocculation/Floc_Design_Solution:figure-gtheta-vs-temperature}}} tell you about flocculator performance and flocculator design? Explain why performance varies with temperature. Explain how temperature influences collisions between particles. What temperature should be used to design flocculators?

Flocculator performance improves with warmer temperatures because the fluid deforms more given the same input energy. The fluid deforms more because it is less viscous at higher temperatures. Flocculators should be designed to perform well based on the coldest operating temperature that they will encounter.


\subsubsection{5)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id5}}
Calculate the volume of flocculator. Note that this volume does not take into account the extra volume that flocculator will have due to the changing water level caused by the head loss. Simply estimate the volume based on the residence time and the flow rate.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{vol\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{vol} \PYG{o}{=} \PYG{n}{t\PYGZus{}floc\PYGZus{}est}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD} \PYG{p}{)}\PYG{o}{*}\PYG{n}{flow\PYGZus{}plant}
    \PYG{k}{return} \PYG{n}{vol}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The volume of flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{vol\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The volume of flocculator is 7.936 meter ** 3


\subsubsection{6)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id6}}
Calculate the actual length of the flocculator channels. This must meet two constraints. First, it must be less than or equal to the maximum channel length. Second, the channel length is limited by the flocculator volume, height, minimum number of channels, and minimum width of the channels. This second constraint is important for low flow rates so that the flocculator has the correct target volume. Make sure to use this floc channel length in subsequent calculations.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{length\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{c+c1}{\PYGZsh{}The factor of two below is because the minimum number of channels in the flocculator is two.}
    \PYG{c+c1}{\PYGZsh{}This is a result of the orientation of the sedimentation tanks and the plumbing in the plant.}
    \PYG{c+c1}{\PYGZsh{}Unless the design is for very low flows (\PYGZlt{}10 L/s), there will always be an even number of flocculator channels.}
    \PYG{n}{length} \PYG{o}{=} \PYG{n}{vol\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{/}\PYG{n}{width\PYGZus{}floc\PYGZus{}min\PYGZus{}BOD}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{n}{height\PYGZus{}floc\PYGZus{}end}
    \PYG{k}{return} \PYG{n+nb}{min}\PYG{p}{(}\PYG{n}{length}\PYG{p}{,}\PYG{n}{length\PYGZus{}channel\PYGZus{}max}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum channel length is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{length\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The maximum channel length is 3.719 meter


\subsubsection{7)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id7}}
Calculate the combined total width of the flocculator channels (not including walls) based on the given length and depth.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{width\PYGZus{}floc\PYGZus{}total}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{width\PYGZus{}floc} \PYG{o}{=} \PYG{n}{vol\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{length\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{*}\PYG{n}{height\PYGZus{}floc\PYGZus{}end}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{width\PYGZus{}floc}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The total width of the flocculator channels is is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{width\PYGZus{}floc\PYGZus{}total}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The total width of the flocculator channels is is 1.067 meter


\subsubsection{8)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id8}}
Calculate the minimum channel width required to achieve H/S\textgreater{}3. The channel can be wider than this, but this is the absolute minimum width for a channel. The minimum width occurs when there is only one expansion per baffle and thus the distance between expansions is the same as the depth of water at the end of the flocculator.

\({W_{Min}} = \frac{{\Pi _{HS}}Q}{H_e}{\left( {\frac{K_e}{2{H_e}\nu {\bar G}^2}} \right)^{\frac{1}{3}}}\)

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{width\PYGZus{}floc\PYGZus{}min\PYGZus{}est}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{Gavg} \PYG{o}{=} \PYG{n}{G\PYGZus{}avg}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{nu} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{width\PYGZus{}floc\PYGZus{}min} \PYG{o}{=} \PYG{n}{Pi\PYGZus{}HS\PYGZus{}min}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{n}{K\PYGZus{}e}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{height\PYGZus{}floc\PYGZus{}end} \PYG{o}{*} \PYG{p}{(}\PYG{n}{Gavg}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*} \PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{flow\PYGZus{}plant}\PYG{o}{/}\PYG{n}{height\PYGZus{}floc\PYGZus{}end}
    \PYG{k}{return} \PYG{n}{width\PYGZus{}floc\PYGZus{}min}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum channel width is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{width\PYGZus{}floc\PYGZus{}min\PYGZus{}est}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The minimum channel width is 11.64 centimeter


\subsubsection{9)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id9}}
What is the minimum channel width given the additional constraint that must be built by humans? Use the max function to find the true minimum channel width given both constraints.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{width\PYGZus{}floc\PYGZus{}min}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{width\PYGZus{}floc\PYGZus{}min\PYGZus{}est}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{,}\PYG{n}{width\PYGZus{}floc\PYGZus{}min\PYGZus{}BOD}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum channel width is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{width\PYGZus{}floc\PYGZus{}min}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The minimum channel width is 0.5335 meter


\subsubsection{10)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id10}}
Calculate the number of channels by taking the total flocculator width (see step 7) and dividing by the minimum channel width (round down). Include the requirement that the number of channels must be even (Use the numpy floor function - look it up!). To make this function robust, make sure that it can’t ever return zero channels (the max function might be useful here)! You can convert the float to an integer with the int() function.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{num\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
     \PYG{n}{num} \PYG{o}{=} \PYG{p}{(}\PYG{n}{width\PYGZus{}floc\PYGZus{}total}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{/}
        \PYG{p}{(}\PYG{n}{width\PYGZus{}floc\PYGZus{}min}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
     \PYG{c+c1}{\PYGZsh{} floor function with step size 2}
     \PYG{n}{num} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{floor}\PYG{p}{(}\PYG{n}{num}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{l+m+mi}{2}
     \PYG{k}{return} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n+nb}{max}\PYG{p}{(}\PYG{n}{num}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{There are}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{num\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{channels.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

There are 2 channels.


\subsubsection{11)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id11}}
Calculate the actual channel width based on the number of channels and the total flocculator width.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{width\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{width\PYGZus{}total} \PYG{o}{=} \PYG{n}{width\PYGZus{}floc\PYGZus{}total}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{num\PYGZus{}c} \PYG{o}{=} \PYG{n}{num\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{width\PYGZus{}total}\PYG{o}{/}\PYG{n}{num\PYGZus{}c}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The actual flocculator channel width is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{width\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The actual flocculator channel width is 53.35 centimeter


\subsubsection{12)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id12}}
Calculate the \sphinxstyleemphasis{maximum} distance between expansions. This occurs for the largest allowable H/S ratio. Note that this isn’t accounting for the integer requirement for the number of baffle spaces per channel yet.
\begin{equation}\label{equation:Flocculation/Floc_Design_Solution:Flocculation/Floc_Design_Solution:1}
\begin{split}{H_{{e_{Max}}}} = {\left[ {\frac{{{K_e}}}{{2\nu {{\bar G}^2}}}{{\left( {\frac{{Q{\Pi _{H{S_{Max}}}}}}{W}} \right)}^3}} \right]^{\frac{1}{4}}}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{height\PYGZus{}exp\PYGZus{}max}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{g\PYGZus{}avg} \PYG{o}{=} \PYG{n}{G\PYGZus{}avg}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{nu} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{term1} \PYG{o}{=} \PYG{p}{(}\PYG{n}{K\PYGZus{}e}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{p}{(}\PYG{n}{g\PYGZus{}avg}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*} \PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}

    \PYG{n}{term2} \PYG{o}{=} \PYG{p}{(}\PYG{n}{Pi\PYGZus{}HS\PYGZus{}max}\PYG{o}{*}\PYG{n}{flow\PYGZus{}plant}\PYG{o}{/}\PYG{n}{width\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)}

    \PYG{n}{height\PYGZus{}exp} \PYG{o}{=} \PYG{n}{term1}\PYG{o}{*}\PYG{n}{term2}
    \PYG{k}{return} \PYG{n}{height\PYGZus{}exp}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum distance between expansions}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{height\PYGZus{}exp\PYGZus{}max}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The maximum distance between expansions 1.074 meter


\subsubsection{13)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id13}}
Calculate the minimum number of expansions per baffle space.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{num\PYGZus{}expansions}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{n}{height\PYGZus{}floc\PYGZus{}end}\PYG{o}{/}\PYG{p}{(}\PYG{n}{height\PYGZus{}exp\PYGZus{}max}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of expansions is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{num\PYGZus{}expansions}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The number of expansions is 2


\subsubsection{14)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id14}}
Calculate the actual distance between expansions given the integer requirement for the number of expansions per flocculator depth.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{height\PYGZus{}exp}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{k}{return} \PYG{n}{height\PYGZus{}floc\PYGZus{}end}\PYG{o}{/}\PYG{n}{num\PYGZus{}expansions}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}


\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The actual distance between expansions is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{height\PYGZus{}exp}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The actual distance between expansions is 1 meter


\subsubsection{15)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id15}}
Calculate the spacing between baffles based on the target velocity gradient using \eqref{equation:Flocculation/Floc_Design:Floc_baffle_spacing}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{spacing\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{g\PYGZus{}avg} \PYG{o}{=} \PYG{n}{G\PYGZus{}avg}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{nu} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{term1} \PYG{o}{=} \PYG{p}{(}\PYG{n}{K\PYGZus{}e}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{height\PYGZus{}exp}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{g\PYGZus{}avg}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{*} \PYG{n}{nu}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}

    \PYG{n}{ans} \PYG{o}{=}  \PYG{n}{term1}\PYG{o}{*}\PYG{n}{flow\PYGZus{}plant}\PYG{o}{/}\PYG{n}{width\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{ans}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The spacing between baffles is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{spacing\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The spacing between baffles is 0.1832 meter


\subsubsection{16)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id16}}
How many baffle spaces would fit in the channel(s) given the length of the flocculator and the baffle spacing? Round to the nearest integer.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{num\PYGZus{}baffles}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{num} \PYG{o}{=} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{num\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{*}\PYG{n}{length\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{/}\PYG{n}{spacing\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{num}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of baffle spaces that would fit in the channels is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{num\PYGZus{}baffles}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The number of baffle spaces that would fit in the channels is 41


\subsubsection{17)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id17}}
How many baffle spaces are needed to create the required collision potential? Note that this isn’t necessarily the same number as found in Problem 16. Calculating the collision potential per baffle space is the advised first step.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Gt\PYGZus{}baffle}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{term1} \PYG{o}{=} \PYG{n}{spacing\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{*}\PYG{n}{width\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{ans} \PYG{o}{=} \PYG{n}{term1}\PYG{o}{*}\PYG{n}{G\PYGZus{}avg}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{*}\PYG{n}{height\PYGZus{}floc\PYGZus{}end}\PYG{o}{/}\PYG{n}{flow\PYGZus{}plant}
    \PYG{k}{return} \PYG{n}{ans}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The collision potential (Gt) per baffle space is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}baffle}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{num\PYGZus{}baffle\PYGZus{}min}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{ans} \PYG{o}{=} \PYG{n+nb}{round}\PYG{p}{(}\PYG{n}{Gt\PYGZus{}BOD}\PYG{o}{/}\PYG{n}{Gt\PYGZus{}baffle}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{ans}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum number of baffles required is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{num\PYGZus{}baffle\PYGZus{}min}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The collision potential (Gt) per baffle space is 944 dimensionless. The minimum number of baffles required is 41


\subsubsection{18)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id18}}
Do the two estimates of the number of baffle spaces agree?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{if} \PYG{n}{num\PYGZus{}baffles}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)} \PYG{o}{==} \PYG{n}{num\PYGZus{}baffle\PYGZus{}min}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Yes}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{else}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{No}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

Yes


\subsubsection{19)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id19}}
Calculate the average velocity of the water in the flocculator. This is the velocity after the flow has expanded through each baffle/obstacle.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{vel\PYGZus{}floc\PYGZus{}ave}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{ans} \PYG{o}{=} \PYG{n}{flow\PYGZus{}plant}\PYG{o}{/}\PYG{p}{(} \PYG{n}{spacing\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{o}{*}\PYG{n}{width\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{ans}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The average velocity of the water in the flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{vel\PYGZus{}floc\PYGZus{}ave}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The average velocity of the water in the flocculator is 0.2046 meter / second


\subsubsection{20)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id20}}
Calculate the depth of water at the beginning of the flocculator based on the design head loss.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{HEIGHT\PYGZus{}WATER\PYGZus{}FLOC\PYGZus{}START} \PYG{o}{=} \PYG{n}{height\PYGZus{}floc\PYGZus{}end} \PYG{o}{+} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}
\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The depth of the water at the beginning of the flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{HEIGHT\PYGZus{}WATER\PYGZus{}FLOC\PYGZus{}START}\PYG{p}{)}
\end{sphinxVerbatim}

The depth of the water at the beginning of the flocculator is 2.4 meter


\subsubsection{21)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id21}}
Estimate the residence time in the hydraulic flocculator taking head loss into account. It is okay if your estimate doesn’t capture all of the details of the flocculator. You don’t need to account for the volume of the baffles. Simply account for the added water due to head loss. You can approximate the extra depth as a triangle.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{theta\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{theta\PYGZus{}est} \PYG{o}{=} \PYG{n}{t\PYGZus{}floc\PYGZus{}est}\PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
    \PYG{n}{ans} \PYG{o}{=} \PYG{n}{theta\PYGZus{}est}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{n}{height\PYGZus{}floc\PYGZus{}end} \PYG{o}{+} \PYG{p}{(}\PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{n}{height\PYGZus{}floc\PYGZus{}end}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{ans}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{min}\PYG{p}{)}

\PYG{n+nb}{print} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The residence time in the hydraulic flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{theta\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The residence time in the hydraulic flocculator is 7.275 minute


\subsubsection{22)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id22}}
Create plots showing number of channels, number of expansions per water depth, total number of baffles, and channel width for a flow range from 10-100 L/s. Note that the functions that we created in this design challenge are not able to handle arrays as inputs. Use \sphinxcode{\sphinxupquote{for}} loops to create the numpy arrays of y data needed for these graphs. Use 100 points to define each plot. Remember to initialize the numpy arrays before

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{plot\PYGZus{}points}\PYG{o}{=}\PYG{l+m+mi}{100}
\PYG{n}{flow\PYGZus{}plant}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{num}\PYG{o}{=}\PYG{n}{plot\PYGZus{}points}\PYG{p}{,} \PYG{n}{endpoint}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}

\PYG{n}{expansions}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{expansions}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{num\PYGZus{}expansions}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{expansions}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Plant Flow Rate (L/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Expansion per baffle space}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/Expansions\PYGZus{}per\PYGZus{}baffle\PYGZus{}space\PYGZus{}vs\PYGZus{}plant\PYGZus{}flow}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{channels}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{channels}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{=}\PYG{n}{num\PYGZus{}channel}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{channels}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Plant Flow Rate (L/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Number of channels}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/Number\PYGZus{}of\PYGZus{}channels\PYGZus{}vs\PYGZus{}plant\PYGZus{}flow}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{baffles}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{baffles}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{=}\PYG{n}{num\PYGZus{}baffles}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{baffles}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Plant Flow Rate (L/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Number of Baffle Spaces}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/Number\PYGZus{}of\PYGZus{}baffle\PYGZus{}spaces\PYGZus{}vs\PYGZus{}plant\PYGZus{}flow}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{width\PYGZus{}floc\PYGZus{}channel}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{plot\PYGZus{}points}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{width\PYGZus{}floc\PYGZus{}channel}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{o}{=}\PYG{n}{width\PYGZus{}floc}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{headloss\PYGZus{}floc\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{Gt\PYGZus{}BOD}\PYG{p}{,} \PYG{n}{T\PYGZus{}BOD}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant}\PYG{p}{,}\PYG{n}{width\PYGZus{}floc\PYGZus{}channel}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Plant Flow Rate (L/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Floc Channel Width (m)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{title}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Floc channel width vs plant flow}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flocculation/Images/Floc\PYGZus{}channel\PYGZus{}width\PYGZus{}vs\PYGZus{}plant\PYGZus{}flow}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Expansions_per_baffle_space_vs_plant_flow}.png}
\caption{The number of expansions per baffle space decreases rapidly with flow rate. These results are a function of the flocculator depth and of the target head loss used for the design.}\label{\detokenize{Flocculation/Floc_Design_Solution:id26}}\label{\detokenize{Flocculation/Floc_Design_Solution:figure-expansions-per-baffle-space-vs-plant-flow}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Number_of_channels_vs_plant_flow}.png}
\caption{The number of channels is less than 2 for a wide range of flows. This is because the required residence time in the flocculator is so low. We may eventually want to create a design that makes it possible to have an odd number of flocculator channels so that we can use a single channel for low flow rates.}\label{\detokenize{Flocculation/Floc_Design_Solution:id27}}\label{\detokenize{Flocculation/Floc_Design_Solution:figure-number-of-channels-vs-plant-flow}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Number_of_baffle_spaces_vs_plant_flow}.png}
\caption{The number of baffle spaces is lower for low flow rates because those flocculators have additional expansions. At high flow rates the number of baffles spaces increases because the residence time per baffle space decreases. The residence time per baffle space decreases when the number of channels jumps from 2 to 4.}\label{\detokenize{Flocculation/Floc_Design_Solution:id28}}\label{\detokenize{Flocculation/Floc_Design_Solution:figure-number-of-baffle-spaces-vs-plant-flow}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Floc_channel_width_vs_plant_flow}.png}
\caption{The flocculator channel width varies linearly with flow rate for a constant number of channels. The exception is for flows below about 35 L/s. In that flow rate the requirement of 2 channels that are the length of the sedimentation tank is excessive and results in more collision potential than needed. We need a new design solution to handle this suboptimal design for flows lower than 35 L/s.}\label{\detokenize{Flocculation/Floc_Design_Solution:id29}}\label{\detokenize{Flocculation/Floc_Design_Solution:figure-floc-channel-width-vs-plant-flow}}\end{figure}


\subsubsection{23)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id23}}
Read from the graphs to determine
\begin{enumerate}
\item {} 
At what flow rate is it no longer necessary to add extra obstacles in the flocculator?

\item {} 
At what flow rate does the flocculator switch from 2 channels to 4 channels?

\item {} 
\sphinxstylestrong{Why} did the flocculator switch from 2 to 4 channels?

\item {} 
No obstacles are needed for flows greater than about 65 L/s.

\item {} 
The flocculator switches from 2 to 4 channels at 65 L/s.

\item {} 
The channels had reached their maximum width at that flow rate.

\end{enumerate}


\subsubsection{24)}
\label{\detokenize{Flocculation/Floc_Design_Solution:id24}}
Change Gt\_BOD to 20,000 and run the code again. Identify at least 3 changes in the design.
\begin{enumerate}
\item {} 
The number of channels would be 2 for all of the flows explored here.

\item {} 
The value of G increased

\item {} 
The spacing between baffles decreased

\item {} 
The flow expansions became closer together (because the spacing between baffles decreased)

\item {} 
The number of baffles decreased

\end{enumerate}

Phi.. \_title\_Sedimentation\_Intro:


\chapter{Sedimentation Introduction}
\label{\detokenize{Sedimentation/Sed_Intro:sedimentation-introduction}}\label{\detokenize{Sedimentation/Sed_Intro::doc}}\phantomsection\label{\detokenize{Sedimentation/Sed_Intro:sedimentation-unit-process-overview}}
Sedimentation is a gravity-driven unit process in which suspended flocs are settled out from water. Large flocs made up of many primary particles and coagulant will settle if given enough time. Sedimentation is commonly preceded by coagulation/flocculation processes - coagulation/flocculation aim to form flocs which will be large enough to settle in sedimentation - and is commonly followed by filtration processes for further treatment. Sludge consolidation processes are often present alongside sedimentation to reduce the waste stream of settled flocs. Optimizing sedimentation is important because the more particles that sedimentation can remove, the fewer particles the filter will have to remove. This is good because filters can only handle a small amount of solids, and cleaning the filters with backwash uses a lot of water so we want to reduce the number of backwashes. The goal of sedimentation is to concentrate a waste stream of flocs, or sludge.

To introduce you to sedimentation, we will begin with a simple example. If a jar of water filled with flocs was left at rest, flocs would begin to settle due to gravitational forces pulling them down. Large flocs would settle first, but if left for long enough, all flocs would settle to the bottom of the jar. In its most basic form, the jar represents a sedimentation tank in which flocculated water is treated. Settled flocs are waste and the water on the top of the jar, referred to as the supernatant, is the settled water.

Constraints of space, time, and cost make it important to optimize the settling process. It would not be realistic to design water treatment systems that use the basic jar-like system to settle flocs because large flow rates would require unreasonably large reactor volumes and long retention times. The goal of sedimentation reactor design is to employ geometries that promote settling and allow for fast treatment with small footprints.

What if we were to do the same jar experiment with raw water that did not go through successful coagulation and flocculation? Would we observe the same settling and successful particle removal? To answer this, we must recall information learned in the section on coagulation and flocculation; those two treatment processes serve to destabilize and agglomerate particles to form flocs that will be heavy enough to settle. If the particles are colloids and are not destabilized, no amount of time will allow for the settling. This emphasizes the fact that successful sedimentation can only happen with successful coagulation and flocculation steps before it.

The three main steps that need to be accomplished for a sedimentation system to be successful are as follows:
\begin{enumerate}
\item {} 
Suspended flocs need to be able to settle out of the water.

\item {} 
Settling flocs need to be able to move from wherever they settle to a lower section of the tank.

\item {} 
Accumulated flocs at the bottom of the tank need to be removed.

\end{enumerate}

Sedimentation is ubiquitous in water treatment. Nevertheless, the process is very complex with many failure modes and there are many active research areas. The following sections will explore the state of conventional sedimentation systems and their challenges, gaps in knowledge, and the AguaClara approach to sedimentation.

To understand how sedimentation works, a few key concepts must first be developed. This includes understanding how and why flocs move in water. Remember, the goal of sedimentation reactor design is to optimize the floc-settling process.


\section{Terminal Velocity}
\label{\detokenize{Sedimentation/Sed_Intro:terminal-velocity}}
As flocs settle in water, they will fall at a speed dictated by the weight of the floc, the buoyancy of the floc, and drag from the water. These three forces - the gravitational weight force, the buoyant force, and the drag force - dictate the speed at which a floc falls and are detailed in the free body diagram of \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-terminal-velocity-fbd}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-terminal-velocity-fbd}}}. We care about determining the speed at which flocs will fall because knowing this information will help inform our sedimentation reactor design criteria.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{terminal_velocity_FBD}.png}
\caption{Free body diagram of a floc in water.}\label{\detokenize{Sedimentation/Sed_Intro:id1}}\label{\detokenize{Sedimentation/Sed_Intro:figure-terminal-velocity-fbd}}\end{figure}

To determine the force balance on a falling floc, consider:
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:0}
\begin{split}\sum F = m a\end{split}
\end{equation}
At terminal velocity, the floc has been falling for a long period of time so there is no acceleration and the right side of the equation simplifies to zero.

\(F_{drag} + F_{buoyant} - W_{floc} = 0\)

Each of the force components can be determined by:
\begin{align}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:1}\!\begin{aligned}
F_{drag} = C_D A_{floc} \rho_{H_2O} \frac{v_t^2}{2}\\
F_{buoyant} = \rlap{--}V_{floc} \rho_{H_2O} g\\
W_{floc} = \rlap{--}V_{floc} \rho_{floc} g\\
\end{aligned}\end{align}
\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(\rlap{--}V_{floc} =\) floc particle volume
\item[] \(A_{floc} =\) particle projected cross-sectional area
\item[] \(\rho_{floc} =\) particle density
\item[] \(\rho_{H_2O} =\) water density
\item[] \(g =\) acceleration due to gravity
\item[] \(C_D =\) drag coefficient
\item[] \(v_t=\) particle terminal velocity
\item[] \(D=\) particle diameter
\end{DUlineblock}

Plugging into the original force balance,
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:2}
\begin{split}\left [C_D A_{floc} \rho_{H_2O} \frac{v_t^2}{2} \right]+\left [\rlap{--}V_{floc} \rho_{H_2O} g\right ]-\left [\rlap{--}V_{floc} \rho_{floc} g \right] =0\end{split}
\end{equation}
Solving for terminal velocity, \(v_t\), provides
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:3}
\begin{split}v_t = \sqrt{\frac{4}{3}\frac{gD}{C_D}\frac{(\rho_{floc}-\rho_{H_2O})}{\rho_{H_2O}}}\end{split}
\end{equation}
Terminal velocity is a function of fluid density, floc density, gravity, particle diameter, and the drag coefficient. To calculate velocity, all of those inputs must be determined.

The first component that we will focus on is the drag coefficient, \(C_D\). The drag coefficient is function of Reynolds Number, \(Re\), and the characteristic flow around a particle. As a reminder, \(Re = \frac{v_t D}{\nu}\) where \(v_t\) is the velocity of the fluid relative to the particle, \(D\) is the characteristic length scale (in this case the particle diameter), and \(\nu\) is kinematic viscosity.

Drag coefficients are used to describe flow around a particle and are shown in \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-drag-coeff-re-base}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-drag-coeff-re-base}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{drag_coeff_Re_base}.png}
\caption{Drag coefficient on a sphere as a function of Reynolds number.}\label{\detokenize{Sedimentation/Sed_Intro:id2}}\label{\detokenize{Sedimentation/Sed_Intro:figure-drag-coeff-re-base}}\end{figure}

As an introduction to this drag coefficient diagram, we can compare it to something we’ve already learned about: the Moody diagram. Drawing parallels between the two will help us understand some important relationships better.


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Comparison of the Moody diagram and the Drag Coefficient diagram.}\label{\detokenize{Sedimentation/Sed_Intro:id3}}\label{\detokenize{Sedimentation/Sed_Intro:table-moody-dragcoefficient}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
Characteristic
&\sphinxstyletheadfamily 
Moody Diagram
&\sphinxstyletheadfamily 
Drag Coefficient Diagram
\\
\hline
Relationship to Reynolds number
&
friction factor, \(f\)
&
drag coefficient, \(C_D\)
\\
\hline
Type of head loss
&
major losses as shear force on pipe walls
&
shear on sphere and pressure drag from wake
\\
\hline
Laminar region
&
\(f = \frac{64}{Re}\)
&
\(C_D = \frac{24}{Re}\)
\\
\hline
High Reynolds number (\(f\), \(C_D\))
&
\(f\) remains constant
&
\(C_D\) remains constant
\\
\hline
High Reynolds number (\(h_L\), \(F_{drag}\))
&
\(h_L = \frac{fL\bar v^2}{2Dg}\)
&
\(F_{drag} = C_D A_{floc} \rho_{H_2O} \frac{v_t^2}{2}\)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

The flow around the particle and the Reynolds Number can be described in the laminar, turbulent, or turbulent-boundary regions as shown in \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-drag-coeff-re-full}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-drag-coeff-re-full}}}. In the laminar region viscous forces dominate, \(Re < 1\),and the coefficient of drag is represented as the straight line with a slope of -1 on the log-log plot. The equation for drag on a sphere in laminar flow \(C_D = \frac{24}{Re}\) is referred to as Stokes Law. You’ll notice that the line for Stokes Law shown in the figure extends past the laminar region. This was done because it highlights that even though Stokes Law is not exactly correct past the turbulent region, it is still a pretty good approximation for  \(Re < 10\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{drag_coeff_Re_full}.png}
\caption{Drag coefficient as a function of Reynolds number.}\label{\detokenize{Sedimentation/Sed_Intro:id4}}\label{\detokenize{Sedimentation/Sed_Intro:figure-drag-coeff-re-full}}\end{figure}

Note that the coefficient of drag in the transition region is an important parameter to understand. Equations for the coefficient of drag are explored in the paper by \sphinxhref{https://www.sciencedirect.com/science/article/pii/S2095268615000178}{Yang et al. in “General formulas for drag coefficient and settling velocity of sphere based on theoretical law”}. They have determined that Oseen law based formulas are recommended for use.

Let’s consider the drag coefficient diagram at Reynolds numbers of \(10^5\). We notice that there is a “bump” in the plot, in which the drag coefficients drop. This is because at really high Reynolds numbers, the boundary layer around the particle became turbulent. This causes the wake behind the particle to be a little smaller, leading to a slight reduction in drag. The drag coefficient decreases, but the total drag force does not necessarily decrease (and likely keeps on increasing).

To understand this phenomenon, think about a golf ball. Golf balls are designed with dimpled surfaces because the dimpled surface forces the transition described above to happen at lower Reynolds numbers. The dimples initiate turbulence in the boundary layer and cause a slight reduction in the drag coefficient. Thus, dimpled golf balls can travel further than smooth ones.

You might think: why aren’t more surfaces dimpled? If I want my car to get better mileage, should I dimple its surface to take advantage of the same turbulent boundary layer properties as the golf ball? But before you go and damage some metal, let’s think. If a car and golf ball are traveling through air at the same speed, what will be their relative Reynolds numbers? We know that \(Re = \frac{v_t D}{\nu}\) and \(D_{golfball} << D_{car}\). The relative length scales mean that cars have much higher Reynolds numbers than the golf ball. In fact, the Reynolds number for a car is so high that it is already past the point that the boundary layer becomes turbulent. The golf ball needs to be dimpled because its Reynolds numbers are not so large that they will pass the turbulent boundary transition.

Let’s go back to the realm of water treatment. We care about drag coefficients and terminal velocities because they help describe how flocs will move in water. Flocs tend to exist in the region between 1\textless{} \(Re\) \textless{} 10. This region is not perfectly described by Stokes Law, but it is used as an appropriate approximation. We have already solved for the general equation for terminal velocity using the force balance approach. Now, we can solve for a terminal velocity equation specifically in the laminar region.

Plug the drag coefficient and Reynolds numbers for laminar flow into the general terminal velocity equation:
\begin{align}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:4}\!\begin{aligned}
v_t = \sqrt{\frac{4}{3}\frac{gD}{C_D}\frac{(\rho_{floc}-\rho_{H_2O})}{\rho_{H_2O}}}\\
C_D = \frac{24}{Re}\\
Re = \frac{v_tD}{\nu}\\
\end{aligned}\end{align}
to yield,
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:5}
\begin{split}v_t = \frac{D^2g}{18\nu}\frac{\rho_{floc} -\rho_{H_2O}}{\rho_{H_2O}}\end{split}
\end{equation}
Again, we can draw a parallel with the Moody Diagram. The general form of the terminal velocity equation is like the Darcy-Weisbach equation; it is always true. The terminal velocity in the laminar flow region is like the Hagen-Poiselle equation; it is only good for laminar flow. We will use the laminar specific condition because we are working with flocs with low Reynolds numbers.

Our equations for terminal velocity depend on the density of a floc. As discussed in previous sections, we know that there is a specific relationship between the density of a floc and the diameter of a floc because flocs are fractals and as flocs get bigger, their density gets lower. We can account for the size and density relationship by modifying the terminal velocity equation.

\phantomsection\label{\detokenize{Sedimentation/Sed_Intro:heading-terminal-velocity-equation}}\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:6}
\begin{split}v_t = \frac{D_0^2g}{18\Phi\nu}\frac{\rho_{floc_0} -\rho_{H_2O}}{\rho_{H_2O}} \left( \frac{D}{D_0} \right) ^{D_{fractal}-1}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(D_0 =\) diameter of clay
\item[] \(D_{fractal} =\) fractal dimension
\item[] \(D =\) floc diameter
\item[] \(\rho_{floc_0} =\) density of the primary particle making up the floc
\item[] \(\Phi = 45/24\) based on Tambo N., and Watanabe Y. (1979). Physical characteristics of flocs-I. The floc density function and aluminum floc. Water Res. 13, 409
\end{DUlineblock}

The following plot in \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-terminal-velocity-floc-diam}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-terminal-velocity-floc-diam}}} shows the relationship between floc diameter and terminal velocity.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{terminal_velocity_floc_diam}.png}
\caption{Terminal velocity as a function of floc diameter, taking into account the changing density of flocs.}\label{\detokenize{Sedimentation/Sed_Intro:id5}}\label{\detokenize{Sedimentation/Sed_Intro:figure-terminal-velocity-floc-diam}}\end{figure}

Three important regions are highlighted in the plot. At small floc diameters, less than 10 \(\mu m\), terminal velocity is less that 0.1 \(\frac{mm}{s}\). A terminal velocity this low would require extremely large sedimentation tanks for reasonable treatment. Because large sedimentation tanks are costly and unfeasible, we use flocculation to aggregate particles and achieve floc sizes of greater diameters and higher terminal velocities.

For floc diameters around 35 \(\mu m\), the terminal velocity is about 0.12 \(\frac{mm}{s}\). AguaClara plate settlers are designed to settle out flocs of this size (particles dropping at 0.12 \(\frac{mm}{s}\)) so the smallest floc that we can capture is 35 \(\mu m\). This will be explored in more detail during the discussion on {\hyperref[\detokenize{Sedimentation/Sed_Intro:heading-capture-velocity}]{\sphinxcrossref{\DUrole{std,std-ref}{capture velocity}}}}.

Flocs with large diameters around 200 \(\mu m\) have a terminal velocity of about 1 \(\frac{mm}{s}\). In our sedimentation tanks, which are upflow sedimentation tanks, we have water flowing up at about 1 \(\frac{mm}{s}\) to capture a 200 \(\mu m\) floc. These flocs are clearly visible but are small.

Our understanding of floc terminal velocity suggests that we can decide the size of the floc that we want our sedimentation tank to capture. If we decide that we want to capture flocs that are 35 \(\mu m\) or larger, we know that we must design for water flowing at 0.12 \(\frac{mm}{s}\). Alternatively, we know that if we design a reactor in which water flows at 1 \(\frac{mm}{s}\), we will only be able to capture flocs that are 200 \(\mu m\) or larger.


\section{Capture Velocity}
\label{\detokenize{Sedimentation/Sed_Intro:capture-velocity}}\label{\detokenize{Sedimentation/Sed_Intro:heading-capture-velocity}}
Settle capture velocity is defined as the velocity of the slowest settling particle that a sedimentation tank captures reliably. It is a property of the geometry of the sedimentation tank. Because it is a property of geometry, we can use it as an important design tool; because we can control reactor geometry, we can control the sizes of particles that we can settle. However, the size of particles that a sedimentation tank can capture is also a function of the viscosity of the water and thus is influenced by temperature.

Note that there are a couple of different terms used to describe the sedimentation process. We can say that sedimentation tanks “capture” particles when particles settled. We can also say that sedimentation tanks “remove” particles. Both terms refer to the process of particles or floc settling out of suspension in water. Sedimentation tanks separate some particles from the water and eventually divert those captured particles into a waste stream.

We will develop our definition of settle capture velocity using examples of horizontal flow and vertical flow sedimentation tanks. It should be noted that there are many idealizations and simplifications made for modeling sedimentation tanks. We assume that water will move through the reactor as expected (in the case of the horizontal flow sedimentation tank, from one end to the other), but we know that there are many more fluids complications than are described here. We assume that everything is moving at the average velocity and there are no turbulence or velocity profiles. For the time being, we will ignore what will happen to particles once they are captured by the sedimentation tank. Our intuition tells us that particles which settle will need to be removed somehow, and that is correct. For now, we only care about capturing the particles, and later we will care about what we do with them once they are captured.

Temperature plays an important role in sedimentation processes. Colder temperatures mean more viscous fluid; particles suspended in viscous fluid don’t fall as quickly as they would in warmer, less viscous fluid. Sedimentation tanks don’t work as well in cold temperatures as they do in warm temperatures. If the goal is for the sedimentation tank to remove a certain size of particle, then the required capture velocity must also be a function of temperature. Keep this in mind throughout the chapter as you learn how capture velocity drives to plant design.


\subsection{Horizontal Flow Sedimentation Tank}
\label{\detokenize{Sedimentation/Sed_Intro:horizontal-flow-sedimentation-tank}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{horizontal_flow_tank_base}.png}
\caption{Horizontal flow sedimentation tank.}\label{\detokenize{Sedimentation/Sed_Intro:id6}}\label{\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-base}}\end{figure}

\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(L =\) length {[}L{]}
\item[] \(W =\) width {[}L{]}
\item[] \(H =\) height {[}L{]}
\item[] \(A_p =\) plan view area of the tank {[}\(L^2\){]}
\end{DUlineblock}

Let’s begin with a few questions that will describe our horizontal flow sedimentation tank in \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-base}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-base}}}. We will assume that 1) water travels uniformly from one end of the tank to the other, and 2) the particle that we are discussing is 35 \(\mu m\) (which is the size of particle that AguaClara plate settlers can capture).
\begin{enumerate}
\item {} 
How much time is required for water to pass through the tank?

\end{enumerate}

To determine this value, we can use the given volume and flow rate information by the following relationship:
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:7}
\begin{split}\theta = \frac{\rlap{--}V_{tank}}{Q}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(\theta =\) residence time \([T]\)
\item[] \(\rlap{--}V_{tank} =\) volume of the sedimentation tank \(\left[L^3\right]\)
\item[] \(Q =\) flow rate through the tank \(\left[\frac{L^3}{T}\right]\)
\end{DUlineblock}
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
In the “worst case scenario”, how far must a particle fall to reach the bottom of the tank?

\end{enumerate}

The “worst case scenario” is the condition in which a particle must travel the furthest in order to be successfully captured by the sedimentation tank. We assume that particles are evenly distributed throughout the height and width of the reactor entrance. Therefore, a particle entering at the top of the entrance of the reactor would need to fall a distance of \(H\) to reach the bottom. Any particle entering from a position lower than the top of the tank would need to fall a distance \(< H\). We refer to the “worst case scenario” pathway as the “critical path” of the particle in the sedimentation tank design because this is the case which we must design to treat. The height that the particle must fall is called the “critical height”, \(H_c\).
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
How fast must the particle fall?

\end{enumerate}

We know that for a particle to fall to the bottom successfully, it needs to fall fast enough that it can reach the bottom before the water that is carrying it leaves the reactor. Water is carrying the particle across the reactor at the horizontal velocity speed, \(v_H\). Gravity is causing the particle to settle at its terminal velocity, \(v_t\). In order to reach the bottom, that settling velocity needs to be the capture velocity, \(\bar v_c\), to ensure that the particle will reach the bottom of the reactor. We can see the critical path of the particle in \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-capture}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-capture}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{horizontal_flow_tank_capture}.png}
\caption{Horizontal flow sedimentation tank with capture velocity.}\label{\detokenize{Sedimentation/Sed_Intro:id7}}\label{\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-capture}}\end{figure}

Capture velocity can be determined by the distance that a particle must travel and the time that the particle has to travel.
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:8}
\begin{split}\bar v_c = \frac{H}{\theta}\end{split}
\end{equation}
We can make some substitutions into the equation for \(\bar v_c\) to solve for it in explicit terms of reactor plan view area. We are interested in plan view area because this will indicate the efficiency and cost of an associated reactor.
\begin{align}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:9}\!\begin{aligned}
\bar v_c = \frac{H}{\theta} = \frac{HQ}{\rlap{--}V_{tank}} = \frac{Q}{LW} = \frac{Q}{A_p}\\
\bar v_c = \frac{Q}{A_p}\\
\end{aligned}\end{align}
Thus, we have capture velocity which is a descriptor of a sedimentation tank. It determines how fast a particle has to settle in order to be reliably captured by a particular sedimentation tank, assuming idealized flow. The capture velocity is not a particle property, but rather a sedimentation tank property.
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
Will any particles that are smaller than 35 \(\mu m\) be captured in the sedimentation tank?

\end{enumerate}

This question is important because as stated in the beginning of this section, our discussion assumed that the particle in question was 35 \(\mu m\). If we design a sedimentation tank to capture particles that are 35 \(\mu m\), we also have to understand the impact of our design on particles smaller than 35 \(\mu m\).

To answer this question, think about the two extremes of our reactor.
\begin{itemize}
\item {} 
We could have a small particle entering the reactor at the top, defining the critical path in the same “worst case scenario”. This particle would not be successfully captured by the tank because its terminal velocity is less than the capture velocity, meaning that it doesn’t have enough time in the reactor to settle.

\item {} 
We could have a small particle entering the reactor near the bottom, in a “best case scenario”. In this case, the particle does not have a large distance to fall because it is already close to the bottom of the tank. Small particles entering the reactor may be able to be captured by a tank designed for particles 35 \(\mu m\) or larger, but it depends on the height at which they enter the reactor as shown in \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-small-capture}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-small-capture}}}.

\end{itemize}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{horizontal_flow_tank_small_capture}.png}
\caption{Horizontal flow sedimentation tank with critical path and small particle.}\label{\detokenize{Sedimentation/Sed_Intro:id8}}\label{\detokenize{Sedimentation/Sed_Intro:figure-horizontal-flow-tank-small-capture}}\end{figure}


\subsection{Vertical Flow Sedimentation Tank}
\label{\detokenize{Sedimentation/Sed_Intro:vertical-flow-sedimentation-tank}}
We will complete the same exercise for vertical flow sedimentation tanks shown in \hyperref[\detokenize{Sedimentation/Sed_Intro:figure-vertical-flow-tank-base}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Intro:figure-vertical-flow-tank-base}}}. In vertical flow sedimentation tanks, water flows up from the bottom of the reactor and exits near the top of the reactor.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=500\sphinxpxdimen]{{vertical_flow_tank_base}.png}
\caption{Vertical flow sedimentation tank.}\label{\detokenize{Sedimentation/Sed_Intro:id9}}\label{\detokenize{Sedimentation/Sed_Intro:figure-vertical-flow-tank-base}}\end{figure}
\begin{enumerate}
\item {} 
How much time is required for water to pass through the tank?

\end{enumerate}

The answer is the same for the horizontal flow sedimentation tank because this is a property of reactor flow rate and volume.
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:10}
\begin{split}\theta = \frac{\rlap{--}V_{tank}}{Q}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Where:
\item[] \(\theta =\) residence time {[}T{]}
\item[] \(\rlap{--}V_{tank} =\) volume of the sedimentation tank {[}\(L^3\){]}
\item[] \(Q =\) flow rate through the tank {[}\(\frac{L^3}{T}\){]}
\end{DUlineblock}
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
How far must a particle fall relative to the fluid to not be carried out the exit?

\end{enumerate}

Note how this question is different from the question we asked for the horizontal flow sedimentation tank. In the horizontal flow sedimentation tank, particles could settle to the bottom of the reactor. We care about particles settling to the bottom because we assume that if particles hit the bottom of the reactor, then they would be captured and would not leave the reactor. Remember, the goal of sedimentation is to remove particles from suspension in water. In the vertical flow sedimentation tank, we also want to remove particles from suspension, but because there is a different geometry, we are now interested in the relative movement of particle to water. If a particle is falling due to the forces of gravity, but also water is pushing up on it, the only way for a particle to remain in the reactor is if it either falls at the same velocity or faster than the water is pushing it.

If a particle is falling at the same velocity that water is moving it, it will be stationary in the reactor. Water flowing through the reactor moves a distance \(H\) in time \(\theta\), which means that a stationary particle must settle the same distance \(H\) in the same time \(\theta\). Therefore, the answer is \(H\).
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
How fast must the particle fall (relative to the fluid)?

\end{enumerate}

We determined in the previous question that a particle must fall a distance \(H\) in time \(\theta\). Therefore, we determine the same capture velocity for vertical flow sedimentation tanks as for horizontal flow sedimentation tanks.
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:11}
\begin{split}\bar v_c = \frac{H}{\theta}\end{split}
\end{equation}
We can the same substitutions to show,
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:12}
\begin{split}\bar v_c = \frac{H}{\theta} = \frac{HQ}{\rlap{--}V_{tank}} = \frac{Q}{LW} = \frac{Q}{A_p}\end{split}
\end{equation}
Again, we find that capture velocity is,
\begin{equation}\label{equation:Sedimentation/Sed_Intro:Sedimentation/Sed_Intro:13}
\begin{split}\bar v_c = \frac{Q}{A_p}\end{split}
\end{equation}
It doesn’t matter whether water is flowing horizontally or vertically in the tank. What determines the capture velocity is the flow rate and the plan view area of the sedimentation tank.
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
Will any particles that are smaller than 35 \(\mu m\) be captured in the sedimentation tank?

\end{enumerate}

This question is surprisingly complex because we have to consider what we have learned so far about sedimentation and also recall what we have learned about flocculation.

Let’s start with the simple sedimentation approach. We can compare the vertical flow sedimentation tank with the horizontal flow sedimentation tank. In a horizontal flow tank, the capture of particles smaller than the design particle (35 \(\mu m\)) is possible depending on the height which the particle enters the reactor. In a vertical flow tank, all particles enter the reactor at the same height (which is the bottom of the tank). This means that any particle entering the reactor will need to fall the same distance \(H\) in time \(\theta\) relative to the water if it will be captured. If particles smaller than 35 \(\mu m\) enter the reactor, they will not be captured because they are not able to settle fast enough.

However, we must also consider potential flocculation processes that could occur in the sedimentation tank. A sedimentation tank is still subject to the same laws of fluids as the flocculator, meaning that there will still be shear in the reactor. While it may not be as much shear as that introduced in the flocculator, there are still velocity gradients which mean that there could be some additional flocculation happening in the sedimentation tank. In the flocculator, the main mechanism that led to flocculation was the deformation of fluid which caused particles to collide. In the sedimentation tank, the main mechanism that can lead to flocculation is velocity gradients. Flocculation is provided by an opportunity for collision by differences in relative velocities of particles. Big particles in the sedimentation tank settle out but are still in suspension, and small particles continue to move up through the large particles. There is relative velocity between particles based on their terminal velocities.

Understanding relative velocities is very important to understand how vertical flow sedimentation tanks work. Let’s consider an example to develop our understanding of differential sedimentation. Imagine that two people are skydiving; one person is 150 lbs and the other person is 300 lbs. Assume that both people are using the same size parachutes and are jumping out of the same stationary helicopter. If the 150 lb person jumps out first and the 300 lb person jumps out a few moments after, what will happen? The 300 lb person will fall faster than the 150 lb person, causing a collision in the air. In a sedimentation tank, we would describe the collision due to differential sedimentation as flocculation because particles are colliding and growing.

Now that we understand differential settling and the potential for flocculation in a sedimentation tank, let’s revisit the original question. Can smaller particles be captured? The answer is that smaller particles can be captured only if they collide with other particles and grow so that they have a terminal velocity that is greater than the capture velocity. This flocculation that happens in the sedimentation tank is an additional mechanism for removing particles.

There are some important differences between horizontal and vertical sedimentation tanks. Many of these points will be discussed next when we learn specifically about the {\hyperref[\detokenize{Sedimentation/Sed_Design:heading-sed-design}]{\sphinxcrossref{\DUrole{std,std-ref}{AguaClara design process}}}}, but it is important to get introduced to these ideas now:
\begin{itemize}
\item {} 
vertical flow tanks require careful attention to the delivery of water in the bottom of the tank and the extraction of water in the top of the tank;

\item {} 
vertical and horizontal flow tanks may have different velocities and turbulence capacities due to plan view areas;

\item {} 
research on tube settlers by \sphinxhref{https://www.brentwoodindustries.com/water-wastewater-products/tube-settlers/}{Brentwood Industries} suggests that settle capture velocities should be 0.12 - 0.36 mm/s;

\item {} 
research on horizontal flow tanks in \sphinxstyleemphasis{Surface Water Treatment for Communities in Developing Countries} by Schulz and Okun suggests that settle capture velocities should be 0.24 - 0.72 mm/s.

\end{itemize}

With this understanding of the basic principles of sedimentation, we will transition to a discussion of AguaClara innovations.


\section{References}
\label{\detokenize{Sedimentation/Sed_Intro:references}}
Schulz, C. R., Okun, D. A., \& Water and Sanitation for Health Project (U.S.). (1984). Surface water treatment for communities in developing countries. New York: Wiley.


\section{Comments, Corrections, or Questions}
\label{\detokenize{Sedimentation/Sed_Intro:comments-corrections-or-questions}}
This textbook is an ever-evolving project. If you find any errors while you are reading, or if you find something unclear, please let the authors know. Write your comment in \sphinxhref{https://github.com/AguaClara/Textbook/issues/83}{this Github issue} and it will be addressed as soon as possible. Please look at other comments before writing your own to avoid duplicate comments.


\chapter{Sedimentation Design}
\label{\detokenize{Sedimentation/Sed_Design:sedimentation-design}}\label{\detokenize{Sedimentation/Sed_Design:title-sed-design}}\label{\detokenize{Sedimentation/Sed_Design::doc}}\phantomsection\label{\detokenize{Sedimentation/Sed_Design:heading-sed-design}}
The AguaClara sedimentation tank is a high-rate vertical flow sedimentation tank that is designed with the following goals:

1) to minimize secondary currents that could send high velocity flow through some of the plate settlers
1) to prevent accumulation of sludge that would tend to become anaerobic and release both dissolved organics (taste and order issues) and methane bubbles that would carry flocs to the top of the sedimentation tank
1) to include a stable floc blanket that reduces the settled water turbidity
1) to remove the solids without requiring power or moving mechanical parts
1) to provide a mechanism for the operator to dump poorly flocculated water before it enters the sedimentation tank. This is important to reduce the recovery time when there is a flocculation failure.
1) to ensure easy operation and maintenance.


\section{Components of an AguaClara Sedimentation Tank}
\label{\detokenize{Sedimentation/Sed_Design:components-of-an-aguaclara-sedimentation-tank}}
In this section, we will develop a conceptual understanding of the sedimentation tank using figures and images. We will be using a mixture of terminology typically found in water treatment settings and AguaClara-specific terminology. We will discuss the different parts of the sedimentation tank in the sequence that a parcel of water would encounter it, from the beginning of the unit process to the end. The three main sections are 1) how water enters the sedimentation tank, 2) how water moves through the sedimentation tank, and 3) how water leaves the sedimentation tank.

\begin{figure}[htbp]
\centering
\sphinxhref{https://youtu.be/ca3xVntxEzw}{\sphinxincludegraphics[height=300\sphinxpxdimen]{{sed_tank_overview}.png}}\label{\detokenize{Sedimentation/Sed_Design:figure-sed-tank-overview}}\end{figure}

Overview of an AguaClara Sedimentation tank (click to be sent to video).


\section{“Sedimentation Tank as a Circuit” Introduction}
\label{\detokenize{Sedimentation/Sed_Design:sedimentation-tank-as-a-circuit-introduction}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-as-circuit}}
To understand how we will use flow distribution as a primary design constraint, we will develop a concept called the “sedimentation tank as a circuit”. This concept will be elaborated on as you learn about the sedimentation tank components and design, but we will introduce it now because it is a driving principle for flow distribution in AguaClara sedimentation tanks. The chapter on Manifold design (still needs to be written) will be very useful to understand some of these fluids concepts.

An electrical circuit is a path in which electrons flow from a voltage or current source. Electrical circuits frequently have resistors, which are passive electrical components to create resistance in the flow of electric current. What does this have to do with sedimentation tanks? In our “sedimentation tank as a circuit” concept, we will draw parallels between how electrons flow through a circuit to how water flows through the sedimentation tank.

The AguaClara treatment train is designed so that flow is driven by potential energy. The entrance of the sedimentation tank, where water comes from the flocculator, is the source of the flow. Water then moves through the sedimentation tank and exits to the filter. At different points throughout the flow of water in the sedimentation tank, there are changes in piezometric head from fluid acceleration/deceleration and head loss. In the development of our circuit concept, piezometric head is like electrical resistance.

In electrical circuits, electrons will travel the path of least resistance in a parallel path system. Water is similar in that it will flow in the path of least resistance.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{circuit_base}.png}
\caption{Sedimentation tank as a circuit.}\label{\detokenize{Sedimentation/Sed_Design:id3}}\label{\detokenize{Sedimentation/Sed_Design:figure-circuit-base}}\end{figure}

\hyperref[\detokenize{Sedimentation/Sed_Design:figure-circuit-base}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-circuit-base}}} shows flow through a sedimentation system in which there are two sedimentation bays working in parallel. Each bay has multiple components through which piezometric head changes; wherever a resistor symbol is shown, it means that there is a difference in piezometric head in that section of pipe. We want to understand what is going on between the influent channel and the effluent channel so that we can design to control head loss and fluid flow.

Remember, the goal is to have even flow distribution. It is bad if different flow paths have different head losses or changes in piezometric head. We must consider this between sedimentation bays (comparing each bay to each other) and within a single sedimentation bay (comparing the flows at different points within the sedimentation bay). We want to limit differences in “resistance” to ensure equal flow distribution. Therefore, we define

\phantomsection\label{\detokenize{Sedimentation/Sed_Design:heading-good-v-bad-hl}}\begin{itemize}
\item {} 
anything that makes parallel flow paths different is “bad” head loss.

\item {} 
anything that increases head loss through all of the paths, to make differences between the paths less significant, is “good” head loss.

\end{itemize}

We can artificially introduce the second form of head loss to dominate the resistance and render small variations due to pressure recovery insignificant. We will go through each part of the sedimentation tank to understand how these goals drive AguaClara designs. As we learn about each component, we will attempt to categorize its contribution into creating “good” or “bad” head loss.


\section{1) How water enters the sedimentation tank}
\label{\detokenize{Sedimentation/Sed_Design:how-water-enters-the-sedimentation-tank}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-entrance}}

\subsection{Influent Channel}
\label{\detokenize{Sedimentation/Sed_Design:influent-channel}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-influent-channel}}
After water exits the flocculator, it is ready for sedimentation. In AguaClara plants, there is one flocculator per treatment train. However, depending on the plant flow rate, one plant may have multiple sedimentation units operating in parallel; we call each of these sedimentation units a ‘bay’ or a ‘tank’. Because there may be multiple sedimentation bays, we have to distribute flocculated water between the bays. To do this, we have an \sphinxstylestrong{influent channel} shown in \hyperref[\detokenize{Sedimentation/Sed_Design:figure-influent-channel-bays}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-influent-channel-bays}}}, which receives water from the flocculator and passes it to the sedimentation bays. The channel is long, concrete, and relatively shallow. The objective of the channel is to distribute water and flocs to the sedimentation bays without allowing any settling of flocs in the influent channel. The minimum velocity in the influent channel is about 0.15 mm/s to prevent flocs from settling. In the bottom of the channel, there are pipes that lead to the bottom of each sedimentation bay.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{influent_channel_bays}.png}
\caption{Influent channel with pipes leading to different sedimentation bays.}\label{\detokenize{Sedimentation/Sed_Design:id4}}\label{\detokenize{Sedimentation/Sed_Design:figure-influent-channel-bays}}\end{figure}

An important question is consider is whether or not the water in the influent channel gets evenly distributed between the different bays. If it does not get evenly distributed, which bay will receive the most water? We know from our understanding of fluids and flow distribution that in a pipe (or channel) with multiple orifices that is closed at one end, the distribution of flow is nonuniform along the length of the pipe; it is decelerating. This nonuniformity is due to conversion of kinetic energy into potential energy as the flow decelerates. This deceleration results in an increase in the piezometric head in the direction of flow.

Where else in fluids have we discussed decelerating flow? We have discussed this in flow expansions. We know that in flow expansions, there are higher pressures and slower velocities downstream. At the end of the pipe, there is low velocity and thus high pressure, driving the flow through the orifices at the end. For this same reason, a channel with multiple exits will have greatest flow thru the last exit.

So, is this type of head loss “good” or “bad”? In our {\hyperref[\detokenize{Sedimentation/Sed_Design:heading-good-v-bad-hl}]{\sphinxcrossref{\DUrole{std,std-ref}{definition of “good” and “bad”}}}}, we stated that “bad” head loss creates unequal flow in parallel flow paths. The head loss in the influent channel is therefore “bad” head loss because it can lead to different bays in parallel receiving different flows.

Sedimentation units have multiple bays for a few different reasons. Plants with higher flow rates require more sedimentation bays because the flow through each bay is limited by other design constraints, namely upflow velocity, which will be discussed later. Additionally, it is good to have more than one bay for maintenance purposes; if one bay needs to be cleaned, we want to always have another that can be working. Pipe stubs can be used to plug the entrance hole to a sedimentation bay to shut it down for maintenance.

Of note is that the sedimentation tank influent channel is located directly next to a drain channel. This drain channel was built to remove poorly flocculated water from the treatment train. If an operator observes poor flocculation, they can change the chemical dosing in an attempt to improve flocculation. In the meantime, they will want to dump the poorly flocculated water to avoid poor effluent quality. Operators can plug the entrance hole to the sedimentation bays, allowing the influent channel to fill with water. Once water reaches the height of the wall separating it from the drain channel, the water will pour over from the influent channel into the drain channel. This allows operators to easily dump poorly treated water and then easily restart sedimentation once flocculation performance improves.


\subsection{Bottom Geometry: Influent Manifold, Diffusers, and Jet Reverser}
\label{\detokenize{Sedimentation/Sed_Design:bottom-geometry-influent-manifold-diffusers-and-jet-reverser}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-bottom-geometry}}
Now, we will focus on a single bay of the sedimentation system. Flocculated water enters a pipe in the bottom of the influent channel and travels down a few feet. The pipe then has a 90 degree bend and extends along the bottom of the entire length of the sedimentation bay. This section of pipe that distributes water at the bottom of the sedimentation bay is referred to as the \sphinxstylestrong{influent manifold} shown in \hyperref[\detokenize{Sedimentation/Sed_Design:figure-influent-channel-manifold}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-influent-channel-manifold}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{influent_channel_manifold}.png}
\caption{Influent channel with pipe leading to one inlet manifold.}\label{\detokenize{Sedimentation/Sed_Design:id5}}\label{\detokenize{Sedimentation/Sed_Design:figure-influent-channel-manifold}}\end{figure}

Water exits the influent manifold through a series of orifices and \sphinxstylestrong{diffusers} in the bottom of the pipe shown in \hyperref[\detokenize{Sedimentation/Sed_Design:figure-influent-manifold-diffuser-base}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-influent-manifold-diffuser-base}}}. Orifices refer to the holes that are drilled into the underside of the manifold while diffusers are what we call short stubs of pipe that extend down from the orifice, perpendicular to the influent manifold. The orifices and diffusers point down to the bottom of the sedimentation bay and extend along the length of the pipe at regular intervals to ensure that water is evenly distributed within the bay. The ends of the diffuser tubes are flattened so that they are thin rectangles and when placed side-by-side achieve a line-jet effect. The end of the influent manifold is capped.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{influent_manifold_diffuser_base}.png}
\caption{Influent manifold with diffusers.}\label{\detokenize{Sedimentation/Sed_Design:id6}}\label{\detokenize{Sedimentation/Sed_Design:figure-influent-manifold-diffuser-base}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{influent_manifold_diffuser_flow}.png}
\caption{Influent manifold and diffuser flow paths.}\label{\detokenize{Sedimentation/Sed_Design:id7}}\label{\detokenize{Sedimentation/Sed_Design:figure-influent-manifold-diffuser-flow}}\end{figure}

Recall the discussion about flow distribution in the influent channel. We know that the sedimentation bay furthest away from the flocculator would receive the most flow from the influent channel due to fluids principles. For the same reasons, the orifice at the end of the influent manifold would receive the most flow in the pipe. Is the type of head loss introduced by the 90 degree bend “good” or “bad”? This head loss is “good” because it increases head loss through all paths equally.

Is the type of head loss in the influent manifold “good” or “bad”? Like the influent channel, it would be “bad” head loss because it can lead to different flow along the length of the sedimentation tank; the end of the sedimentation tank would receive more flow than the beginning.

However, the diffuser system was designed to greatly impact the overall flow distribution in an attempt to make the flow more equal in all parts of the system. Diffusers are designed to introduce 1 cm of head loss (see the section on {\hyperref[\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-diffuser-design}]{\sphinxcrossref{\DUrole{std,std-ref}{diffuser design}}}} for more information). This is “good” head loss because it uniformly increases the head loss through all flow paths. The “good” head loss from the diffusers dominate the “bad” head loss from the influent channel and manifold, making differences between the paths less significant.

The influent manifold diffuser system straightens the fluid jets that are exiting the manifold so that they have no horizontal velocity component as shown in \hyperref[\detokenize{Sedimentation/Sed_Design:figure-flow-straightening}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-flow-straightening}}}. This is critical because even a small horizontal velocity causes a large scale circulation that transports flocs directly to the top of the sedimentation tank as shown in \hyperref[\detokenize{Sedimentation/Sed_Design:figure-flow-circulation}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-flow-circulation}}}. Influent manifolds without flow straightening diffusers are commonly used in vertical flow sedimentation tanks including designs by leading manufacturers.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{flow_circulation}.png}
\caption{Flow with a horizontal velocity component that causes problematic flow circulation.}\label{\detokenize{Sedimentation/Sed_Design:id8}}\label{\detokenize{Sedimentation/Sed_Design:figure-flow-circulation}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{flow_straightening}.png}
\caption{Flow with the diffusers to remove horizontal velocity component to prevent problematic flow circulation.}\label{\detokenize{Sedimentation/Sed_Design:id9}}\label{\detokenize{Sedimentation/Sed_Design:figure-flow-straightening}}\end{figure}

The diffusers create a line jet that spans the entire length of the sedimentation tank. This line jet enters the bay going down, but we want the water to ultimately flow up to make our vertical flow sedimentation tank. To get the flow to redirect upwards, we use a \sphinxstylestrong{jet reverser}, which is half of a pipe that is laid in the bottom of the bay.

You may be wondering, why do we need a jet reverser in the first place? Why don’t we just have the diffusers point up to avoid having to change the flow in the first place? The answer has multiple components.
\begin{itemize}
\item {} 
If the diffusers were to point up, they could clog if anything settles in them. While this is unlikely due to the high velocity of flow exiting the small cross-sectional area diffuser, it is something that is avoided by pointing them down.

\item {} 
If flow were just to point directly up, it would not have an opportunity to sufficiently spread into the width of the sedimentation bay, which could lead to “short-circuiting” and poor flow distribution overall.

\item {} 
The jet reverser functions as a way to keep flocs suspended by ensuring that anything that settles will be propelled back up from the force of the diffuser jet. Because the diffusers and jet reverser are responsible for resuspension, their design must meet minimum velocity requirements, as derived in the section on {\hyperref[\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-diffuser-design}]{\sphinxcrossref{\DUrole{std,std-ref}{diffuser design}}}}. The jet reverser and diffuser alignment is not symmetrical; the diffusers are offset from the jet reverser centerline. This is intentionally done to ensure that the diffuser jet never collapses to promote a floc blanket, which will be discussed next. \hyperref[\detokenize{Sedimentation/Sed_Design:figure-jet-placement}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-jet-placement}}} shows that flat bottomed and centered jets do not create a floc blanket while offset jets are stable.

\end{itemize}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{jet_placement}.png}
\caption{The jet reverser and diffuser alignments; the offset jet is the most successful.}\label{\detokenize{Sedimentation/Sed_Design:id10}}\label{\detokenize{Sedimentation/Sed_Design:figure-jet-placement}}\end{figure}

There is a lot of research interest in determining the optimal upflow velocity for floc blankets considering that high velocity is better for resuspension but breaks more flocs. Currently, AguaClara plants use an upflow velocity of 1 mm/s.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://www.youtube.com/watch?v=04OksWoRmQI}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{flat_bottomed_tank}.png}}\caption{Flat bottomed tank with settled flocs (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id11}}\label{\detokenize{Sedimentation/Sed_Design:figure-flat-bottomed-tank}}\end{figure}

As shown in \hyperref[\detokenize{Sedimentation/Sed_Design:figure-flat-bottomed-tank}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-flat-bottomed-tank}}} and the linked video, in a flat bottom geometry, flocs settle in the corners of the tank because there is no direct flow of water to resuspend it. Flocs fall in such a way that the corners of the tank will fill first, with more and more flocs settling until the angle of repose is created. This angle that is occupied by flocs suggests that if we want to avoid having flocs settle, we should fill the sides of the tank in with concrete and create a sloped bottom so that there are no surfaces for settling.

The influent manifold, diffusers, and jet reverser work with a \sphinxstylestrong{sloped bottom geometry} in an AguaClara plant. The slope on either side of the diffusers is at a 50 degree angle. The bottom geometry allows for smooth flow expansion to the entire plan view area of the bay, and ensures that all flocs that settle are transported to the jet reverser. The diffusers do not touch the bottom of the tank so that flocs on both sides of the diffuser can fall into the jet reverser for resuspension. Thus, there is no accumulation of settled flocs in the main sedimentation basin. Sludge that is allowed to accumulate in the bottom of sedimentation tanks in tropical and temperate climates decomposes anaerobically and generates methane. The methane forms gas bubbles that carry suspended solids to the top of the sedimentation tank and cause a reduction in particle removal efficiency. The AguaClara sedimentation tank bottom geometry prevents sludge accumulation while also ensuring good flow distribution.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{sed_cross_section}.png}
\caption{Cross-section of the bottom of the sedimentation tank.}\label{\detokenize{Sedimentation/Sed_Design:id12}}\label{\detokenize{Sedimentation/Sed_Design:figure-sed-cross-section}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://www.youtube.com/watch?v=2x12wGb7xZE}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{Floc_Blanket_Floc_Hopper}.png}}\caption{Sloped bottom tank with fully suspended flocs (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id13}}\label{\detokenize{Sedimentation/Sed_Design:figure-floc-blanket-floc-hopper}}\end{figure}

So we know that the diffusers, jet reverser, and sloped bottom ensure that no sludge accumulates in the bay by creating a system to resuspend any settled flocs.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/yJ-8g7vQTSM}{\sphinxincludegraphics[height=300\sphinxpxdimen]{{diffuser_jetreverser}.png}}\caption{Distribution of flocculated water and resuspension of settling flocs (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id14}}\label{\detokenize{Sedimentation/Sed_Design:figure-diffuser-jetreverser}}\end{figure}

What are the failure modes for this system? For one, we need to ensure that the jet of water exiting the diffuser is able to maintain its upward direction after the jet reverser. The jet is influenced by the flows that are coming down the sloped sides of the tank. Thus, the jet must have enough momentum to remain upwards even with the momentum from other flows downwards. We can control the momentum of the jet by controlling the cross-sectional area of the diffuser slot. A smaller cross-sectional area will increase the velocity of the jet but the mass is the same because the flow rate for the plant is the same, thus increasing the momentum.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{jet_angle}.png}
\caption{Jet diameter and current of settled flocs.}\label{\detokenize{Sedimentation/Sed_Design:id15}}\label{\detokenize{Sedimentation/Sed_Design:figure-jet-angle}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/WEM-YyGITlQ}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{diffuser_jet_reverser}.png}}\caption{Jet reverser resuspending flocs (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id16}}\label{\detokenize{Sedimentation/Sed_Design:figure-diffuser-jet-reverser}}\end{figure}


\subsection{Jet Reverser Shear Stress}
\label{\detokenize{Sedimentation/Sed_Design:jet-reverser-shear-stress}}
The jet reverser is an AguaClara invention for producing stable floc blankets. The jet reverser includes a plane jet that is thin and has a high velocity. The momentum of that jet is important because it must counteract the momentum of the density current of the settled flocs. The thin, high velocity jet has a high energy dissipation rate (see equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:EDR_JetPlane}) and a high energy dissipation rate undoubtedly breaks up flocs. If the jet breaks flocs into fragments that have a terminal velocity that is less than the capture velocity of the plate settlers, then the sedimentation tank performance will deteriorate.

Conventional wisdom suggests that breaking up flocs on the way to the sedimentation tank is counter productive. The traditional goal of not breaking flocs led to design of tapered flocculators and guidelines suggesting maximum velocities for transport of those flocs to the sedimentation tank. Dimensional analysis provides the insight that if the constraint for not breaking flocs is actually a velocity, that there must be some way to make that velocity dimensionless if that constraint is rational. In order to identify and characterize the constraint related to floc break up we need to understand the physics of the processes and clearly identify the failure mode.

Flocs will break when the fluid forces acting on the floc exceed the strength of the bonds that hold the floc together. The fluid shear stress is given by equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:tau_of_mu_G}. The velocity gradient is caused by turbulent kinetic energy dissipation as given by equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:G_Camp_Stein}. Equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:tau_of_mu_G} and equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:G_Camp_Stein} can be combined to obtain an estimate of the fluid shear stress, \(\tau\).
\begin{equation}\label{equation:Sedimentation/Sed_Design:fluid_shear_stress}
\begin{split}      \tau = \rho \sqrt{\varepsilon \nu} = \mu G\end{split}
\end{equation}
The shear stress is a function of the rate of turbulent energy dissipation and the viscosity of the fluid. The shear stress increases as the water temperature decreases. The shear force acting to pull a doublet floc apart is given in equation \eqref{equation:Flocculation/Floc_Intro:shear_force_on_doublet} and can be combined with equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:tau_of_mu_G} to obtain
\begin{equation}\label{equation:Sedimentation/Sed_Design:fluid_shear_stress_on_doublet}
\begin{split}      F_{shear_{max}} = 3 \tau \frac{ \pi d_{floc}^2}{4} = 3 \tau A_{floc}\end{split}
\end{equation}
The floc will break apart when the \(F_{shear_{max}}\) exceeds the coagulant bond strength. The coagulant bonds are likely covalent bonds with an estimated strength \(F_{covalent}\) of 1.6 nN. Thus we can create a dimensionless parameter describing the ratio of the fluid shear stress to the bond strength by dividing equation \eqref{equation:Sedimentation/Sed_Design:fluid_shear_stress_on_doublet} by \(F_{covalent}\).
\begin{equation}\label{equation:Sedimentation/Sed_Design:fluid_shear_stress_to_bond_ratio}
\begin{split}      \Pi_{Bond}^{Fluid} = \frac{F_{shear_{max}}}{F_{covalent}} = \frac{3 \tau A_{floc}}{F_{covalent}}\end{split}
\end{equation}
The expectation is that the flocs will break for values of \(\Pi_{Bond}^{Fluid}>1\). This analysis shows that the maximum size of a floc is set by the fluid shear stress, \(\tau\). Previously it wasn’t clear if floc size was limited by energy dissipation rate or by the velocity gradient. Neither of those parameters captures the physics because ultimately it is a force that breaks the covalent bond and thus it must be a fluid force (not energy dissipation rate or velocity gradient) that can be used as a design parameter. By recognizing that the shear stress \(\tau\) must be limited we can now develop design equations for the jet reverser and account for the effects of viscosity and temperature on the design.

When flocs are broken by the shearing action of the fluid it is possible that a primary particle is torn off or that the floc is broken in half. The method of breaking matters because if primary particles are dislodged from a floc then any breaking will lead to a deterioration of the sedimentation tank performance because some of those primary particles will make it through the floc blanket and won’t be captured by the plate settlers. Conventional wisdom would suggest that flocs will be broken into little pieces. If that were the case then any floc breakup would cause the settled water turbidity to increase. \sphinxhref{https://doi.org/10.1089/ees.2015.0314}{Garland, 2016} showed that there was no sign of increased settled water turbidity up to an energy dissipation rate of 300 mw/kg (\hyperref[\detokenize{Sedimentation/Sed_Design:figure-sed-performance-vs-jet-edr}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-sed-performance-vs-jet-edr}}}).

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Sed_performance_vs_jet_edr}.png}
\label{\detokenize{Sedimentation/Sed_Design:figure-sed-performance-vs-jet-edr}}\end{figure}

Using equation \eqref{equation:Sedimentation/Sed_Design:fluid_shear_stress} the maximum energy dissipation rate below the performance deterioration obtained by Garland (300 mW/kg) can be converted into a fluid shear stress of 0.55 Pa. The fluid shear combined with the strength of covalent bonds can be used to solve for the floc diameter using equation \eqref{equation:Sedimentation/Sed_Design:fluid_shear_stress_on_doublet}.
\begin{equation}\label{equation:Sedimentation/Sed_Design:d_floc_shear_stress}
\begin{split}d_{floc}=\sqrt{\frac{4F_{covalent}}{3 \pi \tau}}\end{split}
\end{equation}
The floc size that corresponds to 300 mW/kg is 35 micrometers. The terminal velocity of a floc that is dominated by the primary particles rather than by coagulant or dissolved organic matter is given by
\begin{equation}\label{equation:Sedimentation/Sed_Design:vt_of_clay_floc}
\begin{split}\bar v_t = \frac{g d_0^2}{18 \nu_{H_2O}}
\frac{ \left( \rho_{Floc_0} - \rho_{H_2O} \right)}{\rho_{H_2O}}
\left( \frac{d}{d_0} \right)^{D_{Fractal} - 1}\end{split}
\end{equation}
For clay dominated flocs equation \eqref{equation:Sedimentation/Sed_Design:vt_of_clay_floc} gives a 0.13 mm/s sedimentation velocity which is just slightly higher than the 0.1 mm/s capture velocity used by Garland.

Garland’s experiment with the result of floc breakup at the sedimentation tank inlet is consistent with several hypotheses.
\begin{enumerate}
\item {} 
The bonds holding flocs together are likely strong (order 1.6 nN). It is not yet clear what the origin of the bonds is. Van der Waals forces may be of similar magnitude, but they would also apply to water molecules and thus there wouldn’t be a mechanism for the coagulant to displace water molecules between approaching surfaces. For example, the gecko adhesion to surfaces is reduced by a factor of 40 when the surface is wet (\sphinxhref{https://doi.org/10.1242/jeb.070912}{Stark et al., 2012}). Thus a force that is stronger than any bonds between water molecules and the surfaces must be responsible for joining coagulant nanoparticles and the particles present in the raw water. One likely candidate is covalent bonds.

\item {} 
Flocs are broken where there is the largest force per bond. This would logically occur at the connection between the two subunits that form the floc. Thus when flocs break they would not be expected to produce tiny fragments.

\item {} 
The fluid shear stress determines the force acting to tear a floc apart. Thus given a constant energy dissipation rate the force acting to break up flocs will increase as the temperature drops (see equation \eqref{equation:Sedimentation/Sed_Design:fluid_shear_stress})

\item {} 
Settled water turbidity increases when the floc terminal velocity is less than the capture velocity of the plate settlers.

\end{enumerate}

The maximum shear stress that should be used for design of jet reversers requires further analysis. Flocs composed of less clay and more organic matter or more coagulant nanoparticles will have a lower density and would still be sheared to the same diameter by the fluid shear stress. These flocs would have a lower sedimentation velocity than clay based flocs and thus they would not be captured by the plate settlers. Thus the design constraint for the fluid shear stress should be based on the lowest density floc that is to be captured by the plate settlers.

Different coagulants may well have different bond strengths and flocculant aids that increase the bond strength all merit study with the jet reverser experiment to determine an appropriate fluid shear stress. The shear stress of 0.55 Pa is likely an upper limit for operation without using flocculant aids.

The maximum fluid shear stress for conservative basis of design should be calculated based on minimum water temperature, plate settler capture velocity, and minimum floc density. The solution path is
\begin{enumerate}
\item {} 
Calculate the diameter of the lowest density floc that has a terminal velocity equal to the capture velocity of the plate settlers.

\item {} 
Solve equation \eqref{equation:Sedimentation/Sed_Design:d_floc_shear_stress} for the shear stress given the floc diameter.

\end{enumerate}


\subsection{Jet Reverser Design}
\label{\detokenize{Sedimentation/Sed_Design:jet-reverser-design}}\label{\detokenize{Sedimentation/Sed_Design:id2}}
The jet reverser can be designed given a maximum fluid shear stress that is calculated based on minimum operating temperature, plate settler capture velocity, and floc density. We do not yet have a comprehensive model for floc properties and thus we are not yet able to calculate floc terminal velocity as a function of composition. We do anticipate that floc density decreases dramatically for flocs that consist primarily of dissolved organics and coagulant.

The goal is to derive an equation that will calculate the maximum jet velocity given the upflow velocity, \(v_{z_{fb}}\), and width, \(W_{Sed}\), of the sedimentation tank. Begin by eliminating the energy dissipation rate from the fluid shear stress, equation \eqref{equation:Sedimentation/Sed_Design:fluid_shear_stress}, by substituting the plane jet energy dissipation rate, equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:EDR_JetPlane}.
\begin{equation}\label{equation:Sedimentation/Sed_Design:shear_stress_plane_jet}
\begin{split}\tau_{max} = \rho \sqrt{\nu \Pi_{JetPlane} \frac{  \bar v_{Jet} ^3}{W_{Jet}}}\end{split}
\end{equation}
The volumetric flow rate of the plane jet is the same as the volumetric flow rate through the sedimentation tank.
\begin{equation}\label{equation:Sedimentation/Sed_Design:jet_sed_tank_continuity}
\begin{split}\bar v_{Jet} W_{Jet} = \bar v_{z_{fb}} W_{Sed}\end{split}
\end{equation}
Use equation \eqref{equation:Sedimentation/Sed_Design:jet_sed_tank_continuity} to eliminate the thickness of the jet, \(W_{Jet}\) in equation \eqref{equation:Sedimentation/Sed_Design:shear_stress_plane_jet}
\begin{equation}\label{equation:Sedimentation/Sed_Design:shear_stress_jet_sed_tank}
\begin{split}\tau_{max} = \rho \bar v_{Jet} ^2 \sqrt{ \frac{\nu \Pi_{JetPlane}}{\bar v_{z_{fb}} W_{Sed}}}\end{split}
\end{equation}
Solve for the maximum permissible jet velocity, \(\bar v_{Jet}\).
\begin{equation}\label{equation:Sedimentation/Sed_Design:max_sed_tank_jet_velocity}
\begin{split}\bar v_{Jet} = \left(\frac{\tau_{max}}{\rho}\right)^\frac{1}{2} \left( \frac{\bar v_{z_{fb}} W_{Sed}}{\nu \Pi_{JetPlane}}\right)^\frac{1}{4}\end{split}
\end{equation}
The maximum jet velocity increases with width of the sedimentation tank valley because the jet thickness is proportional to valley width and the energy is dissipated more slowly as the jet width increases. The maximum jet velocity, \hyperref[\detokenize{Sedimentation/Sed_Design:figure-jet-velocity-vs-sed-valley-width}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-jet-velocity-vs-sed-valley-width}}}, and head loss, \sphinxcode{\sphinxupquote{\_figure\_Jet\_head\_loss\_vs\_sed\_valley\_width}}, increases with temperature because as the viscosity decreases the fluid shear stress decreases. Floc breakup will be most problematic in low temperatures when the raw water has low turbidity and high concentration of dissolved organics.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Jet_velocity_vs_sed_valley_width}.png}
\caption{The maximum jet velocity increases with width of the sedimentation tank valley and with temperature.}\label{\detokenize{Sedimentation/Sed_Design:id17}}\label{\detokenize{Sedimentation/Sed_Design:figure-jet-velocity-vs-sed-valley-width}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Jet_head_loss_vs_sed_valley_width}.png}
\caption{The maximum jet head loss increases with width of the sedimentation tank valley and with temperature.}\label{\detokenize{Sedimentation/Sed_Design:id18}}\label{\detokenize{Sedimentation/Sed_Design:figure-jet-head-loss-vs-sed-valley-width}}\end{figure}

Sedimentation tank design is strongly influenced by the goal of not breaking flocs down to a size that can’t be captured by the plate settlers. The floc size velocity restriction limits the velocity of the water in the manifold that delivers water to the diffuser jets. The ratio of manifold velocity to port velocity can be obtained as the inverse of equation \eqref{equation:Hydraulics/Hydraulics_Intro:Manifold_max_v_no_hl_series}.
\begin{equation}\label{equation:Sedimentation/Sed_Design:max_sed_tank_manifold_velocity}
\begin{split}\frac{\bar v_{M_1}}{\bar v_{P}} = \sqrt{\frac{2(1 - \Pi_{Q}^2)}{\Pi_{Q}^2 + 1}}\end{split}
\end{equation}
Given a flow uniformity goal, \(\Pi_Q\), of 0.85 the manifold velocity must be less than 0.57 of the jet velocity.

Further works is required to determine the maximum shear stress that will not cause a deterioration on performance especially for flocs that consist of coagulant nanoparticles and dissolved organics.


\section{2) How water moves through the sedimentation tank}
\label{\detokenize{Sedimentation/Sed_Design:how-water-moves-through-the-sedimentation-tank}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-middle}}

\subsection{Floc Blanket}
\label{\detokenize{Sedimentation/Sed_Design:floc-blanket}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-floc-blanket}}
The line jet from the diffusers enters the jet reverser to force flow up through the sedimentation bay. The vertical upward jet momentum is used to resuspend flocs that have settled to the bottom of the sedimentation tank. The resuspended flocs form a fluidized bed which is called a \sphinxstylestrong{floc blanket}. The bed is fluidized because flocs are kept in suspension by the upflowing water.

For a floc blanket to form, a sedimentation system requires that 1) all flocs be returned to the bottom of the sedimentation tank and 2) requires that all settled flocs be resuspended by incoming water. As will be discussed soon, plate settlers are used to return flocs to the bottom of the bay, while the jet reverser and sloped bottom geometry allow for floc resuspension. Any surface with a horizontal component in a sedimentation tank must be sloped to allow settled flocs to return to the resuspension zone. A flat bottom geometry does not allow for the formation of a floc blanket, as discussed previously.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://www.youtube.com/watch?v=w8ZFCz54IBs}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{floc_blanket_experiment}.png}}\caption{Floc blanket formation over time (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id19}}\label{\detokenize{Sedimentation/Sed_Design:figure-floc-blanket-experiment}}\end{figure}

Studies by AguaClara researchers have found that floc blankets improve the performance of a sedimentation tank and reduces settled water turbidity by a factor of 10 for multiple reasons (\sphinxhref{https://www.liebertpub.com/doi/10.1089/ees.2016.0174}{Garland et al., 2017}):
\begin{itemize}
\item {} 
by providing additional collision potential. The high concentration of particles, with a suspended solids concentrations of approximately 1-5 g/L, leads to an increase in collisions and particle aggregation. As discussed for vertical flow sedimentation tanks, flocculation can occur in a floc blanket due to shear from suspended flocs which are colliding and growing. Fluidized flocs provide a collision potential of a few thousand. This collision potential is small compared to the collision potential from the flocculator. So how does a small \(G_{CS} \theta\) cause a large reduction in turbidity? The two-fold answer may be that the lower \(G_{CS}\) value provides an opportunity for all flocs to grow larger without floc breakup. The high concentration of flocs provides many opportunities for clay particles to collide with big flocs, but it is not clear if or when those collisions are successful. We also want to know which flocs are active or inactive in collisions in the floc blanket. See the section on {\hyperref[\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-floc-blanket-design}]{\sphinxcrossref{\DUrole{std,std-ref}{floc blanket design}}}} for more information.

\item {} 
by creating a uniform vertical velocity of water entering the plate settlers.

\item {} 
by transporting excess floc consolidation pipe with a drain port, called the floc hopper. The floc hopper is discussed in the next section.

\end{itemize}

While we have just explained three reasons that the floc blanket improves sedimentation effluent quality, we do not yet have a model for floc blanket performance. Additional research is needed to create this model, and to determine optimal upflow velocity.

Consider the requirements that we have stated for the creation of the floc blanket. Could we design for a floc blanket in a treatment plant that experiences flow variability? There are some plants that only run for certain hours of the day. While this intermittent flow would impact many parts of the plant, how would it impact the floc blanket specifically? Can a settled floc blanket be resuspended?

We do not yet have a way to design for variable or intermittent flow rates in a sedimentation tank. The ability of a settled floc blanket to resuspend is dependent on the characteristics of the flocs themselves. For example, sticky and clumpy flocs would have a more difficult time resuspending because they tend to settle into hard masses in the absence of sufficient upflow velocities. The capacity for resuspension may require site-specific analysis. The AguaClara pilot PF300 in testing at the Cornell Water Treatment Plant is going to determine whether the floc blanket at that site will be able to intermittent flow; the pilot plant and the Cornell Water Treatment Plant will be offline from around 10pm - 5am daily.

It is of interesting note that the suspended solids concentration in the floc blanket is approximately 1-5 g/L. This concentration corresponds to measurements of thousands of NTU, which is remarkably turbid water. A water treatment plant could have 5 NTU water entering the plant, and water in the bottom of the sedimentation tank could have 1000 NTU. This is one clue that there are interesting things happening in the floc blanket; the bottom of the sedimentation tank can be a completely different world from the rest of the treatment process.

An understanding the bottom of a sedimentation tank is important to understand how sedimentation tanks work. However, most sedimentation tanks do not allow the operator to observe what is happening. Without being able to observe the bottom of the sedimentation tank, an operator would not know what is happening or if a floc blanket is forming successfully. AguaClara research teams are working to develop a probe to get data on floc blanket performance. Until then, there are two ways to learn about the floc blanket. The AguaClara plant at the University of Zamorano in Honduras was built with a translucent wall on one end of a sedimentation bay. This allows students and operators to observe the floc blanket. The AguaClara pilot PF300 in testing at the Cornell Water Treatment Plant has small sample ports installed into the side of the reactor. Drawing a sample of water at different heights of the reactor will indicate if a floc blanket has grown, and how deep it is.

Let’s recap some important conclusions from this section on the floc blanket.
\begin{itemize}
\item {} 
The low G flocculation in the floc blanket may allow for the rapid growth of the flocs coming from the flocculator.

\item {} 
The floc blanket reduces the effluent turbidity from the sedimentation tank.

\item {} 
The floc blanket requires a mechanism to keep the flocs resuspended:
- an upflow velocity of approximately 1 mm/s is the current AguaClara design parameter;
- sloped surfaces to return flocs to the resuspension point is necessary to prevent floc build-up.

\item {} 
We do not have a model for floc blanket performance, meaning that we don’t know the optimal floc blanket depth or optimal upflow velocity.

\item {} 
We do not yet have a consistent way for operators to observe the floc blanket.

\item {} 
We do not know what exactly contributes to the ability of a floc blanket to resuspend or survive variable flow.

\end{itemize}


\subsection{Floc Hopper}
\label{\detokenize{Sedimentation/Sed_Design:floc-hopper}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-floc-hopper}}
The \sphinxstylestrong{floc hopper} provides an opportunity for floc consolidation. The floc weir controls the depth of the floc blanket because as the floc blanket grows, it will eventually reach the top of the floc weir. Because flocs are more dense than water, the flocs “spill” over the edge of the floc weir which allows the floc blanket to stay a constant height while sludge accumulates and consolidates in the floc hopper.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/xh9dTjWRoto}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{floc_hopper_highlight}.png}}\caption{Floc hopper detail with flocs “spilling” over the wall (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id20}}\label{\detokenize{Sedimentation/Sed_Design:figure-floc-hopper-highlight}}\end{figure}

Consolidated sludge in the bottom of the floc hopper is then removed from the sedimentation tank through small drain valve controlled by the operator. Floc hoppers in the lab-scale and PF300 setting are currently set at a 45 degree angle, but further optimization is needed.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{benchtop_sed}.png}
\caption{Benchtop sedimentation tank setup, highlighting the floc blanket and floc hopper.}\label{\detokenize{Sedimentation/Sed_Design:id21}}\label{\detokenize{Sedimentation/Sed_Design:figure-benchtop-sed}}\end{figure}

The floc hopper allows for a self-cleaning sedimentation tank. By gravity, flocs are sent over to a floc hopper. This means that operators only have to clean the sedimentation tank once every three to six months because there is no stagnant accumulation of anoxic sludge. When operators do clean the sedimentation tank, they are primarily cleaning plate settlers. Under normal operation, operators can open the floc hopper drain valve whenever they want to easily drain the sludge. We don’t yet have a method to guide the operation of the floc hopper, so operators determine how frequently to drain the floc hopper from experimental and operational experience. Without the floc blanket transport system, other methods would be required to remove accumulated sludge in the bay. Mechanical sludge removal systems are common alternatives but are well known to be costly to install and a challenge to maintain.

We’ve stated that a benefit of the floc blanket is that flocs can be removed without mechanical assistance, but why do we need the floc hopper at all? Why can’t we just install drain holes in the bottom of the sedimentation tank so that any accumulated sludge is removed? This is a question that plagued AguaClara in its early years. At first, before we were able to successfully build and operate a floc blanket, we had sludge accumulate in the bottom of the sedimentation bay. Therefore, we needed to remove the sludge with drain holes at the bottom. However, to have those drain holes where the sludge was accumulating in the tank, designers made a flat bottom tank. But as we now know, the flat bottom tank is part of the reason that there wasn’t any floc blanket forming. As soon as we realized that we could grow a floc blanket with a sloped bottom tank and a jet reverser, we could not use drain holes in the bottom of the tank. Why? Because in the bottom of tanks with floc blankets created by jet reversers, there is no settling. Drain holes at the bottom of a sloped tank would be draining a combination of flocculated water and floc blanket water, neither of which are consolidated thus making the draining ineffective and inefficient. A benefit of the floc hopper is that there is no upflow velocity, which means that the sludge is able to settle and become more dense, allowing for less water waste from draining sludge.

Floc blanket flow into the floc hopper is a function of the mass flux of particles into the sedimentation tank. In order to optimize the floc hopper design, we need to characterize the consolidation rate of the flocs. We do not have a good model for this yet; developing one would allow us to optimize design and guide operators for how much and how frequently the floc hopper should be drained.


\subsection{Plate Settlers}
\label{\detokenize{Sedimentation/Sed_Design:plate-settlers}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-plate-settlers}}
After flowing through the floc blanket, flocs reach the \sphinxstylestrong{plate settlers}. Plate settlers are sloped surfaces that provide additional settling area for flocs, thereby increasing the effective settling area of the sedimentation unit without increasing the plan view area. AguaClara plate settlers are sloped at 60 degrees. In our discussion of horizontal and vertical flow sedimentation tanks, an important design parameter was capture velocity which was set by flow rate and plan view area of the sedimentation tank. With the introduction of plate settlers, the important design parameter changes. What matters is not just the plan view area of the sedimentation tank, but instead the projected area of all of the surfaces where particles can settle out, which we call the effective settling area. Without plate settlers, the only way we could improve performance and impact the capture velocity was by increasing the plan view area of the sedimentation tank. With plate settlers, we can improve performance by adding additional settling area without increasing the plan view area. This allows for greater treatment efficiency at low cost because we can maintain a small footprint. Note that plate settlers can also be referred to as lamella settlers, or lamellas.

The first thing that we will discuss is how flocs can settle on plates. To understand this, we will ask a few questions about how particles and flocs will flow between two plate settlers.
\begin{enumerate}
\item {} 
What is the critical path?

\end{enumerate}

We need particles to settle on the bottom plate for it to be effectively captured. Thus, the critical path can be shown by a floc that enters the plate settlers closest to the upper plate, because it will have the greatest distance to settle.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_critpath}.png}
\caption{Critical path between two plate settlers.}\label{\detokenize{Sedimentation/Sed_Design:id22}}\label{\detokenize{Sedimentation/Sed_Design:figure-plate-settler-critpath}}\end{figure}
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
How far must the particle settle to reach the lower plate?

\end{enumerate}

Let’s make a simplification and assume that water is flowing with uniform velocity between the plates, represented by a “top hat” velocity profile. This is a significant assumption, but it is used to help us understand the critical path. The fluid is carrying the floc between the inclined plates while gravity is pulling the floc down. Therefore, a particle must fall the vertical distance between the plates, which is the critical height, \(H_c\). The plates are positioned at an angle, \(\alpha\), to ensure that settling flocs slide down to the floc blanket. The critical height \(H_c\) can be expressed in terms of plate settler length, \(L\), and plate settler angle, \(\alpha\), by \(H_c=\frac{S}{cos\alpha}\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_critheight}.png}
\caption{Critical height between two plate settlers.}\label{\detokenize{Sedimentation/Sed_Design:id23}}\label{\detokenize{Sedimentation/Sed_Design:figure-plate-settler-critheight}}\end{figure}
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
What is the total vertical distance that the critical particle will travel?

\end{enumerate}

Taking the vertical component of the critical path, we see that the total vertical distance is \(H\) where \(H =L sin\alpha\).
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
What is the net vertical velocity of a floc between the plate settlers?

\end{enumerate}

The fluid carries the floc between the plate settlers while gravity pulls the floc down. The velocity through the plate settlers has both a horizontal component, \(\bar v_{x_{Plate}}\), and vertical component, \(\bar v_{z_{Plate}}\), with a resultant velocity we call \(\bar v_{\alpha_{Plate}}\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_base}.png}
\caption{Velocity components between two plate settlers.}\label{\detokenize{Sedimentation/Sed_Design:id24}}\label{\detokenize{Sedimentation/Sed_Design:figure-plate-settler-valpha}}\end{figure}

This means that the net vertical velocity \(v_{z_{net}}\) is the vertical component of flow minus the settling velocity of the floc. Recall our previous discussion of terminal velocity and capture velocity; in this case, because we are designing a plate settler specifically to capture the critical particle, the terminal velocity equals the capture velocity. The terminal velocity is a function of the velocity that the critical particle settles at and the capture velocity is a function of the reactor geometry which we are designing to capture the critical particle. Thus, \(\bar v_{z_{net}} = \bar v_{z_{Plate}} - \bar v_{c}\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_vnet}.png}
\caption{Net velocity between two plate settlers.}\label{\detokenize{Sedimentation/Sed_Design:id25}}\label{\detokenize{Sedimentation/Sed_Design:figure-plate-settler-vnet}}\end{figure}

From answering the questions above, we know that the particle must fall the distance \(H_c\) at its terminal velocity in the same amount of time that it rises a distance \(H\) at its net upward velocity, because otherwise it would not be captured; time to travel \(H_c\) = time to travel \(H\)

Finding time by dividing by distance by velocity for each travel,
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:0}
\begin{split}Time = \frac{H_c}{\bar v_c} = \frac{H}{\bar v_{z_{net}}}\end{split}
\end{equation}
Substituting for \(\bar v_{z_{net}} = \bar v_{z_{Plate}}-v_{c}\),
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:1}
\begin{split}Time = \frac{H_c}{\bar v_c} = \frac{H}{\bar v_{z_{Plate}}- \bar v_{c}}\end{split}
\end{equation}
Using trigonometric substitutions for \(H_c\) and \(H\),
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:2}
\begin{split}Time = \frac{S}{\bar v_c cos\alpha} = \frac{L sin\alpha}{\bar v_{z_{Plate}} - \bar v_{c}}\end{split}
\end{equation}
Rearranging to solve for \(\bar v_{c}\),
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:3}
\begin{split}\bar v_c = \frac{S \bar v_{z_{Plate}}}{Lsin\alpha cos\alpha + S}\end{split}
\end{equation}
Rearranging to solve for \(\frac{\bar v_{z_{Plate}}}{\bar v_{c}}\),
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:4}
\begin{split}\frac{\bar v_{z_{Plate}}}{\bar v_{c}} = 1+\frac{L}{S}cos\alpha sin\alpha\end{split}
\end{equation}
The equation that we determined for critical velocity, \(\bar v_c\), shows its dependence on plate settler geometry. Through another derivation, we can prove that by considering the total projected area over which particles can settle, we determine the same critical velocity.

Beginning with \(Q = \bar vA\), we can modify the equation to fit the specific flow through a plate settler, \(Q = \bar v_{\alpha_{Plate}}SW\).

Using trigonometric substitutions, we know that \(\frac{\bar v_{z_{Plate}}}{\bar v_{\alpha_{Plate}}} = sin\alpha\) and \(\frac{\bar v_{z_{Plate}}}{sin\alpha} = v_{\alpha}\). So,
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:5}
\begin{split}Q = \frac{\bar v_{z_{Plate}}SW}{sin\alpha}\end{split}
\end{equation}
Determining the horizontal projection of the plate settlers,
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:6}
\begin{split}S = Lcos\alpha + \frac{S}{sin\alpha}\end{split}
\end{equation}
Substituting for area, \(A\),
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:7}
\begin{split}A = (Lcos\alpha + \frac{S}{sin\alpha})W\end{split}
\end{equation}
Solving for \(\bar v_c = \frac{Q}{A}\)
\begin{equation}\label{equation:Sedimentation/Sed_Design:Sedimentation/Sed_Design:8}
\begin{split}\bar v_c = \frac{S \bar v_{z_{Plate}}}{Lsin\alpha cos\alpha + S}\end{split}
\end{equation}
We can see that there are five parameters which will impact each other in our design \(\bar v_{z_{Plate}}, \bar v_{c}, L, S\), and \(\alpha\). AguaClara plants typically use constants for \(\bar v_{z_{Plate}}, \bar v_{c}, S\), and \(\alpha\), leaving \(L\) to be calculated. More information is found in the section on {\hyperref[\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-plate-settler-design}]{\sphinxcrossref{\DUrole{std,std-ref}{plate settler design}}}}.

Now that we have established how flocs settle on the plate and the increase in plan view area that plate settlers offer, we need to discuss how flocs will act once they are on the plates. We want particles and flocs that settle to agglomerate and slide down the plate settlers to be returned to the floc blanket. We will explore this concept by first considering the desired spacing between plate settlers.

Let’s start with a basic question. If we know that adding plate settlers improves performance, why don’t we just keep adding more and more plate settlers to our system? Is there any impact of placing plates closer together?

We know that more plates means more effective settling area which means that we could remover more particles and make our tank smaller to save money and limit the use of concrete. But how close can those plates be?

The Ten State Standards report that plate settlers should have a separation of two inches, with very long plate settlers, which means very deep tanks. Sedimentation tanks are usually 4 meters deep, maybe because filters are also deep. This is a result of the engineering context rather than the basic design principles. The Ten State Standards are primarily based off the modification of existing sedimentation tanks which were usually built deep and then plate settlers were added. This means that there wasn’t added incentive to optimize the entire plate settler and tank process because the tanks were already built. However, AguaClara designs are made to use all of the AguaClara innovations in a green field, meaning that we are incentivized to optimize every part of this design process.

AguaClara plants can design for changes in the depth and/or plan view area of the tank for optimal plate settler efficiency. We want to have the smallest and shallowest tanks possible for low cost and ease of construction. We know that in the plate settler design, there is a dimensionless parameter of plate spacing to length, \(\frac{S}{L}\). The ratio is close to constant, which means that if we double the length of the plate settler, we can double the spacing between the plate settler and get the same performance as when we started. Conversely, if we halve the distance between the plate settlers, we can halve the length of the plate settlers. But how far can we push this? Can we make really compact plate settlers?

What we really want to know is: what is the connection of spacing between plate settlers and performance?

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_depth}.png}
\caption{Relationship between plate settler length and sedimentation tank depth.}\label{\detokenize{Sedimentation/Sed_Design:id26}}\label{\detokenize{Sedimentation/Sed_Design:figure-plate-settler-depth}}\end{figure}

When we were discussed how plate settlers promote settling, we assumed a uniform velocity profile between the plates. However, we know from fluid mechanics and boundary layer rules that in reality, there is a nonuniform velocity profile. The flow between the plates, as determined by the Reynolds number, is laminar which means that there is a parabolic velocity profile between the plates and the shape of the parabola is affected by the distance between the plates.

\phantomsection\label{\detokenize{Sedimentation/Sed_Design:heading-floc-rollup}}
There are some cases in which the plates are so close that even if flocs settle on the plate, they do not slide down. This is called \sphinxstylestrong{floc rollup}. Consider the following questions:
\begin{enumerate}
\item {} 
Why would flocs roll up?

\end{enumerate}

It is a force balance! There is a force of gravity pulling the particle down, balanced with the force that the fluid flow exerts through drag related to viscosity. But why does it matter if plates are close together for floc roll up? The average velocity between plates is about 1 mm/s and is the same for any spacing. However, when plates are closer together the velocity profile is much steeper. Compared with plates with greater spacing, the closer plates cause there to be a higher velocity closer to the surface of the plate. This means that flocs between closely spaced plates will see a greater velocity closer to the plate settler, which will impact the force balance. The derivation of the force balance is found in the section on {\hyperref[\detokenize{Sedimentation/Sed_Derivations:heading-floc-rollup-slide-velocity-derivation}]{\sphinxcrossref{\DUrole{std,std-ref}{plate settler design}}}}. The velocity that the flocs slide down the plate is called \(v_{Slide}\).
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
How would you define the transition between floc rollup and slide down? What would describe the case for a floc that is stationary on the plate settler (not rolling up or sliding down?)

\end{enumerate}

The transition is defined as when the gravitational forces and the fluid drag forces match.
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
Will little flocs or big flocs be most vulnerable to floc rollup?

\end{enumerate}

This is a very complicated question. We would expect big flocs to slide down because they are heavier and have a greater gravitational force. However, bigger flocs also have a greater drag force and are out further into the flow. Because of the velocity profile, they will feel a higher velocity than smaller flocs. This means that the answer to this question should be determine mathematically, which it is in the next section.
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
Will large or small spacing between plates cause more floc rollup?

\end{enumerate}

As we have already suggested, small spacing between plates will cause more floc rollup due to the steeper resulting velocity profile between the plates.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/cQJxLO0WOPA}{\sphinxincludegraphics[height=300\sphinxpxdimen]{{floc_rollup}.png}}\caption{Floc rollup between two plates (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id27}}\label{\detokenize{Sedimentation/Sed_Design:figure-floc-rollup}}\end{figure}

So what does this mean for plate settler spacing? Let’s review some results from lab experiments. The following graph shows minimum plate settler spacing (mm) as a function of floc terminal velocity (mm/s). Some important things to note are that AguaClara plate settlers are designed for a capture velocity of 0.12 mm/s (recall that this capture velocity means that we want to capture flocs that are settling at 0.12 mm/s and faster). Before AguaClara filters were designed and deployed, AguaClara adopted the 0.12 mm/s capture velocity in an effort to reduce effluent turbidity as much as possible.

Reading the graph, we can see the line for 1 mm/s upflow velocity in the sedimentation tank, \(v_{z_{fb}}\), at 0.12 mm/s capture velocity requires a minimum plate spacing of about about 2.5 mm to prevent floc rollup. Now, let’s interpret this result. If the upflow velocity increases, we see that the required spacing between plates increases. The results from these experiments will help us answer one of our previous questions: will little flocs or big flocs be most vulnerable to floc rollup? From the graph, we know that it is the little ones. Smaller floc terminal velocities indicate smaller particles, and the graph shows that smaller floc terminal velocities require larger distances of floc spacing to not roll up. The bigger the flocs, the smaller the spacing required to not roll up. Little flocs are harder to capture as you move plates closer together. Little flocs roll up first.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{floc_vsed}.png}
\caption{Minimum plate settler spacing as a function of floc sedimentation velocity.}\label{\detokenize{Sedimentation/Sed_Design:id28}}\label{\detokenize{Sedimentation/Sed_Design:figure-floc-vsed}}\end{figure}

This analysis suggests that the Standard design is nowhere near the constraint of floc roll up (recall that Standard design reports separations of 5 cm). AguaClara plate settlers are currently using separations of 2.5 cm, which is also far above the constraint of floc roll up. So if we determined that the minimum spacing for floc roll up constraints is closer to 2.5 mm, why are we using 2.5 cm? The answer is related to our initial assumptions about the floc composition and terminal velocity. When we calculated terminal velocities, we did so for clay-based flocs. But in reality, there are many kinds of flocs formed in water treatment plants. Dissolved organic matter also interacts with coagulant to form flocs that we assume are much less dense than clay based flocs. We don’t currently have a good model to understand how these organic-matter flocs. We don’t know what the terminal velocity of flocs is if they are made of organics, coagulant, and clay. But even without knowing specifics, how do we think minimum plate spacing will be impacted by flocs that are formed from organic matter instead of clay? If we use dissolved organic matter, the equation predicts that spacing will change primarily due to the big difference in floc density. As floc density decreases, as we expect for organic matter, minimum spacing increases. However, we don’t yet know what that spacing is or where the boundary is because we don’t know the properties of the humic acid-coagulant flocs. This prompts us to opt for safety factors, so we have chosen a plate settler spacing of 2.5 cm. There is room to learn more here.

Why does the plate settling distance matter so much? How much does it impact the rest of the sedimentation tank and its design?

One impact of plate settler spacing is on sedimentation tank depth. We know that the spacing between plate settlers has a strong influence on sedimentation tank depth and closer plate settlers allows for shallower tanks. There is a diminishing effect for small spacings, meaning that the difference in depth between 5 and 2.5 cm spacing is greater than the different in depth between 2.5 and 1 cm spacing. Because AguaClara does not yet have a good model for non-clay flocs, we cannot optimize our plate settler spacing and thus cannot optimize for the shallowest tanks possible.

\phantomsection\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-plate-settlers-head-loss-intro}}
Another impact of plate settler spacing is on flow distribution in the tank. This is related to our previous discussion of pressure recovery and flow distribution. Reduced spacing between plates leads to an increased pressure drop through the plate settlers due to higher head loss. Therefore, plate settlers with small spacing will have more uniform flow distributions because head loss will dominate. The pressure difference between one plate settler and the next would be very small compared to the pressure difference between the bottom of the plate settlers and the top of the plate settlers. This use of head loss can potentially get us better flow distribution. When the plates are brought closer together, there is more shear between the plates because the average velocity remains the same. The velocity gradient is higher between closer plates, which leads to higher shear, and thus higher head loss.

However, if the plates are closer together, then they will be shorter in length to keep the capture velocity constant. The decrease in length decreases the total amount of shear. The head loss from the competing impacts to shear can be determined through a force balance and the Navier-Stokes equation, as shown in the derivation of {\hyperref[\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-hl-thru-plate-settlers}]{\sphinxcrossref{\DUrole{std,std-ref}{head loss through a plate settler}}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_headloss_spacing}.png}
\caption{Head loss as a function of plate settler spacing.}\label{\detokenize{Sedimentation/Sed_Design:id29}}\label{\detokenize{Sedimentation/Sed_Design:figure-plate-settler-headloss-spacing}}\end{figure}

The important thing to note is that after determining head loss as a function of plate settler spacing, we realize that the plate settlers do not provide much head loss at the design separation of 2.5 cm. Head loss through plate settlers is really small, which means that they do not contribute much to equalizing flow distribution. So, is this head loss “good” or “bad”? It is neither because it is so small that it is negligible in our overall system.

The velocities of any eddies or mean flow need to be less than 4 mm/s to achieve uniform flow through plate settlers. This means that if there is any flow entering the plate settlers at greater than 4 mm/s, the head loss provided by the plate settlers will not help at all to dampen the nonuniformity and there will not be adequate flow distribution. Luckily for us, the upflow velocity through the sedimentation tank is on average 1 mm/s, which fulfills the requirement of less than 4 mm/s. However, remember the diffusers that distribute water into the sedimentation tank? They create velocities on the order of 100s of mm/s. Those high initial velocities are damped out by the floc blanket which helps to distribute the flow. If we weren’t able to use the floc blanket to dampen the flow to be less than 4 mm/s, then the plate settlers would not provide any head loss to help with uniform flow distribution. This point about uniform flow is really important.

\phantomsection\label{\detokenize{Sedimentation/Sed_Design:heading-floc-volcano-intro}}
Now, lets discuss a plate settler problem that has not yet been solved: \sphinxstylestrong{floc volcanoes}. Floc volcanoes occur when water and flocs rise preferentially in one part of the sedimentation tank. At points of high velocity, flocs can rise to the surface of the water. Consider the following case: an AguaClara plant in San Nicolas, Honduras, was witnessing intermittent floc volcanoes in the sedimentation tanks. During operation, the plant was treating raw water with 4 NTU with a PACl dose of 3.5 mg/L. The settled water turbidity varied between 0.5 and 4 NTU. What might explain the floc volcanoes and very poor plant performance? Try coming up with a hypothesis that matches the information given to us from the plant. We want to figure out what is causing this problem so we can design a solution. What questions would you want to ask the technicians or engineers in Honduras? This exercise emphasizes the idea that asking the right questions are sometimes the hardest first step to learning more information.

Some hypotheses and questions may include:
\begin{enumerate}
\item {} 
is the problem related to dissolved air flotation? Dissolved air coming out of flocculation can cause flocs to float to the top.

\end{enumerate}

After asking the operators, we are told that there are not any bubbles in the sedimentation tank.
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
is the problem regularly intermittent? Is there anything that we can correlate these fluctuations to?

\end{enumerate}

After asking the operators, we are told that the floc volcanoes appear in the early afternoon each day.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{temp_turbidity}.png}
\caption{Turbidity as a function of time in San Nicolas, Honduras.}\label{\detokenize{Sedimentation/Sed_Design:id30}}\label{\detokenize{Sedimentation/Sed_Design:figure-temp-turbidity}}\end{figure}

Using this new information, we have to make another hypothesis about why the floc volcanoes are impacted daily. Perhaps it is related to the sun and daily temperature changes. We can ask the operators to measure the water temperatures so we can do some analysis. The operators measure temperature and we plot the results, providing the following graph.

We know that this plant brings water from a water source about 14 km away. The water is transported in a galvanized iron pipe that is placed on the surface of the ground because there is no concern about freezing pipes in Honduras (galvanized iron is not damaged by UV like PVC pipe is). The pipe functions as a 14 km water heater, raising the temperature of the water to the plant after noon.

But why does the temperature difference cause a problem for the plate settlers?
The problem is that there is warmer water entering the sedimentation tank than what is in it. This temperature difference causes a density difference in the sedimentation tank and plate settlers. The less dense, warmer water rises to the top of the plate settlers while the cold water drops to the bottom of the plate. This creates a current, allowing water to flow up on the top and settle on the bottom. The temperature gradient changes slowly over a few hours.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{temp_tube_settler}.png}
\caption{Hot water rising and cold water settling in a tube settler.}\label{\detokenize{Sedimentation/Sed_Design:id31}}\label{\detokenize{Sedimentation/Sed_Design:figure-temp-tube-settler}}\end{figure}

So, now that we think we know what the problem is, how would we try to solve it? One idea would be to paint the entire line to reflect heat, but this is not feasible due to cost. The town Water Board had been maintaining the distribution line by cleaning weeds and brush from the pipe. The solution ended up being to just let the weeds grow over the pipe to provide shade. We haven’t yet come up with a real solution. A possible long-term solution could be to design a sedimentation tank that has a really short residence time. The longer the residence time in the sedimentation tank, the worse the problem is because there is a large variation between the water that entered it last night and the water that enters it this afternoon. A tank with a really short residence time, on the order of a few minutes, would ensure that the water coming in would be very close to the water already in the tank.

Let’s recap some important conclusions from this section on plate settlers.
\begin{enumerate}
\item {} 
Reynolds number calculations of flow through plate settlers prove that there is laminar flow between plate settlers. This is important because it allows us to assume that a parabolic velocity profile is established.

\item {} 
There is very low head loss between plate settlers so they will not do a good job of helping to achieve uniform flow between the plate settlers.

\item {} 
The plate settlers are designed to capture flocs with sedimentation velocities greater than the settle capture velocity. AguaClara currently uses \(\bar v_c = 0.12\) mm/s but this value needs to be further optimized; we would like to know how settled water turbidity changes with capture velocity. Future work includes choosing a settle capture velocity based on overall plate performance.

\item {} 
Plate settler spacing:
\begin{enumerate}
\item {} 
Plate settler spacing determines the ability of flocs to roll down the incline.

\item {} 
Smaller spacings between plate setters have diminishing returns in terms of sedimentation tank depth. The current AguaClara spacing is 2.5 cm but there is room for further optimization.

\item {} 
Flocs made from natural organic matter (NOM) may be less dense, more prone to floc rollup, and may require larger spacing between plate settlers.

\end{enumerate}

\end{enumerate}


\section{3) How water leaves the sedimentation tank}
\label{\detokenize{Sedimentation/Sed_Design:how-water-leaves-the-sedimentation-tank}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-exit}}
Now that we have passed through the plate settlers, we are ready to leave the sedimentation tank.


\subsection{Submerged Effluent Manifold}
\label{\detokenize{Sedimentation/Sed_Design:submerged-effluent-manifold}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-effluent-manifold}}
The \sphinxstylestrong{submerged effluent manifold}, sometimes called a launder, collects settled water from the sedimentation tank. It is a horizontal pipe that extends along the length of the tank and is located above the plate settlers but below the surface of the water. The submerged pipe has orifices drilled into its top; water enters the pipe through the orifices and the pipe leads out of the sedimentation tank. Recall that the influent manifold also uses a submerged pipe and orifice design to distribute flow. However, unlike the influent manifold, the effluent manifold does not include diffusers because we do not need to precisely control velocity and flow direction.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{effluent_manifold}.png}
\caption{Effluent manifold from the side- and top-view.}\label{\detokenize{Sedimentation/Sed_Design:id32}}\label{\detokenize{Sedimentation/Sed_Design:figure-effluent-manifold}}\end{figure}

The orifices in the pipe are evenly distributed along the length of the pipe to promote even flow collection from the tank. The orifices are designed create uniform head loss. Is this head loss “good” or “bad”? Like the diffusers, the orifices in the effluent manifold create “good” head loss because they increase head loss through all flow paths. This is critical because there is pressure recovery within the effluent manifold that creates “bad” head loss.

Are there effluent manifold exit losses? What type of head loss would it be? This head loss is a result of exit loss into its receiving channel. Is it “good” or “bad”? This head loss is also “good” head loss because it impacts all flow paths the same; each sedimentation tank bay and all water within a single bay is subject to the same amount of exit loss.

Why did AguaClara design the effluent manifold to be submerged? There are 3 main reasons.
\begin{enumerate}
\item {} 
It is designed to be submerged because sometimes there are particles or substances that rise to the top of sedimentation tanks and float on the water surface. These particles or substances may be flocs that escaped capture and remain buoyant, or may be foam or scum that results from organic matter in the water. No matter what it is that is rising to the water surface, we want to avoid it entering the settled water effluent pipe. Placing the effluent manifold below the surface allows particles or substances floating on the surface to remain separate from the effluent water headed towards filtration. Operators can then skim the water surface to remove and dispose of anything that floats.

\item {} 
The launders were also designed to be submerged to simplify construction. Effluent launders that also act as weirs must be installed perfectly level. This is difficult to ensure during construction and thus we have elected to use a single weir to regulate the water level in all of the sedimentation tanks. The water from all of the sedimentation tanks in one treatment train joins together in a common channel before flowing over the exit weir.

\item {} 
The submerged launder and exit weir system also make it possible to refill and empty a sedimentation tank with clean water, as shown in the following video.

\end{enumerate}

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/B\_LEH1ezd6E}{\sphinxincludegraphics[height=300\sphinxpxdimen]{{sed_fill_empty}.png}}\caption{Sedimentation tank filling and emptying with clean water (click to be sent to video).}\label{\detokenize{Sedimentation/Sed_Design:id33}}\label{\detokenize{Sedimentation/Sed_Design:figure-sed-fill-empty}}\end{figure}

Why are the orifices in the effluent manifold located at the top of the pipe?
They are located on the top to promote even flow collection and for ease of operation and maintenance. The orifices need to be either located on the top or bottom so that they are symmetrical about the tank because if the orifices were put on the sides, then they might not draw water evenly from the entire tank. So, we are to choose between the top or the bottom; which would be better for operation and maintenance? The top is better because orifices located on the top of the pipe can be easily observed and maintained by operators in case any clogging occurs. We also want to limit the number of flocs that rise through the plate settlers and enter the effluent manifold. Locating the orifices on the top discourages that from happening by not drawing up directly from the top of plate settlers and by giving more time for flocs to potentially settle.


\subsection{Exit Weir and Effluent Channel}
\label{\detokenize{Sedimentation/Sed_Design:exit-weir-and-effluent-channel}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-exit-weir-channel}}
The submerged effluent manifold transports water from the sedimentation tank to a channel that runs perpendicular to the sedimentation bays. The channel collects water from all of the sedimentation bays. Water leaves this channel by flowing over a small wall, called the \sphinxstylestrong{exit weir}. The sedimentation tank exit weir controls water levels all the way upstream to the previous free-fall, which was the LFOM. So, the height of the exit weir is critical to ensuring appropriate water levels in the flocculator and sedimentation tank. In construction, great care is taken to ensure that this weir is at the right elevation and is level. After the water flows over the exit weir, it is collected in the \sphinxstylestrong{effluent channel}. The effluent channel has pipes embedded in the bottom of it which lead the settled water to the filter inlet box.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{channel_labeled}.png}
\caption{Image of sedimentation channels.}\label{\detokenize{Sedimentation/Sed_Design:id34}}\label{\detokenize{Sedimentation/Sed_Design:figure-channel-labeled}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{channel_labeled_cad}.png}
\caption{Figure of sedimentation channels.}\label{\detokenize{Sedimentation/Sed_Design:id35}}\label{\detokenize{Sedimentation/Sed_Design:figure-channel-labeled-cad}}\end{figure}


\section{Sedimentation Conclusions and Review}
\label{\detokenize{Sedimentation/Sed_Design:sedimentation-conclusions-and-review}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-conclusions}}
You have now been introduced to the AguaClara sedimentation tank in three parts: 1) how water enters the sedimentation tank, 2) how water moves through the sedimentation tank, and 3) how water leaves the sedimentation tank. This introduction should allow you to understand the components of the sedimentation unit process, the purpose of each component, and AguaClara-specific innovations.

Let’s recap some important points about the sedimentation tank.
\begin{itemize}
\item {} 
The AguaClara sedimentation tank includes three process in one tank: flocculation, sedimentation, and consolidation.

\item {} 
Floc blankets improve sedimentation tank performance.

\item {} 
The floc blanket and floc hopper design eliminate the need for mechanized sludge removal by using hydraulic sludge removal.

\item {} 
Plate settlers make it possible to significantly reduce the plan-view area of the sedimentation tank.

\item {} 
Reduced plate settler spacing allows for shallower, and therefore cheaper, tanks.

\item {} 
Flow distribution is very important in sedimentation tank design.

\item {} 
Hydraulic residence times can be greatly decreased using AguaClara innovations. While some standards suggest a minimum of four hours for sedimentation processes, AguaClara plants have shown that a hydraulic residence time of 24 minutes is sufficient for efficient sedimentation.

\item {} 
The AguaClara sedimentation tank design is driven by the need for high treatment capability coupled with easy operation and maintenance.

\item {} 
There is “good” head loss introduced by the influent manifold entrance, diffusers, effluent manifold orifices, and effluent manifold exit. There is “bad” head loss introduced by pressure recovery in the influent channel, influent manifold, and effluent manifold. Even flow distribution is achieved by ensuring that “good” head loss dominates through intentional design.

\end{itemize}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{circuit_full}.png}
\caption{Sedimentation tank as a circuit, showing “good” and “bad” head loss.}\label{\detokenize{Sedimentation/Sed_Design:id36}}\label{\detokenize{Sedimentation/Sed_Design:figure-circuit-full}}\end{figure}


\subsection{Review}
\label{\detokenize{Sedimentation/Sed_Design:review}}\label{\detokenize{Sedimentation/Sed_Design:heading-sed-tank-review}}
You can review your understanding of AguaClara sedimentation tanks by asking yourself the following questions:
\begin{enumerate}
\item {} 
Why do horizontal flow sedimentation tanks perform must worse than theory predicts?

\item {} 
How does the floc blanket improve sedimentation tank performance?

\item {} 
What is the purpose of the floc hopper?

\item {} 
Why do we use plate settlers?

\item {} 
What is the failure mechanism for small spacing between plate settlers?

\item {} 
What helps the flow divide evenly between and within the sedimentation tanks?

\end{enumerate}

The hydraulic self cleaning sedimentation tank with a high performing floc blanket, zero sludge accumulation, and with no moving parts outperforms conventional sedimentation tanks on capital cost, performance, and maintenance costs. We will now transition to the mathematical models which explain how we make these advancements possible.


\section{References}
\label{\detokenize{Sedimentation/Sed_Design:references}}
Garland, Casey, et al. “Revisiting Hydraulic Flocculator Design for Use in Water Treatment Systems with Fluidized Floc Beds.” Environmental Engineering Science, vol. 34, no. 2, 1 Feb. 2017, pp. 122\textendash{}129., doi:10.1089/ees.2016.0174.


\section{Comments, Corrections, or Questions}
\label{\detokenize{Sedimentation/Sed_Design:comments-corrections-or-questions}}
This textbook is an ever-evolving project. If you find any errors while you are reading, or if you find something unclear, please let the authors know. Write your comment in \sphinxhref{https://github.com/AguaClara/Textbook/issues/84}{this Github issue} and it will be addressed as soon as possible. Please look at other comments before writing your own to avoid duplicate comments.


\section{Appendix Photos}
\label{\detokenize{Sedimentation/Sed_Design:appendix-photos}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{bottom_of_sed_tank_detail}.png}
\caption{Cross-section of the bottom of the sedimentation tank.}\label{\detokenize{Sedimentation/Sed_Design:id37}}\label{\detokenize{Sedimentation/Sed_Design:figure-bottom-of-sed-tank-detail}}\end{figure}


\chapter{Sedimentation Derivations}
\label{\detokenize{Sedimentation/Sed_Derivations:sedimentation-derivations}}\label{\detokenize{Sedimentation/Sed_Derivations:title-sed-derivations}}\label{\detokenize{Sedimentation/Sed_Derivations::doc}}
In the next section, we will develop the mathematical models that help us explain the design.

Note: this section will build off of the conceptual understanding established in the previous section and will explain how the tank works with derivations and mathematical models.


\section{Comparison of velocities and flow in sedimentation tank}
\label{\detokenize{Sedimentation/Sed_Derivations:comparison-of-velocities-and-flow-in-sedimentation-tank}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-velocity-flow}}
To understand how water flows in the sedimentation tank, we must understand how the water velocity changes with the geometry. There are four distinct zones in the sedimentation tank: 1) the velocity of water exiting the diffusers, 2) the velocity of water moving through the floc blanket, 3) the velocity of water that enters the plate settlers, and 4) the velocity of water through the plate settlers. The geometry of the sedimentation tank changes in these four zones, so we will follow these changes to make sure that we understand the conservation of flow. The flow going through the sedimentation tank is the same everywhere, but average velocities are different. The fact that flow rate is velocity multiplied by area, \(Q = \bar v * A\), will be our guiding principle. In all cases,

\begin{DUlineblock}{0em}
\item[] \(Q_{Sed} =\) flow rate through each sedimentation tank
\item[] \(W_{Sed} =\) width of each sedimentation tank
\end{DUlineblock}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{sed_tank_flow_conserve}.png}
\caption{AguaClara sedimentation tank showing “lost triangle” and its impact on relevant lengths.}\label{\detokenize{Sedimentation/Sed_Derivations:id2}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-sed-tank-flow-conserve}}\end{figure}


\subsection{1) Velocity and flow exiting the diffusers}
\label{\detokenize{Sedimentation/Sed_Derivations:velocity-and-flow-exiting-the-diffusers}}
This is discussed specifically in the section on {\hyperref[\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-diffuser-design}]{\sphinxcrossref{\DUrole{std,std-ref}{diffuser design}}}}.


\subsection{2) Velocity and flow in the floc blanket}
\label{\detokenize{Sedimentation/Sed_Derivations:velocity-and-flow-in-the-floc-blanket}}
After the water exits the diffusers and jet reverser, it flows through the expanded floc blanket region where:

\begin{DUlineblock}{0em}
\item[] \(L_{SedFloc} =\) length of the sedimentation tank that has a floc blanket
\item[] \(\bar v_{z_{fb}} =\) upflow velocity of the water through the floc blanket
\end{DUlineblock}

Thus, \(Q_{Sed} = W_{Sed}*L_{SedFloc}* \bar v_{z_{fb}}\)


\subsection{3) Velocity and flow entering the plate settlers}
\label{\detokenize{Sedimentation/Sed_Derivations:velocity-and-flow-entering-the-plate-settlers}}
The ‘active’ sedimentation zone refers to the area of the tank in which water can flow through the plate settlers where:

\begin{DUlineblock}{0em}
\item[] \(L_{SedActive} =\) length of the sedimentation tank that includes entrance to a plate settlers
\item[] \(\bar v_{z_{Active}} =\) upflow velocity of the water entering the plate settlers; vertical velocity in ‘active’ region
\end{DUlineblock}

The only reason that there is a distinction between this area and the floc blanket area is because plate settlers are built at an angle. This angle creates a “lost triangle” because there is a space in which the plate settlers are not effective and water does not flow through them. Because the active length is less than the floc blanket length, \(L_{SedActive} < L_{SedFloc}\), and because flow must be conserved, the average active velocity must be greater than the average upflow velocity through the floc blanket, \(\bar v_{z_{Active}} > \bar v_{z_{fb}}\). The same flow going through less area means that the velocity must increase.

Thus, \(Q_{Sed} = W_{Sed} L_{SedActive} \bar v_{z_{Active}}\), and \(\bar v_{z_{Active}} > \bar v_{z_{fb}}\).


\subsection{4) Velocity and flow in the plate settlers}
\label{\detokenize{Sedimentation/Sed_Derivations:velocity-and-flow-in-the-plate-settlers}}
Now, we will discuss flow through plate settlers where:

\begin{DUlineblock}{0em}
\item[] \(\bar v_{z_{Plate}} =\) upflow velocity of the water in the plate settlers; vertical velocity component between the plate settlers
\item[] \(S =\) spacing between plate settlers
\item[] \(B =\) center-to-center distance between plate settlers
\item[] \(T =\) thickness of plate settlers
\item[] \(L =\) length of plate settlers
\end{DUlineblock}

We know that plate settlers have a certain thickness and take up area, which means that once we reach the plate settler zone, there is less area for water to travel through. Because flow is conserved and there is a decrease in area, we know that the upflow velocity of water through the plate settlers must increase compared to the upflow velocity of water below the plate settlers, \(\bar v_{z_{Plate}} > \bar v_{z_{Active}}\).

Thus, \(\bar v_{z_{Plate}} > \bar v_{z_{Active}} > \bar v_{z_{fb}}\)

In addition to the vertical velocity component increasing between the plates, the resultant velocity of water between the plates increases compared to \(\bar v_{z_{Active}}\). What are the two reasons that this is true?
\begin{itemize}
\item {} 
the first reason, as already discussed, is that the vertical velocity component needs to increase to ensure conservation of flow.

\item {} 
the second reason has to do with the fact that the resultant velocity of water between the plates is at an angle. This means that there is a horizontal component introduced. Because we know that the vertical velocity increases, and there is a new positive horizontal velocity component, the resultant velocity must also increase.

\end{itemize}

Now, consider a tube settler used in a lab setting instead of a plate settler. If a tube settler was designed with an angle to mimic a plate settler, would the water change vertical velocity after the angle? How does this compare to the plate settler scenario? In the case of the tube settler, the vertical velocity does not increase because there is no change in flow area; the diameter of the tube is constant throughout, meaning that for the flow to remain constant, the velocity does not change.

For another example of flow conservation, let’s consider the relationship between \(\bar v_{z_{Plate}}*S\) and \(\bar v_{z_{Active}}*B\). \(B\) is the center-to-center distance between plate settlers, and does not take into account the thickness of plate settlers. Considering only the center-to-center distance means that the area for water to travel through does to change from before the plate settlers to within the plate settlers because we are not accounting for any thickness. If the area does not change, then velocity should also not change to keep flow conserved. However, if we are to account for thickness, we must discuss \(S\) which is the spacing between plate settlers. This does take into account the change in area,  which means that the velocity would need to increase through the lesser area. So if we look at the flow through plate settlers, we can confirm that \(\bar v_{z_{Plate}}*S = \bar v_{z_{Active}}*B\).

By using flow conservation and plate settler geometry, we can begin to understand the mathematical relationships that drive design.


\section{Plate Settler Design}
\label{\detokenize{Sedimentation/Sed_Derivations:plate-settler-design}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-plate-settler-design}}

\subsection{Plate Settler Parameters}
\label{\detokenize{Sedimentation/Sed_Derivations:plate-settler-parameters}}
From the relationship that \(\bar v_{z_{Plate}}*S = \bar v_{z_{Active}}*B\), we can solve for \(B\) or \(L\) in terms of their related parameters.

Let’s start with the relationships that we already know:
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:0}
\begin{split}\bar v_{z_{Plate}}*S = \bar v_{z_{Active}}*B\end{split}
\end{equation}
and
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:1}
\begin{split}B = S+T\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{SvsBplatesettlers}.png}
\caption{Thick plate settlers.}\label{\detokenize{Sedimentation/Sed_Derivations:id3}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-svsbplatesettlers}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_base}.png}
\caption{Plate settlers.}\label{\detokenize{Sedimentation/Sed_Derivations:id4}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-plate-settler-base}}\end{figure}

Solving for \(\bar v_{z_{Plate}}\), we rearrange and substitute by,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:2}
\begin{split}\bar v_{z_{Plate}} S = \bar v_{z_{Active}} (S+T)\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:3}
\begin{split}\bar v_{z_{Plate}} = \frac{\bar v_{z_{Active}} (S+T)}{S}\end{split}
\end{equation}
We also already know from our {\hyperref[\detokenize{Sedimentation/Sed_Design:heading-sed-tank-plate-settlers}]{\sphinxcrossref{\DUrole{std,std-ref}{discussion of plate settlers}}}} that we can relate capture velocity, \(\bar v_c\), to \(S, L, \alpha\), and \(\bar v_{z_{Plate}}\) by,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:4}
\begin{split}\bar v_c = \frac{S  \bar v_{z_{Plate}}}{Lsin\alpha cos\alpha + S}\end{split}
\end{equation}
Substitute for \(\bar v_{z_{Plate}} = \frac{\bar v_{z_{Active}}(S+T)}{S}\) by,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:5}
\begin{split}\bar v_c = \left(\frac{S}{Lsin\alpha cos\alpha + S}\right)\left(\frac{\bar v_{z_{Active}}(S+T)}{S}\right)\end{split}
\end{equation}
Now, we can use this form of the capture velocity equation to solve for \(B\) or \(L\), as shown by,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:6}
\begin{split}B = \frac{Lsin\alpha cos\alpha - T}{\frac{\bar v_{z_{Plate}}}{\bar v_c}-1}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:7}
\begin{split}L = \frac{B\left(\frac{\bar v_{z_{Plate}}}{\bar v_c}-1\right) + T}{sin\alpha cos\alpha}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:8}
\begin{split}L = \frac{S\left(\frac{\bar v_{z_{Plate}}}{\bar v_c}-1\right) + T\left(\frac{\bar v_{z_{Plate}}}{\bar v_c}\right)}{sin\alpha cos\alpha}\end{split}
\end{equation}

\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{AguaClara plate settler design approach.}\label{\detokenize{Sedimentation/Sed_Derivations:id5}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-plate-settler-design-review}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|T|T|}
\hline
\sphinxstyletheadfamily 
Parameter
&\sphinxstyletheadfamily 
Variable
&\sphinxstyletheadfamily 
Determined by:
&\sphinxstyletheadfamily 
Determines:
&\sphinxstyletheadfamily 
Value
\\
\hline
Upflow velocity
&
\(\bar v_{z_{fb}}\)
&
floc blanket
&
plan view area of tank
&
1 \(\frac{mm}{s}\)
\\
\hline
Capture velocity
&
\(\bar v_c\)
&
target turbidity
&
particle size distribution
&
0.12 \(\frac{mm}{s}\)
\\
\hline
Plate angle
&
\(\alpha\)
&
self-cleaning requirements
&
\(L\)
&
60 deg
\\
\hline
Plate spacing
&
\(S\)
&
clogging and floc rollup constraints
&
\(L\)
&
2.5 cm
\\
\hline
Plate settler length
&
\(L\)
&
\(\bar v_{z_{fb}}, \bar v_c, \alpha, S\)
&
tank depth
&
Calculated for each plant
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

The relationship between the vertical velocity and the velocity in the direction of the sloped tube or plate settlers is given by
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:9}
\begin{split}\bar v_{z} = \bar v_{\alpha} \sin \alpha\end{split}
\end{equation}

\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Lamellar settler geometry and relevant equations.}\label{\detokenize{Sedimentation/Sed_Derivations:id6}}\label{\detokenize{Sedimentation/Sed_Derivations:table-lamellar-settler-geometry}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
Settler geometry
&\sphinxstyletheadfamily 
Single tubes
&\sphinxstyletheadfamily 
multiple tubes or plates
\\
\hline
\(\bar v_{z}\) ratio
&
\(\frac{\bar v_{z_{Tube}}}{\bar v_{c}}=\frac{L}{D} \cos \alpha \sin \alpha+\sin ^{2} \alpha\)
&
\(\frac{\bar v_{z_{Plate}}}{\bar v_{c}}=\frac{L}{S} \cos \alpha \sin \alpha+1\)
\\
\hline
\(\bar v_{\alpha}\) ratio
&
\(\frac{\bar v_{\alpha_{Tube}}}{\bar v_{c}}=\frac{L}{D} \cos \alpha +\sin \alpha\)
&
\(\frac{\bar v_{\alpha_{Plate}}}{\bar v_{c}}=\frac{L}{S} \cos \alpha +\frac{1}{\sin \alpha}\)
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

For single tube settlers used in laboratory settings the
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:10}
\begin{split}\bar v_{\alpha_{Tube}}=\frac{4Q_{Tube}}{\pi D^2}\end{split}
\end{equation}
Substituting into the equation for single tube settlers
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:11}
\begin{split}Q_{Tube}=\frac{\bar v_{c}\pi D^2}{4} \left(\frac{L}{D} \cos \alpha +\sin \alpha \right)\end{split}
\end{equation}
It is common to need to design the length of the tube given a target flow rate and thus we have
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:12}
\begin{split}L = \frac{4Q_{Tube}}{\bar v_{c}\pi D\cos \alpha} - D\tan\alpha\end{split}
\end{equation}

\subsection{Floc Rollup and Slide Velocity}
\label{\detokenize{Sedimentation/Sed_Derivations:floc-rollup-and-slide-velocity}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-floc-rollup-slide-velocity-derivation}}
As has been discussed, {\hyperref[\detokenize{Sedimentation/Sed_Design:heading-floc-rollup}]{\sphinxcrossref{\DUrole{std,std-ref}{floc rollup}}}} is a failure mode of plate settler performance. To determine the appropriate spacing between plate settlers, we must consider the potential for flocs to rollup because we want to minimize rollup and promote settling. We will determine this by calculating the floc sedimentation velocity, \(v_{Slide}\), that can be captured given a plate spacing. The steps to calculate this are:
\begin{enumerate}
\item {} 
find the velocity gradient next to the plate

\item {} 
find the fluid velocity at the center of the floc

\item {} 
find terminal velocity of the floc down the plate (for the case of zero velocity fluid)

\item {} 
set those two velocities equal for the critical case of no movement, and the required plate spacing

\item {} 
find the floc sedimentation velocity, \(v_{Slide}\)

\end{enumerate}

We will solve for both the plate settler and tube settler conditions.


\subsubsection{1) Find the velocity gradient next to the plate:}
\label{\detokenize{Sedimentation/Sed_Derivations:find-the-velocity-gradient-next-to-the-plate}}

\paragraph{Plate Settler}
\label{\detokenize{Sedimentation/Sed_Derivations:plate-settler}}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_boundary_conditions}.png}
\caption{Boundary conditions in plate settlers.}\label{\detokenize{Sedimentation/Sed_Derivations:id7}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-plate-settler-boundary-conditions}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{floc_rollup_base}.png}
\caption{Velocity profile between plate settlers.}\label{\detokenize{Sedimentation/Sed_Derivations:id8}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-floc-rollup-base}}\end{figure}

We begin by describing the conditions of infinite horizontal plates.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:13}
\begin{split}\frac{y^2}{2}\frac{dp}{dx} + Ay + B = \mu u\end{split}
\end{equation}
We employ the no-slip condition to solve for the constants A and B. The no-slip condition is that \(u = 0\) at \(y = 0\) and \(y = S\), where \(u\) is the horizontal velocity component, \(y\) is the location in the y-axis direction between plates, and \(S\) is the spacing between plates.

at \(u = 0\) and \(y = 0\):
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:14}
\begin{split}\frac{0}{2}\frac{dp}{dx} + A*0 + B = \mu *0\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:15}
\begin{split}B = 0\end{split}
\end{equation}
at \(u = 0\) and \(y = S\), the solving for A:
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:16}
\begin{split}\frac{S^2}{2}\frac{dp}{dx} + AS + 0 = \mu *0\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:17}
\begin{split}\frac{S^2}{2}\frac{dp}{dx} + AS = 0\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:18}
\begin{split}A = \frac{-S}{2}\frac{dp}{dx}\end{split}
\end{equation}
Our initial equation can be updated as,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:19}
\begin{split}\frac{y^2}{2}\frac{dp}{dx} + \frac{-S}{2}\frac{dp}{dx}y + B = \mu u\end{split}
\end{equation}
If we let \(\frac{dp}{dx}\) be negative, then we can solve for \(\tau\).
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:20}
\begin{split}\mu\left(\frac{du}{dy}\right) = y \frac{dp}{dx} + A\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:21}
\begin{split}\tau = \left(y - \frac{S}{2}\right) \frac{dp}{dx}\end{split}
\end{equation}
Determining the average velocity between plates, \(\bar v_{\alpha_{Plate}}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:22}
\begin{split}u = \frac{y(y-S)}{2\mu} \frac{dp}{dx}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:23}
\begin{split}\bar v_{\alpha_{Plate}} = \frac{q}{S} = \frac{1}{S} \int_{0}^{S}udy = \frac{1}{S} \int_{0}^{S} \left[\frac{y^2 - Sy}{2\mu} \left(\frac{dp}{dx}\right)\right]dy\end{split}
\end{equation}
Integrating to get average velocity, then solving for \(\frac{dp}{dx}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:24}
\begin{split}\bar v_{\alpha_{Plate}} = \frac{S^2}{12\mu} \frac{dp}{dx}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:25}
\begin{split}\frac{dp}{dx} = \frac{12\mu \bar v_{\alpha_{Plate}} }{S^2}\end{split}
\end{equation}
Using Navier-Stokes to model the flow between the plates, and substituting our equation for :math:{}` frac\{dp\}\{dx\}{}`,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:26}
\begin{split}\left(\frac{du}{dy}\right)_{y=0} = \frac{-S}{2\mu} \frac{dp}{dx}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:27}
\begin{split}\left(\frac{du}{dy}\right)_{y=0} = \frac{-S}{2\mu} \frac{12\mu v_{\alpha} }{S^2}\end{split}
\end{equation}
Simplifying the \(\left(\frac{du}{dy}\right)_{y=0}\), we have the velocity gradient as function of average velocity for plate geometry as,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:28}
\begin{split}\left(\frac{du}{dy}\right)_{y=0} = \frac{6 \bar v_{\alpha_{Plate}}}{S}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:29}
\begin{split}\frac{ dv_{\alpha} }{ dy_{y=0} } = \frac{6 \bar v_{\alpha_{Plate}}}{S}\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{floc_rollup_step1}.png}
\caption{Velocity gradient next to the plate.}\label{\detokenize{Sedimentation/Sed_Derivations:id9}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-floc-rollup-step1}}\end{figure}


\paragraph{Tube Settler}
\label{\detokenize{Sedimentation/Sed_Derivations:tube-settler}}
For tube settlers, we will assume laminar flow through circular tubes. \(R\) is the radius of the tube, and we assume that the maximum velocity is when \(r = 0\). The velocity distribution is a paraboloid of revolution, therefore average velocity, \(\bar v_{\alpha_{Tube}}\), is half of the maximum velocity, \(v_{\alpha_{max}}\). So, \(\bar v_{\alpha_{Tube}} = \frac{1}{2}v_{\alpha_{max}}\). We also know that \(Q = \bar v A\) and \(Q = \bar v \pi R^2\). In the case of the tube settler, \(\frac{dp}{dx}\) is the pressure gradient in the direction of flow, not the pressure gradient due to changes in elevation.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:30}
\begin{split}v_{\alpha_{Tube}} = \frac{r^2 - R^2}{4\mu} \frac{dp}{dx}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:31}
\begin{split}v_{\alpha_{max}} = - \frac{R^2}{4\mu} \frac{dp}{dx}\end{split}
\end{equation}
The average velocity is 1/2 of the maximum velocity.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:32}
\begin{split}\bar v_{\alpha_{Tube}} = - \frac{R^2}{8\mu} \frac{dp}{dx}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:33}
\begin{split}Q = - \frac{\pi R^4}{8\mu} \frac{dp}{dx}\end{split}
\end{equation}
Rearranging the flow equation \(Q\) to solve for \(\frac{dp}{dx}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:34}
\begin{split}\frac{dp}{dx} = - \frac{8 \mu Q}{\pi R^4}\end{split}
\end{equation}
Plugging \(\frac{dp}{dx}\) into the original equation for \(\bar v_{\alpha_{Tube}}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:35}
\begin{split}v_{\alpha_{Tube}} = -2Q \frac{r^2 - R^2}{\pi R^4}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:36}
\begin{split}\frac{ dv_{\alpha_{Tube}} }{ dr_{r=R} } = \frac{-4Q}{\pi R^3}\end{split}
\end{equation}
The resulting velocity gradient as function of average velocity for tube geometry is,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:37}
\begin{split}\frac{ dv_{\alpha_{Tube}} }{ dy_{y=0} } = \frac{8\bar v_{\alpha_{Tube}}}{D}\end{split}
\end{equation}

\subsubsection{2) Find the fluid velocity at the center of the floc:}
\label{\detokenize{Sedimentation/Sed_Derivations:find-the-fluid-velocity-at-the-center-of-the-floc}}
Now, we want to determine the velocity at the center of the floc. For flow between parallel plates we determined that,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:38}
\begin{split}\frac{d v_{\alpha_{Plate}}}{dy}_{y = 0} = \frac{6 \bar v_{\alpha_{Plate}}}{S}\end{split}
\end{equation}
The center of the floc is approximately half of the floc diameter, \(D\). So, to find the fluid velocity at the center of the floc, we linearize the differential and plug in \(\frac{D}{2}\) to yield,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:39}
\begin{split}v_{\alpha} \approx \frac{6 \bar v_{\alpha_{Plate}}}{S} \frac{D}{2}\end{split}
\end{equation}
Substituting by the trigonometric relationship \(\bar v_{\alpha_{Plate}} = (\frac{\bar v_{z_{Plate}}}{sin\alpha})\), we find the fluid velocity at the center of the floc as,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:40}
\begin{split}\bar v_{\alpha_{Plate}} \approx \frac{3 \bar v_{z_{Plate}} D}{Ssin\alpha}\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{floc_rollup_step2}.png}
\caption{Fluid velocity at the center of the floc.}\label{\detokenize{Sedimentation/Sed_Derivations:id10}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-floc-rollup-step2}}\end{figure}


\subsubsection{3) Find terminal velocity of the floc down the plate (for the case of zero velocity fluid):}
\label{\detokenize{Sedimentation/Sed_Derivations:find-terminal-velocity-of-the-floc-down-the-plate-for-the-case-of-zero-velocity-fluid}}
Recall from our {\hyperref[\detokenize{Sedimentation/Sed_Intro:heading-terminal-velocity-equation}]{\sphinxcrossref{\DUrole{std,std-ref}{previous explanation of terminal velocity}}}} that the terminal velocity, \(v_t\), of the floc can be calculated by,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:41}
\begin{split}v_t = \frac{D_0^2g}{18\Phi\nu}\frac{\rho_{floc_0} -\rho_{H_2O}}{\rho_{H_2O}} \left( \frac{D}{D_0} \right) ^{D_{fractal}-1}\end{split}
\end{equation}
We can rearrange this equation to solve for \(D\) by
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:42}
\begin{split}D = D_0 \left( \frac{18 v_t \Phi \nu }{D_0^2g} \frac{ \rho_{H_2O}}{ \rho_{floc_0} - \rho_{H_2O}}\right) ^{\frac{1}{ D_{fractal} - 1}}\end{split}
\end{equation}
We will need this equation for \(D\) in the next step.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{floc_rollup_step3}.png}
\caption{Terminal velocity of the floc down the plate (for the case of zero velocity fluid).}\label{\detokenize{Sedimentation/Sed_Derivations:id11}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-floc-rollup-step3}}\end{figure}


\subsubsection{4) Set the fluid velocity at the center of the floc equal to the terminal velocity of the floc to find the critical case of no movement, and the required plate spacing:}
\label{\detokenize{Sedimentation/Sed_Derivations:set-the-fluid-velocity-at-the-center-of-the-floc-equal-to-the-terminal-velocity-of-the-floc-to-find-the-critical-case-of-no-movement-and-the-required-plate-spacing}}
The floc settles due to gravitational forces. First, the \(\alpha\) component of the gravitational settling force, \(v_{t,\alpha}\), must be found by trigonometric relationships.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:43}
\begin{split}v_{t,\alpha} = v_t sin\alpha\end{split}
\end{equation}
Setting \(v_{\alpha} = v_{t,\alpha}\) yields,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:44}
\begin{split}\frac{3 \bar v_{z_{Plate}} D}{Ssin\alpha} \approx v_t sin\alpha\end{split}
\end{equation}
Solving for \(S\) to determine plate spacing,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:45}
\begin{split}S \approx \frac{3 \bar v_{z_{Plate}} D}{v_t sin^2\alpha}\end{split}
\end{equation}
In this equation, we have both \(v_t\) and \(D\), but we can simplify further because we know that \(v_t\) and \(D\) are related by the relationship shown in step 3. The goal is to ensure that flocs that settle to the plates do not roll up. We replace the unknown diameter of the floc with its terminal velocity and set that to be the capture velocity, \(v_c\) for the plate settler.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:46}
\begin{split}S_{min} \approx \frac{3 D_0}{sin^2\alpha} \frac{\bar v_{z_{Plate}}}{v_c}  \left( \frac{18 v_c \Phi \nu }{D_0^2g} \frac{ \rho_{H_2O}}{ \rho_{floc_0} - \rho_{H_2O}} \right) ^{\frac{1}{ D_{fractal} - 1}}\end{split}
\end{equation}
\(S_{min}\) is the smallest spacing that will allow a floc with a given settling velocity to remain stationary on the slope and not be carried upward by rollup.

The minimum spacing increases as the size of the primary particle, \(D_0\), decreases. This is an important insight because flocs that are made of coagulant nanoparticles (no clay) are the most difficult flocs to capture. Flocs made of coagulant nanoparticles are less dense than flocs made of clay. Coagulant nanoparticle flocs are produced when water treatment plants are used to remove dissolved organics or arsenic or when high coagulant dosages are used.


\subsubsection{5) Find the floc sedimentation velocity, \protect\(v_{Slide}\protect\):}
\label{\detokenize{Sedimentation/Sed_Derivations:find-the-floc-sedimentation-velocity}}
Finally, we can determine \(v_{Slide}\) by,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:47}
\begin{split}v_{Slide} = \bar v_{z_{Plate}} \left[ \left( \frac{3D_0}{Ssin^2\alpha} \right)^{D_{fractal} - 1} \left( \frac{18 v_{z_{Plate}} \Phi \nu }{D_0^2g} \frac{\rho_{H_2O}}{\rho_{floc_0} - \rho_{H_2O}} \right) \right] ^ {\frac{1}{ D_{fractal} - 2}}\end{split}
\end{equation}
\(v_{Slide}\) is the terminal sedimentation velocity of the slowest-settling floc that can slide down an incline. Flocs with with terminal velocity (the slide velocity) will be held stationary on the incline because of a balance between gravitational forces and fluid drag. Flocs with a terminal velocity lower than \(v_{Slide}\) will be carried out of the top of the settler (i.e., they will rollup) even if they settle onto the settler wall. Thus, the slide terminal velocity represents a constraint on the ability of plate settlers to capture flocs.

What happens if the primary particles are less dense?
\(v_{Slide}\) will increase because the particles need to be able to settle faster in order to not experience rollup.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{vslide_vsettle}.png}
\caption{Tube settler performance as a function of capture velocity ratio.}\label{\detokenize{Sedimentation/Sed_Derivations:id12}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-vsettle-vslide}}\end{figure}


\subsection{Head Loss through Plate Settlers}
\label{\detokenize{Sedimentation/Sed_Derivations:head-loss-through-plate-settlers}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-hl-thru-plate-settlers}}
Flow through the sedimentation tank is controlled by head loss in an attempt to achieve flow uniformity. We have already explained that {\hyperref[\detokenize{Sedimentation/Sed_Design:heading-sed-tank-plate-settlers-head-loss-intro}]{\sphinxcrossref{\DUrole{std,std-ref}{plate settler spacing impacts head loss}}}}, but by what mathematical relationship? Will putting plate settlers closer together result in more or less head loss? This question is complicated because closer plate settlers would create more shear and head loss, but shorter plate settlers also mean that they become shorter which would decrease shear and head loss.

Let’s start with a force balance. Assume that there is a fully established velocity profile that is parabolic with laminar flow. The forces that we care about are shear forces on the walls of the plate settlers and the differential pressure from flow in the direction of the velocity.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{plate_settler_headloss_diag}.png}
\caption{Velocity, shear forces, and pressure loss through plate settlers.}\label{\detokenize{Sedimentation/Sed_Derivations:id13}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-plate-settler-headloss-diag}}\end{figure}

The shear forces act over the area of the two plates, resulting in \(F_{shear} = 2 \tau L W\) where \(\tau\) is the viscous shear component.

The pressure force is exerted over the entire width of the plate and the plate spacing. Pressure at the entrance of the plate settlers is different from the exit of the plate settlers by \(\Delta P\). The resulting pressure force is \(F_{pressure} = \Delta P W S\). So,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:48}
\begin{split}F_{shear} = F_{pressure}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:49}
\begin{split}2 \tau L W = \Delta P W S\end{split}
\end{equation}
Dividing both sides by width, \(W\), and solving for \(\Delta P\) yields,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:50}
\begin{split}\Delta P = \frac{2 \tau L}{S}\end{split}
\end{equation}
We need to figure out what each of the terms on the right side of the equation is equal to so we can calculate \(\Delta P\). Ultimlately, we need \(\Delta P\) to calculate head loss because \(h_L = \frac{\Delta P}{\rho g}\).

\(\tau =\mu \frac{du}{dy}\), where \(\tau\) is shear, \(\mu\) is the viscosity, and \(\frac{du}{dy}\) is the velocity gradient. Using the Navier-Stokes equation, we can find the velocity gradient as a function of the average velocity between the plates, yielding shear based on the vertical velocity entering the plates as,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:51}
\begin{split}\tau = \mu \frac{6 \bar v_{z_{Plate}}}{S sin\alpha}\end{split}
\end{equation}
\(L\) is found using the equation for capture velocity, \(\bar v_c = \frac{S*\bar v_{z_{Plate}}}{Lsin\alpha cos\alpha + S}\). Capture velocity is kept constant so we solve for \(L\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:52}
\begin{split}L = \frac{S \left( \frac{\bar v_{z_{Plate}}}{\bar v_c} -1 \right)}{sin\alpha cos\alpha}\end{split}
\end{equation}
Substituting \(\tau\) and \(L\) into the equation for \(\Delta P\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:53}
\begin{split}\Delta P = 2\mu \left( \frac{6 \bar v_{z_{Plate}}}{S sin^2 \alpha cos\alpha} \right) \left( \frac{ \bar v_{z_{Plate}}}{\bar v_c} -1 \right)\end{split}
\end{equation}
Now that we have an equation for \(\Delta P\), we can solve for head loss.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:54}
\begin{split}h_L = \frac{\Delta P}{\rho g}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:55}
\begin{split}h_L = 2 \frac{\mu}{\rho g} \left( \frac{6 \bar v_{z_{Plate}}}{S sin^2 \alpha cos\alpha} \right) \left( \frac{ \bar v_{z_{Plate}}}{\bar v_c} -1 \right)\end{split}
\end{equation}
Recall that head loss through plate settlers is really small, on the order of micrometers, \(\mu m\). We are interested in understanding how the head loss relates to velocity, through the relation \(v = \sqrt{2gh}\). The resulting two plots show how head loss and velocity relate to plate settlers (see \hyperref[\detokenize{Sedimentation/Sed_Design:figure-plate-settler-headloss-spacing}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Design:figure-plate-settler-headloss-spacing}}}).


\section{Floc Blanket Design}
\label{\detokenize{Sedimentation/Sed_Derivations:floc-blanket-design}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-floc-blanket-design}}

\subsection{Floc Blanket Collision Potential}
\label{\detokenize{Sedimentation/Sed_Derivations:floc-blanket-collision-potential}}
We have learned that growing a floc blanket leads to better sedimentation tank performance. One explanation for the improved performance is that the floc blanket acts like an additional flocculator because there are additional collisions between particles. To understand the nature and significance of these additional collisions, we can calculate the floc blanket velocity gradients and residence time to find collision potential, \(G\theta\). In a floc blanket, we expect that \(G\) is small; however, \(\theta\) is large, which means that \(G\theta\) in the floc blanket may be significant.

First, we will find \(\theta\). If we simplify the bottom of the sedimentation tank and approximate it as a simple rectangle, we can easily determine the residence time. If the depth of the floc blanket is 1 m and the upflow velocity is 1 mm/s, we determine that
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:56}
\begin{split}\theta = 1000 s\end{split}
\end{equation}
Next, we will find \(G\). Before we begin, consider why there is a velocity gradient in the floc blanket. What causes it? Water is flowing up through the floc blanket while the flocs in the floc blanket are being pulled down by gravity. The differential velocities are caused by particles settling and rising at different velocities relative to the fluid due to drag, gravity, and fluid flow. In the fluid around each particle, there is a velocity gradient and shear between the particles and the surrounding fluid.

Entering the sedimentation tank, there is a large range of particle sizes in the water. The range exists from big flocs made up with hundreds of millions of clay particles to primary particles that made it through flocculation without successful collision. These differentially sized particles create velocity gradients as the particles and flocs are acted on by both settling forces and upward fluid flow forces.

Large flocs provide velocity gradients that can potentially cause collisions between other small particles that we are still trying to capture. Through our derivation to determine \(G\) in a floc blanket, we will also test an assumption. We will assume that primary particles coming into the floc blanket are not interacting with large flocs. Instead,  we will assume that the the fluid shear and differential velocities promote interactions between two primary particles.

So, how can we calculate the velocity gradient? In flocculators, we determined \(G\) from head loss and residence time. In sedimentation tanks, we determine \(G\) the same way. Let’s calculate the head loss through the floc blanket. To do this, we need to know the density of the floc blanket and we need to know the relationship between head loss a fluidized bed and density of the bed.


\subsubsection{Floc blanket density}
\label{\detokenize{Sedimentation/Sed_Derivations:floc-blanket-density}}
To calculate the density of the floc blanket at steady-state, we will use principles of mass and volume conservation.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:57}
\begin{split}C_{clay} = \frac{m_{clay}}{\rlap{--}V_{fb}}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:58}
\begin{split}\rho = \frac{m_{TOT}}{\rlap{--}V}\end{split}
\end{equation}
We will start by finding the mass of clay and the mass of water in the floc blanket, where:

\begin{DUlineblock}{0em}
\item[] \(C_{clay} =\) concentration of clay in the floc blanket
\item[] \(\rlap{--}V_{fb} =\) volume of floc blanket
\item[] \(\rho_{clay} =\) density of clay
\item[] \(\rho_{H_2O} =\) density of water
\item[] \(\rho_{fb} =\) density of floc blanket
\end{DUlineblock}

The mass of clay in the floc blanket is concentration multiplied by volume, shown by \(m_{clay} = C_{clay}\rlap{--}V_{fb}\)

The mass of water in the floc blanket is related to the volume fraction of the floc blanket that is occupied by clay, \(\frac{C_{clay}}{\rho_{clay}}\), whic is a very small number. \(\left( 1 - \frac{C_{clay}}{\rho_{clay}} \right)\) is the fraction of the floc blanket that is occupied by water, also called the water volume fraction. So, \(m_{H_2O} = \left( 1 - \frac{C_{clay}}{\rho_{clay}} \right) \rho_{H_2O} \rlap{--}V_{fb}\).

Now, we know how much clay and water is in our system. The density of the system, neglecting the addition of coagulant, is,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:59}
\begin{split}\rho_{fb} = \frac{m_{clay} + m_{H_2O}}{\rlap{--}V_{fb}}\end{split}
\end{equation}
Substituting for \(m_{clay}\) and \(m_{H_2O}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:60}
\begin{split}\rho_{fb} = \left( 1 - \frac{C_{clay}}{\rho_{clay}} \right)\rho_{H_2O} + C_{clay}\end{split}
\end{equation}
This can be rearranged to yield the following equation derived from first principles,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:61}
\begin{split}\rho_{fb} = \left( 1 - \frac{\rho_{H_2O}}{\rho_{clay}} \right)C_{clay} + \rho_{H_2O}\end{split}
\end{equation}
AguaClara researchers in the lab developed an empirical equation through experimental studies to calculate floc blanket density. They determined that,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:62}
\begin{split}\rho_{fb} = 0.687C_{clay} + \rho_{H_2O}\end{split}
\end{equation}
Comparing the empirical equation to the one determined by first principles, it is clear that the coefficient,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:63}
\begin{split}\left( 1 - \frac{\rho_{H_2O}}{\rho_{clay}} \right) = 0.687\end{split}
\end{equation}

\subsubsection{Floc blanket head loss}
\label{\detokenize{Sedimentation/Sed_Derivations:floc-blanket-head-loss}}
Now that we can calculate the density of the floc blanket, we can calculate the head loss through the floc blanket. This topic will be discussed further in the chapter on filtration. For now, all you need to know is that density can be related to head loss in the floc blanket through the height of the floc blanket, \(H_{fb}\), and the densities of the floc blanket and water.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:64}
\begin{split}\frac{h_L}{H_{fb}} = \frac{\rho_{fb} - \rho_{H_2O}}{\rho_{H_2O}}\end{split}
\end{equation}
There will be a small amount of head loss through the floc blanket because the density of the floc blanket is greater than the density of water by only a little bit. Remember that \(\frac{C_{clay}}{\rho_{clay}}\) is really just the fraction of the floc blanket that is occupied by clay.

Plugging in the equation for \(\rho_{fb}\) and solving for \(h_L\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:65}
\begin{split}h_L = H_{fb} \left( \frac{\rho_{clay}}{\rho_{H_2O}} - 1 \right) \frac{C_{clay}}{\rho_{clay}}\end{split}
\end{equation}

\subsubsection{Floc blanket velocity gradient and collision potential}
\label{\detokenize{Sedimentation/Sed_Derivations:floc-blanket-velocity-gradient-and-collision-potential}}
With the equation for \(h_L\), we can calculate \(G\). We will also use the other equations we developed in the {\hyperref[\detokenize{Flocculation/Floc_Design:heading-hydraulic-flocculation-design}]{\sphinxcrossref{\DUrole{std,std-ref}{chapter on flocculation}}}}.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:66}
\begin{split}G_{CS} = \sqrt{\frac{\bar \varepsilon}{\nu}}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:67}
\begin{split}\bar \varepsilon = \frac{gh_L}{\theta}\end{split}
\end{equation}
We will start by determining \(\varepsilon\) by calculating \(\theta\) using the porosity of the floc blanket, \(\phi_{fb}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:68}
\begin{split}\theta = \frac{H_{fb} \phi_{fb}}{\bar v_{z_{fb}}}\end{split}
\end{equation}
Plugging \(\theta\) into \(\varepsilon\) yields
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:69}
\begin{split}\bar \varepsilon = \frac{g \bar v_{z_{fb}}}{\phi_{fb}} \frac{h_L}{H_{fb}}\end{split}
\end{equation}
Substituting into our equation for \(G\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:70}
\begin{split}G_{CS} =  \sqrt{\frac{g \bar v_{z_{fb}}}{\nu \phi_{fb}} \frac{h_L}{H_{fb}}}\end{split}
\end{equation}
Using our equation for \(h_L\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:71}
\begin{split}G_{CS} =  \sqrt{\frac{g \bar v_{z_{fb}}}{\nu \phi_{fb}} \left( \frac{1}{\rho_{H_2O}} - \frac{1}{\rho_{clay}} \right) C_{clay} }\end{split}
\end{equation}
\(\phi_{fb} \approx 1\) and is a function of \(C_{clay}\)

We can plot our results for \(G_{CS}\) over a range of typical floc blanket concentrations, which is around 1 - 5 g/L. We find that \(G_{CS}\) ranges from 2 to 6 Hz. Recall that for flocculator design, we get anywhere from 70 to several hundred Hz. The \(G_{CS}\) provided by the floc blanket is much smaller than \(G_{CS}\) provided by the flocculator. This is an important point because in the low \(G_{CS}\) environment of the floc blanket where there are low levels of energy dissipation, we can grow larger flocs. The flocs are experiencing less shear so they can grow close to millimeter size.

We can plot our results for \(G_{CS}\theta\) by multiplying \(G_{CS}\) by the residence time we found earlier, \(\theta = 1000 s\). The result is that \(Gv\theta\) ranges from 2,000 to 6,000. Compare this to the \(G_{CS}\theta = 20,000\) for the flocculator used in experiments (\sphinxhref{https://www.liebertpub.com/doi/10.1089/ees.2016.0174}{Garland et al., 2017}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{lab_setup}.png}
\caption{Lab setup for flocculator, half-sedimentation tank, and plate settler testing.}\label{\detokenize{Sedimentation/Sed_Derivations:id14}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-lab-setup}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{floc_conc_G}.png}
\caption{Velocity gradient and collision potential as a function of floc blanket concentration.}\label{\detokenize{Sedimentation/Sed_Derivations:id15}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-floc-conc-g}}\end{figure}

How does such a small \(G_{CS}\theta\) cause such a large reduction in turbidity? The question we are really asking is, is there anything special about the \(G_{CS}\theta\) provided by the floc blanket compared to the \(G_{CS}\theta\) provided by the flocculator? If so, what is the difference and why is it so beneficial?

Experimental data helps explain this. Two systems were set up: one had a flocculator where \(G_{CS}\theta = 20,000\) with a floc blanket where \(G_{CS}\theta = 4,000\); the other just had a flocculator where \(G_{CS}\theta = 24,000\). Using the same influent water quality and coagulant dosing, we find that the first system with the flocculator and floc blanket performed better than the second system, even though the overall \(G_{CS}\theta\) values were the same.

To understand this, we have to review assumptions in the derivation for \(G_{CS}\). Recall our assumption that fluid shear promotes the collision of two primary particles instead of the collision of primary particles with existing, large flocs. If our assumption was true, we would expect to see no difference between our two experimental setups. However, because we know that the two experimental setups did have different results, our assumption must be false because the assumption does not explain or account for these differences. There must be another mechanism occurring to explain why the floc blanket greatly improves treatment quality. This leads us to believe that the flocs in the floc blanket must be more involved than simply providing shear and velocity gradients; they must be involved in some collisions with the small particles coming through the floc blanket.

This highlights an important distinction:
\begin{enumerate}
\item {} 
The model created by the original derivation assumption would suggests that flocs in the floc blanket are inert - simply occupying space and causing there to be head loss in the floc blanket - without being involved in any collisions. This model is disproved through the experimental analysis of the two experimental setups.

\item {} 
The model created after the analysis of experimental results suggests that flocs in the floc blanket are not inert - they are involved in collisions with small particles entering the floc blanket - and are growing in size. The model is supported through the experimental analysis.

\end{enumerate}


\section{Flocculator and Floc Blanket Paradox}
\label{\detokenize{Sedimentation/Sed_Derivations:flocculator-and-floc-blanket-paradox}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-flocculator-floc-blanket-paradox}}
We now have a very interesting apparent contradiction between our conclusions about flocculation and floc blankets. We previously concluded that primary particles do not collide with and attach to flocs in flocculators. This assumption is required to explain experimental observations. Indeed, if primary particles could attach to flocs in a flocculator, then high turbidity events with appropriate coagulant dosages should result in super performance because there would be so many opportunities for collisions between large flocs and primary particles. This is not what we observe.

The contradiction is that now we conclude that primary particles must be attaching to flocs in the floc blanket! Both of these conclusions are based on a combination of experimental measurements and careful application of models. If these apparently contradictory conclusions are both correct, then there must be some fundamental difference between the particle interactions in flocculators and floc blankets.

In both environments the flow around the flocs is dominated by viscous forces. The source of the fluid deformation is different in these two flows. In the flocculator the source of the fluid deformation is from turbulent kinetic energy that is dissipating by deforming (shearing) the fluid. In the floc blanket the source of fluid deformation is from the gravitational pull on the flocs. The flocs are moving relative to the fluid and the fluid is being deformed as the flocs move through the fluid.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Comparison between flocculator and floc blanket.}\label{\detokenize{Sedimentation/Sed_Derivations:id16}}\label{\detokenize{Sedimentation/Sed_Derivations:table-flocculator-vs-floc-blanket}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
Property
&\sphinxstyletheadfamily 
Flocculator
&\sphinxstyletheadfamily 
Floc blanket
\\
\hline
Velocity gradient
&
\textasciitilde{}100 Hz
&
x Hz
\\
\hline
\(G_{CS}\theta\)
&
20,000 - 40,000
&
x,000 to y,000
\\
\hline
energy source for fluid deformation
&
turbulence
&
floc drag
\\
\hline
flow regime at floc length scale
&
shear flow
&
velocity field is perturbed by falling flocs
\\
\hline
flocs are…
&
rotating from fluid shear
&
falling due to gravity
\\
\hline
flocs have a stagnation point
&
no
&
yes
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

Flocs that are rotating in a shear flow drag a boundary layer of fluid with them as they rotate. This boundary layer of fluid prevents any approaching fluid from penetrating to the surface of the floc. There is no stagnation point on the floc! This means that approaching particles are swept around the floc due to the presence of the boundary layer. The only way for a particle to collide with a large floc is for the particle to be large enough that it can penetrate through the boundary layer even though the center of the particle continues to follow the streamline around the boundary layer of the floc.

Flocs that are falling through a fluid that is not undergoing significant shear have stagnation points on the upstream side of the flocs and thus there exists a small amount of fluid that gets close enough to the floc near the stagnation point for small particles to collide with the floc.


\section{Diffuser Design}
\label{\detokenize{Sedimentation/Sed_Derivations:diffuser-design}}\label{\detokenize{Sedimentation/Sed_Derivations:heading-sed-tank-diffuser-design}}
Diffusers are shaped so that one end is a circular pipe that fits into the influent manifold orifice, and the other end is deformed to the shape of a thin rectangle, as shown in \hyperref[\detokenize{Sedimentation/Sed_Derivations:figure-diffuser-side-top-bottom}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Derivations:figure-diffuser-side-top-bottom}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{diffuser_side_top_bottom}.png}
\caption{Side, top, and bottom view of a diffuser.}\label{\detokenize{Sedimentation/Sed_Derivations:id17}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-diffuser-side-top-bottom}}\end{figure}

Recall that this deformation is done to create a line jet entering the jet reverser in the bottom of the sedimentation tank. Diffusers are shaped by dipping the pipe stubs in hot oil, and then pushing the maleable and heated pipe onto a metal form, as shown in \hyperref[\detokenize{Sedimentation/Sed_Derivations:figure-diffuser-fabrication}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Derivations:figure-diffuser-fabrication}}}. This metal form is sized so that the target shape is achieved.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{diffuser_fabrication}.png}
\caption{Process of heating the PVC in oil and molding the diffuser shape on the metal forms.}\label{\detokenize{Sedimentation/Sed_Derivations:id18}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-diffuser-fabrication}}\end{figure}

The bottom-view of the diffuser is shown in \hyperref[\detokenize{Sedimentation/Sed_Derivations:figure-bvss-diffuser}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Derivations:figure-bvss-diffuser}}}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{BvsS_diffuser}.png}
\caption{Diagram of diffuser exit.}\label{\detokenize{Sedimentation/Sed_Derivations:id19}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-bvss-diffuser}}\end{figure}

\begin{DUlineblock}{0em}
\item[] \(T_{diff} =\) thickness of diffuser wall
\item[] \(S_{diff} =\) internal width of diffuser
\item[] \(B_{diff} =\) center-to-center spacing between diffusers; external width of diffuser
\item[] \(W_{diff} =\) internal width of diffuser
\item[] \(\bar v_{jet} =\) velocity of the jet exiting the diffuser
\item[] \(Q_{diff} =\) flow rate through each diffuser
\item[] \(h_{L,jet} =\) head loss in jet leaving the jet reverser
\end{DUlineblock}


\subsection{Properties of \protect\(\bar v_{jet}\protect\)}
\label{\detokenize{Sedimentation/Sed_Derivations:properties-of}}
\(\bar v_{jet}\) is defined as the velocity of the water jet exiting the diffuser. After exiting the diffuser, this water jet is sent into the jet reverser to make a 180 degree turn. Does the water jet change pressure or velocity as it exits the jet reverser? Do we need to consider the effects of a \sphinxstyleemphasis{vena contracta}?

Recall that a {\hyperref[\detokenize{Review/Review_Fluid_Mechanics:heading-what-is-a-vena-contracta}]{\sphinxcrossref{\DUrole{std,std-ref}{*vena contracta*}}}} is associated with a change in pressure that causes a contraction and subsequent acceleration of the fluid. Water exiting the diffuser is pointed directly down and the streamlines are straight and parallel, which means that the pressure across the streamlines is constant. Water exiting the jet reverser is pointed directly up and the streamlines are straight and parallel, which again means that the pressure across the streamlines is constant. Because the pressure is constant at the exit of the diffuser and at the exit of the jet reverser, we assume that the pressure of the water in the space between those two points is also constant because there is no physical barrier. If the pressure in this bottom section of the sedimentation tank is constant from the exit of the diffuser to the exit of the jet reverser, we can infer that they are equal.

By Bernoulli, if the pressures between the exit of the diffuser to the exit of the jet reverser are equal then the velocities must also be equal. Bernoulli is applicable here because there is no flow expansion yet. The shear along the wall of the jet reverser is insignificant due to the short flow path. The water accelerates to account for the directional change but the absolute velocity does not change as it goes around the jet reverser.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=600\sphinxpxdimen]{{Wdiff_Wjet}.png}
\caption{Diagram of diffuser exit and jet.}\label{\detokenize{Sedimentation/Sed_Derivations:id20}}\label{\detokenize{Sedimentation/Sed_Derivations:figure-wdiff-wjet}}\end{figure}

Therefore, the velocity at the exit of the diffuser is equal to the velocity at the exit of the jet reverser.


\subsection{Diffuser Design}
\label{\detokenize{Sedimentation/Sed_Derivations:id1}}
What is the target shape of the diffuser? We know that the diffuser must be sized so that our velocity constraints will be achieved. The minimum velocity constraint comes from the need to keep flocs resuspended. We also know that in the active region of our sedimentation tank, we want an upflow velocity of 1 mm/s. Additionally, because diffusers are a key component of our “sedimentation tank as a circuit”, we want to precisely control head loss in the jet leaving the jet reverser because that will help us achieve uniform flow within and between sedimentation tanks. AguaClara designs set head loss in the jet constant at 1 cm.

Let’s begin by finding the internal width of a single diffuser. Using conservation of flow, we know that,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:72}
\begin{split}Q_{diff} = \bar v_{jet}W_{diff}S_{diff} = \bar v_{z_{fb}}W_{Sed}B_{diff}\end{split}
\end{equation}
\(Q_{diff}\) is determined {\hyperref[\detokenize{Sedimentation/Sed_Examples:heading-flow-thru-diffuser}]{\sphinxcrossref{\DUrole{std,std-ref}{as an example}}}}, where we find that \(Q_{diff} = 50 \frac{mL}{s}\).

Solving for \(W_{diff}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:73}
\begin{split}W_{diff} = \frac{\bar v_{z_{fb}}W_{Sed}B_{diff}}{\bar v_{jet}S_{diff}}\end{split}
\end{equation}
Using the constraint of head loss in the jet and solving for \(\bar v_{jet}\),
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:74}
\begin{split}h_{L,jet} = \frac{\bar v_{jet}^2}{2g}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:75}
\begin{split}\bar v_{jet} = \sqrt{2gh_{L,jet}}\end{split}
\end{equation}
Substituting back into the equation for \(W_{diff}\), we can find the minimum diffuser width required to not exceed target head loss as,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:76}
\begin{split}W_{diff,min} = \frac{\bar v_{z_{fb}}W_{Sed}B_{diff}}{(\sqrt{2gh_{L,jet}})S_{diff}}\end{split}
\end{equation}
Now that we have determined the minimum width, we can use known parameters and constraints to find a precise value for \(W_{diff}\) and \(v_{jet}\).

Using known constants for \(\bar v_{z_{fb}} = 1 \frac{mm}{s}\), \(h_{L,jet} = 1 cm\), and \(W_{Sed} = 1m\), we can find that \(W_{diff,min} = 2.7 mm\). The mold used to create diffusers in Honduras comes in sizes of 1/8 in, or 3.175 mm, so to find \(W_{diff}\) we round up to 3.175 mm.
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:77}
\begin{split}W_{diff} = 3.175 mm\end{split}
\end{equation}
Solving for \(\bar v_{jet}\) from our earlier equations yields,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:78}
\begin{split}\bar v_{jet} = \frac{\bar v_{z_{fb}}W_{Sed}B_{diff}}{W_{diff}S_{diff}}\end{split}
\end{equation}
Using known constants,
\begin{equation}\label{equation:Sedimentation/Sed_Derivations:Sedimentation/Sed_Derivations:79}
\begin{split}\bar v_{jet} \approx 380 \frac{mm}{s}\end{split}
\end{equation}

\section{References}
\label{\detokenize{Sedimentation/Sed_Derivations:references}}
Garland, Casey, et al. “Revisiting Hydraulic Flocculator Design for Use in Water Treatment Systems with Fluidized Floc Beds.” Environmental Engineering Science, vol. 34, no. 2, 1 Feb. 2017, pp. 122\textendash{}129., doi:10.1089/ees.2016.0174.


\section{Comments, Corrections, or Questions}
\label{\detokenize{Sedimentation/Sed_Derivations:comments-corrections-or-questions}}
This textbook is an ever-evolving project. If you find any errors while you are reading, or if you find something unclear, please let the authors know. Write your comment in \sphinxhref{https://github.com/AguaClara/Textbook/issues/85}{this Github issue} and it will be addressed as soon as possible. Please look at other comments before writing your own to avoid duplicate comments.


\chapter{Sedimentation Theory and Future Work}
\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:sedimentation-theory-and-future-work}}\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:id1}}\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work::doc}}
Unsolved sedimentation tank failure modes:
\begin{enumerate}
\item {} 
{\hyperref[\detokenize{Sedimentation/Sed_Design:heading-floc-volcano-intro}]{\sphinxcrossref{\DUrole{std,std-ref}{Floc volcanoes}}}} and \DUrole{xref,std,std-ref}{temperature-induced flow circulations}

\item {} 
Dissolved air flotation that results from air coming out of solution. Two sources of air include 1) compressed air traveling from the transmission line and 2) increased temperature which releases dissolved air.

\item {} 
Slime growth from iron-oxidizing bacteria.

\item {} 
NOM impact on floc density

\end{enumerate}


\section{Optimizing the transition from flocculator to floc blanket}
\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:optimizing-the-transition-from-flocculator-to-floc-blanket}}\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:floc-floc-blanket}}
We now how a published flocculator model and we have strong evidence that primary particles are removed first order with respect to depth (or time) in the floc blanket. Given these two models it is possible for the first time to optimize the design of a flocculator based on minimizing the volume of the flocculator and floc blanket reactors.

From the floc model we have
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:dCPdt_floc}
\begin{split}      \frac{dC_{P}}{dt}=-\pi\bar{\alpha}kC_{P}\left(\frac{6}{\pi}\frac{C_{P}}{\rho_P}\right)^{2/3} G_{CS}\end{split}
\end{equation}
From the floc blanket we know that particle removal is first order with respect to depth of the floc blanket or time in the floc blanket. We can use floc blanket data to estimate the first order rate constant.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:dCPdt_fb}
\begin{split}      \frac{dC_{P}}{dt}=-k_{fb}C_{P}\end{split}
\end{equation}
Separate variables to integrate this rate equation.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:0}
\begin{split}      \frac{dC_{P}}{C_{P}}=-k_{fb}dt\end{split}
\end{equation}
We integrate this to solve for the rate constant.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:1}
\begin{split}      k_{fb} = -\frac{1}{\theta_{fb}}ln{\frac{C_{P}}{C_{P_0}}}\end{split}
\end{equation}
We will use the previous equation to estimate the rate constant for the floc blanket.

We can obtain a minimum volume design by setting the rate of primary particle loss at the end of the flocculator to be equal to the rate of primary particle loss at the beginning of the floc blanket.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:2}
\begin{split}      -k_{fb}C_{P}=-\pi\bar{\alpha}kC_{P}\left(\frac{6}{\pi}\frac{C_{P}}{\rho_P}\right)^{2/3} G_{CS}\end{split}
\end{equation}
Now we solve the previous equation for the target concentration of primary particles that we should design for at the end of the flocculator.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:3}
\begin{split}     C_{P_{floc out}} = \frac{\pi \rho_P}{6} \left( \frac{k_{fb}}{\pi\bar{\alpha}k G_{CS}}\right)^{3/2}\end{split}
\end{equation}
The concentration of primary particles at the flocculator effluent will be a function of the flocculator velocity gradient.

The next step is to determine the Gt for the flocculator given this effluent flocculator particle concentration. The approximate equation for
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:4}
\begin{split}G_{CS}\theta \approx \frac{3}{2} \frac{\Lambda^2}{k \pi d_P^2 \alpha}\end{split}
\end{equation}
where the particle separation distance is given by
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:5}
\begin{split}\Lambda = \left( \frac{\pi d_P^3}{6} \frac{\rho_P}{C_P} \right)^\frac{1}{3}\end{split}
\end{equation}
Putting the previous two equations together we have:
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:6}
\begin{split}G_{CS}\theta \approx \frac{3}{2} \frac{1}{k \pi d_P^2 \alpha} \left( \frac{\pi d_P^3}{6} \frac{\rho_P}{C_P} \right)^\frac{2}{3}\end{split}
\end{equation}
We can simplify this equation because the particle size cancels out.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:7}
\begin{split}G_{CS}\theta \approx \frac{3}{2} \frac{1}{k \pi \alpha} \left( \frac{\pi}{6} \frac{\rho_P}{C_P} \right)^\frac{2}{3}\end{split}
\end{equation}
Now we can substitute the equation for the optimal flocculated water primary particle concentrations into the flocculator performance equation.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:8}
\begin{split}G_{CS}\theta \approx \frac{3}{2} \frac{1}{k \pi \alpha} \left( \frac{\pi\bar{\alpha}k G_{CS}}{k_{fb}}\right)\end{split}
\end{equation}
This simplifies to a very simple relationship that gives the optimal flocculator residence time. This analysis assumes that the cost per volume of flocculator is the same as the cost per volume of floc blanket.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:9}
\begin{split}\theta \approx \frac{3}{2} \left( \frac{1}{k_{fb}}\right)\end{split}
\end{equation}
We now have an equation for the optimal flocculator residence time! It is a function of the floc blanket rate constant. The analysis below suggests that the optimal flocculator residence time is about 300 seconds (5 minutes). This analysis does not provide guidance on the optimal amount of energy to be used in that flocculator. Overall plant performance is a function of how much energy is used in flocculation and so that would need to be an economic analysis. Startup performance when the floc blanket is not yet formed is a function of the energy dissipation rate.

This analysis suggests that a residence time that is less than what we are currently using for civil works AguaClara plants (about 8 minutes) and greater than what we are using for the PF300 (1-2 minutes) is the optimal solution.
High velocity gradients for flocculators with this long of a residence time will require a lot of head loss. We need to make sure that we are using a reasonable amount of energy.

The flocculator head loss is given by
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:10}
\begin{split}h_{Floc} = G_{CS} \theta \frac{\nu G_{CS}}{g}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\PYG{c+c1}{\PYGZsh{}I played with the velocity gradient to get a reasonable head loss of 50 cm.}
\PYG{n}{G\PYGZus{}CS} \PYG{o}{=} \PYG{l+m+mi}{123} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}
\PYG{n}{density\PYGZus{}clay} \PYG{o}{=} \PYG{l+m+mi}{2650} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{c+c1}{\PYGZsh{}From William\PYGZsq{}s research the k for flocculator is 0.03. We need to confirm that this value is correct.}
\PYG{n}{k} \PYG{o}{=} \PYG{l+m+mf}{0.03}
\PYG{c+c1}{\PYGZsh{} It isn\PYGZsq{}t clear what value should be used for alpha}
\PYG{n}{alpha} \PYG{o}{=} \PYG{l+m+mf}{0.5}
\PYG{c+c1}{\PYGZsh{} The following 3 values are estimates from Casey\PYGZsq{}s floc blanket video.}
\PYG{n}{C\PYGZus{}infb} \PYG{o}{=} \PYG{l+m+mi}{40} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{C\PYGZus{}outfb} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{t\PYGZus{}fb} \PYG{o}{=} \PYG{l+m+mi}{800} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{k\PYGZus{}fb} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{t\PYGZus{}fb}\PYG{o}{*}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{C\PYGZus{}outfb}\PYG{o}{/}\PYG{n}{C\PYGZus{}infb}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{C\PYGZus{}out\PYGZus{}f} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{*} \PYG{n}{density\PYGZus{}clay}\PYG{o}{/}\PYG{l+m+mi}{6} \PYG{o}{*} \PYG{p}{(}\PYG{n}{k\PYGZus{}fb}\PYG{o}{/}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{*}\PYG{n}{alpha}\PYG{o}{*}\PYG{n}{k}\PYG{o}{*}\PYG{n}{G\PYGZus{}CS}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The concentration of primary particles in the flocculated water is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{C\PYGZus{}out\PYGZus{}f}\PYG{p}{)}

\PYG{n}{Gt} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{n}{k}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{*} \PYG{n}{alpha}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{density\PYGZus{}clay}\PYG{o}{/}\PYG{n}{C\PYGZus{}out\PYGZus{}f}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flocculator Gt value is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Gt}\PYG{p}{)}
\PYG{n}{t\PYGZus{}floc} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{o}{/}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{k\PYGZus{}fb}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flocculator residence time is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{t\PYGZus{}floc}\PYG{p}{)}

\PYG{n}{Temp} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}

\PYG{n}{Floc\PYGZus{}HL} \PYG{o}{=} \PYG{p}{(}\PYG{n}{G\PYGZus{}CS}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{t\PYGZus{}floc} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temp}\PYG{p}{)}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{standard\PYGZus{}gravity}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The head loss through the flocculator is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Floc\PYGZus{}HL}\PYG{p}{)}
\end{sphinxVerbatim}

The target flocculator Gt of 39,000 is crazy close to the current design. This value will undoubtedly change somewhat as we get better measurements for the floc blanket rate constant.

This analysis suggests that the primary particle concentration after flocculation can be quite high when operating with a floc blanket. Further work will be required to ensure that startup is not a problem.


\section{Floc recycle}
\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:floc-recycle}}\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:id2}}
We hypothesize that the flocs in floc blankets serve as collectors that primary particles attach to. We suspect that collisions between primary particles and large flocs are possible in the sedimentation tank because the rotational velocity of the flocs is small relative to the sedimentation velocity of the flocs. If the rotational velocity of the flocs is small, then a stagnation point will exist on the floc and a finite flow of fluid will come within a primary particle radius of the floc. Thus we expect primary particle removal in floc blankets to be proportional to the number of collectors that a primary particle passes while in the floc blanket.

The number of collectors that a primary particle passes is proportional to the solids concentration (a surrogate for the number concentration of flocs), the primary particle residence time in the floc blanket, and the sedimentation velocity of the flocs. The sedimentation velocity of the flocs is important because that is what causes a relative velocity between the primary particles and the flocs.

As we have explored increasing the upflow velocity in sedimentation tanks the performance has dropped markedly. This is undoubtedly due in part to the combined effective of a very dilute floc blanket at high upflow velocities AND a low residence time for the primary particles.

Would it be possible to increase the concentration of the floc blanket and thus increase the collision rate? At 3 mm/s upflow velocity there are very few flocs that can stay in the floc blanket. We need a mechanism to transport flocs to the bottom of the floc blanket and return them again after they are carried to the top of the floc blanket.

We propose to test this by installing a settled floc recycle line. The recycle line will connect to the bottom surface of the tube settler below the location of the floc weir. From there is will carry concentrated sludge to the very bottom of the sedimentation tank where it will pass through the wall of the sedimentation tank. Increasing the amount of recycle flow will both increase the solids concentration in the floc blanket and decrease the primary particle residence time in the floc blanket.

There must be an optimal amount of recycled flocs for a floc blanket. Of course, one possiblity is that the optimal recycle is zero. Recycled flocs increase the floc blanket concentration and thus increase the rate of collisions between primary particles and flocs. The recycled flocs also decrease the residence time in the floc blanket and thus decrease the total number of collisions between primary particles and flocs. It may be more complicated than this because the hindered sedimentation velocity of the flocs in the floc blanket is also a function of their concentration.

Our goal is to find the optimal recycle ratio. Optimal is defined as the maximum collision potential. Collision potential for the floc blanket is proportional to to the collision rate times the hydraulic residence time. The collision rate is proportional to the solids concentration and the hindered sedimentation velocity of those flocs. The collision potential is thus proportional to the total number of flocs that a primary particle passes on its way through the floc blanket.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:11}
\begin{split}CP_{fb} \propto C_{fb} \theta_{fb} \bar v_{hindered}\end{split}
\end{equation}
The residence time in the floc blanket is given by
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:12}
\begin{split}\theta_{fb} = \frac{H_{fb}}{\bar v_{fb}}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:13}
\begin{split}\bar v_{fb} = \frac{Q_{plant} + Q_{recycle}}{A_{fb}}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:14}
\begin{split}Q_{recycle} = \Pi_{recycle}Q_{plant}\end{split}
\end{equation}
The velocity up through the floc blanket without recycle is defined as
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:15}
\begin{split}\bar v_z = \frac{Q_{plant}}{A_{fb}}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:16}
\begin{split}\bar v_{fb} = \bar v_z\left( 1 + \Pi_{recycle} \right)\end{split}
\end{equation}
Now we need equations for the concentration in the floc blanket. This is based on mass conservation such that the mass in the floc blanket is constant. There is a hindered sedimentation velocity of the flocs that results in a reduction of the mass flux out of the top of the control volume.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:17}
\begin{split}C_{fb}\left(\frac{ Q_{plant}+Q_{recycle} }{A_{fb}}-\bar v_{hindered}\right) A_{fb}= C_{plant}Q_{plant} + C_{recycle}Q_{recycle}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:18}
\begin{split}C_{fb}\left(\frac{ Q_{plant}+\Pi_{recycle}Q_{plant} }{A_{fb}}-\bar v_{hindered}\frac{Q_{plant}}{Q_{plant}}\right) A_{fb}= C_{plant}Q_{plant} + C_{recycle}\Pi_{recycle}Q_{plant}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:19}
\begin{split}C_{fb}\left( 1+\Pi_{recycle} -\frac{\bar v_{hindered}}{\bar v_z}\right) = C_{plant} + C_{recycle}\Pi_{recycle}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:20}
\begin{split}C_{fb} = \frac{C_{plant} + C_{recycle}\Pi_{recycle}}{\left(1+\Pi_{recycle}-\frac{\bar v_{hindered}}{\bar v_z}\right)}\end{split}
\end{equation}
Now we can substitute to get the collision potential as a function of the flow rates.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:21}
\begin{split}CP_{fb} \propto \frac{C_{plant} + C_{recycle}\Pi_{recycle}}{\left(1+\Pi_{recycle}-\frac{\bar v_{hindered}}{\bar v_z}\right)\left( 1 + \Pi_{recycle} \right)}  \frac{H_{fb}\bar v_{hindered}} {\bar v_z}\end{split}
\end{equation}
We estimate the hindered sedimentation velocity to be 1 mm/s since that is what occurs in a 1 mm/s upflow velocity floc blanket. Ideally we would have a hindered sedimentation velocity as a function of the concentration of flocs in the floc blanket. The concentration of recycled flocs is assumed to be approximately 20 g/L based on Casey Garland measurements of the solids concentration in the floc hopper sludge.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{n}{D\PYGZus{}fb}\PYG{o}{=}\PYG{l+m+mf}{2.5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{A\PYGZus{}fb} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{D\PYGZus{}fb}\PYG{p}{)}
\PYG{n}{H\PYGZus{}fb} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{v\PYGZus{}hindered} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{C\PYGZus{}fb\PYGZus{}conventional} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{C\PYGZus{}recycle} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{g}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}
\PYG{n}{C\PYGZus{}plant} \PYG{o}{=} \PYG{l+m+mi}{100} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{v\PYGZus{}up} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}


\PYG{k}{def} \PYG{n+nf}{CP}\PYG{p}{(}\PYG{n}{H\PYGZus{}fb}\PYG{p}{,}\PYG{n}{v\PYGZus{}up}\PYG{p}{,}\PYG{n}{v\PYGZus{}hindered}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}recycle}\PYG{p}{,}\PYG{n}{C\PYGZus{}plant}\PYG{p}{,}\PYG{n}{C\PYGZus{}recycle}\PYG{p}{)}\PYG{p}{:}
 \PYG{k}{return} \PYG{p}{(}\PYG{n}{H\PYGZus{}fb}\PYG{o}{*}\PYG{n}{v\PYGZus{}hindered}\PYG{o}{/}\PYG{n}{v\PYGZus{}up}\PYG{o}{*}\PYG{p}{(}\PYG{n}{C\PYGZus{}plant}\PYG{o}{+}\PYG{n}{C\PYGZus{}recycle}\PYG{o}{*}\PYG{n}{Pi\PYGZus{}recycle}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{Pi\PYGZus{}recycle}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{Pi\PYGZus{}recycle}\PYG{o}{\PYGZhy{}}\PYG{n}{v\PYGZus{}hindered}\PYG{o}{/}\PYG{n}{v\PYGZus{}up}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{Pi\PYGZus{}recycle\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{Pi\PYGZus{}recycle} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}recycle\PYGZus{}max}\PYG{p}{,}\PYG{l+m+mf}{0.1}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{x}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}recycle\PYGZus{}max}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{yscale} \PYG{o}{=} \PYG{p}{(}\PYG{n}{C\PYGZus{}fb\PYGZus{}conventional}\PYG{o}{*}\PYG{n}{H\PYGZus{}fb}\PYG{o}{*}\PYG{n}{v\PYGZus{}hindered}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to\PYGZus{}base\PYGZus{}units}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{yscale}
\PYG{n}{y}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{yscale}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}recycle}\PYG{p}{,}\PYG{n}{CP}\PYG{p}{(}\PYG{n}{H\PYGZus{}fb}\PYG{p}{,}\PYG{n}{v\PYGZus{}up}\PYG{p}{,}\PYG{n}{v\PYGZus{}hindered}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}recycle}\PYG{p}{,}\PYG{n}{C\PYGZus{}plant}\PYG{p}{,}\PYG{n}{C\PYGZus{}recycle}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{imagepath} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sedimentation/Images/}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{recycle ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Collision Potential (kg/m\PYGZca{}2)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{no recycle at 1 mm/s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{with recycle at 3 mm/s}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{imagepath}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{fb\PYGZus{}recycle\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

Here are the results.
\begin{quote}
\end{quote}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=700\sphinxpxdimen]{{fb_recycle_ratio}.png}
\caption{Collision potential comparison in a 1 m deep floc blanket.}\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:id4}}\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:collision-potential-with-sludge-recycle}}\end{figure}

This analysis suggest that a recycle flow rate that is between 0.5 and 1.5 at a net upflow velocity of 3 mm/s could produce collision potential that is 2/3 of the collision potential with a 1 mm/s upflow velocity. Thus a 3 mm/s sed tank with 1.5 m of floc blanket and recycle might be able to perform at the same level as a 1 mm/s sed tank with a 1 m floc blanket.

The next step is to design the recycle tube. The recycle tube could be inclined to promote additional consolidation to reduce the amount of water that is recycled. The slope would need to be about 60 degrees. We could experiment with the design of the recycle line if it were made of flexible tubing.

It is expected that the consolidated sludge will flow by gravity because of its higher density. The big unknown is what diameter recycle line is needed for a lab scale test with a 2.5 cm diameter sedimentation tank.

The recycle sludge has a density given by
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:22}
\begin{split}\rho_{sludge} = \left( 1 - \frac{\rho_{H_2O}}{\rho_{Clay}} \right) C_{sludge} + \rho_{H_2O}\end{split}
\end{equation}
The piezometric head (measured in equivalent change in height of the recycle line liquid) that is causing the flow through the recycle line is equal to the difference in density between the recycled sludge and the floc blanket times the height of the floc blanket normalized by the recycle line density.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:23}
\begin{split}H_l = H_{fb}\frac{\rho_{sludge} - \rho_{fb}}{\rho_{sludge}}\end{split}
\end{equation}
Substitute to replace the sludge and floc blanket densities.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:24}
\begin{split}H_l = H_{fb}\frac{\left( 1 - \frac{\rho_{H_2O}}{\rho_{Clay}} \right) C_{sludge} + \rho_{H_2O} -\left[  \left( 1 - \frac{\rho_{H_2O}}{\rho_{Clay}} \right) C_{fb} + \rho_{H_2O} \right]} {\left( 1 - \frac{\rho_{H_2O}}{\rho_{Clay}} \right) C_{sludge} + \rho_{H_2O}}\end{split}
\end{equation}
Simplify the equation for the head loss in the recycle tube.
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:25}
\begin{split}H_l = H_{fb}\frac{ C_{sludge} -C_{fb}} { C_{sludge} + \frac{\rho_{H_2O}\rho_{Clay}}{  \rho_{Clay} -\rho_{H_2O} }}\end{split}
\end{equation}
The recycle tube is assumed to be sloped at 60 degrees from the horizontal to enable further consolidation. The length of the recycle tube is
\begin{equation}\label{equation:Sedimentation/Sed_Theory_and_Future_Work:Sedimentation/Sed_Theory_and_Future_Work:26}
\begin{split}L_{tube} = H_{fb}/sin(60)\end{split}
\end{equation}
We will assume that the dynamic viscosity of the sludge is the same as the dynamic viscosity of water. We will calculate the kinematic viscosity of the sludge by dividing the dynamic viscosity of water by the density of the recycle.

Now we can solve for the required tube diameter

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{n}{Temperature}\PYG{o}{=} \PYG{l+m+mi}{20}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{D\PYGZus{}fb}\PYG{o}{=}\PYG{l+m+mf}{2.5}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{A\PYGZus{}fb} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{area\PYGZus{}circle}\PYG{p}{(}\PYG{n}{D\PYGZus{}fb}\PYG{p}{)}
\PYG{n}{H\PYGZus{}fb} \PYG{o}{=} \PYG{l+m+mf}{1.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{Angle\PYGZus{}tube} \PYG{o}{=} \PYG{l+m+mi}{60}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{deg}
\PYG{n}{L\PYGZus{}tube} \PYG{o}{=} \PYG{n}{H\PYGZus{}fb}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{Angle\PYGZus{}tube}\PYG{p}{)}
\PYG{n}{density\PYGZus{}clay}\PYG{o}{=}\PYG{l+m+mi}{2650}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}

\PYG{n}{H\PYGZus{}l} \PYG{o}{=} \PYG{n}{H\PYGZus{}fb}\PYG{o}{*}\PYG{p}{(}\PYG{n}{C\PYGZus{}recycle}\PYG{o}{\PYGZhy{}}\PYG{n}{C\PYGZus{}fb}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{C\PYGZus{}recycle}\PYG{o}{+}\PYG{p}{(}\PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*}\PYG{n}{density\PYGZus{}clay}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{density\PYGZus{}clay}\PYG{o}{\PYGZhy{}}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{H\PYGZus{}l}
\PYG{n}{Q\PYGZus{}plant}\PYG{o}{=}\PYG{n}{v\PYGZus{}up}\PYG{o}{*}\PYG{n}{A\PYGZus{}fb}
\PYG{n}{Pi\PYGZus{}recycle}\PYG{o}{=}\PYG{l+m+mf}{0.5}
\PYG{n}{density\PYGZus{}recycle} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{/}\PYG{n}{density\PYGZus{}clay}\PYG{p}{)}\PYG{o}{*}\PYG{n}{C\PYGZus{}recycle} \PYG{o}{+} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}
\PYG{n}{nu\PYGZus{}recycle} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}dynamic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{/}\PYG{n}{density\PYGZus{}recycle}
\PYG{n}{D\PYGZus{}recycle} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{diam\PYGZus{}pipe}\PYG{p}{(}\PYG{n}{Q\PYGZus{}plant}\PYG{o}{*}\PYG{n}{Pi\PYGZus{}recycle}\PYG{p}{,}\PYG{n}{H\PYGZus{}l}\PYG{p}{,}\PYG{n}{L\PYGZus{}tube}\PYG{p}{,}\PYG{n}{nu\PYGZus{}recycle}\PYG{p}{,}\PYG{l+m+mf}{0.01}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{D\PYGZus{}recycle}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n}{D\PYGZus{}recycle}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}
\end{sphinxVerbatim}

The head loss in the recycle tube is approximately 1.6 cm in a 1.5 m deep floc blanket.

The recycle line will be installed between the bottom of the tube settler and the inlet to the sedimentation tank. The recycle line will connect  directly to the side of the sedimentation tank to minimize minor losses. We will use a 0.25” ID, 3/8”OD clear flexible tube for the recycle line. We will use PVC glue to attach the flexible tube to the rigid clear PVC tubing.

It is possible that it will be necessary to prevent flow in the recycle line initially so that it doesn’t flow upward. Once the tube begins filling with solids it should be possible for it to start flowing downwards.


\section{Floc Volcanoes}
\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:floc-volcanoes}}\label{\detokenize{Sedimentation/Sed_Theory_and_Future_Work:id3}}
Floc volcanoes are caused by differences in temperature between the water that is in a sedimentation tank and the incoming water. If the incoming water is warmer than the water that is already in the sedimentation tank, then the incoming water will be buoyant and will rise quickly to the top of the sedimentation tank and carry flocs to the effluent launder.

Temperature fluctuations can be especially pronounced with small scale water supplies where small streams and small diameter transmission lines can be exposed to the sun and can warm up dramatically during a few hours of sunshine. Given that temperature changes and density changes can not easily be engineered, the only solution that we have is to reduce the time that water spends in the sedimentation tank so that the influent water is closer to the average temperature of the water in the sedimentation tank. Solar heating causing the raw water temperature to go from a minimum at 6 am to a maximum at 1 pm. AguaClara sedimentation tanks currently have a residence time of approximately 2 m / (1 mm/s) or 2000 s. We anticipate that by increasing the upflow velocity and by introducing floc recycle that the effects of temperature induced floc volcanoes will be reduced.


\chapter{Sedimentation Examples}
\label{\detokenize{Sedimentation/Sed_Examples:sedimentation-examples}}\label{\detokenize{Sedimentation/Sed_Examples:title-sedimentation-examples}}\label{\detokenize{Sedimentation/Sed_Examples::doc}}
These are a few short examples of calculations required for sedimentation tank design. More examples can be found in the {\hyperref[\detokenize{Sedimentation/Sed_Design_Solution:heading-sed-design-challenge-solution}]{\sphinxcrossref{\DUrole{std,std-ref}{Sedimentation Design Solution}}}}.


\section{Tube Settler Design}
\label{\detokenize{Sedimentation/Sed_Examples:tube-settler-design}}\begin{enumerate}
\item {} 
Design a tube settler for a laboratory scale sedimentation tank. The vertical section of the sedimentation tank, \(v_{z_{fb}}\), has a net upflow velocity of 3 mm/s. This velocity is maintained in the tube settler, \(v_{\alpha}\). The target capture velocity is 0.2 mm/s. The tube settler diameter is 2.54 cm.

\end{enumerate}
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:0}
\begin{split}\frac{\bar v_{z_{fb}}}{\bar v_c} = \frac{L}{D} \cos \alpha \sin \alpha + \sin ^2 \alpha\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:1}
\begin{split}\bar v_{z_{fb}} = \bar v_\alpha\sin \alpha\end{split}
\end{equation}
Solve for the length of the tube settler.
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:2}
\begin{split}L = \frac{D}{\cos \alpha}\left(\frac{\bar v_\alpha}{\bar v_c} - \sin \alpha\right)\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{v\PYGZus{}alpha} \PYG{o}{=} \PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{v\PYGZus{}c} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{D} \PYG{o}{=} \PYG{l+m+mf}{2.54} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{alpha} \PYG{o}{=} \PYG{l+m+mi}{60} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{deg}

\PYG{k}{def} \PYG{n+nf}{L\PYGZus{}settler}\PYG{p}{(}\PYG{n}{D}\PYG{p}{,}\PYG{n}{alpha}\PYG{p}{,}\PYG{n}{v\PYGZus{}alpha}\PYG{p}{,}\PYG{n}{v\PYGZus{}c}\PYG{p}{)}\PYG{p}{:}
 \PYG{k}{return} \PYG{n}{D}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{n}{v\PYGZus{}alpha}\PYG{o}{/}\PYG{n}{v\PYGZus{}c} \PYG{o}{\PYGZhy{}} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{alpha}\PYG{p}{)}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{L\PYGZus{}settler}\PYG{p}{(}\PYG{n}{D}\PYG{p}{,}\PYG{n}{alpha}\PYG{p}{,}\PYG{n}{v\PYGZus{}alpha}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{L\PYGZus{}settler}\PYG{p}{(}\PYG{n}{D}\PYG{p}{,}\PYG{n}{alpha}\PYG{p}{,}\PYG{n}{v\PYGZus{}alpha}\PYG{p}{,}\PYG{l+m+mf}{0.2}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The tube settler above the floc hopper needs to be 72 cm long. The tube settler should provide a capture velocity of at least 1 mm/s prior to the floc hopper. Thus there should be 11 cm below the floc hopper.


\section{Determining flow through a diffuser}
\label{\detokenize{Sedimentation/Sed_Examples:determining-flow-through-a-diffuser}}\label{\detokenize{Sedimentation/Sed_Examples:heading-flow-thru-diffuser}}\begin{enumerate}
\item {} 
What is the flow rate of a single diffuser in the bottom of the sedimentation tank? Consider a sedimentation tank that is 6 m long, 1 m wide and 2 m deep, with an upflow velocity of 1 mm/s and a diffuser spacing of 5 cm.

\end{enumerate}

What is this question really asking? This question is asking us to understand that each diffuser “serves” a specific cross-sectional area of the sedimentation tank; all of the diffusers together serve the entire area of the sedimentation tank. So, let’s imagine a single diffuser serving a slice of a sedimentation tank. With this in mind, we can easily solve this using \(Q = \bar vA\). The area, \(A\), is the slice of the sedimentation tank that we are serving. We are told that the tank is 1 m wide, so \(W_{tank} = 1\) m. The length of the slice is dictated by the spacing of the diffusers, \(B_{diff}\), so \(B_{diff} = 5\) cm.
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:3}
\begin{split}A = B_{diff}W_{tank}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:4}
\begin{split}A = 5 cm * 1 m\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:5}
\begin{split}A = 50,000 mm^2\end{split}
\end{equation}
The problem statement includes that \(\bar v_{z_{fb}} = 1\) mm/s. Plugging into our flow equation,
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:6}
\begin{split}Q_{diff} = \bar v_{z_{fb}}A\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:7}
\begin{split}Q_{diff} = (1 \frac{mm}{s})(50,000mm^2)\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:8}
\begin{split}Q_{diff} = 50,000 \frac{mm^3}{s}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:9}
\begin{split}Q_{diff} = 50 \frac{mL}{s}\end{split}
\end{equation}
The flow rate of each diffuser is \(50 \frac{mL}{s}\).


\section{Identify Failure Modes from Old Design}
\label{\detokenize{Sedimentation/Sed_Examples:identify-failure-modes-from-old-design}}
Look at a proposed design for the bottom of the sedimentation tank, shown in \hyperref[\detokenize{Sedimentation/Sed_Examples:figure-failure-mode-example}]{Fig.\@ \ref{\detokenize{Sedimentation/Sed_Examples:figure-failure-mode-example}}}. This design has an influent manifold at the bottom of the tank. Water flows upwards from the influent manifold. At one end of the influent manifold, there is a drain port. Above the influent manifold, there is a single slot that extends the length of the sedimentation tank. There are no diffusers in this design.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[height=300\sphinxpxdimen]{{failure_mode_example}.png}
\caption{Proposed sedimentation tank design.}\label{\detokenize{Sedimentation/Sed_Examples:id1}}\label{\detokenize{Sedimentation/Sed_Examples:figure-failure-mode-example}}\end{figure}
\begin{enumerate}
\item {} 
What are the failure modes for this design?

\end{enumerate}

Some issues are:
\begin{itemize}
\item {} 
flocs can settle in the influent manifold, specifically at the end of the influent manifold pipe;

\item {} 
the upflow line jet may be impacted and bent by settling flocs, allowing for floc settling on one side of the tank;

\item {} 
without diffusers, there may not be uniform flow distribution from one end of the sedimentation tank to the other;

\item {} 
without diffusers, there will be large flow circulations inside the sedimentation tank.

\end{itemize}

This design has never been built and never will be. Understanding what the problems are with this design will help us design better in the future.


\section{Diffuser and Jet Reverser Design}
\label{\detokenize{Sedimentation/Sed_Examples:diffuser-and-jet-reverser-design}}\begin{enumerate}
\item {} 
Calculate the maximum velocity of water leaving the diffuser based on the maximum head loss. Assume that the majority of head loss is the kinetic energy of the flow exiting the diffuser slot (this assumption will be checked later). Assume K=1.

\end{enumerate}

Given parameters:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core} \PYG{k}{import} \PYG{n}{utility} \PYG{k}{as} \PYG{n}{ut}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{c+c1}{\PYGZsh{}given sedimentation inlet maximum headloss}
\PYG{n}{headloss\PYGZus{}sed\PYGZus{}inlet\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{c+c1}{\PYGZsh{}given sedimentation tank up flow velocity}
\PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{c+c1}{\PYGZsh{}given sedimentation tank width}
\PYG{n}{W\PYGZus{}sed} \PYG{o}{=} \PYG{l+m+mi}{42} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\end{sphinxVerbatim}

To find the maximum velocity based on maximum headloss we will use the minor loss equation.
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:10}
\begin{split}h_{e,inlet} = K \frac{\bar v_{jet}^2}{2g}\end{split}
\end{equation}
To find the minimum width based on the maximum velocity through the diffuser, we will use conservation of mass. Since it is an incompressible fluid the flow rate entering from the diffuser line jet must be equal to the flow rate up through the sedimentation tank.
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:11}
\begin{split}\bar v_{jet}W_{diff} L_{sed} = \bar v_{z_{fb}}W_{sed}L_{sed}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{g} \PYG{o}{=} \PYG{l+m+mf}{9.81} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
\PYG{c+c1}{\PYGZsh{} minor loss equation with K=1}
\PYG{n}{V\PYGZus{}diffuser\PYGZus{}max} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{g} \PYG{o}{*} \PYG{n}{headloss\PYGZus{}sed\PYGZus{}inlet\PYGZus{}max}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum velocity of the sed tank diffusers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{V\PYGZus{}diffuser\PYGZus{}max}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} mass conservation}
\PYG{n}{W\PYGZus{}diffuser\PYGZus{}inner\PYGZus{}min} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{/} \PYG{n}{V\PYGZus{}diffuser\PYGZus{}max}\PYG{p}{)} \PYG{o}{*} \PYG{n}{W\PYGZus{}sed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum width of the sed tank diffusers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{W\PYGZus{}diffuser\PYGZus{}inner\PYGZus{}min}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The maximum velocity of the sedimentation tank diffusers is 0.4429 meters / second.
The minimum width of the sedimentation tank diffusers is 2.409 millimeter.
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
Calculate the minimum inner width of the diffuser. Assume that the diffuser slot is continuous over the entire length of the sedimentation tank to get an initial estimate (it isn’t actually continuous because it is made from many flattened diffuser pipes).

\end{enumerate}

Diffusers are made by deforming PVC pipe. Softened PVC pipe is forced onto a mold that shapes it into the rectangular shape of the diffuser. (link to sedimentation chapter)

What metal plate thickness should be used to make the mold for the diffusers? This value will be the minimum diffuser width. Metal plates are available in 1/16” increments of thickness. The minimum thickness of plate that is strong enough for a mold is 1/16”.
The \sphinxtitleref{ceil\_nearest} function defined in utility.py can take in a parameter and an array and it will find the closest value in the array that is at least as big and the parameter. For our problem we will use this to find the plate size that is available and at least as big as the minimum width defined above.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{W\PYGZus{}diffuser} \PYG{o}{=} \PYG{n}{ut}\PYG{o}{.}\PYG{n}{ceil\PYGZus{}nearest}\PYG{p}{(}\PYG{n}{W\PYGZus{}diffuser\PYGZus{}inner\PYGZus{}min}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{16}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{16}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The width of sed tank diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{W\PYGZus{}diffuser}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The width of sedimentation tank diffuser is 0.3175 centimeter

The PVC pipe that forms the diffusers changes in shape and wall thickness during the molding process. The inner width of the rectangle is created by forcing the pipe over a rectangular wedge that is the thickness you calculated above. During the molding process, PVC pipe wall cross-sectional area is conserved. The pipe wall is stretched in total length approximately 20\%. Another way to think about this is that the thickness of the wall is reduced by a factor of 1/1.2 because the mass of PVC is conserved and the density is unchanged. Thus, volume and cross-sectional area are conserved.

Area is given using the following equation \(A_{PVC}=2\left (B_{diffuser}+W_{diffuser} \right)T_{diff}\)
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
Use the equation for \(A_{PVC}\) to calculate the following

\end{enumerate}
\begin{itemize}
\item {} 
the outer length of the rectangular diffuser slot, \(B_{diffuser}\).

\item {} 
the inner length of the rectangular diffuser slot, \(W_{diffuser}\).

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core} \PYG{k}{import} \PYG{n}{pipes} \PYG{k}{as} \PYG{n}{pipe}
\PYG{n}{SDR}\PYG{o}{=}\PYG{l+m+mi}{26}

\PYG{c+c1}{\PYGZsh{} Assumed stretch of the PVC pipes as they are heated and molded:}
\PYG{n}{Pi\PYGZus{}PVC\PYGZus{}stretch} \PYG{o}{=} \PYG{l+m+mf}{1.2}

\PYG{c+c1}{\PYGZsh{} Nominal diameter of the sed tank diffuser}
\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\PYG{c+c1}{\PYGZsh{}The cross\PYGZhy{}sectional area of the pipe wall is:}
\PYG{n}{area\PYGZus{}PVC} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{OD}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}The thickness of the wall is reduced by the stretch factor:}
\PYG{n}{thickness\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}wall} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{OD}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{Pi\PYGZus{}PVC\PYGZus{}stretch}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} From geometry of the rectangular diffuser opening (assuming perfectly square corners) we have:}
\PYG{n}{B\PYGZus{}diffuser} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{area\PYGZus{}PVC} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{thickness\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}wall}\PYG{p}{)}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{W\PYGZus{}diffuser}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Sed diffuser outer length:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{B\PYGZus{}diffuser}\PYG{p}{)}

\PYG{n}{S\PYGZus{}diffuser} \PYG{o}{=} \PYG{n}{B\PYGZus{}diffuser} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{thickness\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}wall}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Sed diffuser inner length:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{S\PYGZus{}diffuser}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The sedimentation diffuser outer length: 5.736 centimeter

Sedimentation diffuser inner length: 5.522 centimeter

Each diffuser serves a certain width and length of the sedimentation tank. Assume that the diffusers are installed so that they touch each other.

4. Determine the flow through each diffuser.
\(Q_{max,diff} = \bar v_{z_{fb}} A\)

\(A = W_{sed}  B_{diff}\)

5. Determine the velocity through each diffuser.
\(\bar v_{diff} = \frac{Q_{max,diff}}{W_{diff} * S_{diff}}\)

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flow\PYGZus{}max\PYGZus{}diffuser} \PYG{o}{=} \PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{*} \PYG{n}{W\PYGZus{}sed} \PYG{o}{*} \PYG{n}{B\PYGZus{}diffuser}
\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{=} \PYG{p}{(}\PYG{n}{flow\PYGZus{}max\PYGZus{}diffuser} \PYG{o}{/} \PYG{p}{(}\PYG{n}{W\PYGZus{}diffuser} \PYG{o}{*} \PYG{n}{S\PYGZus{}diffuser}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow of water leaving a sed tank diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{flow\PYGZus{}max\PYGZus{}diffuser}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{ml}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The velocity of water leaving the sed tank diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The flow of water leaving a sed tank diffuser is 61.19 milliliter / second
The velocity of water leaving the sed tank diffuser is 0.349 meter / second
\begin{enumerate}
\setcounter{enumi}{5}
\item {} 
What is the Reynolds number of the jet exiting the diffusers at the design temperature of 15 degrees Celsius?

\end{enumerate}

Recall the formula for Reynold’s number:

\(Re = \frac{\bar v D}{\nu}\) The D is actually just representative of the length scale so we can replace this with the width of the diffuser.
\(Re = \frac{\bar v_{diff}*W_{diff}}{\nu}\)

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core} \PYG{k}{import} \PYG{n}{physchem} \PYG{k}{as} \PYG{n}{pc}
\PYG{n}{T\PYGZus{}design} \PYG{o}{=} \PYG{l+m+mi}{15} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{Re\PYGZus{}diffuser\PYGZus{}jet} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{W\PYGZus{}diffuser} \PYG{o}{*} \PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)} \PYG{o}{/} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The Reynolds number for this jet is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Re\PYGZus{}diffuser\PYGZus{}jet}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The Reynolds number for this jet is 974.6 dimensionless
\begin{enumerate}
\setcounter{enumi}{6}
\item {} 
What is the Reynolds number of the vertical flow up through the top of the floc blanket?

\end{enumerate}

The same principle as above can be applied to this question except the length scale is the width of the sedimentation tank and the velocity is the upwards velocity in the tank.

\(Re = \frac{\bar v_{z_{fb}} W_{sed}}{\nu}\)

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Re\PYGZus{}sed} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{W\PYGZus{}sed} \PYG{o}{*} \PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{p}{)} \PYG{o}{/} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Reynolds number through floc is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Re\PYGZus{}sed}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} Reynolds number through floc is 938.2 dimensionless. These two Reynold’s numbers are similar because conservation of mass requires for a constant length that \(\bar v_{1}*W_{1} = \bar v_{2}*W_{2}\). The slight difference in the numbers is due to that fact that diffusers are not a continuous line jet but rather broken up by two times the thickness of the pipe wall between the diffusers.

Next, we want to determine the energy dissipation rate for the flow leaving the jet reverser. For this process, you can assume that the jet remains laminar. The flow spreads to fill the gaps created by the walls of the diffuser tubes by the time it traverses the jet reverser. Jet velocity and flow rate are conserved as the jet changes direction in the jet reverser.

8. Calculate the thickness of the jet after it does the 180 degree bend of the jet reverser. The change in thickness of the jet after the 180 degree bend is due to the flow spreading out to fill in the gaps created by the diffuser pipe walls.
\(W_{jet} * \bar v_{diff} = W_{sed} * \bar v_{z_{fb}}\)
\begin{enumerate}
\setcounter{enumi}{8}
\item {} 
Calculate the maximum energy dissipation rate for the flow leaving the jet reverser. See Equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:EDR_JetPlane} for the maximum energy dissipation rate in a plane jet and see \hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-edr-g-equations}]{Table \ref{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-edr-g-equations}}} for the value of \(\Pi_{JetPlane}\).

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}jet\PYGZus{}plane} \PYG{o}{=} \PYG{l+m+mf}{0.0124}
\PYG{n}{W\PYGZus{}jet\PYGZus{}reversed} \PYG{o}{=} \PYG{n}{W\PYGZus{}sed} \PYG{o}{*} \PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{/} \PYG{n}{V\PYGZus{}diffuser}
\PYG{n}{EDR\PYGZus{}inlet\PYGZus{}jet} \PYG{o}{=} \PYG{n}{Pi\PYGZus{}jet\PYGZus{}plane}\PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{/} \PYG{n}{W\PYGZus{}jet\PYGZus{}reversed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The energy dissipation rate for inlet jet is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{EDR\PYGZus{}inlet\PYGZus{}jet}\PYG{p}{)}
\end{sphinxVerbatim}

The energy dissipation rate for inlet jet is 158.5 milliwatt / kilogram

In designing AguaClara plants, it is critical to account for all forms of significant head loss. In the sedimentation tank, effluent launders provide about 4 cm of head loss. We want to calculate the exit head loss for water leaving the diffusers to determine whether it is a significant addition to the total head loss through the sedimentation tank.
\begin{enumerate}
\setcounter{enumi}{9}
\item {} 
Calculate this diffuser exit head loss in two ways.

\end{enumerate}

First, calculate the head loss making sure to account for the upflow velocity in the sed tank.

\(h_e = \frac{\left( {{\bar v_{diff}} - {\bar v_{z_{fb}}}} \right)^2}{2g}\)

Second, calculate the head loss but assume that the upflow velocity is negligible.

\(h_e = \frac{\ {\bar v_{diff}}^2}{2g}\)
\begin{enumerate}
\setcounter{enumi}{10}
\item {} 
Is it reasonable to neglect the upflow velocity in the sed tank when calculating this head loss?

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{\PYGZhy{}} \PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*}\PYG{n}{g}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit2} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*}\PYG{n}{g}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}error} \PYG{o}{=} \PYG{p}{(}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit2}\PYG{o}{\PYGZhy{}}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The best estimate of the exit head loss for the diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The 2nd estimate of the exit head loss for the diffuser ignoring the upflow velocity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{It is reasonable to neglect the effect of the upflow velocity. The error is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}error}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The best estimate of the exit head loss for the diffuser is 0.6176 centimeter. The 2nd estimate of the exit head loss for the diffuser ignoring the upflow velocity is 0.6211 centimeter. It is reasonable to neglect the effect of the upflow velocity. The error is 0.005755 dimensionless


\section{Manifolds and Launders}
\label{\detokenize{Sedimentation/Sed_Examples:manifolds-and-launders}}
Flow distribution between and within sedimentation tanks is an important design component to ensure good sedimentation performance. We need to distribute flow uniformly between sedimentation tanks and also between diffusers on the inlet manifolds.

The following variable definitions and equations will be useful in answering later questions.

\({h}_{L,ParallelPath}\) is the head loss (flow resistance) in the parallel paths leaving the manifold. The head loss in the parallel path is the total head loss from where the flow leaves the manifold to the point where the parallel flows reunite.

\(\Delta{H}_{Manifold}\) is the variability in piezometric head in the manifold that is driving the flow through the parallel paths.

The ratio of minimum (first diffuser port) to maximum (last diffuser port) flow is given by:
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:12}
\begin{split}\Pi_{DiffuserFlow} = \sqrt{\frac{h_{L,parallelpath} - \frac{\Delta{H}_{Manifold}}{2}}{h_{L,parallelpath} + \frac{\Delta{H}_{Manifold}}{2}}}\end{split}
\end{equation}
The change in piezometric head is given by: \(\Delta{H}_{Manifold} = \frac{{v_{manifold}}^{2}}{2g}\)

The maximum allowable velocity in the manifold is given by:
\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:13}
\begin{split}{\Pi_{DiffuserFlow}}^{2} * \left(h_{L,parallelpath} + \frac{\Delta{H}_{Manifold}}{2} \right) = h_{L,parallelpath} - \frac{\Delta{H}_{Manifold}}{2}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:14}
\begin{split}\left({\Pi_{DiffuserFlow}}^{2} - 1 \right) h_{L,parallelpath} + \left({\Pi{DiffuserFlow}}^{2} + 1 \right) \frac{\Delta{H}_{Manifold}}{2} = 0\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:15}
\begin{split}\left(\frac{1 - {\Pi_{DiffuserFlow}}^{2}}{{\Pi_{DiffuserFlow}}^{2} + 1} \right) h_{L,parallelpath} = \frac{\Delta{H}_{Manifold}}{2}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Examples:Sedimentation/Sed_Examples:16}
\begin{split}\left(\frac{1 - {\Pi_{DiffuserFlow}}^{2}}{{\Pi_{DiffuserFlow}}^{2} + 1} \right) h_{L,parallelpath} = \frac{{v_{manifold}}^{2}}{4g}\end{split}
\end{equation}
Now, we want to find the maximum velocity for an inlet manifold which is dependent on the given flow distribution constraint, \(\Pi_{DiffuserFlow}\), and the head loss in the parallel paths, \(h_{L,ParallelPath}\).
\begin{enumerate}
\item {} 
Determine the relationship between diffuser exit velocity and the head loss in the parallel paths.

\item {} 
Determine an equation for maximum velocity for an inlet manifold in terms of diffuser exit velocity and the flow distribution constraint.**

\end{enumerate}

Write a function for maximum velocity for an inlet manifold using the equations you just found.

Exit losses from the diffusers dominate the head loss because the velocity in the diffuser slots is much higher than the velocity at the entrance to the diffuser pipes. Using the insight from the previous problem, it is reasonable to neglect the effect of the upflow velocity when calculating the exit head loss for the manifold diffusers.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Vel\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}diffuser\PYGZus{}flow}\PYG{p}{,} \PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}diffuser\PYGZus{}flow}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}diffuser\PYGZus{}flow}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

Head loss in the sedimentation tank is impacted by multiple forms of head loss, inlcuding head loss through the effluent launder and diffusers. Head loss through the effluent launder is about 4 cm. You found head loss through the diffusers in Problem 9.
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
Which form of head loss (effluent launder or diffuser) is in the parallel path, \({h}_{L,ParallelPath}\)?

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}sed\PYGZus{}manifold\PYGZus{}flow} \PYG{o}{=} \PYG{l+m+mf}{0.8}
\PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max} \PYG{o}{=} \PYG{n}{Vel\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}sed\PYGZus{}manifold\PYGZus{}flow}\PYG{p}{,} \PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum velocity in the sedimentation tank manifold is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} Only the diffuser head loss is in the parallel paths. The maximum velocity in the sedimentation tank manifold is 0.2313 meter / second.

The ratio of manifold pipe cross-sectional area to total diffuser cross-sectional area determines the flow distribution between diffusers.
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
Calculate the ratio of manifold pipe cross-sectional area to total diffuser cross-sectional area. You can use the velocities of the manifold and the diffusers to calculate the areas.

\end{enumerate}

Since the sedimentation tank has a constant volume, the flow rate into the tank is equal to the flow rate out of the tank:
\(Q_{manifold,pipe} = Q_{diff}\)

\(v_{manifold} * A_{manifold} = v{diff} * A_{diff}\)

\(\frac{A_{manifold}}{A_{diff}} = \frac{v_{diff}}{v_{manifold}}\)
\begin{enumerate}
\setcounter{enumi}{4}
\item {} 
What is the significance of the flow area ratio that you found? What does it tell you about the relative areas?

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow area ratio of manifold pipe to diffusers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{/} \PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The flow area ratio of manifold pipe to diffusers is 1.509 dimensionless. This means that the manifold flow area is larger than the total diffuser area. The flow distribution is more uniform because the diffuser velocity is higher than the manifold velocity.

The maximum sed tank flow rate is currently set by the constraint of using a single length of pipe for the manifold and launder. The maximum length of the upflow region of the sedimentation tank is 5.8 m, as given below.
\begin{enumerate}
\setcounter{enumi}{5}
\item {} 
What is the corresponding sedimentation tank flow rate? This can be solved using \(Q = \bar v A\).

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L\PYGZus{}sed\PYGZus{}upflow\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mf}{5.8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{flow\PYGZus{}sed\PYGZus{}max} \PYG{o}{=} \PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}upflow\PYGZus{}max} \PYG{o}{*} \PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{*} \PYG{n}{W\PYGZus{}sed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{The maximum flow rate in one sedimentation tank is}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{flow\PYGZus{}sed\PYGZus{}max}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The maximum flow rate in one sedimentation tank is 6.187 liter / second.

The maximum sed tank flow rate dictates the required pipe diameter for the manifold and launder.

7. What is the minimum inner diameter of the sedimentation tank manifold?
\(Q = \frac{\bar v*\pi*D^2}{4}\)

8. What is the required nominal pipe diameter given this flow rate?
The function from the pipe database can return the nominal diameter from the diameter and SDR.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{D\PYGZus{}sed\PYGZus{}manifold\PYGZus{}min}\PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{diam\PYGZus{}circle}\PYG{p}{(}\PYG{n}{flow\PYGZus{}sed\PYGZus{}max} \PYG{o}{/} \PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{)}
\PYG{n}{ND\PYGZus{}sed\PYGZus{}manifold} \PYG{o}{=} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ND\PYGZus{}SDR\PYGZus{}available}\PYG{p}{(}\PYG{n}{D\PYGZus{}sed\PYGZus{}manifold\PYGZus{}min}\PYG{p}{,} \PYG{n}{SDR}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum inner diameter of the sedimentation tank manifold is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{D\PYGZus{}sed\PYGZus{}manifold\PYGZus{}min}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The nominal diameter of the sedimentation tank manifold is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ND\PYGZus{}sed\PYGZus{}manifold}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The minimum inner diameter of the sedimentation tank manifold is 7.266 inch. The nominal diameter of the sedimentation tank manifold is 8 inch.


\section{Sedimentation Tank Bays and Number of Diffusers}
\label{\detokenize{Sedimentation/Sed_Examples:sedimentation-tank-bays-and-number-of-diffusers}}
The design will be for a 60 liter per second plant.
1. What is the total required plan area for the sedimentation tanks?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flow\PYGZus{}plant} \PYG{o}{=} \PYG{l+m+mi}{60} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{A\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total} \PYG{o}{=} \PYG{p}{(}\PYG{n}{flow\PYGZus{}plant} \PYG{o}{/} \PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The plant view area of the floc blanket is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{A\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The plant view area of the floc blanket is 60 square meters.
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
What is the total length of the floc blanket zone for all tanks?

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total} \PYG{o}{=} \PYG{p}{(}\PYG{n}{A\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total} \PYG{o}{/} \PYG{n}{W\PYGZus{}sed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The total length of the floc blanket zone for all tanks is 56.24 meters.
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
How many sedimentation tanks are required to treat the total plant flow?  The plant flow rate is the basis of design and the maximum sed tank flow rate is based on the manifold diameter.

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant} \PYG{o}{/} \PYG{n}{flow\PYGZus{}sed\PYGZus{}max}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The required number of sedimentation tanks is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The required number of sedimentation tanks is 10.
\begin{enumerate}
\setcounter{enumi}{3}
\item {} 
How much water (in L/s) can all of the sedimentation tanks for the plant treat?

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flow\PYGZus{}sed\PYGZus{}tanks\PYGZus{}total} \PYG{o}{=} \PYG{n}{flow\PYGZus{}sed\PYGZus{}max} \PYG{o}{*} \PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{flow\PYGZus{}sed\PYGZus{}tanks\PYGZus{}total}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The total amount of water this plant could treat is 61.87 liter / second. It is slightly larger than the basis of design due to the needs for an integer number of sedimentation tanks.
\begin{enumerate}
\setcounter{enumi}{4}
\item {} 
How many diffusers are required in each tank? Assume the maximum length of the upflow region of the sedimentation tank is used.

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}sed\PYGZus{}tank\PYGZus{}diffusers} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{floor}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{o}{/}\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}\PYG{p}{)} \PYG{o}{/} \PYG{n}{B\PYGZus{}diffuser}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of diffuser pipes per sed tank is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{N\PYGZus{}sed\PYGZus{}tank\PYGZus{}diffusers}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The number of diffuser pipes per sedimentation tank is 98.


\section{Plate Settler Design}
\label{\detokenize{Sedimentation/Sed_Examples:plate-settler-design}}
We will assume that the active area of the sedimentation tank is equal to the top area of the floc blanket zone. This isn’t quite right because of the geometric constraints from the floc hopper, inlet channel, settled water channel, and angled plates. However, it is a good approximation for these long tanks.
\begin{enumerate}
\item {} 
What is the required length of the plate settlers?

\end{enumerate}

The equation for this problem can be found in \DUrole{xref,std,std-ref}{Sedimentation Derivations}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L\PYGZus{}sed\PYGZus{}plate} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{s\PYGZus{}sed\PYGZus{}plate} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{o}{/}\PYG{n}{V\PYGZus{}sed\PYGZus{}capture}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{+} \PYG{n}{thickness\PYGZus{}sed\PYGZus{}plate} \PYG{o}{*} \PYG{p}{(}\PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{o}{/}\PYG{n}{V\PYGZus{}sed\PYGZus{}capture}\PYG{p}{)}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{angle\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{angle\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum length of the plate settlers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{L\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The minimum length of the plate settlers is 0.4619 meters.
\begin{enumerate}
\setcounter{enumi}{1}
\item {} 
What is the horizontal spacing (center to center) of the plate settlers?

\end{enumerate}

The equation for this problem can be found in \DUrole{xref,std,std-ref}{Sedimentation Derivations}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{B\PYGZus{}sed\PYGZus{}plate\PYGZus{}horizontal} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{thickness\PYGZus{}sed\PYGZus{}plate} \PYG{o}{+} \PYG{n}{s\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}\PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{angle\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The horizontal center to center spacing of the plate settlers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{B\PYGZus{}sed\PYGZus{}plate\PYGZus{}horizontal}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The horizontal center to center spacing of the plate settlers is 3.118 centimeter.
\begin{enumerate}
\setcounter{enumi}{2}
\item {} 
Approximately how many plate settlers spaces are needed in each sedimentation tank? Assume the maximum length of the upflow region of the sedimentation tank is used. Neglect the lost space at the end of the sedimentation tank due to the angle of the plate settlers.

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}sed\PYGZus{}plates\PYGZus{}pertank} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n+nb}{round}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{o}{/}\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}\PYG{p}{)} \PYG{o}{/} \PYG{n}{B\PYGZus{}sed\PYGZus{}plate\PYGZus{}horizontal}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of plate settlers per sedimentation tank is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{N\PYGZus{}sed\PYGZus{}plates\PYGZus{}pertank}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstylestrong{Answer:} The number of plate settlers per sedimentation tank is 180.


\section{Comments, Corrections, or Questions}
\label{\detokenize{Sedimentation/Sed_Examples:comments-corrections-or-questions}}
This textbook is an ever-evolving project. If you find any errors while you are reading, or if you find something unclear, please let the authors know. Write your comment in \sphinxhref{https://github.com/AguaClara/Textbook/issues/86}{this Github issue} and it will be addressed as soon as possible. Please look at other comments before writing your own to avoid duplicate comments.


\chapter{Sedimentation Design Solution}
\label{\detokenize{Sedimentation/Sed_Design_Solution:sedimentation-design-solution}}\label{\detokenize{Sedimentation/Sed_Design_Solution::doc}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}


\section{Introduction}
\label{\detokenize{Sedimentation/Sed_Design_Solution:introduction}}\label{\detokenize{Sedimentation/Sed_Design_Solution:heading-sed-design-challenge-solution}}
The AguaClara team would like to understand how to design larger sedimentation tanks. In this design challenge you will learn how some of the sedimentation tank components work together. The design for an entire sedimentation tank is somewhat complex and you are welcome to review the sedimentation tank design file to see the latest AguaClara design team solution. The sedimentation tank design has evolved rapidly since 2005 and our fabrication techniques have evolved as well.

In AguaClara sedimentation tanks the influent and effluent channels are located above the space occupied by the floc hopper. If you want to see how those geometric constraints are handled you can review the AguaClara sedimentation tank design file. Agua Para el Pueblo is building a 120 L/s plant for Gracias, the capital of Lempira, Honduras. This plant has 2 treatment trains and thus we can design each train for 60 L/s. For this design challenge you may assume the following:

For each step in the solution define a variable with a name that is easily understood so that it can be used later if needed. Consider using the AguaClara naming convention.

Use numpy for ceil, floor, sin, and pi.

The following cell has constants defined for you to use in designing your sedimentation tank. Read through and run it so you know what variables have been defined for you. See \hyperref[\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-edr-g-equations}]{Table \ref{\detokenize{Fluid_Deformation_and_Energy_Dissipation/FDED_Intro:table-edr-g-equations}}} for the plane jet constant.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} We are experimenting with using head loss at the exit of the diffusers as}
\PYG{c+c1}{\PYGZsh{} a reasonable design constraint for the design of the}
\PYG{c+c1}{\PYGZsh{} inlet manifold/diffuser system. This head loss in the exit of the diffuser}
\PYG{c+c1}{\PYGZsh{} will allow higher velocities (and pressure recovery) in the manifold pipe}
\PYG{c+c1}{\PYGZsh{} and thus will enable use of smaller diameter manifold pipes.}
\PYG{c+c1}{\PYGZsh{} \PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}}
\PYG{c+c1}{\PYGZsh{} We\PYGZsq{}ve set a maximum head loss in the sedimentation tank inlet:}
\PYG{n}{headloss\PYGZus{}sed\PYGZus{}inlet\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}

\PYG{c+c1}{\PYGZsh{} The manifold and diffuser pipes used in the sedimentation tank have an SDR of 26.}
\PYG{n}{SDR}\PYG{o}{=}\PYG{l+m+mi}{26}

\PYG{c+c1}{\PYGZsh{} Pi\PYGZus{}jet\PYGZus{}plane is used to estimate the maximum energy dissipation rate in a plane jet.}
\PYG{c+c1}{\PYGZsh{} A plane jet is uniform in one dimension. A plane jet can be formed by a long narrow slot.}
\PYG{c+c1}{\PYGZsh{} see table\PYGZus{}EDR\PYGZus{}G\PYGZus{}equations}
\PYG{n}{Pi\PYGZus{}jet\PYGZus{}plane} \PYG{o}{=} \PYG{l+m+mf}{0.0124}

\PYG{c+c1}{\PYGZsh{} Design temperature will be helpful to calculate viscosity}
\PYG{n}{T\PYGZus{}design} \PYG{o}{=} \PYG{l+m+mi}{15}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}

\PYG{c+c1}{\PYGZsh{} Plant Flowrate:}
\PYG{n}{flow\PYGZus{}plant} \PYG{o}{=} \PYG{l+m+mi}{60} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}

\PYG{c+c1}{\PYGZsh{} Upflow velocity at the top of the floc blanket:}
\PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}

\PYG{c+c1}{\PYGZsh{} The corrugated plastic sheets used to make the plate settlers:}
\PYG{n}{W\PYGZus{}sed} \PYG{o}{=} \PYG{l+m+mi}{42} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\PYG{n}{thickness\PYGZus{}sed\PYGZus{}plate} \PYG{o}{=} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}

\PYG{c+c1}{\PYGZsh{} The plate settlers are angled 60° from the horizontal:}
\PYG{n}{angle\PYGZus{}sed\PYGZus{}plate} \PYG{o}{=} \PYG{l+m+mi}{60} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{deg}

\PYG{c+c1}{\PYGZsh{} The plate setters are spaced 2.5cm apart (this is the perpendicular}
\PYG{c+c1}{\PYGZsh{} distance between plates, not the horizontal distance between plates):}
\PYG{n}{s\PYGZus{}sed\PYGZus{}plate} \PYG{o}{=} \PYG{l+m+mf}{2.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}

\PYG{c+c1}{\PYGZsh{} Plate settler capture velocity:}
\PYG{n}{V\PYGZus{}sed\PYGZus{}capture} \PYG{o}{=} \PYG{l+m+mf}{0.12} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}

\PYG{c+c1}{\PYGZsh{} The minimum port flow (from the first port) divided by the maximum port}
\PYG{c+c1}{\PYGZsh{} flow (from the last port) for flow division between sedimentation tanks}
\PYG{c+c1}{\PYGZsh{} and for flow distribution from the inlet manifold should be at least:}
\PYG{n}{Pi\PYGZus{}sed\PYGZus{}manifold\PYGZus{}flow} \PYG{o}{=} \PYG{l+m+mf}{0.8}

\PYG{n}{g} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}
\end{sphinxVerbatim}


\section{Diffusers}
\label{\detokenize{Sedimentation/Sed_Design_Solution:diffusers}}

\subsection{1:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id1}}
We will start our design of the sedimentation tank by considering the diffusers.
\begin{itemize}
\item {} 
Calculate the maximum velocity of water leaving the diffuser based on the maximum head loss. Assume that the majority of head loss is the kinetic energy of the flow exiting the diffuser slot (this assumption will be checked later). Assume K=1.

\item {} 
Calculate the minimum inner width of the diffuser. Assume that the diffuser slot is continuous over the entire length of the sedimentation tank to get an initial estimate (it isn’t actually continuous because it is made from many flattened diffuser pipes).

\end{itemize}

Define your answers as variables and then print those variables.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} minor loss equation with K=1}
\PYG{n}{V\PYGZus{}diffuser\PYGZus{}max} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{g} \PYG{o}{*} \PYG{n}{headloss\PYGZus{}sed\PYGZus{}inlet\PYGZus{}max}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum velocity of the sed tank diffusers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{V\PYGZus{}diffuser\PYGZus{}max}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} mass conservation}
\PYG{n}{W\PYGZus{}diffuser\PYGZus{}inner\PYGZus{}min} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{/} \PYG{n}{V\PYGZus{}diffuser\PYGZus{}max}\PYG{p}{)} \PYG{o}{*} \PYG{n}{W\PYGZus{}sed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum width of the sed tank diffusers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{W\PYGZus{}diffuser\PYGZus{}inner\PYGZus{}min}\PYG{p}{)}
\end{sphinxVerbatim}

The maximum velocity of the sed tank diffusers is 0.4429 meter / second
The minimum width of the sed tank diffusers is 2.409 millimeter


\subsection{2:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id2}}
Diffusers are made by deforming PVC pipe. Softened PVC pipe is forced onto a mold that shapes it into the rectangular shape of the diffuser (see slides from the Sedimentation Lecture).
\begin{itemize}
\item {} 
What metal plate thickness should be used to make the mold for the diffusers? This value will be the minimum diffuser width. Metal plates are available in 1/16” increments of thickness. The minimum thickness of plate that is strong enough for a mold is 1/16“.

\end{itemize}

Note: you can use the \sphinxcode{\sphinxupquote{ceil\_nearest}} function defined in \sphinxcode{\sphinxupquote{utility.py}} to do this elegantly. You can create an array of available metal plates using \sphinxcode{\sphinxupquote{numpy.arange}}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{W\PYGZus{}diffuser} \PYG{o}{=} \PYG{n}{ut}\PYG{o}{.}\PYG{n}{ceil\PYGZus{}nearest}\PYG{p}{(}\PYG{n}{W\PYGZus{}diffuser\PYGZus{}inner\PYGZus{}min}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{16}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{16}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The width of sed tank diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{W\PYGZus{}diffuser}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The width of sed tank diffuser is 0.3175 centimeter

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}Error} \PYG{o}{=} \PYG{l+m+mf}{0.1}
\PYG{n}{Headloss\PYGZus{}DosingTube\PYGZus{}Max} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{o}{*}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{n}{K\PYGZus{}Minor} \PYG{o}{=} \PYG{l+m+mi}{2}

\PYG{n}{Vel\PYGZus{}Tube\PYGZus{}Max} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}Error} \PYG{o}{*} \PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{Headloss\PYGZus{}DosingTube\PYGZus{}Max} \PYG{o}{*} \PYG{n}{g}\PYG{p}{)} \PYG{o}{/} \PYG{n}{K\PYGZus{}Minor}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{meter}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{equation}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:0}
\begin{split}Vel_{Tube,Max}=\left(\frac{2\,\Pi_{Error}\,Headloss_{DosingTube,Max}\,g}{K_{Minor}}\right)^{\frac{1}{2}}\end{split}
\end{equation}

\subsection{3:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id3}}
The PVC pipe that forms the diffusers changes in shape and wall thickness during the molding process. The inner width of the rectangle is created by forcing the pipe over a rectangular wedge that is the thickness you calculated above. During the molding process, PVC pipe wall cross-sectional area is conserved. The pipe wall is stretched in total length approximately 20\%. Another way to think about this is that the thickness of the wall is reduced by a factor of 1/1.2 because the mass of PVC is conserved and the density is unchanged. Thus, volume and cross-sectional area are conserved.
\begin{itemize}
\item {} 
Start by drawing a picture of what is happening to the deformation of the pipe as it is converted from the circular pipe to the rectangular diffuser slot (assume that the slot is a rectangle with perfectly square corners). You do not need to submit your sketches for this design challenge.
\begin{itemize}
\item {} 
Draw the initial circular pipe. Label the diagram with the appropriate variables for inner diameter, outer diameter, and wall thickness.

\item {} 
Draw the final rectangular diffuser slot. Label the diagram with the appropriate variables for length, width, and wall thickness.

\end{itemize}

\end{itemize}

Area is given using the following equation:
\begin{align}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:1}\!\begin{aligned}
Area_{PVC}=2\left (B_{diffuser}+W_{diffuser} \right )thickness_{wall}\\
- Use the equation for :math:`Area_{PVC}` to calculate the following:\\
- the outer length of the rectangular diffuser slot,
     :math:`B_{diffuser}`.
  - the inner length of the rectangular diffuser slot,
     :math:`W_{diffuser}`.\\
\end{aligned}\end{align}
Answering this question will require using functions from the
\sphinxcode{\sphinxupquote{pipedatabase}} file, imported here as \sphinxcode{\sphinxupquote{pipe}}.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{SDR}\PYG{o}{=}\PYG{l+m+mi}{26}

\PYG{c+c1}{\PYGZsh{} Assumed stretch of the PVC pipes as they are heated and molded:}
\PYG{n}{Pi\PYGZus{}PVC\PYGZus{}stretch} \PYG{o}{=} \PYG{l+m+mf}{1.2}

\PYG{c+c1}{\PYGZsh{} Nominal diameter of the sed tank diffuser}
\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}The cross\PYGZhy{}sectional area of the pipe wall is:}
\PYG{n}{area\PYGZus{}PVC} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{4}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{OD}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
                          \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
                          \PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}The thickness of the wall is reduced by the stretch factor:}
\PYG{n}{thickness\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}wall} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{pipe}\PYG{o}{.}\PYG{n}{OD}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{)}
                               \PYG{o}{\PYGZhy{}} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR}\PYG{p}{(}\PYG{n}{ND\PYGZus{}sed\PYGZus{}diffuser}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}\PYG{p}{)}
                              \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{Pi\PYGZus{}PVC\PYGZus{}stretch}\PYG{p}{)}
                              \PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} From geometry of the rectangular diffuser opening (assuming perfectly square corners) we have:}
\PYG{n}{B\PYGZus{}diffuser} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{area\PYGZus{}PVC} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{thickness\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}wall}\PYG{p}{)}\PYG{p}{)}
                            \PYG{o}{\PYGZhy{}} \PYG{n}{W\PYGZus{}diffuser}
                            \PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Sed diffuser outer length:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{B\PYGZus{}diffuser}\PYG{p}{)}

\PYG{n}{S\PYGZus{}diffuser} \PYG{o}{=} \PYG{n}{B\PYGZus{}diffuser} \PYG{o}{\PYGZhy{}} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{thickness\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}wall}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Sed diffuser inner length:}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{S\PYGZus{}diffuser}\PYG{p}{)}
\end{sphinxVerbatim}

Sed diffuser outer length: 5.736 centimeter
Sed diffuser inner length: 5.522 centimeter


\subsection{4:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id4}}
Each diffuser serves a certain width and length of the sedimentation tank. Assume that the diffusers are installed so that they touch each other.
\begin{itemize}
\item {} 
Determine the flow through each diffuser.

\item {} 
Determine the velocity through each diffuser.

\end{itemize}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flow\PYGZus{}max\PYGZus{}diffuser} \PYG{o}{=} \PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{*} \PYG{n}{W\PYGZus{}sed} \PYG{o}{*} \PYG{n}{B\PYGZus{}diffuser}

\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{=} \PYG{p}{(}\PYG{n}{flow\PYGZus{}max\PYGZus{}diffuser}
                    \PYG{o}{/} \PYG{p}{(}\PYG{n}{W\PYGZus{}diffuser} \PYG{o}{*} \PYG{n}{S\PYGZus{}diffuser}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow of water leaving a sed tank diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{flow\PYGZus{}max\PYGZus{}diffuser}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{ml}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The velocity of water leaving the sed tank diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{The flow of water leaving a sed tank diffuser is 61.19 milliliter / second}] \leavevmode
The velocity of water leaving the sed tank diffuser is 0.349 meter / second

\end{description}


\subsection{5:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id5}}
What is the Reynolds number of the jet exiting the diffusers?

Note: you will likely need to force Pint to display this as a dimensionless number.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Re\PYGZus{}diffuser\PYGZus{}jet} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{W\PYGZus{}diffuser} \PYG{o}{*} \PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)} \PYG{o}{/} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The Reynolds number for this jet is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Re\PYGZus{}diffuser\PYGZus{}jet}\PYG{p}{)}
\end{sphinxVerbatim}

The Reynolds number for this jet is 974.6 dimensionless


\subsection{6:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id6}}
What is the Reynolds number of the vertical flow up through the top of the floc blanket?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Re\PYGZus{}sed} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{W\PYGZus{}sed} \PYG{o}{*} \PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{p}{)} \PYG{o}{/} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Reynolds number through floc is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Re\PYGZus{}sed}\PYG{p}{)}
\end{sphinxVerbatim}

Reynolds number through floc is 938.2 dimensionless.


\subsection{7:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id7}}
Compare the two values for Reynolds numbers that you found for Problems 5 and 6. What do the Reynolds numbers for these very different flows tell you?

The Reynolds number is almost the same because mass conservation requires V*W to be a constant. The only difference in the Reynolds number is due to the fact that the plane jet isn’t quite continuous. It is broken by twice the thickness of the pipe wall between diffusers.


\subsection{8:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id8}}
Next, we want to determine the energy dissipation rate for the flow leaving the jet reverser. For this process, you can assume that the jet remains laminar. The flow spreads to fill the gaps created by the walls of the diffuser tubes by the time it traverses the jet reverser. Jet velocity and flow rate are conserved as the jet changes direction in the jet reverser.
\begin{itemize}
\item {} 
Calculate the thickness of the jet after it does the 180 degree bend of the jet reverser.

\item {} 
Calculate the energy dissipation rate for the flow leaving the jet reverser.

\end{itemize}

Convert your final answer to milliwatts per kilogram.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Calculate the thickness of the jet when it leaves the diffuser. B\PYGZus{}diff = S\PYGZus{}diff}

\PYG{n}{W\PYGZus{}jet\PYGZus{}reversed} \PYG{o}{=} \PYG{n}{W\PYGZus{}sed} \PYG{o}{*} \PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{/} \PYG{n}{V\PYGZus{}diffuser}

\PYG{c+c1}{\PYGZsh{}Calculate the maximum energy dissipation rate}

\PYG{n}{EDR\PYGZus{}inlet\PYGZus{}jet} \PYG{o}{=} \PYG{n}{Pi\PYGZus{}jet\PYGZus{}plane} \PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(} \PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}
                        \PYG{o}{/} \PYG{n}{W\PYGZus{}jet\PYGZus{}reversed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}


\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The energy dissipation rate for inlet jet is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{EDR\PYGZus{}inlet\PYGZus{}jet}\PYG{p}{)}
\end{sphinxVerbatim}

The energy dissipation rate for inlet jet is 172.5 milliwatt / kilogram


\subsection{9:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id9}}
In designing AguaClara plants, it is critical to account for all forms of significant head loss. In the sedimentation tank, effluent launders (the pipes that collect settled water at above the plate settlers) provide about 4 cm of head loss. That 4 cm of head loss is the majority of the head loss through an AguaClara sedimentation tank. We want to calculate the exit head loss for water leaving the inlet diffusers to determine whether it is a significant addition to the total head loss through the sedimentation tank.

Calculate this diffuser exit head loss in two ways. * First, calculate the head loss making sure to account for the upflow velocity in the sed tank. * Second, calculate the head loss but assume that the upflow velocity is negligible.
\begin{itemize}
\item {} 
Is it reasonable to neglect the upflow velocity in the sed tank when calculating this head loss?

\end{itemize}
\begin{equation}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:2}
\begin{split}h_e = \frac{\left( {{V_{in}} - {V_{out}}} \right)^2}{2g}\end{split}
\end{equation}
You will find that the exit head loss for water leaving the diffuser is high enough that we need to account for head loss in the sed tank inlet piping for our designs.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{\PYGZhy{}} \PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*}\PYG{n}{g}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit2} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)} \PYG{o}{*}\PYG{o}{*} \PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*}\PYG{n}{g}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}error}\PYG{o}{=}\PYG{p}{(}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit2}\PYG{o}{\PYGZhy{}}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1}\PYG{p}{)}\PYG{o}{/}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The best estimate of the exit head loss for the diffuser is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit1}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The 2nd estimate of the exit head loss for the diffuser ignoring the upflow velocity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}exit2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{It is reasonable to neglect the effect of the upflow velocity. The error is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{hl\PYGZus{}sed\PYGZus{}diffuser\PYGZus{}error}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{The best estimate of the exit head loss for the diffuser is 0.6176 centimeter}] \leavevmode
The 2nd estimate of the exit head loss for the diffuser ignoring the upflow velocity is 0.6211 centimeter
It is reasonable to neglect the effect of the upflow velocity. The error is 0.005755 dimensionless

\end{description}


\section{Manifold and Launders}
\label{\detokenize{Sedimentation/Sed_Design_Solution:manifold-and-launders}}
Flow distribution between and within sedimentation tanks is an important design component to ensure good sedimentation performance. We need to distribute flow uniformly between sedimentation tanks and also between diffusers on the inlet manifolds.

The following variable definitions and equations will be useful in answering later questions. * \({hl}_{ParallelPath}\) is the head loss (flow resistance) in the parallel paths leaving the manifold. The head loss in the parallel path is the total head loss from where the flow leaves the manifold to the point where the parallel flows reunite. * \(\Delta{H}_{Manifold}\) is the variability in piezometric head in the manifold that is driving the flow through the parallel paths.
\begin{itemize}
\item {} 
The ratio of minimum (first diffuser port) to maximum (last diffuser
port) flow is given by:

\end{itemize}
\begin{align}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:3}\!\begin{aligned}
\Pi_{DiffuserFlow} = \sqrt{\frac{{hl}_{ParallelPath}  - \frac{\Delta{H}_{Manifold}}{2}}{{hl}_{ParallelPath} + \frac{\Delta{H}_{Manifold}}{2}}}\\
- The change in piezometric head is given by:\\
\end{aligned}\end{align}\begin{align}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:4}\!\begin{aligned}
\Delta{H}_{Manifold} = \frac{{{Velocity}_{Manifold}}^{2}}{2g}\\
- The maximum allowable velocity in the manifold is given by:\\
\end{aligned}\end{align}\begin{equation}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:5}
\begin{split}{\Pi_{DiffuserFlow}}^{2} * \left({hl}_{ParallelPath} + \frac{\Delta{H}_{Manifold}}{2} \right) = {hl}_{ParallelPath}  - \frac{\Delta{H}_{Manifold}}{2}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:6}
\begin{split}\left({\Pi_{DiffuserFlow}}^{2} - 1 \right) {hl}_{ParallelPath} + \left({\Pi_{DiffuserFlow}}^{2} + 1 \right) \frac{\Delta{H}_{Manifold}}{2} = 0\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:7}
\begin{split}\left(\frac{1 - {\Pi_{DiffuserFlow}}^{2}}{{\Pi_{DiffuserFlow}}^{2} + 1} \right) {hl}_{ParallelPath} =  \frac{\Delta{H}_{Manifold}}{2}\end{split}
\end{equation}\begin{equation}\label{equation:Sedimentation/Sed_Design_Solution:Sedimentation/Sed_Design_Solution:8}
\begin{split}\left(\frac{1 - {\Pi_{DiffuserFlow}}^{2}}{{\Pi_{DiffuserFlow}}^{2} + 1} \right) {hl}_{ParallelPath} = \frac{{{Velocity}_{Manifold}}^{2}}{4g}\end{split}
\end{equation}

\subsection{10:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id10}}
Now, we want to find the maximum velocity for an inlet manifold which is dependent on the given flow distribution constraint,
\(\Pi_{DiffuserFlow}\), and the head loss in the parallel paths,
\({hl}_{ParallelPath}\).
\begin{itemize}
\item {} 
Determine the relationship between diffuser exit velocity and the head loss in the parallel paths.

\item {} 
Determine an equation for maximum velocity for an inlet manifold in terms of diffuser exit velocity and the flow distribution constraint.

\item {} 
Write a \sphinxstylestrong{function} for maximum velocity for an inlet manifold using the equations you just found.

\end{itemize}

Exit losses from the diffusers dominate the head loss because the velocity in the diffuser slots is much higher than the velocity at the entrance to the diffuser pipes. Using the insight from the previous problem, it is reasonable to neglect the effect of the upflow velocity when calculating the exit head loss for the manifold diffusers.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}h\PYGZus{}jet = V\PYGZus{}jet\PYGZca{}2/(2*g)}

\PYG{k}{def} \PYG{n+nf}{Vel\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}diffuser\PYGZus{}flow}\PYG{p}{,} \PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}diffuser\PYGZus{}flow}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
                                          \PYG{o}{/} \PYG{p}{(}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}diffuser\PYGZus{}flow}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{+}\PYG{l+m+mi}{1}\PYG{p}{)}
                                          \PYG{p}{)}
                                     \PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{11:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id11}}
Head loss in the sedimentation tank is impacted by multiple forms of head loss, including head loss through the effluent launder and diffusers. Head loss through the effluent launder is about 4 cm. You found head loss through the diffusers in Problem 9.
\begin{itemize}
\item {} 
Which form of head loss (effluent launder or diffuser) is in the parallel path, \({hl}_{ParallelPath}\)?

\end{itemize}

Use the function that you wrote for Problem 10 to calculate the maximum velocity in the inlet manifold of the sedimentation tank. Use the value for \sphinxcode{\sphinxupquote{Pi\_sed\_manifold\_flow}} given above. Use the diffuser exit velocity you found in Problem 4.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Only the diffuser head loss is in the parallel paths.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max} \PYG{o}{=} \PYG{n}{Vel\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}sed\PYGZus{}manifold\PYGZus{}flow}\PYG{p}{,} \PYG{n}{V\PYGZus{}diffuser}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum velocity in the sedimentation tank manifold is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{)}
\end{sphinxVerbatim}
\begin{description}
\item[{Only the diffuser head loss is in the parallel paths.}] \leavevmode
The maximum velocity in the sedimentation tank manifold is 0.2313 meter / second

\end{description}


\subsection{12:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id12}}
The ratio of manifold pipe cross-sectional area to total diffuser cross-sectional area determines the flow distribution between diffusers.
\begin{itemize}
\item {} 
Calculate the ratio of manifold pipe cross-sectional area to total diffuser cross-sectional area. You can use the velocities of the manifold and the diffusers to calculate the areas.

\item {} 
What is the significance of the flow area ratio that you found? What does it tell you about the relative areas?

\end{itemize}

Note: the flow distribution will be more uniform if the diffuser velocity is higher than the manifold velocity.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow area ratio of manifold pipe to diffusers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{p}{(}\PYG{n}{V\PYGZus{}diffuser} \PYG{o}{/} \PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{This means that the manifold flow area is larger than the total diffuser area.}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The flow area ratio of manifold pipe to diffusers is 1.509 dimensionless
This means that the manifold flow area is larger than the total diffuser area.


\subsection{13:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id13}}
The maximum sed tank flow rate is currently set by the constraint of using a single length of pipe for the manifold and launder. The maximum length of the upflow region of the sedimentation tank is 5.8 m, as given below. What is the corresponding sedimentation tank flow rate?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L\PYGZus{}sed\PYGZus{}upflow\PYGZus{}max} \PYG{o}{=} \PYG{l+m+mf}{5.8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}

\PYG{n}{flow\PYGZus{}sed\PYGZus{}max} \PYG{o}{=} \PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}upflow\PYGZus{}max} \PYG{o}{*} \PYG{n}{V\PYGZus{}sed\PYGZus{}up} \PYG{o}{*} \PYG{n}{W\PYGZus{}sed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{The maximum flow rate in one sedimentation tank is}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{flow\PYGZus{}sed\PYGZus{}max}\PYG{p}{)}
\end{sphinxVerbatim}

The maximum flow rate in one sedimentation tank is 6.187 liter / second


\subsection{14:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id14}}
The maximum sed tank flow rate dictates the required pipe diameter for the manifold and launder.
\begin{itemize}
\item {} 
What is the minimum inner diameter of the sedimentation tank manifold?

\item {} 
What is the required nominal pipe diameter given this flow rate? Use the \sphinxcode{\sphinxupquote{pipe.ND\_SDR\_available}} function.

\end{itemize}

SDR is the same as given in Problem 3 (SDR = 26).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{D\PYGZus{}sed\PYGZus{}manifold\PYGZus{}min}\PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{diam\PYGZus{}circle}\PYG{p}{(}\PYG{n}{flow\PYGZus{}sed\PYGZus{}max} \PYG{o}{/} \PYG{n}{V\PYGZus{}sed\PYGZus{}manifold\PYGZus{}max}\PYG{p}{)}

\PYG{n}{ND\PYGZus{}sed\PYGZus{}manifold} \PYG{o}{=} \PYG{n}{pipe}\PYG{o}{.}\PYG{n}{ND\PYGZus{}SDR\PYGZus{}available}\PYG{p}{(}\PYG{n}{D\PYGZus{}sed\PYGZus{}manifold\PYGZus{}min}\PYG{p}{,} \PYG{n}{SDR}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum inner diameter of the sedimentation tank manifold is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{D\PYGZus{}sed\PYGZus{}manifold\PYGZus{}min}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The nominal diameter of the sedimentation tank manifold is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ND\PYGZus{}sed\PYGZus{}manifold}\PYG{p}{)}
\end{sphinxVerbatim}

The minimum inner diameter of the sedimentation tank manifold is 7.266 inch
The nominal diameter of the sedimentation tank manifold is 8 inch


\section{Sedimentation Tank Bays and Number of Diffusers}
\label{\detokenize{Sedimentation/Sed_Design_Solution:sedimentation-tank-bays-and-number-of-diffusers}}

\subsection{15:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id15}}
What is the total required plan area for the sedimentation tanks? Calculate this using the design flow rate and the upflow velocity between the floc blanket and plate settlers.

Give your final answer in square meters.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{A\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total} \PYG{o}{=} \PYG{p}{(}\PYG{n}{flow\PYGZus{}plant} \PYG{o}{/} \PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The plant view area of the floc blanket is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{A\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{p}{)}
\end{sphinxVerbatim}

The plant view area of the floc blanket is 60 meter ** 2


\subsection{16:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id16}}
What is the total length of the floc blanket zone for all tanks? Calculate this using the total required plan area for the sedimentation tank and the sedimentation tank width.

This total length will enable you to calculate how many sed tanks are required.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total} \PYG{o}{=} \PYG{p}{(}\PYG{n}{A\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total} \PYG{o}{/} \PYG{n}{W\PYGZus{}sed}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{p}{)}
\end{sphinxVerbatim}

56.24 meter


\subsection{17:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id17}}
How many sedimentation tanks are required to treat the total plant flow? Calculate this using the the total plant flow rate and the maximum sed tank flow rate. The plant flow rate is the basis of design and the maximum sed tank flow rate is based on the manifold diameter.

Your answer should be an integer value.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{ceil}\PYG{p}{(}\PYG{n}{flow\PYGZus{}plant} \PYG{o}{/} \PYG{n}{flow\PYGZus{}sed\PYGZus{}max}\PYG{p}{)}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The required number of sedimentation tanks is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}\PYG{p}{)}
\end{sphinxVerbatim}

The required number of sedimentation tanks is 10


\subsection{18:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id18}}
How much water (in L/s) can all of the sedimentation tanks for the plant treat? Assume that all tanks have been built to maximum length.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flow\PYGZus{}sed\PYGZus{}tanks\PYGZus{}total} \PYG{o}{=} \PYG{n}{flow\PYGZus{}sed\PYGZus{}max} \PYG{o}{*} \PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{flow\PYGZus{}sed\PYGZus{}tanks\PYGZus{}total}\PYG{p}{)}
\end{sphinxVerbatim}

61.87 liter / second
If we use this design approach the plant design capacity will slightly exceed the requested 120 L/s. We are still working on setting the optimal design for a single sedimentation tank.


\subsection{19:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id19}}
How many diffusers are required in each tank? Assume the maximum length of the upflow region of the sedimentation tank is used. Use the \sphinxcode{\sphinxupquote{np.floor}} function to round down to an integer value.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}sed\PYGZus{}tank\PYGZus{}diffusers} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{floor}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{o}{/}\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}\PYG{p}{)} \PYG{o}{/} \PYG{n}{B\PYGZus{}diffuser}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of diffuser pipes per sed tank is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{N\PYGZus{}sed\PYGZus{}tank\PYGZus{}diffusers}\PYG{p}{)}
\end{sphinxVerbatim}

The number of diffuser pipes per sed tank is 98


\section{Plate Settlers}
\label{\detokenize{Sedimentation/Sed_Design_Solution:plate-settlers}}
You may assume that the active area of the sedimentation tank is equal to the top area of the floc blanket zone. This isn’t quite right because of the geometric constraints from the floc hopper, inlet channel, settled water channel, and angled plates. However, it is a good approximation for these long tanks. We will use this approximation to determine the plate settler details.


\subsection{20:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id20}}
What is the required length of the plate settlers? Do not neglect the thickness of the plate settlers.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L\PYGZus{}sed\PYGZus{}plate} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{s\PYGZus{}sed\PYGZus{}plate} \PYG{o}{*} \PYG{p}{(}\PYG{p}{(}\PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{o}{/}\PYG{n}{V\PYGZus{}sed\PYGZus{}capture}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}
                  \PYG{o}{+} \PYG{n}{thickness\PYGZus{}sed\PYGZus{}plate} \PYG{o}{*} \PYG{p}{(}\PYG{n}{V\PYGZus{}sed\PYGZus{}up}\PYG{o}{/}\PYG{n}{V\PYGZus{}sed\PYGZus{}capture}\PYG{p}{)}\PYG{p}{)}
                 \PYG{o}{/} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{angle\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{angle\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}\PYG{p}{)}
                 \PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum length of the plate settlers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{L\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}
\end{sphinxVerbatim}

The minimum length of the plate settlers is 0.4619 meter


\subsection{21:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id21}}
What is the horizontal spacing (center to center) of the plate settlers?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{B\PYGZus{}sed\PYGZus{}plate\PYGZus{}horizontal} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{thickness\PYGZus{}sed\PYGZus{}plate} \PYG{o}{+} \PYG{n}{s\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}
                                    \PYG{o}{/} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{angle\PYGZus{}sed\PYGZus{}plate}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The horizontal center to center spacing of the plate settlers is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{B\PYGZus{}sed\PYGZus{}plate\PYGZus{}horizontal}\PYG{p}{)}
\end{sphinxVerbatim}

The horizontal center to center spacing of the plate settlers is 3.118 centimeter


\subsection{22:}
\label{\detokenize{Sedimentation/Sed_Design_Solution:id22}}
Approximately how many plate settlers spaces are needed in each sedimentation tank? Assume the maximum length of the upflow region of the sedimentation tank is used. Neglect the lost space at the end of the sedimentation tank due to the angle of the plate settlers.

Round your answer to the closest integer value.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}sed\PYGZus{}plates\PYGZus{}pertank} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n+nb}{round}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{p}{(}\PYG{n}{L\PYGZus{}sed\PYGZus{}flocblanket\PYGZus{}total}\PYG{o}{/}\PYG{n}{N\PYGZus{}sed\PYGZus{}tanks}\PYG{p}{)} \PYG{o}{/} \PYG{n}{B\PYGZus{}sed\PYGZus{}plate\PYGZus{}horizontal}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The number of plate settlers per sedimentation tank is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{N\PYGZus{}sed\PYGZus{}plates\PYGZus{}pertank}\PYG{p}{)}
\end{sphinxVerbatim}

The number of plate settlers per sedimentation tank is 180

Congratulations on making it this far! Although we haven’t designed every component in the sedimentation tank, you have a good idea of the analysis that is required for systematic parametric design. We have not covered the topics of the inlet channel, the launder that removes clean water from the top of the sedimentation tank, the floc weir or floc hopper, or the system of equations used to calculate the final depth of the sedimentation tank. The detailed design required to create a high-performing sedimentation tank is sophisticated, complicated, and if you are successful the resulting sedimentation tank is high-performing and easy to maintain!


\chapter{Filtration  Introduction}
\label{\detokenize{Filtration/Filtration_Intro:filtration-introduction}}\label{\detokenize{Filtration/Filtration_Intro:title-filtration-introduction}}\label{\detokenize{Filtration/Filtration_Intro::doc}}
“If the water is dirty, then filter it.” That is a common misunderstanding of what we should do if the water is dirty. And that misunderstanding has led to many, many failures of water treatment technologies. There are slow sand filters and multistage filters abandoned in many corners of Honduras. The first AguaClara plant at Marcala, Honduras was built in an abandoned filtration plant. In many cases the failed filters were installed in locations where the raw water carried far too much sediment to be treated by filtration. This common misunderstanding of the capabilities of sand filters has a long history.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{Abandoned_Filtration_Plant}.jpg}
\caption{Abandoned multiple stage filtration plant in the valley north of Tegucigalpa, Honduras.}\label{\detokenize{Filtration/Filtration_Intro:id3}}\label{\detokenize{Filtration/Filtration_Intro:figure-abandoned-filtration-plant}}\end{figure}


\section{History of Filtration}
\label{\detokenize{Filtration/Filtration_Intro:history-of-filtration}}
Starting in 1829 surface water treatment plants in England used slow sand filters. Decades later in 1885 they discovered that slow sand filters actually remove bacteria. That was quite a surprise given that the pores in slow sand filters are perhaps 50 times larger than the bacteria that they remove! Clearly filters were doing something more interesting than simply straining out particles that were bigger than the pores.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{glass_beads_and_flow_constriction}.jpg}
\caption{Sample taken from the top of a slow sand filter made with glass beads. Note the constriction that is building in the narrowest part of the void between 4 glass beads.}\label{\detokenize{Filtration/Filtration_Intro:id4}}\label{\detokenize{Filtration/Filtration_Intro:figure-glass-beads-and-flow-constriction}}\end{figure}

Slow sand filtration ran into big trouble when they were installed in cities along the Ohio and Mississippi Rivers in the United States. The high sediment load carried by those rivers could not be removed using slow sand filters. The need to treat water with high sediment loads (high turbidities) led to the innovation of coupling flocculation, sedimentation, and a new kind of filter - rapid sand filters. The early emphasis on filtration as the primary process persisted and continues even today. For example, the surface water treatment plant that provides drinking water to the Cornell University campus is called Cornell Water Filtration Plant.

The process that removes most of the particles in the Cornell Water Filtration Plant is the sedimentation tank with big assistance from the flocculators. The rapid sand filters are a polishing step that removes approximately 1 NTU or about 1 mg/L of solids. This is not to diminish the importance of filtration. After all, this chapter is all about filtration. The goal is to put filtration in context and remind all of us that both slow and rapid sand filters are limited to polishing water that is already very clean.


\subsection{Slow Sand Filters}
\label{\detokenize{Filtration/Filtration_Intro:slow-sand-filters}}
Slow sand filters don’t use coagulants or pretreatment. They are suited for surface waters coming from pristine watersheds. They are a passive technology in that there is no way for an operator to improve performance other than to clean the filter.

Slow sand filters are sometimes called bio filters, a misunderstanding that has persisted from the early observations that biofilms grow (or are imported) in the sand bed. Although biofilms do form in slow sand filters it is unlikely that they play a role in particle removal. Weber-Shirk demonstrated that removal of E. coli by slow sand filters was insignificant even when the filters had 1 m of head loss due to biofilm growth. Weber-Shirk also demonstrated that slow sand filters perform well even when poisoned with azide. Weber-Shirk also demonstrated that predation by a small protozoan, a chrysophyte, can play a role in the removal of bacteria. The chrysophyte is too small to ingest protozoan pathogens such as cryptosporidium or Giardia lamblia and thus those organisms are likely only removed by physical-chemical means. Similarly it is unlikely that the chrysophyte wastes energy on ingesting virus particles. The dominant particle removal mechanism in slow sand filters is physical-chemical and is the same mechanisms at work in rapid sand filters. Naturally occurring aluminum creates sticky surfaces in the sand bed and makes some of the influent particles sticky. It is likely that aluminum content in the raw water plays a significant role in slow sand filter performance. The aluminum hydroxide nanoparticle “glue” is likely able to effect the removal of a wide range of particle sizes.

Slow sand filters remove the majority of the particles in the top cm of the sand bed. A schmutzdecke (filter cake or layer of dirt) generally forms on top of the sand and this layer of dirt causes the majority of the head loss thru the filter bed. It is this thin layer that is removed when the head loss is too high to achieve the desired flow rate through the filter. Most slow sand filters are cleaned by hand using shovels to remove a thin layer of the schmutzdecke. The cleaning process is labor intensive and requires taking the filter offline for a day or longer.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{SSF_at_Jesus_de_Otoro}.jpg}
\caption{Slow sand filters at Jesus de Otoro, Honduras. Slow sand filters require extensive areas of flat terrain or extensive earthwork to create a level spot. In the tropics the filters are open to the sky and that results in nuisance growth of algae. In climates where freezing is a problem the filters are covered.}\label{\detokenize{Filtration/Filtration_Intro:id5}}\label{\detokenize{Filtration/Filtration_Intro:figure-ssf-at-jesus-de-otoro}}\end{figure}


\subsection{Multistage filters}
\label{\detokenize{Filtration/Filtration_Intro:multistage-filters}}
Multistage filters were invented to extend the range of applicability of slow sand filters. Slow sand filters were viewed as an appropriate technology for rural communities, but their very limited ability to treat water with suspended solids made them inappropriate for communities that have surface water sources with high turbidity during runoff events. Roughing filters made with various sizes of gravel were added to remove sediment. The roughing filters were essentially inefficient sedimentation tanks with 60\% of their volume occupied by rocks! Roughing filters were also difficult to clean and without using coagulants their particle removal efficiency was poor. Nonetheless, multistage filters have been built in many rural communities in Latin America.


\subsection{Rapid Sand Filters}
\label{\detokenize{Filtration/Filtration_Intro:rapid-sand-filters}}
It is always interesting to try to understand why different technologies were invented and specifically what problem they were trying to solve. One possibility is that goal was to reduce the labor required for cleaning slow sand filters by devising a system to clean the sand in place. Given the idea of fluidizing the bed of sand with a high upflow velocity it then became tempting evolve to higher flow rates during filtration because having to clean the filter frequently was no longer a problem. Another possibility is that rapid sand filters were invented to handle higher turbidity water, but that isn’t supported by the capabilities of rapid sand filters. Slow and rapid sand filters have very similar maximum influent water turbidity limits. Thus the real advantage to rapid sand filters is that they can be cleaned quickly.

Many rapid sand filters use 2 or 3 different densities and sizes of filter media to achieve a system with large pores at the surface of the filter and smaller pores deeper within the filter. If sand with a wide range of sizes is fluidized the small sand grains quickly rise to the top and the large sand grains fall to the bottom. Thus a poorly sieved sand will have small pores at the top and large pores at the bottom after backwash. The trick to creating a mix of filter media that results in big pores on the top is to use low density, large diameter media with a lower terminal velocity than a higher density, small diameter media. During backwash the less dense media ends up on top and thus this reverse stratification is achieved.

Given that many installed rapid sand filters are dual media it is worth reflecting on what problem the dual media filters are designed to solve. One possible problem is surface clogging of the sand filter when large, strong flocs bridge across sand pores and then support a layer of flocs above the sand bed. This surface layer would be similar to the schmutzdecke in slow sand filters and could be the location of significant head loss. It appears that rapid sand filters do suffer from surface clogging in some instances. Of course, it is possible that this failure is related to the use of flocculent aids that result in excessively strong flocs and/or sedimentation tanks that don’t effectively capture large flocs.

Additional potential benefits of dual media filtration include the possibility that they can hold a larger mass of particles before requiring backwash or that they may be able to achieve higher particle removal efficiency. \sphinxhref{https://doi.org/10.1016/j.desal.2006.02.102}{Zouboulis et al.} compared single and dual media filtration and demonstrated that the main advantage to dual media filtration was that it had a lower rate of head loss accumulation. Given that the rate of increase of head loss for the dual media filters was constant over time suggests that the pores that were doing the filtration were exclusively in the larger of the two media. This suggests that larger diameter media (rather than dual media) might be a better choice for rapid sand filters.

Dual media filters face more challenges during cleaning. The use of relatively low density media for the top layer results in a lower density fluidized bed. This lower density fluidized bed makes it possible for flocs to form mudballs that are sufficiently dense to fall through the top layer of media during backwash (page 221 of Water and Wastewater Technology, 6th edition, by Hammer and Hammer, 2008). The formation of these mudballs is one of the reasons that dual media filters use air scour before or during backwash to breakup the mudballs.

The addition of flocculation and sedimentation prior to filtration changes the properties of the incoming particles. The settled water contains small flocs and primary particles with some coagulant nanoparticles attached. These particles are sticky and the stickiness undoubtedly influences the physics of the particle attachment processes inside the sand bed. We will talk more about the mysteries of life inside a filter bed later in this chapter.

Rapid sand filters rely on a backwash system.  It takes a relatively high velocity of water to fluidize a bed of sand and that water has to come from somewhere. In conventional water treatment plants that water comes from a clearwell that is filled with filtered water. During backwash water from the clearwell is pumped through the filter and then either wasted or returned to the head of the plant for another pass through the treatment processes. The need for pumps is one of the big disadvantages of conventional rapid sand filters. Conventional rapid sand filters fail if they lose power or if there isn’t enough filtered water in the clearwell when the filter needs to be backwashed. This raises an interesting question about how rapid sand filters are initially commissioned at water treatment plants given that the clearwell is initially empty and given that filters MUST BE FILLED WITH WATER FROM THE BOTTOM. If you dump water on top of a dry filter bed the water will create a few paths down through the sand and the majority of the sand pores will remain filled with air even when the level of water floods the top of the filter bed. Thus the first operation in rapid sand filter startup must be backwash!

One solution for eliminating the need for backwash pumps is to design a set of filters that work together to backwash one of the filters. This eliminates the need for a clearwell for backwash water. This system of a set of filters is used by \sphinxhref{http://cepis.org.pe/sobre-el-cepis/}{CEPIS} in their design of \sphinxhref{../\_static/references/CEPIS/CEPIS5\_Batería\_de\_filtros.pdf}{rapid sand filters} This system is an elegant solution that works well for small cities, but the requirement of 6 filters is onerous for towns where 2 filters should have been sufficient.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=300\sphinxpxdimen]{{CEPIS_filter_set}.jpg}
\caption{6 filters form a complete set such that 5 filters can work together to backwash one filter without using pumps.}\label{\detokenize{Filtration/Filtration_Intro:id6}}\label{\detokenize{Filtration/Filtration_Intro:figure-cepis-filter-set}}\end{figure}


\subsection{Stacked Rapid Sand Filters}
\label{\detokenize{Filtration/Filtration_Intro:stacked-rapid-sand-filters}}
Stacked Rapid Sand, StaRS, filters were invented in 2010 by the AguaClara Cornell program in response to the need for a new technology that would both eliminate the need for backwash pumps AND not require the construction of 6 filters for small towns. StaRS filters use 6 20 cm deep layers of sand (no dual media here) with the layers stacked vertically. The six layers give a total sand depth of 1.2 m. The filter operates with the same design flow rate for both backwash and filtration modes and uses settled water for backwash. This eliminates the startup problem for rapid sand filters that don’t have an initial source of backwash water. The shallow filter layers take advantage of new insights into the filtration mechanisms (more on that soon).

StaRS filters come in two configurations. Open StaRS (OStaRS) are used for flow rates greater than about 8 L/s. An 8 L/s filter has a plan view area of 85 cm x 85 cm. This is considered the minimum size that can be constructed with a human working inside the filter. For lower flow rates Enclosed StaRS (EStaRS) filters can be assembled using PVC pipe as the body of the filter. The inner plumbing can be accessed through openings in the top and bottom of the main filter body.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{Q\PYGZus{}Filter} \PYG{o}{=} \PYG{l+m+mi}{8} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{V\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{=} \PYG{l+m+mi}{11} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{A\PYGZus{}Filter} \PYG{o}{=} \PYG{n}{Q\PYGZus{}Filter}\PYG{o}{/}\PYG{n}{V\PYGZus{}filter\PYGZus{}backwash}
\PYG{n}{W\PYGZus{}Filter} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{A\PYGZus{}Filter}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The width of a filter designed to treat }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Q\PYGZus{}Filter}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{W\PYGZus{}Filter}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Relative velocities and areas for different unit processes.}\label{\detokenize{Filtration/Filtration_Intro:id7}}\label{\detokenize{Filtration/Filtration_Intro:table-net-velocities}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{20}{120}|\X{20}{120}|\X{20}{120}|\X{20}{120}|\X{20}{120}|\X{20}{120}|}
\hline
\sphinxstyletheadfamily 
Filter Type
&\sphinxstyletheadfamily 
Velocity (mm/s)
&\sphinxstyletheadfamily 
Cleaning (mm/s)
&\sphinxstyletheadfamily 
Max (NTU)
&\sphinxstyletheadfamily 
pC*
&\sphinxstyletheadfamily 
Area \((m^2)\) for 1 L/s
\\
\hline
Dynamic
&
0.4
&&&
0
&
2.5
\\
\hline
Roughing
&
0.17
&
5.5 mm/s downflow
&&
0.5
&
5.9
\\
\hline
Slow
&
0.04
&
Scrape surface
&
10
&
0.8
&
25
\\
\hline
Multistage
&
0.03
&&
100
&
1.3
&
33.4
\\
\hline
Rapid
&
0.7 - 2.8
&
11 mm/s backwash
&
5
&
1
&
0.55
\\
\hline
AC Entrance
&
8
&&&&
0.125
\\
\hline
AC Flocculation
&
4
&&&&
0.25
\\
\hline
AC Sedimentation
&
1
&&&
2.5
&
1
\\
\hline
AC Floc Hopper
&
5
&&&&
0.2
\\
\hline
AC Stacked Rapid
&
1.8*6
&
11 mm/s backwash
&
3
&
1
&
0.093
\\
\hline
AC total
&
0.6
&&
1000
&
3.5
&
1.67
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

The slowest (and hence largest) unit process in the AguaClara surface water treatment train is sedimentation. Thus sedimentation represents the most likely opportunity for significant cost reduction. The entire AguaClara treatment train is a fraction of the size of the dynamic filters that are used in multiple stage filtration plants.

Filters remove the least amount of contaminants in a surface water treatment plant.

Filters have a huge range in velocities that correspond to a huge range in size. This is illustrated in the city of Jesus de Otoro, Honduras. They have both a 20 L/s multiple stage filtration plant and a 20 L/s AguaClara plant serving different sections of the city. The plants can both be seen in \sphinxhref{https://www.google.com/maps/d/u/0/viewer?mid=1Rjl2cfjMn0Pk7E11KVq9A1mlj2Q\&ll=14.491993514824715\%2C-87.97505904373156\&z=16}{Google Maps}.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Size_of_Jesus_de_Otoro_Plants}.png}
\caption{Two water treatment plants using different technologies and serving the same city illustrate the high construction cost of low technologies simply based on the required size of the low tech facilities.}\label{\detokenize{Filtration/Filtration_Intro:id8}}\label{\detokenize{Filtration/Filtration_Intro:figure-size-of-jesus-de-otoro-plants}}\end{figure}


\section{Porosity}
\label{\detokenize{Filtration/Filtration_Intro:porosity}}\label{\detokenize{Filtration/Filtration_Intro:heading-porosity}}
Porosity of a sand bed refers to the ratio of the void volume to the total volume of the sand bed.
\begin{equation}\label{equation:Filtration/Filtration_Intro:porosity}
\begin{split} \phi_{FiSand} = \frac{\rlap{--} V_{voids}}{\rlap{--} V_{total}}\end{split}
\end{equation}
Porosity is determined by the geometry of the material and the size distribution (or uniformity of the particle sizes) and not by the average size of the particles. If you have three different sized spheres (such as  1 um clay, 0.2 mm sand, and 1 cm gravel) in three different buckets, each bucket will have the same porosity as seen in \hyperref[\detokenize{Filtration/Filtration_Intro:figure-porosity}]{Fig.\@ \ref{\detokenize{Filtration/Filtration_Intro:figure-porosity}}}. To minimize the porosity, the three materials could be mixed because the smaller materials would be filling the pore space of the larger material.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics{{figure_porosity}.png}
\caption{Within each box, the spheres are different sizes. However the total porosity is the same. To minimize the pore space, the smaller particles could be used to fill the spore space between the larger particles, though in a filter this is not necessarily ideal.}\label{\detokenize{Filtration/Filtration_Intro:id9}}\label{\detokenize{Filtration/Filtration_Intro:figure-porosity}}\end{figure}

One way that the relative size of particles is characterized is by describing the size of the smallest 10\% of grains, and the smallest 60\% of grains. That is:

\(D_{10}\) = the sieve size that passes 10\% by mass of sand through

\(D_{60}\) = the sieve size that passes 60\% by mass of sand through

\(D_{10}\) is used for particle removal models, and \(D_{60}\) is used for hydraulic modeling.

The ratio of the two is the uniformity coefficient:
\begin{equation}\label{equation:Filtration/Filtration_Intro:uniformity_coefficient}
\begin{split} UC = \frac{D_{60}}{D_{10}}\end{split}
\end{equation}
The uniformity coefficient describes the uniformity of the sand. A \(UC = 1\) indicates that every grain of sand is the same size, which is the ideal case. A large \(UC\) is indicative of a wide range of grain sizes which will result in stratification of the sand bed after backwash with fine sand on top. This will result in more rapid development of head loss during filtration. The fine sand on top will also expand more during backwash and could result in loss of sand during backwash.

During backwash, the sand is fluidized and the sand bed expands. This expansion causes a change in porosity of the sand bed (as the volume of water occupied by the sand is increased). The porosity and height of the sand bed are directly related through the following equation:
\begin{equation}\label{equation:Filtration/Filtration_Intro:backwash_porosity}
\begin{split} \phi_{FiSandBw} = \frac{\phi_{FiSand} H_{FiSand} A_{Fi} + \left( H_{FiSandBw} - H_{FiSand} \right) A_{Fi}}{H_{FiSandBw} A_{Fi}}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\phi_{FiSandBw}\) = sand porosity during backwash
\item[] \(\phi_{FiSand}\) = settled sand porosity
\item[] \(H_{FiSand}\) = height of sand in the filter
\item[] \(H_{FiSandBw}\) = height of sand during backwash
\item[] \(A_{Fi}\) = filter area
\end{DUlineblock}

From this it becomes possible to directly relate porosity (as above) to the filter expansion ratio, which is simply the ratio of the heights of the expanded sand bed and the settled sand bed:
\begin{align}\label{equation:Filtration/Filtration_Intro:Filtration/Filtration_Intro:0}\!\begin{aligned}
:label: filter_expansion_ratio\\
\Pi_{FiBw} = \frac{H_{FiSandBw}}{H_{FiSand}}\\
\end{aligned}\end{align}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(\Pi_{FiBw}\) = the expansion ratio value
\item[] \(H_{FiSand}\) = height of sand in the filter
\item[] \(H_{FiSandBw}\) = height of sand during backwash
\end{DUlineblock}


\section{Filtration Clean Bed Head loss}
\label{\detokenize{Filtration/Filtration_Intro:filtration-clean-bed-head-loss}}\label{\detokenize{Filtration/Filtration_Intro:clean-sand-head-loss}}
The Carman Kozeny Equation, an adaptation of the Hagen-Poiseuille equation :eq:{}`{}` describes the head loss through a clean bed during filtration. The Ergun equation \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_Ergun} can also be used to estimate head loss in porous media.
\begin{equation}\label{equation:Filtration/Filtration_Intro:eq_Carman_Kozeny}
\begin{split} \frac{h_l}{H_{FiSand}} = 36 k \frac{\left( 1 - \phi_{FiSand} \right)^2}{\phi_{FiSand}^3} \frac{\nu \bar v_a}{g D_{60}^2}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] where
\item[] \(h_l\) = head loss in sand bed
\item[] \(H_{FiSand}\) = the sand bed depth/length of flow paths
\item[] \(\phi_{FiSand}\) = porosity of sand
\item[] \(\nu\) = kinematic viscosity
\item[] \(\bar v_a\) = the approach velocity (the velocity the water would have if the filter didn’t have any sand!)
\item[] \(D_{60}\) = the size of the sand
\item[] \(g\) = gravity
\item[] \(k\) = Kozeny constant (5 for most filtration cases)
\end{DUlineblock}

This equation is valid for Reynolds numbers less than 6. Where:
\({\rm Re}  = \frac{D_{60} \bar v_a}{\nu}\)


\section{Backwash Head Loss}
\label{\detokenize{Filtration/Filtration_Intro:backwash-head-loss}}\label{\detokenize{Filtration/Filtration_Intro:backwash-head-loss-force-balance}}
To determine the head loss during backwash a force balance can be performed between the water and the sand per unit of filter area (thus pressure values will be yielded). A schematic for this system is shown below:

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=0.500\linewidth]{{figure_force_balance}.png}
\caption{The pressure required to hold up the fluidized sand must equal the pressure in the manometer.}\label{\detokenize{Filtration/Filtration_Intro:id10}}\label{\detokenize{Filtration/Filtration_Intro:figure-force-balance}}\end{figure}

The pressure from the water in the manometer:
\begin{equation}\label{equation:Filtration/Filtration_Intro:Filtration/Filtration_Intro:1}
\begin{split}P_{Manometer} = \rho_{Water} g \left( H_{W_1} + H_{W_2} + \phi_{FiSand} H_{FiSand} \right) + \rho_{Sand} g \left( 1 - \phi_{FiSand} \right) H_{FiSand}\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(P_{Manometer} =\) total height from the bottom of the filter to the inlet box
\item[] \(\rho_{Water} =\) density of water
\item[] \(H_{W_1} =\) the distnace from the top of the settled sand bed to the water surface in the filter
\item[] \(H_{W_2} =\) the height of the water below the sand bed but within the filter
\item[] \(\phi_{FiSand} =\) porosity of sand
\item[] \(H_{FiSand} =\) height of the filter bed
\item[] \(\rho_{Sand} =\) density of sand
\end{DUlineblock}

The pressure from the sand and water in the filter:
\begin{equation}\label{equation:Filtration/Filtration_Intro:Filtration/Filtration_Intro:2}
\begin{split}P_{Manometer} = \rho_{Water} g \left( H_{W_1} + H_{W_2} + H_{FiSand} + h_{l_{FiBw}} \right)\end{split}
\end{equation}
\begin{DUlineblock}{0em}
\item[] Such that:
\item[] \(h_{l_{FiBw}} =\) the difference in height of the inlet and water surface height during backwash; the backwash head loss
\end{DUlineblock}

Setting them equal for a force balance:
\begin{equation}\label{equation:Filtration/Filtration_Intro:Filtration/Filtration_Intro:3}
\begin{split}\rho_{Water} g \left( H_{W_1} + H_{W_2} + \phi_{FiSand} H_{FiSand} \right) + \rho_{Sand} g \left( 1 - \phi_{FiSand} \right) H_{FiSand} = \rho_{Water} g \left( H_{W_1} + H_{W_2} + H_{FiSand} + h_{l_{FiBw}} \right)\end{split}
\end{equation}
Which simplifies to:
\begin{align}\label{equation:Filtration/Filtration_Intro:Filtration/Filtration_Intro:4}\!\begin{aligned}
h_{l_{FiBw}} = \frac{\rho_{Sand} - \rho_{Water}}{\rho_{Water}} \left( 1 - \phi_{FiSand} \right) H_{FiSand}\\
or\\
h_{l_{FiBw}} = H_{FiSand} \left( 1 - \phi_{FiSand} \right)  \left( \frac{\rho_{Sand}}{\rho_{Water}} - 1 \right)\\
\end{aligned}\end{align}
This result gives a ratio of the head loss during backwash to the height difference during forward operation. With \(\phi_{FiSand} = 0.4\) and \(\rho_{Sand} = 2650 kg/m^3\) the value of this ratio is:
\begin{equation}\label{equation:Filtration/Filtration_Intro:eq_Min_Fluidization_Velocity}
\begin{split}  \left( 1- \Phi_{FiSand} \right) \left( \frac{\rho_{FiSand}}{\rho_{Water}} - 1 \right) = 0.99\end{split}
\end{equation}

\section{Minimum Fluidization Velocity}
\label{\detokenize{Filtration/Filtration_Intro:minimum-fluidization-velocity}}
The minimum fluidization velocity for a sand bed can be obtained by setting the head loss through the sand (equation \eqref{equation:Filtration/Filtration_Intro:eq_Carman_Kozeny}) equal to the head required to suspend the sand bed (equation \eqref{equation:Filtration/Filtration_Intro:eq_Min_Fluidization_Velocity}).

Using these two equations the minimum velocity for sand fluidization can be found!
\begin{equation}\label{equation:Filtration/Filtration_Intro:minimum_fluidization_velocity_sand}
\begin{split}\bar v_{MinFluidization} = \frac{\phi_{FiSand}^3 g D_{60}^2}{36 k \nu \left( 1 - \phi_{FiSand} \right)} \left( \frac{\rho_{Sand}}{\rho_{Water}} - 1 \right)\end{split}
\end{equation}
From this equation it can easily be seen that if the diameter of the sand at the top is half the diameter of the sand at the bottom, it will fluidize at one quarter the velocity. This result indicates that fluidization occurring at the top of the filter does \sphinxstylestrong{not} imply that the sand at the bottom of the filter is fluidized.


\section{Filtration Theory}
\label{\detokenize{Filtration/Filtration_Intro:filtration-theory}}
Filters are used to remove particles and thus we’d like to be able to predict particle removal efficiency in a filter. Unfortunately we don’t yet have equations that describe particle removal by sand filtration. This is a very unpleasant surprise. It is as if we were designing a suspension bridge and didn’t have any equations describing the relationship between the tension in the cables and the load they are supporting. We only have an equation describing what the cables do when there isn’t any additional load. In the case of filtration we only have clean bed filtration models that attempt to describe what happens before the filter begins to remove particles.
\begin{description}
\item[{Reflection: How did we get to 2019 without a model for filter performance? There may be several reasons for the lack of a filtration model. Here are a few ideas.}] \leavevmode\begin{itemize}
\item {} 
The lack of data acquisition systems in university laboratories means that very few rapid sand filters were operated and evaluated for full filter runs in laboratory settings

\item {} 
The Environmental Engineering fixation on jar tests as the way to model water treatment plants provided no method to test filtration and thus most university laboratories only experimented with batch operation and not continuous flow.

\item {} 
Filtration models were borrowed from air filtration (\sphinxhref{https://pubs.acs.org/doi/abs/10.1021/es60058a005}{Yao et al, 1971}) and thus did not take into account that the coagulant nanoparticles made particle attachment to surfaces very favorable.

\item {} 
Filtration models only modeled the clean bed phase(the first few minutes of a filter run) before particles were deposited and began altering the geometry of the pores.

\end{itemize}

\end{description}

Clean bed filtration models include an equation first presented by Iwasaki in 1937 that suggested that particle removal occurred as a first order process with respect to depth. This simplifies to
\begin{equation}\label{equation:Filtration/Filtration_Intro:filter_Iwasaki}
\begin{split}pC^* \propto \frac{L}{D_{sand}}\end{split}
\end{equation}
where L is the depth of the sand in the column. This suggests that increasing the depth of sand in a filter would dramatically improve performance.

It is quite amazing that we have no useful models for sand filter performance after more than a century of using sand filters as a required process in converting surface waters into safe drinking water. Fortunately we have plenty of clues suggesting what is happening inside filters and at the level of the particles traveling through the pores.

The movie in \hyperref[\detokenize{Filtration/Filtration_Intro:figure-active-zone-model}]{Fig.\@ \ref{\detokenize{Filtration/Filtration_Intro:figure-active-zone-model}}} illustrates that the classic performance of a rapid sand filter as a function of time could be explained by the presence of an active filtration zone that slowly progresses down through the filter as the pores become fully loaded. But that begs the question of what determines “fully loaded.”

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/II0cfH80nrI}{\sphinxincludegraphics[width=400\sphinxpxdimen]{{Active_zone_model}.png}}\caption{Movie illustrating how effluent turbidity connects to deposition of particles within a sand bed.}\label{\detokenize{Filtration/Filtration_Intro:id11}}\label{\detokenize{Filtration/Filtration_Intro:figure-active-zone-model}}\end{figure}

The linear increase in head loss with time (see \hyperref[\detokenize{Filtration/Filtration_Intro:figure-head-loss-vs-time}]{Fig.\@ \ref{\detokenize{Filtration/Filtration_Intro:figure-head-loss-vs-time}}}) is a remarkable and surprising property of depth filtration. The deposition of particles in a pore would change the flow geometry, increase the flow velocity, and increase the head loss across the pore. As each particle is deposited in the pore it would be expected to have an increasing impact on head loss as the flow area is decreased and the flow velocity increases.  Head loss due to the flow expansion downstream from the flow constriction is proportional to the velocity squared. Thus we would not expect head loss across a pore to increase linearly with time.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=800\sphinxpxdimen]{{Head_loss_vs_time}.png}
\caption{Head loss through a filter increases linearly with time under conditions of constant influent turbidity.}\label{\detokenize{Filtration/Filtration_Intro:id12}}\label{\detokenize{Filtration/Filtration_Intro:figure-head-loss-vs-time}}\end{figure}

The data is trying to tell us something. The head loss through a filter does increase linearly with time and with the amount of solids that have been captured by the filter. Our hypothesis is that the number of fully loaded pores is increasing linearly with time. To understand how this might be working we need to delve into the filter and imagine what must be happening in the pores as particles are flowing by.

\hyperref[\detokenize{Filtration/Filtration_Intro:figure-deposition-at-constrictions}]{Fig.\@ \ref{\detokenize{Filtration/Filtration_Intro:figure-deposition-at-constrictions}}} illustrates that particles that are carried by the fluid can come into contact with the walls of the pores where the streamlines converge. Clean bed filtration models predict that this process of interception is significant even for clean beds. As a pore begins to fill due to particle deposition, the flow constriction becomes even more severe and thus the capture efficiency increases. This would suggest that a pore would rapidly fill with flocs until it became so clogged that the flow of water through the pore effectively stopped.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/Odp6uwqJmMc}{\sphinxincludegraphics[width=300\sphinxpxdimen]{{Deposition_at_constrictions}.png}}\caption{Movie illustrating that particles are transported closer to sand surfaces where streamlines converge.}\label{\detokenize{Filtration/Filtration_Intro:id13}}\label{\detokenize{Filtration/Filtration_Intro:figure-deposition-at-constrictions}}\end{figure}

If pores clogged completely, then sand filters would clog as soon as one layer of pores was filled. There must be another process that is preventing pores from clogging. We hypothesize that flocs can’t attach to the filter surfaces when the fluid drag on the floc exceeds the strength of the bonds between the coagulant nanoparticles and the particle and pore surfaces. Thus as pores grow smaller due to deposition it becomes more difficult for incoming flocs to attach. Instead, the flocs are shoved right through the pore even if it means the floc has to undergo significant deformation to squeeze through.

\begin{figure}[htbp]
\centering
\capstart
\sphinxhref{https://youtu.be/lgfggRX\_Wgs}{\sphinxincludegraphics[width=300\sphinxpxdimen]{{Flocs_teleport}.png}}\caption{Movie showing flocs flowing through a pore created by sand grains. (Credit \sphinxhref{https://github.com/AguaClara/filter-constrictions}{Filter\_Constrictions team Spring 2018})}\label{\detokenize{Filtration/Filtration_Intro:id14}}\label{\detokenize{Filtration/Filtration_Intro:figure-flocs-teleporting}}\end{figure}

The story is beginning to emerge. Converging streamlines result in flocs touching previously deposited particles in the flow constriction and attaching. As the flow constriction becomes even smaller the fluid drag on particles that attempt to attach to the pore becomes too great and the particles are forced through the constriction. At that point the pore is fully loaded. However, fully loaded does not mean that the void is full of flocs. It just means that the constriction is as small as it can get given the strength of the coagulant nanoparticle bonds and the fluid drag on the flocs.

Pores at the upstream end of the filter are fully loaded first and then remain relatively unchanged for the duration of the filter run. Thus the active filtration zone is pushed deeper into the filter bed. At any one time there are likely a series of pores that are partially loaded and thus actively filling. The number of pores in series that are actively filling is not yet known, but it is clear that the particle removal efficiency of a filter must be related to the number of actively filling pores in series.

The active filtration zone is progressing through the filter at a constant velocity. The number of fully loaded pores is increasing linearly with time! That is why head loss increases linearly with time.

The poor performance at the beginning of a filter run is because the clean zone isn’t a good filter. This suggests that dual media filters are pointless because the smaller media at the downstream end of the filter remains clean and doesn’t actually do anything. If this is correct, then multimedia filters can be replaced with a single larger media size.
\begin{description}
\item[{As coagulant dose increases}] \leavevmode\begin{itemize}
\item {} 
flocs are larger and thus they fill the pores faster and thus the active zone moves faster through the filter

\item {} 
large flocs are removed more efficiently and thus the active zone is thinner (fewer active pores in series)

\item {} 
thinner active zone results in faster failure (higher slope of turbidity vs time during failure)

\item {} 
larger flocs results in faster failure (higher slope of turbidity vs time during failure)

\end{itemize}

\item[{As sand size increases}] \leavevmode\begin{itemize}
\item {} 
There are fewer pores and thus fewer constrictions and thus less head loss at the end of the filter run

\item {} 
Each constriction requires more particles to build and thus there is less head loss per mass of particles removed.

\end{itemize}

\end{description}


\subsection{What about particle removal efficiency?}
\label{\detokenize{Filtration/Filtration_Intro:what-about-particle-removal-efficiency}}
This is the multi-decade old question that challenges us to continue our research. What determines how many particles sneak through a water treatment plant? We’ve learned that flocculation runs out of steam because the primary particles only want to collide with other primary particles and thus they start taking forever to collide as they become scarce. The floc blanket likely acts like a series of collectors (can’t say it is like a filter because it doesn’t have stationary constrictions). This would suggest that more floc blanket is always better. Some primary particles make it through the floc blanket. What determines how many of those primary particles make it through the filter? It must depend on the geometry of every constriction. Large flocs are easy to capture in a sand filter. Primary particles are much more difficult to capture. Large flocs tend to fill up the first unfilled pore they come to. Thus large flocs tend to take active pores out of service. This suggests that the influent floc size distribution might influence filter performance. See {\hyperref[\detokenize{Filtration/Filtration_Theory_and_Future_Work:heading-shear-big-flocs-to-improve-filter-performance}]{\sphinxcrossref{\DUrole{std,std-ref}{Shear big flocs to improve filter performance}}}} for an analysis of the feasibility of breaking up flocs at the point of injection into the sand bed.

\sphinxhref{https://doi.org/10.1016/j.desal.2006.02.102}{Zouboulis et al.} found that dual media filter produced water of slighly higher turbidity and it produced significantly less head loss than a single media filter. This comparison was


\chapter{Filtration Design}
\label{\detokenize{Filtration/Filtration_Design:filtration-design}}\label{\detokenize{Filtration/Filtration_Design:title-filtration-design}}\label{\detokenize{Filtration/Filtration_Design::doc}}\begin{enumerate}
\item {} 
Calculate array of maximum filter flows given available trunk sizes and given constraint of maximum allowable head loss in the trunk line during backwash. Note that the outer inlet trunk minor loss coefficient is set (by adding a flow restriction at the inlet to the trunk line) to be 4 times the minor loss coefficient for the inner inlet trunks so that during filtration they have the same head loss when the outer trunks have 1/2 the flow of the inner trunks.

\item {} 
Select the trunk size that gives a number of filters equal to or less than the minimum number of filters required for operation and maintenance.

\item {} 
Calculate filter flow given minimum number of filters

\item {} 
Calculate the orifice head loss required to provide uniform flow to the sand bed during backwash. This is based on the required ratio of port to manifold velocity (see equation \eqref{equation:Hydraulics/Hydraulics_Intro:Manifold_max_v_no_hl_series}).

\item {} 
Design the branches based on manifold flow distribution requirements

\item {} 
Set the siphon drain time (assuming no inflow!) to equal the time required to refill the filter box after backwash.

\item {} 
Design the siphon pipe given the constraint on drain time

\item {} 
Design the siphon air valve given volume of air in the siphon

\item {} 
Calculate all elevations

\item {} 
Design backwash flow control weirs

\end{enumerate}


\section{Potential Changes to the Filter Design}
\label{\detokenize{Filtration/Filtration_Design:potential-changes-to-the-filter-design}}\begin{itemize}
\item {} 
Have the siphon manifold exit straight through the side of the filter (perhaps in line with the other inlets and outlets) and then elbow up to the required elevation and elbow and Tee back down again. This would make the siphon install inside the filter be a single straight pipe instead of the large assembly that is currently used. This will have the additional advantage that the connection between this drain manifold and the pipe stub in the wall doesn’t have to be leak tight! The connection could be a wrap of stainless steel and two hose clamps.

\item {} 
Switch to gravity exclusion zones that include orifices to get uniform flow distribution without risk of sand scour.

\item {} 
Simplest design to fabricate will have identical trunk lines for all inlets

\item {} 
Change the inlet and outlet boxes so that all of the inlet trunks have only one elbow

\item {} 
Outlet trunks each have 2 elbows

\end{itemize}


\section{Maximum Trunk Flows}
\label{\detokenize{Filtration/Filtration_Design:maximum-trunk-flows}}
The trunks are constrained to both provide similar flow to each filter layer and to provide similar flow to each branch within the sand bed. Providing the same flow to each filter layer during filtration is the key constraint that determines the size of the trunk lines. The most challenging flow distribution is between middle inlets that carry flow for two layers and the top and bottom inlets that carry flow for one sand layer. This flow distribution is ensured by making the head loss through the outer inlet trunks to be equal to the head loss through the inner inlet trunks when the outer inlet trunks have 1/2 the flow of the inner inlet trunks.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Filter_Max_Q_given_ND}.png}
\caption{The flows through the inlet trunks of stacked rapid sand filters are not identical and this requires a careful hydraulic design.}\label{\detokenize{Filtration/Filtration_Design:id1}}\label{\detokenize{Filtration/Filtration_Design:figure-filter-max-q-given-nd}}\end{figure}

The flow distribution within the filter bed to ensure complete fluidization of the sand bed during backwash can be achieved by increasing the head loss through the flow control orifices in the branches. Calculating this required head loss is the second step in designing the filter inlet piping.


\chapter{Filtration Theory and Future Work}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:filtration-theory-and-future-work}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:title-filtration-theory-and-future-work}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work::doc}}

\section{Filtration model}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:filtration-model}}
The filtration model is based on the insight that rapid sand filters have an active filtration zone that slowly progresses down through the filter as it fills to maximum capacity at the upstream end. A clean bed of sand is ineffective at capturing small particles as evidenced by the poor initial performance after backwash. Thus it is apparently that previously deposited particles play a key role in subsequent capture of particles.

Interception!
Flow constrictions - converging streamlines move particles closer to the pore wall. Previously deposited particles form constrictions. The constrictions are the most likely location for particles to collide with deposited particles. Thus particles do not fill the pores and clog the filter. Instead particle form constrictions where streamlines already converged.

Maximum shear sets a minimum constriction opening size!
As particles gradually deposit in an ever shrinking flow constriction the velocity through the constriction increases and the velocity gradient at the wall increases. Eventually the bond strength of the coagulant nanoparticles is not great enough to capture suspended particles that collide with the deposited particles. The flow constriction reaches a minimum diameter and subsequent suspended flocs flow right through the constriction.

The gradual creation of more flow constrictions results in an almost linear increase in head loss as a function of the volume of deposited flocs.


\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Hypotheses, evidence, and why it matters}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:id1}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:table-filter-hypotheses}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{2}{62}|\X{30}{62}|\X{15}{62}|\X{15}{62}|}
\hline
\sphinxstyletheadfamily 
\#
&\sphinxstyletheadfamily 
Hypotheses
&\sphinxstyletheadfamily 
Evidence
&\sphinxstyletheadfamily 
Why it matters
\\
\hline
1
&
Particle removal is primarily due to converging streamlines that move particles close to the sand surface or to previously deposited particles
&
Filtration theory and estimates of void volume occupied by particles
&
Basis for our filtration model
\\
\hline
2
&
The particle size distribution entering the filter is set by the plate settlers
&
Estimate of velocity gradient in inlet waterfall and in filter bed
&
High velocity injection would be required to reduce the floc size
\\
\hline
3
&
The jets that the constrictions create dissipate almost all of their energy in the downstream void BEFORE entering the next constriction
&
Laminar flow jets dissipate energy very quickly
&
Allows a simple relationship between pore head loss and constriction velocity
\\
\hline
4
&
Flocs are captured with VERY high efficiency and thus primary particle removal limits filter performance
&
Clean bed filtration models
&
Need to optimize filters for primary particle removal
\\
\hline
5
&
Constrictions form a continuous barrier across the filter at each sand grain layer
&
Any gaps would receive higher flow rate and thus higher flux of particles
&
Filter automatically prevents short circuiting
\\
\hline
6
&
The thickness of the deposit scales with the width of the ring or perhaps simply with the pore size or sand size
&
Thickness can’t scale with diameter of the flocs because that would predict more total mass retained with increased coagulant dose
&
Required to predict head loss vs mass deposited.
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\section{Filter Head loss model}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:filter-head-loss-model}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:heading-filter-head-loss-model}}
The maximum velocity in a constriction is set by the drag on a primary particle that is large enough to prevent the primary particle from attaching. Given that the constriction is likely sharp edged on the upstream face the flow velocity is likely close to uniform at the entrance to the constriction. There is likely a vena contracta effect and that effect would prevent deposition of particles downstream of the leading edge of the constriction because particles are diverted away from the constriction walls.

The maximum constriction velocity is thus likely independent of the filtration velocity and pore size. The maximum velocity at the inlet to the constrictions is likely proportional to the fractional surface coverage of the primary particles by coagulant nanoparticles. Thus as the coagulant dose increases the head loss per pore and the head loss at the time of particle breakthrough increases.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:eq_headloss_constriction}
\begin{split}h_{l_{constriction}} = \frac{\bar v_{constriction}^2}{2g}\end{split}
\end{equation}\begin{description}
\item[{The maximum drag that a primary particle can}] \leavevmode\begin{itemize}
\item {} 
need to connect velocity to drag

\item {} 
Use experimental data from filtration to find critical velocity

\item {} 
expect velocity to be independent of pore size (sand size)

\item {} 
Create model for total head loss in a filter as a function of sand size

\item {} 
Need a connection between pore size and volume of particles it can hold.

\end{itemize}

\end{description}

The average distance between sand grains in a filter bed is obtained by taking the cube root of the total volume occupied by a sand grain including the pore space. We also assume that there is a one-to-one correspondence between pores and sand grains and thus the distance between pores is the same as the distance between sand grains.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:0}
\begin{split}\Lambda_{sand} = \Lambda_{pore} = \left(\frac{\pi}{6(1-\phi)} \right)^\frac{1}{3}D_{sand}\end{split}
\end{equation}
The flow rate per pore is the approach velocity multiplied by \(\Lambda^2\).
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:1}
\begin{split}Q_{pore} = v_a \Lambda_{pore}^2\end{split}
\end{equation}
The velocity through a constriction in a pore is
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:2}
\begin{split}Q_{pore} = v_a \Lambda_{pore}^2 = \frac{\pi}{4} D_{constriction}^2v_{constriction}\end{split}
\end{equation}
The constriction diameter is thus given by
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:eq_D_constriction}
\begin{split}D_{constriction} = \Lambda_{pore} \sqrt\frac{4 v_a}{\pi v_{constriction}}\end{split}
\end{equation}
The Reynolds number of the jet issuing from the constriction is obtained by using equation \eqref{equation:Filtration/Filtration_Theory_and_Future_Work:eq_D_constriction} to eliminate the dependence on diameter.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:eq_Re_constriction}
\begin{split}Re_{jet} = \frac{\Lambda_{pore} }{\nu }\sqrt\frac{4 v_a v_{constriction}}{\pi }\end{split}
\end{equation}
The jet issuing from the constrictions is laminar for Reynolds numbers below 500 (\sphinxhref{https://dspace.mit.edu/handle/1721.1/27517}{see Ungate et al., 1975 page 13}).  The constriction is likely a relatively thin (washer-like) deposit and thus the flow through the constriction is likely close to uniform. In order to estimate the head loss in the flow expansion that occurs after the constriction we need to understand how much the flow expands. The flow expansion may be limited by the geometry of the pores or it might be limited by the rate at which laminar flow jets expand. WE don’t have a way to know which constraint will set the expansion and thus we need to calculate the expansion rate for a laminar jet to see if that expansion could occur given the pore geometry.

The rate of jet expansion can be obtained from an analytical solution of the Navier Stokes equation as shown by \sphinxhref{https://babel.hathitrust.org/cgi/pt?id=mdp.39015000450273;view=1up;seq=99}{Pai, S.I., Fluid dynamics of jets. (D. Van Nostrand Company, Inc., Princeton, NJ, 1954 (pages 78-79)}

The momentum in the direction of flow is conserved and is given by
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:3}
\begin{split}M_0 = 2 \pi \rho \int_{0}^{\infty} u^2 r dr\end{split}
\end{equation}
For the case of uniform velocity through the constriction we can replace \(\infty\) with \(r_{constriction}\)
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:4}
\begin{split}M_0 = 2 \pi \rho v_{constriction}^2 \int_{0}^{r_{constriction}}  r dr\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:5}
\begin{split}M_0 = \pi \rho v_{constriction}^2 r_{constriction}^2 = \rho Q_{pore}v_{constriction}\end{split}
\end{equation}
The velocity in the direction of the jet is given by (equation 4.39 in \sphinxhref{https://babel.hathitrust.org/cgi/pt?id=mdp.39015000450273;view=1up;seq=99}{Pai, 1954})
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:6}
\begin{split}u = \frac{3M_0}{8\pi \mu} \frac{1}{x} \frac{1}{\left[1+(\frac{\zeta^2}{4})\right]^2}\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:7}
\begin{split}\zeta = \frac{1}{4\nu} \left(\frac{3M_0}{\pi\rho}\right)^{\frac{1}{2}} \frac{r}{x}\end{split}
\end{equation}
and thus \(\zeta\) is zero at the centerline.  We will use the centerline velocity at distance \(\Lambda_{pore}\) from the constriction to estimate the head loss caused by one constriction.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:8}
\begin{split}v_{exp} = \frac{3\rho Q_{pore}v_{constriction}}{8\pi \mu \Lambda_{pore}}\end{split}
\end{equation}
We can substitute for \(Q_{pore}\) to obtain
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:9}
\begin{split}v_{exp} =  \frac{3 v_a \Lambda_{pore} }{8\pi \nu }v_{constriction}\end{split}
\end{equation}
We can use mass conservation and the equation for \(Q_{pore}\) to replace \(v_a\) with \(v_{constriction}\)
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:10}
\begin{split}v_{exp} =  \frac{3}{32}\frac{D_{constriction}}{\Lambda_{pore}}Re_{jet}v_{constriction}\end{split}
\end{equation}
It isn’t yet clear if this always means that \(v_{exp}\) will be very small compared with \(v_{constriction}\), but that seems to be the logical conclusion. Thus when calculating the head loss for a pore it is reasonable to assume that the kinetic energy of the jet is all lost before entering the next constriction.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{n}{D\PYGZus{}sand} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}
\PYG{n}{Porosity} \PYG{o}{=} \PYG{l+m+mf}{0.4}
\PYG{n}{Temperature} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{v\PYGZus{}a} \PYG{o}{=} \PYG{l+m+mf}{1.85} \PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{he\PYGZus{}filter} \PYG{o}{=} \PYG{l+m+mi}{40} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{H\PYGZus{}filter} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{Lambda\PYGZus{}pore} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{porosity}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{*}\PYG{n}{D\PYGZus{}sand}
\PYG{n}{Lambda\PYGZus{}pore}
\PYG{c+c1}{\PYGZsh{} Use measured fully constricted filter head loss to estimate the constricted velocity}
\PYG{n}{v\PYGZus{}constriction} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}\PYG{o}{*}\PYG{n}{Lambda\PYGZus{}pore}\PYG{o}{*}\PYG{n}{he\PYGZus{}filter}\PYG{o}{/}\PYG{n}{H\PYGZus{}filter}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The velocity in the constriction is estimated (for these conditions) to be}\PYG{l+s+s1}{\PYGZsq{}} \PYG{p}{,}\PYG{n}{v\PYGZus{}constriction}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Re\PYGZus{}constriction} \PYG{o}{=}\PYG{p}{(}\PYG{n}{Lambda\PYGZus{}pore}\PYG{o}{/}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{v\PYGZus{}a}\PYG{o}{*}\PYG{n}{v\PYGZus{}constriction}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The jet is laminar because the Reynolds number is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{Re\PYGZus{}constriction}\PYG{o}{.}\PYG{n}{magnitude}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ which is well within the laminar range because it is less than 500.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{D\PYGZus{}constriction} \PYG{o}{=} \PYG{n}{Lambda\PYGZus{}pore} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{o}{*}\PYG{n}{v\PYGZus{}a}\PYG{o}{/}\PYG{n}{v\PYGZus{}constriction}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}velocity of the jet after it travels on pore length}
\PYG{n}{v\PYGZus{}exp} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{3}\PYG{o}{*}\PYG{n}{v\PYGZus{}a}\PYG{o}{*}\PYG{n}{Lambda\PYGZus{}pore}\PYG{o}{*}\PYG{n}{v\PYGZus{}constriction}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The velocity of the jet after it travels one pore length is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{v\PYGZus{}exp}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ which contains an insignificant amount of kinetic energy compared with the original jet.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Now find the Camp Stein velocity gradient in the pore}
\PYG{n}{G\PYGZus{}CS} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}constriction} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*}\PYG{n}{porosity} \PYG{o}{*} \PYG{n}{Lambda\PYGZus{}pore}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The constricted jet induced Camp Stein velocity gradient in the pores is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{G\PYGZus{}CS}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Calculate the Camp Stein velocity gradient at the StaRS injection site}
\PYG{n}{W\PYGZus{}inject} \PYG{o}{=} \PYG{l+m+mf}{2.5} \PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{S\PYGZus{}inject} \PYG{o}{=} \PYG{l+m+mi}{10} \PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{n\PYGZus{}layers\PYGZus{}per\PYGZus{}inject} \PYG{o}{=} \PYG{l+m+mi}{2}
\PYG{n}{v\PYGZus{}a\PYGZus{}inject} \PYG{o}{=} \PYG{n}{v\PYGZus{}a} \PYG{o}{*} \PYG{n}{S\PYGZus{}inject}\PYG{o}{*}\PYG{n}{n\PYGZus{}layers\PYGZus{}per\PYGZus{}inject}\PYG{o}{/}\PYG{n}{W\PYGZus{}inject}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The StaRS injection velocity is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{v\PYGZus{}a\PYGZus{}inject}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}The clean bed camp velocity gradient given this injection approach velocity}
\PYG{k}{def} \PYG{n+nf}{Re\PYGZus{}Erdon}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{o}{*}\PYG{n}{D\PYGZus{}sand}\PYG{o}{/}\PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{Porosity}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{f\PYGZus{}Erdon}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{l+m+mi}{300}\PYG{o}{/}\PYG{n}{Re\PYGZus{}Erdon}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mf}{3.5}

\PYG{k}{def} \PYG{n+nf}{hf\PYGZus{}Erdon}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{,} \PYG{n}{L}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{p}{(}\PYG{n}{f\PYGZus{}Erdon}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)}\PYG{o}{*}\PYG{n}{L}\PYG{o}{/}\PYG{n}{D\PYGZus{}sand}\PYG{o}{*}\PYG{n}{v\PYGZus{}a}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{Porosity}\PYG{p}{)}\PYG{o}{/}\PYG{n}{Porosity}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{k}{def} \PYG{n+nf}{G\PYGZus{}CS\PYGZus{}Ergun}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{f\PYGZus{}Erdon}\PYG{p}{(}\PYG{n}{v\PYGZus{}a}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)} \PYG{o}{*} \PYG{n}{v\PYGZus{}a}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{*} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{Porosity}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)} \PYG{o}{*} \PYG{n}{D\PYGZus{}sand} \PYG{o}{*} \PYG{n}{Porosity}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}\PYG{p}{)}

\PYG{n}{G\PYGZus{}CS\PYGZus{}inject} \PYG{o}{=} \PYG{n}{G\PYGZus{}CS\PYGZus{}Ergun}\PYG{p}{(}\PYG{n}{v\PYGZus{}a\PYGZus{}inject}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The velocity gradient at the StaRS injection sites (in the two middle inlets) is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{G\PYGZus{}CS\PYGZus{}inject}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Sedimentation plates set the size of the flocs in the filter}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:sedimentation-plates-set-the-size-of-the-flocs-in-the-filter}}
The characteristic floc size could be set by the plate settlers that preferentially remove large flocs or it could be set by any of the high shear events on the path to or through the filter. We will estimate floc size from each of the potential shear and terminal velocity events. The calculations are done in
{\hyperref[\detokenize{Filtration/Filtration_Theory_and_Future_Work:heading-floc-size-and-velocity-gradient-calculations}]{\sphinxcrossref{\DUrole{std,std-ref}{python below}}}}.


\subsection{Sedimentation tank floc diameter}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:sedimentation-tank-floc-diameter}}
The floc diameter that is not completely captured by plate settlers with a capture velocity of 0.12 mm/s (the capture velocity used by AguaClara) is 25 \(\mu m\).


\subsection{Constricted pore velocity gradient}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:constricted-pore-velocity-gradient}}
Almost all of the kinetic energy of the jet issuing from the constriction is dissipated in the downstream pore. We will assume that the majority of the head loss is due to the jet (rather than wall shear). The volume of a pore is given by
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:11}
\begin{split}\rlap{--} V_{pore} = \phi\Lambda_{pore}^3\end{split}
\end{equation}
The hydraulic residence time in a pore is obtained from the volume and flow rate through a pore.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:12}
\begin{split}\theta_{pore} = \frac{\rlap{--} V_{pore}}{Q_{pore}} = \frac{\phi\Lambda_{pore}^3}{v_a \Lambda_{pore}^2} = \frac{\phi\Lambda_{pore}}{v_a}\end{split}
\end{equation}
The Camp Stein velocity gradient in a pore is obtained by assuming that all of the input kinetic energy is dissipated through viscosity during the time that the water spends in the pore.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:13}
\begin{split}G_{CS} = \sqrt{\frac{gh_{\rm{L}}}{\nu \theta}}\end{split}
\end{equation}
The head loss in the pore is from the jet kinetic energy. Substitute the equations for pore volume, residence time, and head loss to obtain the fundamental equation for the velocity gradient in a pore.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:14}
\begin{split}G_{CS} =\bar v_{constriction} \sqrt{\frac{ v_a}{2\nu \phi\Lambda_{pore}}}\end{split}
\end{equation}
The estimated value of this velocity gradient is \sphinxstyleemphasis{300 Hz}.


\subsection{Influent sand injection velocity gradient}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:influent-sand-injection-velocity-gradient}}
We need to compare the constricted jet velocity gradient with the clean bed injection velocity gradient that occurs due to the fact that the approach velocity at the point of flow injection in StaRS filters is much higher than the average approach velocity. The flow injection area is approximately 2.5 cm wide and serves an effective filter area (up and down!) of 20 cm (spacing between injection points is 10 cm.). Thus the approach velocity in current StaRS filters is 14.6 mm/s and the corresponding Camp Stein velocity gradient is \sphinxstyleemphasis{1440 Hz}.


\subsection{Filter inlet box water fall velocity Gradient}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:filter-inlet-box-water-fall-velocity-gradient}}
EstaRS filters have water falls from the filter inlet channel to inlet box. In recent designs the water flows through a narrow slot and then falls into the inlet box. The slot is about 3.4 cm wide and the water falls about 40 cm. The vertical velocity after dropping 40 cm is 2.8 m/s. The geometry of this water fall is complicated and We will assume the resulting jet is circular at impact with the water surface. The diameter of the jet is thus obtained from continuity and is equal to 9.5 cm.  Now we use the energy dissipation rate of a round jet to obtain \sphinxstyleemphasis{4300 Hz}. Thus the floc size could be set by the water fall in the inlet box since this is the highest velocity gradient on the path into and through the filter. However, our rough estimate based on wild extrapolation suggests that this would yield a 36 \(\mu m\) diameter floc. This is larger than the flocs produced by the sedimentation tank plate settlers and thus it is possible that even with this waterfall, that the floc size distribution is set by the sedimentation tank plate settlers.

Note that the water fall height diminishes during a filter run as the water level in the inlet box increases due to head loss through the filter. Thus it is likely that the waterfall doesn’t significantly break flocs.


\section{Maximum velocity in constrictions}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:maximum-velocity-in-constrictions}}
The maximum velocity in a pore is hypothesized to be set by the bond strength of the coagulant nanoparticles and the fluid drag on the primary particle that is attaching. It is assumed that the last particles that are able to deposit in a pore are primary particles because they can fill in the last available volume before the pore velocity is too high for any other particles to attach. It is possible that the attachment strength of the primary particles is a function of the fraction of their surface area that is covered by coagulant nanoparticles, \(\Gamma\). The total force acting downward on a primary particle that attaches to a constriction is the sum of the drag and the particle buoyant weight. These forces are counteracted by the force of the coagulant bonds.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:15}
\begin{split}F_{coag_{bonds}} = F_{drag} + F_{weight} - F_{buoyancy}\end{split}
\end{equation}
The drag force on a clay particle that has attached to the
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:16}
\begin{split}F_{drag} = C_D \frac{\pi}{4} D_{clay}^2 \rho_{H_2O} \frac{v_{constriction}^2}{2}\end{split}
\end{equation}
At Reynolds numbers (based on primary particle diameter) less than about 10 the drag coefficient is given by
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:17}
\begin{split}C_D = \frac{24}{Re} = \frac{24\nu}{v_{constriction}D_{clay}}\end{split}
\end{equation}
Thus the drag on a clay particle is given by
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:18}
\begin{split}F_{drag} = 3\pi \nu v_{constriction} D_{clay} \rho_{H_2O}\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:19}
\begin{split}F_{coag_{bonds}} = 3\pi \nu v_{constriction} D_{clay} \rho_{H_2O} + (\rho_{clay} - \rho_{H_2O}) g \frac{\pi}{6}D_{clay}^3\end{split}
\end{equation}
The drag force is assumed to be set by the average pore water velocity because the deposition occurs near the entrance to the constriction before the boundary layer on the wall can develop.

The force of the coagulant bonds is presumed to be proportional to the fractional coverage of the clay with coagulant and the intrinsic shear strength of the coagulant bonds to the clay surface
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:20}
\begin{split}F_{coag_{bonds}} = \Gamma \tau_{bonds} \frac{\pi}{4} D_{clay}^2\end{split}
\end{equation}
where \(\tau_{bonds}\) is the intrinsic shear strength of the coagulant bonds to the clay surface. Solving for the maximum constriction velocity we obtain
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:21}
\begin{split}v_{constriction_{max}} = \frac{\Gamma \tau_{bonds}\frac{\pi}{4} D_{clay}^2 - (\rho_{clay} - \rho_{H_2O}) g \frac{\pi}{6}D_{clay}^3}{3\pi \nu  D_{clay} \rho_{H_2O}}\end{split}
\end{equation}
It is likely that the weight of the clay particle is a small contribution to the force balance. In that case the equation simplifies to
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:22}
\begin{split}v_{constriction_{max}}  = \frac{\Gamma \tau_{bonds} D_{clay} }{12 \nu \rho_{H_2O}}\end{split}
\end{equation}
Unfortunately, we do not have a measure of the intrinsic bond strength of the coagulant nanoparticles to clay surfaces, \(\tau_{bonds}\). This equation does provide a possible means to back calculate this property.

The minimum diameter of a particle deposition constriction is set by the maximum constriction velocity, \(v_{constriction_{max}}\).
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:eq_D_constriction_min}
\begin{split}D_{constriction_{min}} = \Lambda_{pore} \sqrt\frac{4 v_a}{\pi v_{constriction_{max}}}\end{split}
\end{equation}
The head loss through a flow constriction can be estimated from the head loss through a flow expansion. We will use the form of the expansion equation \eqref{equation:Review/Review_Fluid_Mechanics:eq_exp_v_in} that is based on the contraction velocity. The jet is assumed to expand sufficiently so that the residual kinetic energy is insignificant.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:eq_exp_v_constriction}
\begin{split} h_{e_{constriction}} =  \frac{\bar v_{constriction_{max}}^2}{2g}\end{split}
\end{equation}
The number of deposited constrictions per unit depth in a filter is
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:23}
\begin{split}N_{constrictions_{series}} = \frac{H_{filter}}{\Lambda_{pore}}\end{split}
\end{equation}
The total head loss in a filter if taken to the point where the active filtration zone exited the filter and all pores were constricted would be
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:eq_he_filter}
\begin{split} h_{e_{filter_{max}}} = \frac{H_{filter}}{\Lambda_{pore}}  \frac{\bar v_{constriction_{max}}^2}{2g}\end{split}
\end{equation}
The effect of increasing the pore size on terminal head loss is to decrease the \sphinxstyleemphasis{final} head loss when the active zone reaches the bottom of the filter because of the effect of \(\Lambda_{pore}`in the first term of equation :eq:`eq_he_filter\). Note that this does not yet address the rate of head loss accumulation which is expected to be a function of sand grain diameter.

We can solve equation \eqref{equation:Filtration/Filtration_Theory_and_Future_Work:eq_he_filter} for maximum constriction velocity based on experimental measurements of the head loss at filter failure that is due to constrictions. Note that this head loss does NOT include the clean bed head loss.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:eq_he_filter2}
\begin{split}v_{constriction_{max}} = \sqrt{ \frac{2g\Lambda_{pore}}{H_{filter}}h_{e_{filter_{max}}}}\end{split}
\end{equation}
From \hyperref[\detokenize{Filtration/Filtration_Intro:figure-head-loss-vs-time}]{Fig.\@ \ref{\detokenize{Filtration/Filtration_Intro:figure-head-loss-vs-time}}} we have an estimate of 35 to 80 cm of head loss through a 20 cm bed of 0.5 mm diameter sand. This gives an estimate of 137 mm/s for the constriction velocity. This could be used to obtain an estimate of the bond strength of the coagulant nanoparticles.


\section{Shear big flocs to improve filter performance}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:shear-big-flocs-to-improve-filter-performance}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:heading-shear-big-flocs-to-improve-filter-performance}}
Here we explore the possibility of breaking flocs as they enter the filter bed to eliminate large flocs that may be reducing filter performance.

Primary particles have the lowest probability of hitting the wall in a constriction. Thus primary particles can travel the greatest distance through the active zone and still have a very small chance of being deposited near the end of the active zone. Thus it is possible that primary particles set the maximum length of the active zone and flocs tend to fill in the active zone at the upstream end. The larger the floc the more likely it will fill in an upstream constriction and thus shorten the active zone.

This suggests that one way to improve filter performance is to have a zone of very high shear that rips flocs apart so that they don’t fill in the upstream pores in the active zone so quickly. This is because smaller flocs will not be removed as efficiently by each constriction and thus they will penetrate deeper into the active zone. One possible method to create a high shear zone is to size the flow injection area to achieve high shear through the first sand grains. The idea is to shred incoming flocs so they have a lower probability of being removed per pore and thus more of these small flocs penetrate deeper into the active filtration zone before being captured. Smaller flocs are also more dense and thus don’t fill up the available volume in the constrictions as fast as the large flocs that they came from.

We need an estimate of the shear through the first pores as the water enters the sand. The Kozeny equation is valid up to a particle Reynolds number of 1 (\eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_Re_porous_media}). The Reynolds number at this proposed flow injection site will be much larger than 1 and thus the Ergun equation (\eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_Ergun}) that is valid for laminar and turbulent flow in porous media will be used.

We will use the Camp Stein velocity gradient to estimate injection velocity required to create very small flocs. The important parameter for floc break up is a force that can be obtained from the velocity gradient multiplied by the dynamic viscosity.

Solving \eqref{equation:Fluid_Deformation_and_Energy_Dissipation/FDED_Derivations:eq_G_CS_porous_media} for the approach velocity, \(v_a\), we obtain
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:24}
\begin{split}v_a = \left( G_{CS}^2 \frac{2\nu D_{sand}}{f_{\phi}} \frac{\phi^4}{(1-\phi)} \right)^{\frac{1}{3}}\end{split}
\end{equation}
to estimate the injection area that should be used to break up flocs entering the sand bed.


\section{Floc size and velocity gradient calculations}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:floc-size-and-velocity-gradient-calculations}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:heading-floc-size-and-velocity-gradient-calculations}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}

\PYG{n}{N\PYGZus{}layers} \PYG{o}{=} \PYG{l+m+mi}{6}
\PYG{n}{v\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{=} \PYG{l+m+mi}{11} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{v\PYGZus{}a} \PYG{o}{=} \PYG{n}{v\PYGZus{}filter\PYGZus{}backwash}\PYG{o}{/}\PYG{n}{N\PYGZus{}layers}
\PYG{n}{Porosity} \PYG{o}{=} \PYG{l+m+mf}{0.4}
\PYG{n}{D\PYGZus{}sand} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}
\PYG{c+c1}{\PYGZsh{} the following is just a guess at pore size}
\PYG{n}{D\PYGZus{}pore} \PYG{o}{=} \PYG{l+m+mf}{0.2} \PYG{o}{*} \PYG{n}{D\PYGZus{}sand}
\PYG{n}{Temperature} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{L} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{Q\PYGZus{}waterfall} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{v\PYGZus{}waterfall}\PYG{o}{=}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{l+m+mi}{40}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{v\PYGZus{}waterfall}
\PYG{c+c1}{\PYGZsh{}use continuity to get diameter of waterfall}
\PYG{n}{D\PYGZus{}waterfall} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{Q\PYGZus{}waterfall}\PYG{o}{/}\PYG{n}{v\PYGZus{}waterfall} \PYG{o}{*}\PYG{l+m+mi}{4}\PYG{o}{/}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}
\PYG{n}{D\PYGZus{}waterfall}
\PYG{n}{Pi\PYGZus{}JetRound} \PYG{o}{=} \PYG{l+m+mf}{0.08}
\PYG{n}{G\PYGZus{}Max\PYGZus{}waterfall} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}waterfall}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}JetRound}\PYG{o}{*}\PYG{n}{v\PYGZus{}waterfall}\PYG{o}{/}\PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*}\PYG{n}{D\PYGZus{}waterfall}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum velocity gradient in the plunging jet in the filter inlet box is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{G\PYGZus{}Max\PYGZus{}waterfall}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} now estimate the size of this floc}
\PYG{n}{EDR\PYGZus{}waterfall} \PYG{o}{=} \PYG{p}{(}\PYG{n}{G\PYGZus{}Max\PYGZus{}waterfall}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mW}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{p}{)}
\PYG{n}{EDR\PYGZus{}waterfall}
\PYG{n}{D\PYGZus{}floc\PYGZus{}waterfall} \PYG{o}{=} \PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{diam\PYGZus{}floc\PYGZus{}max}\PYG{p}{(}\PYG{n}{G\PYGZus{}Max\PYGZus{}waterfall}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{um}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The diameter of flocs after the waterfall is estimated to be}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{D\PYGZus{}floc\PYGZus{}waterfall}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{} Calculate maximum diameter of flocs leaving the sedimentation tank}
\PYG{n}{D\PYGZus{}floc}\PYG{o}{=} \PYG{n}{fm}\PYG{o}{.}\PYG{n}{diam\PYGZus{}floc\PYGZus{}vel\PYGZus{}term}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{p}{,}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{PACl}\PYG{p}{,}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{Clay}\PYG{p}{,}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{DIM\PYGZus{}FRACTAL}\PYG{p}{,} \PYG{l+m+mf}{0.12}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum diameter of flocs leaving the sedimentation tank is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{D\PYGZus{}floc}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{um}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{v\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+m+mi}{500}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{v\PYGZus{}graph}\PYG{p}{,}\PYG{p}{(}\PYG{n}{hf\PYGZus{}Erdon}\PYG{p}{(}\PYG{n}{v\PYGZus{}graph}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{,} \PYG{n}{L}\PYG{p}{)}\PYG{o}{/}\PYG{n}{L}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{v\PYGZus{}graph}\PYG{p}{,}\PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{headloss\PYGZus{}kozeny}\PYG{p}{(}\PYG{n}{L}\PYG{p}{,}\PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{v\PYGZus{}graph}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{,} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)} \PYG{p}{)}\PYG{o}{/}\PYG{n}{L}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{approach velocity (mm/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{head loss per m}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Ergun}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kozeny}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filtration/Images/Head\PYGZus{}loss\PYGZus{}Ergun\PYGZus{}and\PYGZus{}Kozeny}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Head_loss_Ergun_and_Kozeny}.png}
\caption{The Ergun and Kozeny equations are very similar even at approach velocities that are much larger than are used in rapid sand filtration. At very high velocities the turbulent term in the Ergun equation begins to be significant.}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:id2}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:figure-head-loss-ergun-and-kozeny}}\end{figure}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Need to use a root finding method here because f\PYGZus{}phi is a function of velocity}
\PYG{c+c1}{\PYGZsh{} Will use a graphical solution for now}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{v\PYGZus{}graph}\PYG{p}{,}\PYG{n}{G\PYGZus{}CS\PYGZus{}Ergun}\PYG{p}{(}\PYG{n}{v\PYGZus{}graph}\PYG{p}{,} \PYG{n}{D\PYGZus{}sand}\PYG{p}{,} \PYG{n}{Temperature}\PYG{p}{,} \PYG{n}{Porosity}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{approach velocity (mm/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{velocity gradient (Hz)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filtration/Images/G\PYGZus{}vs\PYGZus{}approach\PYGZus{}velocity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{G_vs_approach_velocity}.png}
\caption{The Camp Stein velocity gradient increases rapidly with approach velocity.}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:id3}}\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:figure-g-vs-approach-velocity}}\end{figure}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}We guess at a velocity gradient by extrapolating wildly to a 20 um floc.}
\PYG{n}{G\PYGZus{}CS} \PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{p}{(}\PYG{n}{fm}\PYG{o}{.}\PYG{n}{ener\PYGZus{}dis\PYGZus{}diam\PYGZus{}floc}\PYG{p}{(}\PYG{l+m+mi}{40}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{um}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{Hz}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A wild guess at the velocity gradient required to break up flocs is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{G\PYGZus{}CS}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}from the graph above we\PYGZsq{}d need an approach velocity of about 80 mm/s to achieve a G of 10,000 Hz.}
\PYG{n}{v\PYGZus{}inject} \PYG{o}{=} \PYG{l+m+mi}{80}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{p}{(}\PYG{n}{v\PYGZus{}inject}\PYG{o}{/}\PYG{n}{v\PYGZus{}a}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{n}{injection\PYGZus{}port\PYGZus{}spacing} \PYG{o}{=} \PYG{l+m+mi}{10} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{injection\PYGZus{}port\PYGZus{}width} \PYG{o}{=}     \PYG{p}{(}\PYG{n}{injection\PYGZus{}port\PYGZus{}spacing}\PYG{o}{/}\PYG{p}{(}\PYG{n}{v\PYGZus{}inject}\PYG{o}{/}\PYG{n}{v\PYGZus{}a}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The injection port width would be }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{injection\PYGZus{}port\PYGZus{}width}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The injection velocity would be }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{v\PYGZus{}inject}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The analysis above suggests that the approach velocity required to break flocs down to a dimension of \(20 \mu m\) is approximately 80 mm/s. This is based on a VERY bad guesstimate of the relationship between floc size and shear.

We need to know how much energy would be expended to force the water through this high velocity injection zone. Once the water enters the sand it will spread radially in all directions. As the water spreads it will slow down and the head loss per distance traveled will decrease. We need to integrate this head loss over the first few centimeters to get an estimate of the injection head loss.

The velocity at distance r from the center of the injection line can be calculated from the velocity at \(r_0\) by continuity.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:25}
\begin{split}v_{a_r} r= v_{a_{r_0}} r_0\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:26}
\begin{split}v_{a_r}= v_{a_{r_0}} \frac{r_0}{r}\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:27}
\begin{split}dh_f= \frac{dr}{2g D_{sand}} \left( 300 \frac{\nu (1-\phi)^2}{D_{sand} \phi^3}v_a  + 3.5 \frac{ (1-\phi) }{\phi^3}v_a^2 \right)\end{split}
\end{equation}
Now substitute for the approach velocity
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:28}
\begin{split}\frac{dh_f}{dr}= \frac{1}{2g D_{sand}} \left[ 300 \frac{\nu (1-\phi)^2}{D_{sand} \phi^3}\left(v_{a_{r_0}} \frac{r_0}{r}\right)  + 3.5 \frac{ (1-\phi) }{\phi^3} \left(v_{a_{r_0}} \frac{r_0}{r}\right)^2 \right]\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:29}
\begin{split}dh_f= \frac{v_{a_{r_0}}r_0}{2g D_{sand}} \left[ 300 \frac{\nu (1-\phi)^2}{D_{sand} \phi^3}\left( \frac{1}{r}\right)  + 3.5 \frac{ (1-\phi)v_{a_{r_0}}r_0 }{\phi^3} \left( \frac{1}{r}\right)^2 \right] dr\end{split}
\end{equation}
We will create terms to make the integration easier
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:30}
\begin{split}a_0 = \frac{v_{a_{r_0}}r_0}{2g D_{sand}}\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:31}
\begin{split}a_1 = 300 \frac{\nu (1-\phi)^2}{D_{sand} \phi^3}\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:32}
\begin{split}a_2 = 3.5 \frac{ (1-\phi)v_{a_{r_0}}r_0 }{\phi^3}\end{split}
\end{equation}
Now we set up the numerical integration and integrate from the injection site to the radius where the velocity is equal to the filtration velocity.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}This is for an inlet that serves 2 layers (up and down)}
\PYG{n}{v\PYGZus{}filter} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{11} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}\PYG{o}{/}\PYG{n}{N\PYGZus{}layers}\PYG{o}{*}\PYG{l+m+mi}{2}
\PYG{n}{S\PYGZus{}branch} \PYG{o}{=} \PYG{l+m+mi}{10} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{v0} \PYG{o}{=} \PYG{l+m+mi}{80} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{r0} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{v\PYGZus{}filter}\PYG{o}{/}\PYG{n}{v0} \PYG{o}{*} \PYG{n}{S\PYGZus{}branch}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n}{r0}

\PYG{c+c1}{\PYGZsh{}create coefficients for the constant terms in the equation}
\PYG{n}{a0} \PYG{o}{=} \PYG{n}{v0} \PYG{o}{*} \PYG{n}{r0} \PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity}\PYG{o}{*}\PYG{n}{D\PYGZus{}sand}\PYG{p}{)}
\PYG{n}{a1} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{300}\PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{Temperature}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{Porosity}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{D\PYGZus{}sand}\PYG{o}{*}\PYG{n}{Porosity}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{n}{a2} \PYG{o}{=} \PYG{l+m+mf}{3.5}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{Porosity}\PYG{p}{)}\PYG{o}{*} \PYG{n}{v0} \PYG{o}{*} \PYG{n}{r0}\PYG{o}{/}\PYG{n}{Porosity}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{r1} \PYG{o}{=} \PYG{n}{S\PYGZus{}branch}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{)}
\PYG{n}{r1}
\PYG{c+c1}{\PYGZsh{}create an array of r values with each value centered in the ring that it represents. \PYGZsh{}We will use simple}
\PYG{n}{n\PYGZus{}points} \PYG{o}{=} \PYG{l+m+mi}{10000}
\PYG{n}{dr} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{r1}\PYG{o}{\PYGZhy{}}\PYG{n}{r0}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{n\PYGZus{}points}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n}{r\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{p}{(}\PYG{n}{r0}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{,}\PYG{p}{(}\PYG{n}{r1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}\PYG{p}{,}\PYG{n}{n\PYGZus{}points}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}
\PYG{n}{y\PYGZus{}array} \PYG{o}{=} \PYG{p}{(}\PYG{n}{a0}\PYG{o}{*}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{divide}\PYG{p}{(}\PYG{n}{a1}\PYG{p}{,}\PYG{n}{r\PYGZus{}array}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{divide}\PYG{p}{(}\PYG{n}{a2}\PYG{p}{,}\PYG{n}{np}\PYG{o}{.}\PYG{n}{multiply}\PYG{p}{(}\PYG{n}{r\PYGZus{}array}\PYG{p}{,}\PYG{n}{r\PYGZus{}array}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}Use the trapezoidal rule to integrate}
\PYG{c+c1}{\PYGZsh{}need to reattach units to np.trapz.}
\PYG{n}{hf\PYGZus{}inlet} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{trapz}\PYG{p}{(}\PYG{n}{y\PYGZus{}array}\PYG{p}{,}\PYG{n}{x}\PYG{o}{=}\PYG{n}{r\PYGZus{}array}\PYG{p}{,} \PYG{n}{dx} \PYG{o}{=} \PYG{n}{dr}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The head loss through the sand between the injection point and where it reaches the filtration velocity is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hf\PYGZus{}inlet}\PYG{p}{)}
\end{sphinxVerbatim}

The analysis above suggests that a high velocity and high velocity gradient injection into the sand bed with the goal of breaking flocs into pieces that are 20 \(\mu m\) in diameter would require about 12 cm of head loss. This is based on the assumption that the water would be able to flow radially from the injection point and thus rapidly slow down. Thus the head loss rapidly decreases with distance from the injection point.

This is an experiment worth trying. It will help us understand if large flocs result in poorer filter performance.


\section{Volume of flocs per pore}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:volume-of-flocs-per-pore}}
The volume of solids deposited in one pore can be obtained based on the average diameter of clean pore constrictions, the diameter of the constricted pore after solids deposition, and the thickness of the deposit. We already have an estimate for the diameter of the constricted pore after solids deposition. The thickness of the deposit must be proportional to some other length scale. We initially hypothesized that the thickness of the deposit scaled with the diameter of the flocs that make it up. That led to the conclusion that increased coagulant dose would increase the total mass of solids that could be retained by the filter before breakthrough. That doesn’t match experimental data and thus we now propose that the average thickness of the deposit scales with the sand grain size, or pore size, or pore separation distance. We will use the pore separation distance as our scaling parameter.

There are several options for estimating the areal extent of the constriction. We already have an estimate of the inner diameter of the constriction and thus all we need is an estimate of the outer extent of the deposited constriction.  One option would be to take the area of a circle defined by 3 spheres coming close together. That is a clear underestimate because the constriction must extend into the gaps between the spheres. A second option would be to use the porosity to estimate the average plane view area of the pores. If we assume that the pore must connect vertically and thus has a height \(\Lambda_{pore}\), then the plane view area is given by
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:33}
\begin{split}A_{pore} = \phi\Lambda_{pore}^2\end{split}
\end{equation}
The area of the deposit is obtained by subtracting the constriction opening from the previous equation.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:34}
\begin{split}A_{deposit} = \Lambda_{pore}^2\left(\phi-\frac{v_a}{ v_{constriction}} \right)\end{split}
\end{equation}
The volume of the deposit is thus
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:35}
\begin{split}\rlap{--} V_{deposit} = \Pi_{pore}^{deposit}\Lambda_{pore}^3\left(\phi-\frac{v_a}{ v_{constriction}} \right)\end{split}
\end{equation}
where \(\Pi_{pore}^{deposit}\) a number much less than 1 that represents the fixed ratio between the thickness of the deposit and the pore separation distance.

The head loss per volume of particles deposited can be obtained by dividing the head loss per pore by the volume of particles per pore.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:36}
\begin{split}h_{l_{per_{deposit}}} = \frac{\bar v_{constriction}^2}{2g\Pi_{pore}^{deposit}\Lambda_{pore}^3\left(\phi-\frac{v_a}{ v_{constriction}} \right)}\end{split}
\end{equation}
If the primary goal for filter design were to decrease head loss per volume of solids deposited, then selecting larger sand (increasing \(\Lambda_{pore}\)) would be the clear strategy. Increasing the sand diameter by a factor of two should decrease the head loss by a factor of 8. Increasing the approach velocity \(v_a\), results in a small increase in the head loss per volume of deposited material.

We need a method to connect turbidity removed by a filter into volume of deposited flocs. We will make this connection by first assuming that the flocs have a characteristic size based on a high shear event on their way into the filter. We begin with the relationship between the number of clay particles in a floc and the floc diameter.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:37}
\begin{split}D_{floc} = D_{clay} n_{clay}^\frac{1}{D_{fractal}}\end{split}
\end{equation}
Where \(D_{fractal}\) is the volume based fractal dimension of a floc. We estimate \(D_{fractal}\) to have a value of 2.3. We can rearrange this equation and solve for the number of clay particles in a floc.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:38}
\begin{split}n_{clay} = \left(\frac{D_{floc}}{D_{clay}}\right)^{D_{fractal}}\end{split}
\end{equation}
Now we can create a relationship for the concentration of clay in a floc dividing the mass of clay by the volume of the floc.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:39}
\begin{split}C_{clay_{floc}} = \frac{n_{clay}\rlap{--} V_{clay}\rho_{clay}}{\rlap{--} V_{floc}} = \frac{n_{clay}D_{clay}^3\rho_{clay}}{D_{floc}^3}= \frac{D_{clay}^3\rho_{clay}}{D_{floc}^3}\left(\frac{D_{floc}}{D_{clay}}\right)^{D_{fractal}}\end{split}
\end{equation}
With one more simplification we obtain the desired equation for the clay concentration in a floc of given diameter.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:40}
\begin{split}C_{clay_{floc}} = \rho_{clay} \left(\frac{D_{clay}}{D_{floc}}\right)^{3-D_{fractal}}\end{split}
\end{equation}
The mass of clay per pore is obtained by multiplying the deposit volume by the concentration of the flocs.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:41}
\begin{split}M_{clay_{pore}} =\rho_{clay}  \Pi_{pore}^{deposit}\Lambda_{pore}^3\left(\phi-\frac{v_a}{ v_{constriction}} \right)\left(\frac{D_{clay}}{D_{floc}}\right)^{3-D_{fractal}}\end{split}
\end{equation}
The mass of clay per plan view area of the filter is obtained by multiplying by the number of pores per depth of the filter and dividing by the plan view area of a pore, \(\Lambda_{pore}^2\).
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:42}
\begin{split}M_{clay_{filter}} =H_{filter} \rho_{clay}  \Pi_{pore}^{deposit}\left(\phi-\frac{v_a}{ v_{constriction}} \right)\left(\frac{D_{clay}}{D_{floc}}\right)^{3-D_{fractal}}\end{split}
\end{equation}
According to this model, the mass of clay that can be held by a filter increases linearly with filter depth. The retained mass is independent of the sand size. This is an easy hypothesis to test. Note, however, that this model does not account for the depth of the active zone. Presumably the active zone depth may be greater for larger diameter media and thus breakthrough may occur sooner for larger diameter media.

If coagulant dose increases it will have two effects. The primary particle attachment strength will increase, the constricted velocity will increase, and the mass retained will increase. The size of the flocs will also increase and that will result in a slight decrease in the retained mass.

Thus it isn’t immediately clear how changing the coagulant dose will change the maximum mass of retained particles. The evidence from the AguaClara filter theory team is that the mass of clay retained decreases as the coagulant dose increases.

The head loss per mass of particles deposited can be obtained by dividing the head loss per pore by the mass per pore.
\begin{equation}\label{equation:Filtration/Filtration_Theory_and_Future_Work:Filtration/Filtration_Theory_and_Future_Work:43}
\begin{split}h_{e_{permassclay}} = \frac{\bar v_{constriction_{max}}^2}{2g\rho_{clay}  \Pi_{pore}^{deposit}\Lambda_{pore}^3\left(\phi-\frac{v_a}{ v_{constriction}} \right)}\left(\frac{D_{floc}}{D_{clay}}\right)^{3-D_{fractal}}\end{split}
\end{equation}
The head loss per mass of solids removed is significantly lower for larger sand sizes. When the coagulant dose increases the head loss increases rapidly because the constricted velocity increases and the floc diameter increases. Unfortunately we do not yet have a model describing floc size as a function of both velocity gradient and coagulant nanoparticle coverage.


\section{Particle removal efficiency}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:particle-removal-efficiency}}
Particle removal is complicated. We hypothesize that flocs form the deposits that change the flow from being wall shear dominated with a parabolic velocity profile to being uniform velocity flow through the constrictions. This uniform velocity profile transports a very small fraction of clay particles close enough to the deposit to be captured.

During filter ripening the particles that pass through the filter would be expected to be the primary particles because removal efficiency increases very rapidly with size. During the main part of the filter run the escaping particles are primary particles that weren’t captured by the actively growing deposits. Breakthrough at the end of the filter run is caused by both primary particles and flocs.

The flocs form a series of actively growing deposits. The number of actively growing deposits in series is possibly a function of the average volume of the flocs (smaller flocs result in more active deposits) and the volume fraction of the flocs normalized by the volume fraction of the primary particles. If this dimensionless volume fraction increases there may be more active deposits and hence improved removal of primary particles.


\section{Proposed experiments and inventions}
\label{\detokenize{Filtration/Filtration_Theory_and_Future_Work:proposed-experiments-and-inventions}}\begin{enumerate}
\item {} 
Compare different sizes of sand media. Expect to get poorer removal efficiency with larger sand sizes, similar mass of particles retained at breakthrough, and much lower head loss.

\item {} 
dual media. expect to find less head loss and poorer performance than single small media. And expect the smaller media to not contribute anything.

\item {} 
How small could the sand media be? We could get better filter performance if we used smaller sand. Shallow sand beds are apparently fine and if we used smaller diameter sand the filter layer depth could be reduced even more. Why not use a 0.2 mm sand and 5 cm sand layers? If we offset the inlet and outlet branches (with branches spaced on 10 cm centers and inlet and outlet branches offset by 5 cm) there would still be a significant path length.

\item {} 
Floc amendment. We could add floc hopper particles to the filter to increase the ratio of flocs to primary particles. Presumably this would reduce effluent turbidity IF there aren’t many primary particles in the floc hopper. We could compare the prospects of using smaller sand grains vs adding floc amendment as strategies to get higher performing filters.

\item {} 
Now that we know that sand doesn’t remove clay without the help of flocs, could we invent a filter that could capture clay and other primary particles without requiring ripening? We need a filter media that has sharp edges or sudden constrictions that create high velocity near the edge. Washers with holes the size of constrictions aren’t available.

\end{enumerate}


\chapter{Filtration Design Solution}
\label{\detokenize{Filtration/Filtration_Design_Solution:filtration-design-solution}}\label{\detokenize{Filtration/Filtration_Design_Solution::doc}}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{physchem} \PYG{k}{as} \PYG{n+nn}{pc}
\PYG{k+kn}{from} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{core}\PYG{n+nn}{.}\PYG{n+nn}{units} \PYG{k}{import} \PYG{n}{unit\PYGZus{}registry} \PYG{k}{as} \PYG{n}{u}
\PYG{k+kn}{import} \PYG{n+nn}{aguaclara}\PYG{n+nn}{.}\PYG{n+nn}{research}\PYG{n+nn}{.}\PYG{n+nn}{floc\PYGZus{}model} \PYG{k}{as} \PYG{n+nn}{fm}

\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{sphinxVerbatim}


\section{DC Stacked Rapid Sand Filtration}
\label{\detokenize{Filtration/Filtration_Design_Solution:dc-stacked-rapid-sand-filtration}}
The stacked rapid sand filter at Tamara, Honduras is treating 12 L/s of water with six 20 cm deep layers of sand. The sand has an effective size of 0.5 mm and a uniformity coefficient of 1.6. The backwash velocity of the filter is 11 mm/s. Defined below are many of the necessary inputs for the filtration analysis.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flow\PYGZus{}plant} \PYG{o}{=} \PYG{l+m+mi}{12} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{L} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{density\PYGZus{}sand} \PYG{o}{=} \PYG{l+m+mi}{2650} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{k\PYGZus{}Kozeny} \PYG{o}{=} \PYG{l+m+mi}{5}
\PYG{n}{H\PYGZus{}filter\PYGZus{}layer} \PYG{o}{=} \PYG{l+m+mi}{20} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{N\PYGZus{}filter\PYGZus{}layer} \PYG{o}{=} \PYG{l+m+mi}{6}


\PYG{c+c1}{\PYGZsh{}We will use 20 deg C as the typical operating temperature. Honduras is quite warm.}
\PYG{n}{T\PYGZus{}design} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}


\PYG{c+c1}{\PYGZsh{} Notes on Uniformity Coefficient and Effective size from http://www.clean\PYGZhy{}water\PYGZhy{}for\PYGZhy{}laymen.com/sand\PYGZhy{}sieve.html}

\PYG{c+c1}{\PYGZsh{}Effective Size (ES) \textendash{} This is defined as the size of screen opening that will pass 10\PYGZpc{} of the sand sample (see more explanation below)}
\PYG{c+c1}{\PYGZsh{}Uniformity Coefficient (UC) \textendash{} This is defined as a ratio and is calculated as the size opening that will just pass 60\PYGZpc{} of the sand (d60 value) divided by the size opening that will just pass 10\PYGZpc{} of the sand sample (d10 value).}
\PYG{c+c1}{\PYGZsh{}ES is basically a value describing the average size of sand grains in a sand sample.}
\PYG{c+c1}{\PYGZsh{}UC is basically a value describing the range of grain sizes present in a sample}

\PYG{n}{D\PYGZus{}filter\PYGZus{}sand\PYGZus{}ES} \PYG{o}{=} \PYG{l+m+mf}{0.5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}
\PYG{n}{UC\PYGZus{}filter\PYGZus{}sand} \PYG{o}{=} \PYG{l+m+mf}{1.6}
\PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand} \PYG{o}{=} \PYG{l+m+mf}{0.4}
\PYG{n}{V\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{=} \PYG{l+m+mi}{11} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\end{sphinxVerbatim}


\subsection{Remember: don’t break continuity!}
\label{\detokenize{Filtration/Filtration_Design_Solution:remember-dont-break-continuity}}
Ensure that you use the variables defined above in your code, do not hard code any numbers if you do not have to.


\subsubsection{1)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id1}}
Calculate the total sand depth of all 6 sand layers.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{H\PYGZus{}filter\PYGZus{}sand\PYGZus{}total} \PYG{o}{=} \PYG{p}{(}\PYG{n}{H\PYGZus{}filter\PYGZus{}layer} \PYG{o}{*} \PYG{n}{N\PYGZus{}filter\PYGZus{}layer}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The total depth of the filter sand is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{H\PYGZus{}filter\PYGZus{}sand\PYGZus{}total}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The total depth of the filter sand is 1.2 meter


\subsubsection{2)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id2}}
Calculate the diameter that is larger than 60\% of the sand (D60 of the filter sand).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{D60\PYGZus{}filter\PYGZus{}sand} \PYG{o}{=} \PYG{n}{D\PYGZus{}filter\PYGZus{}sand\PYGZus{}ES} \PYG{o}{*} \PYG{n}{UC\PYGZus{}filter\PYGZus{}sand}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The D60 for the sand grain size is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The D60 for the sand grain size is 0.8 millimeter


\subsubsection{3)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id3}}
What is the total filter bed plan view area for both filters in Tamara?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{A\PYGZus{}filter\PYGZus{}total} \PYG{o}{=} \PYG{p}{(}\PYG{n}{flow\PYGZus{}plant} \PYG{o}{/} \PYG{n}{V\PYGZus{}filter\PYGZus{}backwash}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The filter bed plan view area is }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{A\PYGZus{}filter\PYGZus{}total}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The filter bed plan view area is  1.091 meter ** 2


\subsubsection{4)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id4}}
What is the velocity of water through a filter during filtration? Recall that the flow through the filter is the same in filter and backwash modes.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{V\PYGZus{}filter} \PYG{o}{=} \PYG{n}{V\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{/} \PYG{n}{N\PYGZus{}filter\PYGZus{}layer}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The filtration velocity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{V\PYGZus{}filter}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The filtration velocity is 1.833 millimeter / second


\subsubsection{5)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id5}}
\sphinxstylestrong{Create a function} to calculate the head loss through the filter at the beginning of filtration with a clean filter bed. Then use that function to find the head loss through the clean bed of the Tamara filter. Assume that each flow path receives the same flow.

Recall: - If you have flow paths in parallel, the head loss is NOT the sum of the head loss in each path. - Instead, the head loss in each path is the same as the total head loss.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{headloss\PYGZus{}kozeny}\PYG{p}{(}\PYG{n}{PorosityFilterSand}\PYG{p}{,} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,} \PYG{n}{VelocityFilter}\PYG{p}{,} \PYG{n}{DepthFilter}\PYG{p}{)}\PYG{p}{:}

    \PYG{k}{return} \PYG{p}{(}\PYG{l+m+mi}{36}\PYG{o}{*}\PYG{n}{k\PYGZus{}Kozeny}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{PorosityFilterSand}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{/} \PYG{n}{PorosityFilterSand}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}
            \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)} \PYG{o}{*} \PYG{n}{VelocityFilter}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{D\PYGZus{}filter\PYGZus{}sand\PYGZus{}ES}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*} \PYG{n}{DepthFilter}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}\PYG{p}{)}

\PYG{n}{hl\PYGZus{}filter\PYGZus{}clean} \PYG{o}{=} \PYG{n}{headloss\PYGZus{}kozeny}\PYG{p}{(}\PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,} \PYG{n}{V\PYGZus{}filter}\PYG{p}{,} \PYG{n}{H\PYGZus{}filter\PYGZus{}layer}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The headloss through the clean filter sand is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hl\PYGZus{}filter\PYGZus{}clean}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The head loss through the clean filter sand is 15.20 cm


\subsubsection{6)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id6}}
\sphinxstylestrong{Create a function} to estimate the minimum fluidization velocity for this filter bed. Then use that function to find the minimum fluidization velocity of the Tamara filter. Fluidization occurs at the beginning of backwash as all of the water flows through the bottom inlet. Note that this is not the actual velocity used for backwashing the sand.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{velocity\PYGZus{}backwash\PYGZus{}min}\PYG{p}{(}\PYG{n}{porosity\PYGZus{}sand}\PYG{p}{,} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,}\PYG{n}{T}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{(}\PYG{p}{(}\PYG{n}{porosity\PYGZus{}sand}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{/} \PYG{p}{(}
            \PYG{l+m+mi}{36} \PYG{o}{*} \PYG{n}{k\PYGZus{}Kozeny} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{viscosity\PYGZus{}kinematic}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{porosity\PYGZus{}sand}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}
            \PYG{n}{density\PYGZus{}sand} \PYG{o}{/} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{T}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum fluidization velocity for this filter bed is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{velocity\PYGZus{}backwash\PYGZus{}min}\PYG{p}{(}\PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The minimum fluidization velocity for this filter bed is 6.1 mm/s


\subsubsection{7)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id7}}
First, plot the minimum backwash velocity as a function of water temperature from 0°C to 30°C. Then use your plot to answer the following question: if you have a water treatment plant with a single filter and there is a drought that is reducing flow to the plant, when should you backwash the filter? Should you backwash when the water is coolest or when the water is warmest?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{T\PYGZus{}graph}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{degC}
\PYG{n}{ypoints} \PYG{o}{=} \PYG{n}{velocity\PYGZus{}backwash\PYGZus{}min}\PYG{p}{(}\PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{p}{,}\PYG{n}{T\PYGZus{}graph}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{T\PYGZus{}graph}\PYG{p}{,}\PYG{n}{ypoints}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZhy{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Temperature (°C)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Minimum backwash velocity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filtration/Images/Minimum\PYGZus{}backwash\PYGZus{}velocity\PYGZus{}vs\PYGZus{}water\PYGZus{}temperature}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Minimum_backwash_velocity_vs_water_temperature}.png}
\caption{The minimum backwash velocity increases with temperature. Thus it is best to backwash when the water is coolest.}\label{\detokenize{Filtration/Filtration_Design_Solution:id22}}\label{\detokenize{Filtration/Filtration_Design_Solution:figure-minimum-backwash-velocity-vs-water-temperature}}\end{figure}


\subsubsection{8)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id8}}
What is the residence time of water in the filter during backwash, when the bed is fluidized? You may assume the sand bed expansion ratio is 1.3.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}filter\PYGZus{}backwash\PYGZus{}expansion} \PYG{o}{=} \PYG{l+m+mf}{1.3}
\PYG{n}{t\PYGZus{}res\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand} \PYG{o}{*} \PYG{n}{H\PYGZus{}filter\PYGZus{}sand\PYGZus{}total} \PYG{o}{+} \PYG{p}{(}
                            \PYG{n}{Pi\PYGZus{}filter\PYGZus{}backwash\PYGZus{}expansion} \PYG{o}{\PYGZhy{}} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{o}{*} \PYG{n}{H\PYGZus{}filter\PYGZus{}sand\PYGZus{}total}
                           \PYG{p}{)} \PYG{o}{/} \PYG{n}{V\PYGZus{}filter\PYGZus{}backwash}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}


\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The residence time in the fluidized bed during backwash is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{t\PYGZus{}res\PYGZus{}filter\PYGZus{}backwash}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The residence time in the fluidized bed during backwash is 76.36 second

Our next overall goal is to determine the ratio of water wasted in a Stacked Rapid Sand (StaRS) Filter to water treated in a StaRS. Given that the backwash water that ends up above the filter bed never returns to the filter it isn’t necessary to completely clear the water above the filter bed during a backwash cycle. Therefore we anticipate that backwash can be ended after approximately 3 expanded bed residence times. In addition it takes about 1 minute to initiate backwash by lowering the water level above the filter bed.


\subsubsection{9)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id9}}
To start, estimate the time between beginning backwash and finishing the cleaning of the bed.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{t\PYGZus{}filter\PYGZus{}backwash\PYGZus{}drain} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{min}
\PYG{n}{t\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{=} \PYG{p}{(}\PYG{n}{t\PYGZus{}res\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{*} \PYG{l+m+mi}{3} \PYG{o}{+} \PYG{n}{t\PYGZus{}filter\PYGZus{}backwash\PYGZus{}drain}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The time to backwash the filter is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{t\PYGZus{}filter\PYGZus{}backwash}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The time to backwash the filter is 289.1 second


\subsubsection{10)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id10}}
Estimate the total \sphinxstylestrong{depth} of water that is wasted while backwash is occurring.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water} \PYG{o}{=} \PYG{p}{(}\PYG{n}{V\PYGZus{}filter\PYGZus{}backwash} \PYG{o}{*} \PYG{n}{t\PYGZus{}filter\PYGZus{}backwash}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The total depth of water that is wasted is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

The total depth of water that is wasted is 3.18 meter


\subsubsection{11)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id11}}
Estimate the total depth of water that is lost due to refilling the filter box at the end of backwash plus the slow refilling to the maximum dirty bed height. You may ignore the influence of plumbing head loss and you may assume that the dirty bed head loss is about 40 cm. The water level in the filter during backwash is lower than the water level at the end of filtration by both the head loss during backwash AND the head loss at the end of filtration. There is also an additional 20 cm of lost water that is required for the hydraulic controls.

To reiterate, the three components that contribute to the depth of water lost in refilling the filter box after backwash are as follows:
\begin{enumerate}
\item {} 
Head loss during clean-bed filtration.

\item {} 
Difference in head loss between clean-bed filtration and dirty-bed filtration, just before backwash.

\item {} 
Height of the pipe that initiates backwash, also called the hydraulic control. This is actually the pipe’s diameter, since it is laying sideways in the filter.

\end{enumerate}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hl\PYGZus{}filter\PYGZus{}final} \PYG{o}{=} \PYG{l+m+mi}{40} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{H\PYGZus{}hydraulic\PYGZus{}controls} \PYG{o}{=} \PYG{l+m+mi}{20}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water\PYGZus{}refill} \PYG{o}{=} \PYG{n}{H\PYGZus{}filter\PYGZus{}sand\PYGZus{}total} \PYG{o}{+} \PYG{n}{H\PYGZus{}hydraulic\PYGZus{}controls} \PYG{o}{+} \PYG{n}{hl\PYGZus{}filter\PYGZus{}final}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The total depth of water that is lost due to refilling the filter box is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water\PYGZus{}refill}\PYG{p}{)}
\end{sphinxVerbatim}

The total depth of water that is lost due to refilling the filter box is 1.8 meter


\subsubsection{12)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id12}}
Now calculate the total length (or depth) of water that is wasted due to backwash by adding the two previous lengths. The length found in problem 10 represents water wasted while backwash is occurring, while the length in problem 11 represents the water lost in the transition to and from backwash.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water\PYGZus{}wasted} \PYG{o}{=} \PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water} \PYG{o}{+} \PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water\PYGZus{}refill}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The depth of the water that is wasted due to backwash is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water\PYGZus{}wasted}\PYG{p}{)}
\end{sphinxVerbatim}

The depth of the water that is wasted due to backwash is 4.98 meter


\subsubsection{13)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id13}}
Assume that the filter is backwashed every 12 hours. This means that the filter is producing clean water for 12 hours before it need to be backwashed. What is the total height (or length) of water that would be treated by the filter during this time? This length when multiplied by the area of the filter would give the total volume of water processed by a filter.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{t\PYGZus{}filter\PYGZus{}cycle} \PYG{o}{=} \PYG{l+m+mi}{12} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{hr}
\PYG{n}{H\PYGZus{}water\PYGZus{}filtered\PYGZus{}per\PYGZus{}cycle} \PYG{o}{=} \PYG{p}{(}\PYG{n}{t\PYGZus{}filter\PYGZus{}cycle} \PYG{o}{*} \PYG{n}{V\PYGZus{}filter\PYGZus{}backwash}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The height of water that would enter the filter in 12 hours is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{H\PYGZus{}water\PYGZus{}filtered\PYGZus{}per\PYGZus{}cycle}\PYG{p}{)}
\end{sphinxVerbatim}

The height of water that would enter the filter in 12 hours is 475.2 meter


\subsubsection{14)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id14}}
Finally, what is the ratio of water lost due to backwash and related water level changes in the filter box to water treated?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}water\PYGZus{}wasted} \PYG{o}{=} \PYG{p}{(}\PYG{n}{H\PYGZus{}filter\PYGZus{}backwash\PYGZus{}water\PYGZus{}wasted} \PYG{o}{/} \PYG{n}{H\PYGZus{}water\PYGZus{}filtered\PYGZus{}per\PYGZus{}cycle}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The fraction of the total water that is lost due to backwash is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Pi\PYGZus{}water\PYGZus{}wasted}\PYG{p}{)}
\end{sphinxVerbatim}

The fraction of the total water that is lost due to backwash is 0.01048 dimensionless


\subsubsection{15)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id15}}
Now we will evaluate the very first data set from a full scale SRSF. The performance data given below is the settled water turbidity and then the filtered water turbidity during one filter run. The time step is 5 minutes. Plot pC* for the filter as well as effluent turbidity as a function of time on two separate graphs.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{filter\PYGZus{}influent} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{7.06201}\PYG{p}{,}\PYG{l+m+mf}{7.14465}\PYG{p}{,}\PYG{l+m+mf}{7.00537}\PYG{p}{,}\PYG{l+m+mf}{6.33032}\PYG{p}{,}\PYG{l+m+mf}{5.4502}\PYG{p}{,}\PYG{l+m+mf}{4.98511}\PYG{p}{,}\PYG{l+m+mf}{4.64221}\PYG{p}{,}\PYG{l+m+mf}{4.23853}\PYG{p}{,}\PYG{l+m+mf}{3.93707}\PYG{p}{,}\PYG{l+m+mf}{3.72717}\PYG{p}{,}\PYG{l+m+mf}{3.67126}\PYG{p}{,}\PYG{l+m+mf}{3.55866}\PYG{p}{,}\PYG{l+m+mf}{3.55292}\PYG{p}{,}\PYG{l+m+mf}{3.45593}\PYG{p}{,}\PYG{l+m+mf}{3.48163}\PYG{p}{,}\PYG{l+m+mf}{3.50226}\PYG{p}{,}\PYG{l+m+mf}{3.45093}\PYG{p}{,}\PYG{l+m+mf}{3.50232}\PYG{p}{,}\PYG{l+m+mf}{3.41095}\PYG{p}{,}\PYG{l+m+mf}{3.55341}\PYG{p}{,}\PYG{l+m+mf}{3.46643}\PYG{p}{,}\PYG{l+m+mf}{3.50732}\PYG{p}{,}\PYG{l+m+mf}{3.49146}\PYG{p}{,}\PYG{l+m+mf}{3.51208}\PYG{p}{,}\PYG{l+m+mf}{3.487}\PYG{p}{,}\PYG{l+m+mf}{3.58893}\PYG{p}{,}\PYG{l+m+mf}{3.54315}\PYG{p}{,}\PYG{l+m+mf}{3.61469}\PYG{p}{,}\PYG{l+m+mf}{3.58429}\PYG{p}{,}\PYG{l+m+mf}{3.55835}\PYG{p}{,}\PYG{l+m+mf}{3.72723}\PYG{p}{,}\PYG{l+m+mf}{3.7829}\PYG{p}{,}\PYG{l+m+mf}{3.74201}\PYG{p}{,}\PYG{l+m+mf}{3.82398}\PYG{p}{,}\PYG{l+m+mf}{3.74725}\PYG{p}{,}\PYG{l+m+mf}{3.83423}\PYG{p}{,}\PYG{l+m+mf}{3.72717}\PYG{p}{,}\PYG{l+m+mf}{3.72705}\PYG{p}{,}\PYG{l+m+mf}{3.87079}\PYG{p}{,}\PYG{l+m+mf}{3.77338}\PYG{p}{,}\PYG{l+m+mf}{3.70148}\PYG{p}{,}\PYG{l+m+mf}{3.74762}\PYG{p}{,}\PYG{l+m+mf}{3.76227}\PYG{p}{,}\PYG{l+m+mf}{3.58875}\PYG{p}{,}\PYG{l+m+mf}{3.63477}\PYG{p}{,}\PYG{l+m+mf}{3.67566}\PYG{p}{,}\PYG{l+m+mf}{3.52789}\PYG{p}{,}\PYG{l+m+mf}{3.59296}\PYG{p}{,}\PYG{l+m+mf}{3.66577}\PYG{p}{,}\PYG{l+m+mf}{3.51709}\PYG{p}{,}\PYG{l+m+mf}{3.63965}\PYG{p}{,}\PYG{l+m+mf}{3.57843}\PYG{p}{,}\PYG{l+m+mf}{3.47546}\PYG{p}{,}\PYG{l+m+mf}{3.66016}\PYG{p}{,}\PYG{l+m+mf}{3.58386}\PYG{p}{,}\PYG{l+m+mf}{3.53259}\PYG{p}{,}\PYG{l+m+mf}{3.57886}\PYG{p}{,}\PYG{l+m+mf}{3.51392}\PYG{p}{,}\PYG{l+m+mf}{3.63983}\PYG{p}{,}\PYG{l+m+mf}{3.64972}\PYG{p}{,}\PYG{l+m+mf}{3.64606}\PYG{p}{,}\PYG{l+m+mf}{3.49121}\PYG{p}{,}\PYG{l+m+mf}{3.51691}\PYG{p}{,}\PYG{l+m+mf}{3.5119}\PYG{p}{,}\PYG{l+m+mf}{3.61414}\PYG{p}{,}\PYG{l+m+mf}{3.5835}\PYG{p}{,}\PYG{l+m+mf}{3.46558}\PYG{p}{,}\PYG{l+m+mf}{3.63965}\PYG{p}{,}\PYG{l+m+mf}{3.60962}\PYG{p}{,}\PYG{l+m+mf}{3.50147}\PYG{p}{,}\PYG{l+m+mf}{3.51678}\PYG{p}{,}\PYG{l+m+mf}{3.46039}\PYG{p}{,}\PYG{l+m+mf}{3.49133}\PYG{p}{,}\PYG{l+m+mf}{3.48566}\PYG{p}{,}\PYG{l+m+mf}{3.50104}\PYG{p}{,}\PYG{l+m+mf}{3.5943}\PYG{p}{,}\PYG{l+m+mf}{3.47778}\PYG{p}{,}\PYG{l+m+mf}{3.53766}\PYG{p}{,}\PYG{l+m+mf}{3.55811}\PYG{p}{,}\PYG{l+m+mf}{3.50635}\PYG{p}{,}\PYG{l+m+mf}{3.42535}\PYG{p}{,}\PYG{l+m+mf}{3.48077}\PYG{p}{,}\PYG{l+m+mf}{3.54242}\PYG{p}{,}\PYG{l+m+mf}{3.55274}\PYG{p}{,}\PYG{l+m+mf}{3.59369}\PYG{p}{,}\PYG{l+m+mf}{3.48596}\PYG{p}{,}\PYG{l+m+mf}{3.53296}\PYG{p}{,}\PYG{l+m+mf}{3.51746}\PYG{p}{,}\PYG{l+m+mf}{3.45056}\PYG{p}{,}\PYG{l+m+mf}{3.59387}\PYG{p}{,}\PYG{l+m+mf}{3.5426}\PYG{p}{,}\PYG{l+m+mf}{4.26868}\PYG{p}{,}\PYG{l+m+mf}{3.99201}\PYG{p}{,}\PYG{l+m+mf}{3.45569}\PYG{p}{,}\PYG{l+m+mf}{3.86975}\PYG{p}{,}\PYG{l+m+mf}{3.54407}\PYG{p}{,}\PYG{l+m+mf}{3.49097}\PYG{p}{,}\PYG{l+m+mf}{3.9823}\PYG{p}{,}\PYG{l+m+mf}{3.58325}\PYG{p}{,}\PYG{l+m+mf}{3.77789}\PYG{p}{,}\PYG{l+m+mf}{3.70111}\PYG{p}{,}\PYG{l+m+mf}{3.59839}\PYG{p}{,}\PYG{l+m+mf}{4.09424}\PYG{p}{,}\PYG{l+m+mf}{3.56769}\PYG{p}{,}\PYG{l+m+mf}{3.83325}\PYG{p}{,}\PYG{l+m+mf}{3.76019}\PYG{p}{,}\PYG{l+m+mf}{3.49121}\PYG{p}{,}\PYG{l+m+mf}{4.52917}\PYG{p}{,}\PYG{l+m+mf}{3.63037}\PYG{p}{,}\PYG{l+m+mf}{4.21228}\PYG{p}{,}\PYG{l+m+mf}{3.60858}\PYG{p}{,}\PYG{l+m+mf}{4.72827}\PYG{p}{,}\PYG{l+m+mf}{4.00757}\PYG{p}{,}\PYG{l+m+mf}{3.71674}\PYG{p}{,}\PYG{l+m+mf}{3.87647}\PYG{p}{,}\PYG{l+m+mf}{3.8288}\PYG{p}{,}\PYG{l+m+mf}{3.44067}\PYG{p}{,}\PYG{l+m+mf}{3.74219}\PYG{p}{,}\PYG{l+m+mf}{3.64941}\PYG{p}{,}\PYG{l+m+mf}{3.87439}\PYG{p}{,}\PYG{l+m+mf}{3.79327}\PYG{p}{,}\PYG{l+m+mf}{4.10486}\PYG{p}{,}\PYG{l+m+mf}{4.16638}\PYG{p}{,}\PYG{l+m+mf}{3.84418}\PYG{p}{,}\PYG{l+m+mf}{4.11792}\PYG{p}{,}\PYG{l+m+mf}{3.46082}\PYG{p}{,}\PYG{l+m+mf}{3.71661}\PYG{p}{,}\PYG{l+m+mf}{3.5061}\PYG{p}{,}\PYG{l+m+mf}{3.48596}\PYG{p}{,}\PYG{l+m+mf}{4.42175}\PYG{p}{,}\PYG{l+m+mf}{3.57806}\PYG{p}{,}\PYG{l+m+mf}{4.01294}\PYG{p}{,}\PYG{l+m+mf}{3.63965}\PYG{p}{,}\PYG{l+m+mf}{3.80408}\PYG{p}{,}\PYG{l+m+mf}{3.60431}\PYG{p}{,}\PYG{l+m+mf}{3.67572}\PYG{p}{,}\PYG{l+m+mf}{3.61981}\PYG{p}{,}\PYG{l+m+mf}{3.66022}\PYG{p}{,}\PYG{l+m+mf}{3.67554}\PYG{p}{,}\PYG{l+m+mf}{3.46076}\PYG{p}{,}\PYG{l+m+mf}{3.72669}\PYG{p}{,}\PYG{l+m+mf}{3.56287}\PYG{p}{,}\PYG{l+m+mf}{3.66003}\PYG{p}{,}\PYG{l+m+mf}{3.60004}\PYG{p}{,}\PYG{l+m+mf}{3.4812}\PYG{p}{,}\PYG{l+m+mf}{3.55823}\PYG{p}{,}\PYG{l+m+mf}{6.19641}\PYG{p}{,}\PYG{l+m+mf}{3.74146}\PYG{p}{,}\PYG{l+m+mf}{3.88025}\PYG{p}{,}\PYG{l+m+mf}{4.18713}\PYG{p}{,}\PYG{l+m+mf}{4.27881}\PYG{p}{,}\PYG{l+m+mf}{3.6496}\PYG{p}{,}\PYG{l+m+mf}{3.45111}\PYG{p}{,}\PYG{l+m+mf}{3.8656}\PYG{p}{,}\PYG{l+m+mf}{3.90106}\PYG{p}{,}\PYG{l+m+mf}{3.68597}\PYG{p}{,}\PYG{l+m+mf}{3.66101}\PYG{p}{,}\PYG{l+m+mf}{3.88513}\PYG{p}{,}\PYG{l+m+mf}{3.74652}\PYG{p}{,}\PYG{l+m+mf}{3.70123}\PYG{p}{,}\PYG{l+m+mf}{3.79828}\PYG{p}{,}\PYG{l+m+mf}{3.84369}\PYG{p}{,}\PYG{l+m+mf}{3.59418}\PYG{p}{,}\PYG{l+m+mf}{3.60968}\PYG{p}{,}\PYG{l+m+mf}{3.49127}\PYG{p}{,}\PYG{l+m+mf}{3.45081}\PYG{p}{,}\PYG{l+m+mf}{3.40424}\PYG{p}{,}\PYG{l+m+mf}{3.35852}\PYG{p}{,}\PYG{l+m+mf}{3.32788}\PYG{p}{,}\PYG{l+m+mf}{3.29211}\PYG{p}{,}\PYG{l+m+mf}{3.21008}\PYG{p}{,}\PYG{l+m+mf}{3.79279}\PYG{p}{,}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}
\PYG{n}{filter\PYGZus{}effluent} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.926376}\PYG{p}{,}\PYG{l+m+mf}{0.645981}\PYG{p}{,}\PYG{l+m+mf}{0.69725}\PYG{p}{,}\PYG{l+m+mf}{0.625855}\PYG{p}{,}\PYG{l+m+mf}{0.600449}\PYG{p}{,}\PYG{l+m+mf}{0.472694}\PYG{p}{,}\PYG{l+m+mf}{0.381546}\PYG{p}{,}\PYG{l+m+mf}{0.340439}\PYG{p}{,}\PYG{l+m+mf}{0.309883}\PYG{p}{,}\PYG{l+m+mf}{0.289848}\PYG{p}{,}\PYG{l+m+mf}{0.27813}\PYG{p}{,}\PYG{l+m+mf}{0.254097}\PYG{p}{,}\PYG{l+m+mf}{0.249432}\PYG{p}{,}\PYG{l+m+mf}{0.253769}\PYG{p}{,}\PYG{l+m+mf}{0.203117}\PYG{p}{,}\PYG{l+m+mf}{0.253891}\PYG{p}{,}\PYG{l+m+mf}{0.34063}\PYG{p}{,}\PYG{l+m+mf}{0.223385}\PYG{p}{,}\PYG{l+m+mf}{0.365952}\PYG{p}{,}\PYG{l+m+mf}{0.264389}\PYG{p}{,}\PYG{l+m+mf}{0.259193}\PYG{p}{,}\PYG{l+m+mf}{0.340576}\PYG{p}{,}\PYG{l+m+mf}{0.279671}\PYG{p}{,}\PYG{l+m+mf}{0.309776}\PYG{p}{,}\PYG{l+m+mf}{0.304878}\PYG{p}{,}\PYG{l+m+mf}{0.279404}\PYG{p}{,}\PYG{l+m+mf}{0.299896}\PYG{p}{,}\PYG{l+m+mf}{0.340294}\PYG{p}{,}\PYG{l+m+mf}{0.25399}\PYG{p}{,}\PYG{l+m+mf}{0.350731}\PYG{p}{,}\PYG{l+m+mf}{0.34053}\PYG{p}{,}\PYG{l+m+mf}{0.487877}\PYG{p}{,}\PYG{l+m+mf}{0.391518}\PYG{p}{,}\PYG{l+m+mf}{0.309715}\PYG{p}{,}\PYG{l+m+mf}{0.360901}\PYG{p}{,}\PYG{l+m+mf}{0.442352}\PYG{p}{,}\PYG{l+m+mf}{0.30967}\PYG{p}{,}\PYG{l+m+mf}{0.391251}\PYG{p}{,}\PYG{l+m+mf}{0.457253}\PYG{p}{,}\PYG{l+m+mf}{0.447685}\PYG{p}{,}\PYG{l+m+mf}{0.386322}\PYG{p}{,}\PYG{l+m+mf}{0.549149}\PYG{p}{,}\PYG{l+m+mf}{0.33036}\PYG{p}{,}\PYG{l+m+mf}{0.426437}\PYG{p}{,}\PYG{l+m+mf}{0.513458}\PYG{p}{,}\PYG{l+m+mf}{0.279022}\PYG{p}{,}\PYG{l+m+mf}{0.462692}\PYG{p}{,}\PYG{l+m+mf}{0.589768}\PYG{p}{,}\PYG{l+m+mf}{0.381073}\PYG{p}{,}\PYG{l+m+mf}{0.532669}\PYG{p}{,}\PYG{l+m+mf}{0.538529}\PYG{p}{,}\PYG{l+m+mf}{0.350472}\PYG{p}{,}\PYG{l+m+mf}{0.559036}\PYG{p}{,}\PYG{l+m+mf}{0.51828}\PYG{p}{,}\PYG{l+m+mf}{0.462578}\PYG{p}{,}\PYG{l+m+mf}{0.594772}\PYG{p}{,}\PYG{l+m+mf}{0.47242}\PYG{p}{,}\PYG{l+m+mf}{0.538681}\PYG{p}{,}\PYG{l+m+mf}{0.605087}\PYG{p}{,}\PYG{l+m+mf}{0.402168}\PYG{p}{,}\PYG{l+m+mf}{0.538818}\PYG{p}{,}\PYG{l+m+mf}{0.66658}\PYG{p}{,}\PYG{l+m+mf}{0.447243}\PYG{p}{,}\PYG{l+m+mf}{0.574585}\PYG{p}{,}\PYG{l+m+mf}{0.691544}\PYG{p}{,}\PYG{l+m+mf}{0.513382}\PYG{p}{,}\PYG{l+m+mf}{0.655701}\PYG{p}{,}\PYG{l+m+mf}{0.655884}\PYG{p}{,}\PYG{l+m+mf}{0.605408}\PYG{p}{,}\PYG{l+m+mf}{0.666153}\PYG{p}{,}\PYG{l+m+mf}{0.599976}\PYG{p}{,}\PYG{l+m+mf}{0.651047}\PYG{p}{,}\PYG{l+m+mf}{0.702515}\PYG{p}{,}\PYG{l+m+mf}{0.92572}\PYG{p}{,}\PYG{l+m+mf}{0.90535}\PYG{p}{,}\PYG{l+m+mf}{0.732117}\PYG{p}{,}\PYG{l+m+mf}{0.605026}\PYG{p}{,}\PYG{l+m+mf}{0.849335}\PYG{p}{,}\PYG{l+m+mf}{0.691925}\PYG{p}{,}\PYG{l+m+mf}{0.584976}\PYG{p}{,}\PYG{l+m+mf}{0.803314}\PYG{p}{,}\PYG{l+m+mf}{0.783569}\PYG{p}{,}\PYG{l+m+mf}{0.706787}\PYG{p}{,}\PYG{l+m+mf}{0.783066}\PYG{p}{,}\PYG{l+m+mf}{0.640701}\PYG{p}{,}\PYG{l+m+mf}{0.732269}\PYG{p}{,}\PYG{l+m+mf}{0.803497}\PYG{p}{,}\PYG{l+m+mf}{0.625458}\PYG{p}{,}\PYG{l+m+mf}{0.625687}\PYG{p}{,}\PYG{l+m+mf}{1.00089}\PYG{p}{,}\PYG{l+m+mf}{1.03265}\PYG{p}{,}\PYG{l+m+mf}{1.00687}\PYG{p}{,}\PYG{l+m+mf}{0.834213}\PYG{p}{,}\PYG{l+m+mf}{0.732224}\PYG{p}{,}\PYG{l+m+mf}{0.859665}\PYG{p}{,}\PYG{l+m+mf}{0.559174}\PYG{p}{,}\PYG{l+m+mf}{1.08862}\PYG{p}{,}\PYG{l+m+mf}{0.93634}\PYG{p}{,}\PYG{l+m+mf}{0.722717}\PYG{p}{,}\PYG{l+m+mf}{0.966141}\PYG{p}{,}\PYG{l+m+mf}{1.03278}\PYG{p}{,}\PYG{l+m+mf}{0.890366}\PYG{p}{,}\PYG{l+m+mf}{0.874756}\PYG{p}{,}\PYG{l+m+mf}{0.813675}\PYG{p}{,}\PYG{l+m+mf}{0.864746}\PYG{p}{,}\PYG{l+m+mf}{0.874863}\PYG{p}{,}\PYG{l+m+mf}{0.625504}\PYG{p}{,}\PYG{l+m+mf}{0.874847}\PYG{p}{,}\PYG{l+m+mf}{0.889893}\PYG{p}{,}\PYG{l+m+mf}{0.931473}\PYG{p}{,}\PYG{l+m+mf}{0.880112}\PYG{p}{,}\PYG{l+m+mf}{1.30231}\PYG{p}{,}\PYG{l+m+mf}{0.813965}\PYG{p}{,}\PYG{l+m+mf}{0.961502}\PYG{p}{,}\PYG{l+m+mf}{0.966324}\PYG{p}{,}\PYG{l+m+mf}{0.839432}\PYG{p}{,}\PYG{l+m+mf}{0.889969}\PYG{p}{,}\PYG{l+m+mf}{0.930618}\PYG{p}{,}\PYG{l+m+mf}{1.20074}\PYG{p}{,}\PYG{l+m+mf}{0.93631}\PYG{p}{,}\PYG{l+m+mf}{0.951584}\PYG{p}{,}\PYG{l+m+mf}{0.78331}\PYG{p}{,}\PYG{l+m+mf}{0.961609}\PYG{p}{,}\PYG{l+m+mf}{0.996796}\PYG{p}{,}\PYG{l+m+mf}{0.940994}\PYG{p}{,}\PYG{l+m+mf}{0.966675}\PYG{p}{,}\PYG{l+m+mf}{1.04788}\PYG{p}{,}\PYG{l+m+mf}{0.951645}\PYG{p}{,}\PYG{l+m+mf}{0.966888}\PYG{p}{,}\PYG{l+m+mf}{1.01251}\PYG{p}{,}\PYG{l+m+mf}{0.96167}\PYG{p}{,}\PYG{l+m+mf}{1.0076}\PYG{p}{,}\PYG{l+m+mf}{0.900436}\PYG{p}{,}\PYG{l+m+mf}{0.996628}\PYG{p}{,}\PYG{l+m+mf}{1.12949}\PYG{p}{,}\PYG{l+m+mf}{0.910263}\PYG{p}{,}\PYG{l+m+mf}{1.03256}\PYG{p}{,}\PYG{l+m+mf}{1.04788}\PYG{p}{,}\PYG{l+m+mf}{0.997604}\PYG{p}{,}\PYG{l+m+mf}{1.05817}\PYG{p}{,}\PYG{l+m+mf}{1.05801}\PYG{p}{,}\PYG{l+m+mf}{1.06311}\PYG{p}{,}\PYG{l+m+mf}{1.05805}\PYG{p}{,}\PYG{l+m+mf}{1.00711}\PYG{p}{,}\PYG{l+m+mf}{1.05811}\PYG{p}{,}\PYG{l+m+mf}{1.11896}\PYG{p}{,}\PYG{l+m+mf}{1.06299}\PYG{p}{,}\PYG{l+m+mf}{1.07318}\PYG{p}{,}\PYG{l+m+mf}{0.966049}\PYG{p}{,}\PYG{l+m+mf}{1.07343}\PYG{p}{,}\PYG{l+m+mf}{1.09918}\PYG{p}{,}\PYG{l+m+mf}{1.15497}\PYG{p}{,}\PYG{l+m+mf}{1.07303}\PYG{p}{,}\PYG{l+m+mf}{1.13937}\PYG{p}{,}\PYG{l+m+mf}{1.12402}\PYG{p}{,}\PYG{l+m+mf}{1.155}\PYG{p}{,}\PYG{l+m+mf}{1.15436}\PYG{p}{,}\PYG{l+m+mf}{1.2056}\PYG{p}{,}\PYG{l+m+mf}{1.14954}\PYG{p}{,}\PYG{l+m+mf}{1.17526}\PYG{p}{,}\PYG{l+m+mf}{1.15457}\PYG{p}{,}\PYG{l+m+mf}{1.20569}\PYG{p}{,}\PYG{l+m+mf}{1.17517}\PYG{p}{,}\PYG{l+m+mf}{1.0376}\PYG{p}{,}\PYG{l+m+mf}{0.915253}\PYG{p}{,}\PYG{l+m+mf}{0.935471}\PYG{p}{,}\PYG{l+m+mf}{0.884979}\PYG{p}{,}\PYG{l+m+mf}{0.89035}\PYG{p}{,}\PYG{l+m+mf}{0.940781}\PYG{p}{,}\PYG{l+m+mf}{0.885071}\PYG{p}{,}\PYG{l+m+mf}{0.874817}\PYG{p}{,}\PYG{l+m+mf}{0.828796}\PYG{p}{]}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU}


\PYG{n}{t\PYGZus{}delta} \PYG{o}{=} \PYG{l+m+mi}{5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{min}
\PYG{n}{t\PYGZus{}end} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{(}\PYG{n}{filter\PYGZus{}effluent}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{n}{t\PYGZus{}data} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{n}{t\PYGZus{}end}\PYG{p}{)}\PYG{o}{*}\PYG{n}{t\PYGZus{}delta}
\PYG{n}{c\PYGZus{}dim} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{divide}\PYG{p}{(}\PYG{n}{filter\PYGZus{}effluent}\PYG{p}{,}\PYG{n}{filter\PYGZus{}influent}\PYG{p}{)}
\PYG{n}{filter\PYGZus{}pc} \PYG{o}{=} \PYG{o}{\PYGZhy{}}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log10}\PYG{p}{(}\PYG{n}{c\PYGZus{}dim}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{t\PYGZus{}data}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{,}\PYG{n}{filter\PYGZus{}pc}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filter run time (hrs)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{pC*}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filtration/Images/Filter\PYGZus{}run\PYGZus{}time\PYGZus{}vs\PYGZus{}removal\PYGZus{}efficiency}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{t\PYGZus{}data}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{,}\PYG{n}{filter\PYGZus{}effluent}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filter run time (hrs)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Effluent turbidity (NTU)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filtration/Images/Filter\PYGZus{}run\PYGZus{}time\PYGZus{}vs\PYGZus{}effluent\PYGZus{}turbidity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Filter_run_time_vs_removal_efficiency}.png}
\caption{The pC* for this filter run was not very good and suggests that either some particles were being released by the new sand or the coagulant dose was not optimal.}\label{\detokenize{Filtration/Filtration_Design_Solution:id23}}\label{\detokenize{Filtration/Filtration_Design_Solution:figure-filter-run-time-vs-removal-efficiency}}\end{figure}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Filter_run_time_vs_effluent_turbidity}.png}
\caption{The filter performance deteriorated over the length of the filter run. This does not match the expectations that we have based on laboratory experiments with filters. AguaClara has limited data of filter performance as a function of time. However, the \sphinxhref{http://aguaclara.github.io/index.html}{recent data from Tamara} (select Tamara from the drop down menu of plants) suggests that filtered water turbidity is consistently lower than in this first run of the filter that you plotted above.}\label{\detokenize{Filtration/Filtration_Design_Solution:id24}}\label{\detokenize{Filtration/Filtration_Design_Solution:figure-filter-run-time-vs-effluent-turbidity}}\end{figure}


\subsubsection{16)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id16}}
How many kg of suspended solids per square meter of filter were removed during this filter run. Use the plan view area for the filter (don’t multiply by the number of layers)

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{M\PYGZus{}filter\PYGZus{}solids} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{(}\PYG{n}{filter\PYGZus{}influent} \PYG{o}{\PYGZhy{}} \PYG{n}{filter\PYGZus{}effluent}\PYG{p}{)} \PYG{o}{*} \PYG{p}{(}
                    \PYG{n}{flow\PYGZus{}plant} \PYG{o}{*} \PYG{n}{t\PYGZus{}delta}\PYG{p}{)}\PYG{o}{/} \PYG{n}{A\PYGZus{}filter\PYGZus{}total}\PYG{p}{)}
                     \PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The mass of the suspended solids removed is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{M\PYGZus{}filter\PYGZus{}solids}\PYG{p}{)}
\end{sphinxVerbatim}

The mass of the suspended solids removed is 2.94 kg/m\(\sp{\text{2}}\)


\subsubsection{17)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id17}}
Another useful way to express the solids capacity of the filter is to calculate the turbidity removed the run time and then express the results with units of NTU hrs. What was the capacity of the filter in NTU hrs?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{solids\PYGZus{}capacity\PYGZus{}filter} \PYG{o}{=} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{p}{(}\PYG{n}{filter\PYGZus{}influent}\PYG{o}{\PYGZhy{}}\PYG{n}{filter\PYGZus{}effluent}\PYG{p}{)} \PYG{o}{*} \PYG{n}{t\PYGZus{}delta}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{NTU} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{hr}\PYG{p}{)}


\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The filter capacity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{solids\PYGZus{}capacity\PYGZus{}filter}\PYG{p}{,}\PYG{p}{)}
\end{sphinxVerbatim}

The filter capacity is 43.72 NTU * hour


\subsubsection{18)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id18}}
How long was the filter run?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{t\PYGZus{}filter\PYGZus{}cycle} \PYG{o}{=} \PYG{n}{t\PYGZus{}data}\PYG{p}{[}\PYG{n}{np}\PYG{o}{.}\PYG{n}{size}\PYG{p}{(}\PYG{n}{t\PYGZus{}data}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The filter was run for}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{t\PYGZus{}filter\PYGZus{}cycle}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{hour}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The filter was run for 14.25 hour


\subsubsection{19)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id19}}
What is the total volume of pores per square meter (plan view area) of StarS filter bed (includes all 6 layers) (in L/m\textasciicircum{}2)?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{volume\PYGZus{}filter\PYGZus{}pores} \PYG{o}{=} \PYG{p}{(}\PYG{n}{H\PYGZus{}filter\PYGZus{}sand\PYGZus{}total} \PYG{o}{*} \PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The total volume of pores is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{volume\PYGZus{}filter\PYGZus{}pores}\PYG{p}{)}
\end{sphinxVerbatim}

The total volume of pores is 480 liter / meter ** 2


\subsubsection{20)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id20}}
The next step is to estimate the volume of flocs per plan view area of the filter. Assume the density of the flocs being captured by the filter are approximated by the density of flocs that have a sedimentation velocity of 0.10 mm/s (slightly less than the capture velocity of the plate settlers). (see slides in flocculation notes for size of the floc and then density of that floc. I’ve provided this value below to simplify the analysis

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{density\PYGZus{}floc} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)} \PYG{o}{+} \PYG{l+m+mi}{100} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\PYG{n}{density\PYGZus{}clay} \PYG{o}{=} \PYG{l+m+mi}{2650} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{kg}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}
\end{sphinxVerbatim}

Given the floc density, calculate fraction of floc volume that is clay.

Given that floc mass is the sum of clay mass and water mass and given that floc volume is the sum of clay volume and water volume, derive an equation for the volume of flocs per plan view area of a stacked rapid sand filter (includes all 6 layers) given the floc, clay, and water densities and the mass of the clay. Show the equations that you derive using Latex

Mass conservation gives
\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:0}
\begin{split}Vol_{Floc} \cdot \rho_{Floc} = M_{Clay} + M_{Water}\end{split}
\end{equation}
\(M_{Water}\) is an unknown.
\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:1}
\begin{split}M_{Water} = Vol_{Floc} \cdot \rho{Floc} - M_{Clay}\end{split}
\end{equation}
Volume conservation gives
\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:2}
\begin{split}Vol_{Floc} = Vol_{Clay} + Vol_{Water}\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:3}
\begin{split}Vol_{Floc} = \frac{M_{Clay}}{\rho_{Clay}} + \frac{M_{Water}}{\rho_{Water}}\end{split}
\end{equation}
Substitute to eliminate \(M_{Water}\)
\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:4}
\begin{split}Vol_{Floc} = \frac{M_{Clay}}{\rho_{Clay}} + \frac{Vol_{Floc} \cdot \rho_{Floc}}{\rho_{Water}} -\frac{M_{Clay}}{\rho_{Water}}\end{split}
\end{equation}
Solve for \(Vol_{Floc}\)
\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:5}
\begin{split}Vol_{Floc} - \frac{Vol_{Floc} \cdot \rho_{Floc}}{\rho_{Water}} = \frac{M_{Clay}}{\rho_{Clay}} - \frac{M_{Clay}}{\rho_{Water}}\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:6}
\begin{split}Vol_{Floc}\left ( 1-\frac{\rho_{Floc}}{\rho_{Water}} \right ) = M_{Clay}\left ( \frac{1}{\rho_{Clay}} -\frac{1}{\rho_{Water}}\right )\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:7}
\begin{split}Vol_{Floc} = M_{Clay}\left ( \frac{\frac{1}{\rho_{Clay}}-\frac{1}{\rho_{Water}}}{ 1-\frac{\rho_{Floc}}{\rho_{Water}}} \right )\end{split}
\end{equation}\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:8}
\begin{split}Vol_{Floc} = { \frac{M_{Clay}\rho_{Water}}{\rho_{Floc}-\rho_{Water}}}\left ( \frac{1}{\rho_{Water}}-\frac{1}{\rho_{Clay}} \right )\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{vol\PYGZus{}floc} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{n}{M\PYGZus{}filter\PYGZus{}solids} \PYG{o}{*}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{density\PYGZus{}floc}\PYG{o}{\PYGZhy{}}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)} \PYG{o}{*}
            \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{pc}\PYG{o}{.}\PYG{n}{density\PYGZus{}water}\PYG{p}{(}\PYG{n}{T\PYGZus{}design}\PYG{p}{)}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{density\PYGZus{}clay}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{l} \PYG{o}{/} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m} \PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The volume of the flocs per plan view area is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{vol\PYGZus{}floc}\PYG{p}{)}
\end{sphinxVerbatim}

The volume of the flocs per plan view area is 18.34 liter / meter ** 2


\subsubsection{21)}
\label{\detokenize{Filtration/Filtration_Design_Solution:id21}}
What percent of the filter pore volume is occupied by the flocs? This fraction of pore space occupied is quite small and suggests that much of the filter bed has a very low particle concentration at the end of a filter run.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}flocvolume\PYGZus{}porevolume} \PYG{o}{=} \PYG{p}{(}\PYG{n}{vol\PYGZus{}floc} \PYG{o}{/} \PYG{n}{volume\PYGZus{}filter\PYGZus{}pores}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The fraction of filter pore volume that is occupied by flocs is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{Pi\PYGZus{}flocvolume\PYGZus{}porevolume}\PYG{p}{)}
\end{sphinxVerbatim}

The fraction of filter pore volume that is occupied by flocs is 0.0382

This result is surprising and intriguing. It indicates that the pores in the filters are 96\% empty when the filter run is complete! Thus filters don’t fail because the pores get full. There is a different mechanism at play here.


\section{Filter constriction hypothesis}
\label{\detokenize{Filtration/Filtration_Design_Solution:filter-constriction-hypothesis}}
The following analysis is completed for you and is intended to illustrate the hypothesis that flocs that are removed by the filter form a small diameter flow constriction at each place where the sand grains form a flow constriction.

Final head loss for the filter was 50cm. Assume that this is caused by minor losses due to creation of a floc orifice (constriction) in each pore. Find the minor loss contribution by subtracting the clean bed head loss to find the head loss created by the flow constrictions that were created by the flocs.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hl\PYGZus{}filter\PYGZus{}final} \PYG{o}{=} \PYG{l+m+mi}{50} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{hl\PYGZus{}constriction} \PYG{o}{=} \PYG{n}{hl\PYGZus{}filter\PYGZus{}final}\PYG{o}{\PYGZhy{}}\PYG{n}{hl\PYGZus{}filter\PYGZus{}clean}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minor loss contribution is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hl\PYGZus{}constriction}\PYG{p}{)}
\end{sphinxVerbatim}

The minor loss contribution is 34.8 centimeter

If we assume that at the end of the filter run every pore in the filter had a flow constricting orifice from the deposition of flocs in the pore, then what was the diameter of each of the flow constrictions? We will calculate this in several steps. To begin, estimate how many flow constrictions are created by the sand grains before any flocs are added with the assumption that there is one flow constriction per sand grain. How many sand grains are there per cubic meter of filter bed? Use D60\_filter\_sand to estimate the number of sand grains. We will assume there is a one to one correspondence between sand grains and flow constrictions.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{vol\PYGZus{}filter\PYGZus{}sand\PYGZus{}grain} \PYG{o}{=} \PYG{n}{D60\PYGZus{}filter\PYGZus{}sand}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{o}{/}\PYG{l+m+mi}{6}
\PYG{n}{vol\PYGZus{}filter\PYGZus{}sand\PYGZus{}grain\PYGZus{}and\PYGZus{}pore} \PYG{o}{=} \PYG{n}{vol\PYGZus{}filter\PYGZus{}sand\PYGZus{}grain} \PYG{o}{/} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand}\PYG{p}{)}
\PYG{n}{N\PYGZus{}sand\PYGZus{}grains} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{/}\PYG{p}{(}\PYG{n}{vol\PYGZus{}filter\PYGZus{}sand\PYGZus{}grain\PYGZus{}and\PYGZus{}pore}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{There are this many sand grains in a cubic millimeter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{N\PYGZus{}sand\PYGZus{}grains}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

There are this many sand grains in a cubic millimeter 2.238 / millimeter ** 3

Estimate the average vertical distance between flow constriction based on the cube root of the volume occupied by a sand grain

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{L\PYGZus{}grain\PYGZus{}separation} \PYG{o}{=} \PYG{p}{(}\PYG{n}{vol\PYGZus{}filter\PYGZus{}sand\PYGZus{}grain\PYGZus{}and\PYGZus{}pore} \PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The distance between flow constriction is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{L\PYGZus{}grain\PYGZus{}separation}\PYG{p}{)}
\end{sphinxVerbatim}

The distance between flow constriction is 0.7645 millimeter

On average, how many sand grain flow constriction does a water molecule flow through on its way through the filter?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}constriction} \PYG{o}{=} \PYG{p}{(}\PYG{n}{H\PYGZus{}filter\PYGZus{}layer}\PYG{o}{/}\PYG{n}{L\PYGZus{}grain\PYGZus{}separation}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{dimensionless}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A water molecule flows through}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{N\PYGZus{}constriction}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{constriction through the StaRS filter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

A water molecule flows through 261.6 dimensionless constriction through the StaRS filter

What is the head loss per flow constriction?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{hl\PYGZus{}per\PYGZus{}constriction} \PYG{o}{=} \PYG{p}{(}\PYG{n}{hl\PYGZus{}constriction} \PYG{o}{/} \PYG{n}{N\PYGZus{}constriction}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The head loss per constriction is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{hl\PYGZus{}per\PYGZus{}constriction}\PYG{p}{)}
\end{sphinxVerbatim}

The head loss per constriction is 1.33 millimeter

If each constriction was partially clogged with flocs at the end of the filter run, estimate the velocity in the constriction using the expansion head loss equation. You can use the average pore water velocity as a good estimate of the expanded flow velocity.
\begin{equation}\label{equation:Filtration/Filtration_Design_Solution:Filtration/Filtration_Design_Solution:9}
\begin{split}h_{e} = \frac{(V_{in}-V_{out})^2}{2g}\end{split}
\end{equation}
\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{V\PYGZus{}pore} \PYG{o}{=} \PYG{n}{V\PYGZus{}filter} \PYG{o}{/} \PYG{n}{porosity\PYGZus{}filter\PYGZus{}sand}
\PYG{n}{V\PYGZus{}constriction} \PYG{o}{=} \PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{hl\PYGZus{}per\PYGZus{}constriction}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{l+m+mi}{2}\PYG{p}{)} \PYG{o}{+} \PYG{n}{V\PYGZus{}pore}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{mm} \PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The velocity in the constriction is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{V\PYGZus{}constriction}\PYG{p}{)}
\end{sphinxVerbatim}

The velocity in the constriction is 166.1 millimeter / second

What is flow rate of water through each pore in \(\mu\)L/s? You can estimate this from the number of pores per square meter given the average separation distance.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{N\PYGZus{}pore\PYGZus{}per\PYGZus{}area} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{/} \PYG{n}{L\PYGZus{}grain\PYGZus{}separation}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}
\PYG{n}{flow\PYGZus{}per\PYGZus{}pore} \PYG{o}{=} \PYG{p}{(}\PYG{n}{V\PYGZus{}filter}\PYG{o}{/} \PYG{n}{N\PYGZus{}pore\PYGZus{}per\PYGZus{}area}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{microliter}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The flow rate through each pore is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{flow\PYGZus{}per\PYGZus{}pore}\PYG{p}{)}
\end{sphinxVerbatim}

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{The} \PYG{n}{flow} \PYG{n}{rate} \PYG{n}{through} \PYG{n}{each} \PYG{n}{pore} \PYG{o+ow}{is} \PYG{l+m+mf}{1.071} \PYG{n}{microliter} \PYG{o}{/} \PYG{n}{second}
\end{sphinxVerbatim}

What is the inner diameter of the flow constriction created by the flocs if the vena contracta is 0.62?

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}vena\PYGZus{}contracta} \PYG{o}{=} \PYG{l+m+mf}{0.62}
\PYG{n}{A\PYGZus{}constriction} \PYG{o}{=} \PYG{n}{flow\PYGZus{}per\PYGZus{}pore} \PYG{o}{/} \PYG{n}{V\PYGZus{}constriction}\PYG{o}{/}\PYG{n}{Pi\PYGZus{}vena\PYGZus{}contracta}
\PYG{n}{D\PYGZus{}constriction} \PYG{o}{=} \PYG{n}{pc}\PYG{o}{.}\PYG{n}{diam\PYGZus{}circle}\PYG{p}{(}\PYG{n}{A\PYGZus{}constriction}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The inner diameter of the flow constriction created by the flocs is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{D\PYGZus{}constriction}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{micrometer}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The inner diameter of the flow constriction created by the flocs is 115.1 micrometer

This suggests that this flow constriction is stable because the high velocity results in shear levels that are too high for flocs to attach. Thus once the constriction forms and reaches the shear level that prevents deposition it remains stable.

Plot the fractional removal per constriction as a function of particle size.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{D\PYGZus{}clay} \PYG{o}{=} \PYG{l+m+mi}{7} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{micrometer}

\PYG{c+c1}{\PYGZsh{}create an array of floc sizes from clay diameter up to the diameter of the constriction}

\PYG{k}{def} \PYG{n+nf}{D\PYGZus{}floc}\PYG{p}{(}\PYG{n}{D\PYGZus{}constriction}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{n}{D\PYGZus{}clay}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{micrometer}\PYG{p}{)}\PYG{p}{,} \PYG{n}{D\PYGZus{}constriction}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{micrometer}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{*}\PYG{n}{u}\PYG{o}{.}\PYG{n}{micrometer}


\PYG{c+c1}{\PYGZsh{}below is an estimate of the floc removal efficiency as a function of the floc size}
\PYG{k}{def} \PYG{n+nf}{c\PYGZus{}star\PYGZus{}constriction}\PYG{p}{(}\PYG{n}{D\PYGZus{}constriction}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{return} \PYG{p}{(}\PYG{p}{(}\PYG{n}{D\PYGZus{}constriction} \PYG{o}{\PYGZhy{}} \PYG{n}{D\PYGZus{}floc}\PYG{p}{(}\PYG{n}{D\PYGZus{}constriction}\PYG{p}{)}\PYG{p}{)}
            \PYG{o}{/} \PYG{n}{D\PYGZus{}constriction}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}

\PYG{n}{c\PYGZus{}star} \PYG{o}{=} \PYG{n}{c\PYGZus{}star\PYGZus{}constriction}\PYG{p}{(}\PYG{n}{D\PYGZus{}constriction}\PYG{p}{)}
\PYG{n}{fig}\PYG{p}{,} \PYG{n}{ax} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{subplots}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{D\PYGZus{}floc}\PYG{p}{(}\PYG{n}{D\PYGZus{}constriction}\PYG{p}{)}\PYG{p}{,}\PYG{n}{c\PYGZus{}star}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{xlabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Particle diameter(micrometer)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{ax}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{n}{ylabel}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Fractional remaining}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{fig}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Filtration/Images/Diameter\PYGZus{}vs\PYGZus{}fractional\PYGZus{}remaining}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Diameter_vs_fractional_remaining}.png}
\caption{There are many constrictions in series and the filter fraction remaining is the pore fraction remaining raised to the power of the number of pores in series.}\label{\detokenize{Filtration/Filtration_Design_Solution:id25}}\label{\detokenize{Filtration/Filtration_Design_Solution:figure-diameter-vs-fractional-remaining}}\end{figure}


\chapter{Hydraulics Introduction}
\label{\detokenize{Hydraulics/Hydraulics_Intro:hydraulics-introduction}}\label{\detokenize{Hydraulics/Hydraulics_Intro:title-hydraulics-intro}}\label{\detokenize{Hydraulics/Hydraulics_Intro::doc}}
The hydraulic controls provide the basis for efficient and robust water treatment plant operation. Water must move through unit processes and between unit processes and the flow passages must be designed to meet various constraints. One constraint is that water that is carrying a significant amount of sediment (flocculator and sedimentation tank inlet) must have sufficient velocity and turbulence levels to minimize sedimentation.  A more challenging constraint is that the flow must be divided equally between parallel processes. Flow distribution through parallel paths is a key hydraulic design constraint for all municipal scale water treatment plants. The parallel path constraint only goes away for laboratory scale processes where there is a single tube settler and a filter with a single layer of sand. A schematic illustrating the electrical circuit analogy is shown in \hyperref[\detokenize{Hydraulics/Hydraulics_Intro:figure-circuit}]{Fig.\@ \ref{\detokenize{Hydraulics/Hydraulics_Intro:figure-circuit}}}.

Municipal water treatment plants

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{circuit}.png}
\caption{The flow through a sedimentation tank is analogous to an electrical circuit with wires and resistors. Identical resistors in parallel paths help improve flow distribution between the paths. Differences in piezometric head (think voltage) in the manifolds that connect to multiple parallel paths.}\label{\detokenize{Hydraulics/Hydraulics_Intro:id1}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-circuit}}\end{figure}


\section{Piezometric Head}
\label{\detokenize{Hydraulics/Hydraulics_Intro:piezometric-head}}\label{\detokenize{Hydraulics/Hydraulics_Intro:heading-piezometric-head}}
The sum of the pressure and elevation term in the energy equation is the piezometric head, \(\Psi\). Fluid will move in the direction of decreasing piezometric head. Note that fluid does NOT always move from high pressure to low pressure nor does it always move from high elevation to low elevation. You can prove this to yourself by placing a sloped pipe in a swimming pool!
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:piezometric_head_defined}
\begin{split}\Psi = \frac{p}{\rho g} + z\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Sloped_Manifold_no_flow}.png}
\caption{Piezometric head is constant in a stationary body of water. The piezometric head inside the enclosed sloped pipe is greater (by height H) than the piezometric head in the tank. Thus if we add an orifice to this sloped pipe, water will from the sloped pipe into the tank.}\label{\detokenize{Hydraulics/Hydraulics_Intro:id2}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-sloped-manifold-no-flow}}\end{figure}

Add multiple outlets to this sloped pipe to create a sloped manifold (\hyperref[\detokenize{Hydraulics/Hydraulics_Intro:figure-sloped-manifold-with-flow}]{Fig.\@ \ref{\detokenize{Hydraulics/Hydraulics_Intro:figure-sloped-manifold-with-flow}}}). The energy equation applied between control surface 1 and n  shows that the piezometric head in an inlet manifold increases in the direction of flow for cases where head loss is smaller than \(\frac{\bar v_{M_1}^2}{2 g}\).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Sloped_Manifold_with_flow}.png}
\caption{Sloped inlet manifold showing that the piezometric head increases in the direction of flow for the case where head loss due to wall shear is smaller than \(\frac{\bar v_{M_1}^2}{2 g}\).}\label{\detokenize{Hydraulics/Hydraulics_Intro:id3}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-sloped-manifold-with-flow}}\end{figure}


\section{Inlet Manifold Flow Distribution}
\label{\detokenize{Hydraulics/Hydraulics_Intro:inlet-manifold-flow-distribution}}\label{\detokenize{Hydraulics/Hydraulics_Intro:heading-inlet-manifold-flow-distribution}}
There is disagreement in the literature about the physics of manifolds. One school of thought postulates that the flow out of the ports exiting a manifold are controlled by the total energy of the flow inside the manifold. The other school of thought postulates that the flow of water out of the ports is controlled by the difference in piezometric head between the manifold and the receiving reservoir. These two approaches are mutually exclusive and make completely different predictions about how manifolds will perform especially for the case where head loss in the manifold is small compared with the pressure recovery caused by the gradual flow expansion in the manifold.

Fortunately it is relatively easy to check the physics to see which approach is correct. A venturi (gradual flow contraction in a pipe) is used to generate a low pressure region in a pipe by converting pressure into kinetic energy. Venturis can be used to generate low pressure inside the pipe and then pull fluid \sphinxstylestrong{into} the pipe even though the total energy of the fluid in the pipe far exceeds the energy of the fluid that was outside of the pipe! This proves that flow out of a manifold is due to the difference in piezometric head and NOT due to the difference in total energy.

If manifolds were built using pitot type exits with the exit facing upstream and into the flow of the fluid then the exit from the manifold would be based on the total energy. The manifolds that we use in water treatment plants do not have pitot tube style ports and thus our analysis of manifolds is based on piezometric head.

Flow distribution from ports exiting a manifold is controlled by the change in piezometric head inside the manifold and the change in piezometric head as the water exits through a port. The reason that the flow from each port is not identical is because of changes in piezometric head in the manifold. These changes are caused by major losses due to shear on the manifold walls and due to pressure recovery as the velocity in the manifold decreases. The control volume is shown in \hyperref[\detokenize{Hydraulics/Hydraulics_Intro:figure-inlet-manifold}]{Fig.\@ \ref{\detokenize{Hydraulics/Hydraulics_Intro:figure-inlet-manifold}}}
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:energy_cv_manifold}
\begin{split} \frac{p_{M_1}}{\rho g}+z_{M_1}+\frac{\bar v_{M_1}^2}{2 g}=\frac{p_{M_n}}{\rho g}+z_{M_n}+\frac{\bar v_{M_n}^2}{2g} + h_{L}\end{split}
\end{equation}
The energy control volume equation \eqref{equation:Hydraulics/Hydraulics_Intro:energy_cv_manifold} can be simplified with the definition of piezometric head (equation \eqref{equation:Hydraulics/Hydraulics_Intro:piezometric_head_defined}).
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:piezometric_cv_manifold}
\begin{split} \Psi_{M_1}+\frac{\bar v_{M_1}^2}{2 g}=\Psi_{M_n}+\frac{\bar v_{M_n}^2}{2 g}+h_{L}\end{split}
\end{equation}
The change in piezometric head is the important parameter and is given by
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:delta_piezometric_cv_manifold}
\begin{split} \Delta\Psi_M = \frac{\bar v_{M_1}^{2}-\bar v_{M_n}^{2}}{2 g} - h_{L}\end{split}
\end{equation}
\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{inlet_manifold}.png}
\caption{The piezometric head can either increase due to conversion of kinetic energy to pressure or the piezometric head can decrease due to major losses.}\label{\detokenize{Hydraulics/Hydraulics_Intro:id4}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-inlet-manifold}}\end{figure}

For short \(f\frac{L}{d}<<1\), straight (minor loss coefficient = 0), inlet manifolds the change in piezometric head, \(\Delta\Psi_M\) is equal the initial velocity head.
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:delta_piezometric_is_velocity_head}
\begin{split} \Delta\Psi_M = \frac{\bar v_{M_1}^{2}}{2 g}\end{split}
\end{equation}
To simplify analysis we assume the middle port gets the average flow (this isn’t quite right because the velocity is squared) and the average piezometric head, \(\bar \Psi_M\). The first port has mean piezometric head \textendash{} ½ delta piezometric head and the last port has an increase in the piezometric head.
\begin{align}\label{equation:Hydraulics/Hydraulics_Intro:Piezo_ports}\!\begin{aligned}
\Psi_{M_1} = \bar \Psi_{M} - \frac{1}{2}\Delta \Psi_M\\
\Psi_{M_n} = \bar \Psi_{M} + \frac{1}{2}\Delta \Psi_M\\
\end{aligned}\end{align}
where the piezometric head at each port is also proportional to the port velocity squared. A design constraint for a manifold is the target ratio of flow from port one, \(Q_{P_1}\), divided by the flow from the last port, \(Q_{P_n}\).
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Pi_Q_ports}
\begin{split} \Pi_{Q} = \frac{Q_{P_1}}{Q_{P_n}}=\sqrt{\frac{\Psi_{M_1}}{\Psi_{M_n}}}\end{split}
\end{equation}
Substitute equations \eqref{equation:Hydraulics/Hydraulics_Intro:Piezo_ports} into equation \eqref{equation:Hydraulics/Hydraulics_Intro:Pi_Q_ports} to obtain the relationship between piezometric head and the flow distribution ratio.
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Pi_Q_ports2}
\begin{split} \Pi_{Q}^2 = \frac{\bar \Psi_{M} - \frac{1}{2}\Delta \Psi_M}{\bar \Psi_{M} + \frac{1}{2}\Delta \Psi_M}\end{split}
\end{equation}
This equation shows that the flow distribution will approach 1 when \(\bar \Psi_{M}\) is much larger than \(\Delta \Psi_M\). This can be achieved by having the manifold velocities be small compared with the port velocities. Solving for the change in piezometric head in the manifold we obtain the relationship between change in piezometric head and uniformity of port flow.
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Pi_Q_ports3}
\begin{split} \Delta \Psi_M = 2\bar \Psi_{M}\frac{1 - \Pi_{Q}^2}{\Pi_{Q}^2 + 1}\end{split}
\end{equation}
The energy equation also yields an equation for the change in piezometric head (see equation \eqref{equation:Hydraulics/Hydraulics_Intro:delta_piezometric_cv_manifold}) and we can equate those two to
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Energy_and_Pi_Q}
\begin{split} \frac{\bar v_{M_1}^{2}-\bar v_{M_n}^{2}}{2 g} - h_{L} = 2\bar \Psi_{M}\frac{1 - \Pi_{Q}^2}{\Pi_{Q}^2 + 1}\end{split}
\end{equation}
If head loss in the manifold is small, then we have
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Energy_and_Pi_Q_no_manifold_hl}
\begin{split} \frac{\bar v_{M_1}^{2}}{2 g} = 2\bar \Psi_M\frac{1 - \Pi_Q^2}{\Pi_Q^2 + 1}\end{split}
\end{equation}
The average piezometric head in the manifold is also influenced by any head loss that is in series with the port head loss. Here we assume that the piezometric head datum is in the receiving tank. If the receiving tank is a filter, then there could be head loss through the sand on the way to the outlet of the filter. This head loss in series will help provide more uniform flow out of the manifold if there aren’t any paths for flow to blend between the first and last ports. This is the case for division of flow between sand layers in a stacked rapid sand filter where the head loss through the sand plays a key role in helping to divide the flow evenly between the 6 layers of sand. The average piezometric head in the manifold, \(\bar \Psi_{M}\) is equal to the head from the port kinetic energy plus any downstream head loss.
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Manifold_piezometric_head_port_KE_and_HL}
\begin{split} \bar \Psi_M \cong \frac{\bar v_{P}^{2}}{2 g} + h_{l_{series}} \cong h_{e_{port}} + h_{l_{series}}\end{split}
\end{equation}
The port head loss is given by \(\bar v_{P} = \sqrt{2gh_e}\) where the port velocity is the true contracted velocity if there is a \sphinxstyleemphasis{vena contracta}. If the head loss in series, \(h_{l_{series}}\), is significant, then equations \eqref{equation:Hydraulics/Hydraulics_Intro:Energy_and_Pi_Q_no_manifold_hl} and \eqref{equation:Hydraulics/Hydraulics_Intro:Manifold_piezometric_head_port_KE_and_HL} combine to produce
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Manifold_max_v_with_hl_series}
\begin{split} \bar v_{M_1}= 2\sqrt{g (h_{e_{port}} + h_{l_{series}})\frac{1 - \Pi_{Q}^2}{\Pi_{Q}^2 + 1}}\end{split}
\end{equation}
If there is no additional head loss in series to improve flow distribution, then equation \eqref{equation:Hydraulics/Hydraulics_Intro:Manifold_max_v_with_hl_series} simplifies to
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Manifold_max_v_no_hl_series}
\begin{split} \frac{\bar v_{P}}{\bar v_{M_1}} = \sqrt{\frac{\Pi_{Q}^2 + 1}{2(1 - \Pi_{Q}^2)}}\end{split}
\end{equation}
Equation \eqref{equation:Hydraulics/Hydraulics_Intro:Manifold_max_v_no_hl_series} (see \hyperref[\detokenize{Hydraulics/Hydraulics_Intro:figure-ratio-port-to-manifold-velocity}]{Fig.\@ \ref{\detokenize{Hydraulics/Hydraulics_Intro:figure-ratio-port-to-manifold-velocity}}}) can be used to determine the required diameter of inlet manifolds in sedimentation tanks or to determine the required port velocity for the backwash manifold in the StaRS filters. It can also be used to solve for the maximum manifold velocity given the port velocity in the sedimentation tank diffusers.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Ratio\PYGZus{}Pipe\PYGZus{}Manifold\PYGZus{}V\PYGZus{}Port\PYGZus{}to\PYGZus{}V\PYGZus{}Man}\PYG{p}{(}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{p}{)}\PYG{p}{:}
  \PYG{k}{return} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{p}{(}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Ratio_port_to_manifold_velocity}.png}
\caption{The ratio of port velocity to manifold velocity must increase to obtain more uniform flow from the ports.}\label{\detokenize{Hydraulics/Hydraulics_Intro:id5}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-ratio-port-to-manifold-velocity}}\end{figure}


\subsection{Sedimentation Tank Inlet Manifold}
\label{\detokenize{Hydraulics/Hydraulics_Intro:sedimentation-tank-inlet-manifold}}\label{\detokenize{Hydraulics/Hydraulics_Intro:heading-sedimentation-tank-inlet-manifold}}
The port velocity for inlet manifold diffusers is set by the slot width, the width of the sedimentation tank, and the upflow velocity in the sedimentation tank. From mass conservation we have
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Sed_diffuser_mass_conserve}
\begin{split}Q_{Diffuser} = \bar v_{Jet} W_{Diffuser} S_{Diffuser} = \bar v_{FB} W_{Sed} B_{Diffuser}\end{split}
\end{equation}
Solve for the jet velocity, \(\bar v_{Jet}\).
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Sed_diffuser_jet_velocity}
\begin{split}\bar v_{Jet}  = \frac{\bar v_{FB} W_{Sed} B_{Diffuser}}{W_{Diffuser} S_{Diffuser}}\end{split}
\end{equation}
For sedimentation tanks that are 1.07 m wide, an upflow velocity of 1 mm/s, with diffusers that are 3.175 mm wide, and assuming that the diffuser wall thickness is small we have a jet velocity of 0.34 m/s.

The maximum inlet manifold velocity can now be determined from equation \eqref{equation:Hydraulics/Hydraulics_Intro:Manifold_max_v_no_hl_series}. Given a port flow ratio of 85\% the maximum manifold velocity is about 0.6 m/s.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Design the sedimentation tank inlet manifold}
\PYG{n}{v\PYGZus{}FB} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{n}{W\PYGZus{}Diffuser} \PYG{o}{=} \PYG{l+m+mf}{3.175} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{mm}
\PYG{n}{W\PYGZus{}Sed} \PYG{o}{=} \PYG{l+m+mf}{1.07} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{v\PYGZus{}jet} \PYG{o}{=} \PYG{n}{v\PYGZus{}FB} \PYG{o}{*} \PYG{n}{W\PYGZus{}Sed}\PYG{o}{/}\PYG{n}{W\PYGZus{}Diffuser}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The jet velocity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{v\PYGZus{}jet}\PYG{p}{)}
\PYG{n}{L\PYGZus{}Sed} \PYG{o}{=} \PYG{l+m+mi}{6} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}
\PYG{n}{Ratio\PYGZus{}Flow} \PYG{o}{=} \PYG{l+m+mf}{0.85}
\PYG{n}{v\PYGZus{}Influent\PYGZus{}Manifold} \PYG{o}{=} \PYG{n}{v\PYGZus{}jet} \PYG{o}{/} \PYG{n}{Ratio\PYGZus{}Pipe\PYGZus{}Manifold\PYGZus{}V\PYGZus{}Port\PYGZus{}to\PYGZus{}V\PYGZus{}Man}\PYG{p}{(}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The manifold velocity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{v\PYGZus{}Manifold}\PYG{p}{)}
\PYG{n}{Q\PYGZus{}sed} \PYG{o}{=}\PYG{p}{(}\PYG{n}{L\PYGZus{}Sed} \PYG{o}{*} \PYG{n}{W\PYGZus{}Sed} \PYG{o}{*} \PYG{n}{v\PYGZus{}FB}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{ID\PYGZus{}min\PYGZus{}Influent\PYGZus{}Manifold} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{diam\PYGZus{}circle}\PYG{p}{(}\PYG{n}{Q\PYGZus{}sed}\PYG{o}{/}\PYG{n}{v\PYGZus{}Influent\PYGZus{}Manifold}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum manifold diameter is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ID\PYGZus{}min\PYGZus{}Influent\PYGZus{}Manifold}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{SDR} \PYG{o}{=} \PYG{l+m+mi}{41}
\PYG{n}{ID\PYGZus{}Influent\PYGZus{}Manifold} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{ceil\PYGZus{}nearest}\PYG{p}{(}\PYG{n}{ID\PYGZus{}min\PYGZus{}Influent\PYGZus{}Manifold}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR\PYGZus{}all\PYGZus{}available}\PYG{p}{(}\PYG{n}{SDR}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ND\PYGZus{}Influent\PYGZus{}Manifold} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{ND\PYGZus{}SDR\PYGZus{}available}\PYG{p}{(}\PYG{n}{ID\PYGZus{}Influent\PYGZus{}Manifold}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The manifold nominal diameter is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ND\PYGZus{}Influent\PYGZus{}Manifold}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Sedimentation Tank Outlet Manifold}
\label{\detokenize{Hydraulics/Hydraulics_Intro:sedimentation-tank-outlet-manifold}}\label{\detokenize{Hydraulics/Hydraulics_Intro:heading-sedimentation-tank-outlet-manifold}}
The sedimentation tank outlet manifold collects the clarified water from the top of the plate setters. The outlet manifold is required to help ensure uniform flow up through the plate settlers.  The outlet manifold has orifices and it is these orifices that provide the majority of the head loss through the sedimentation tank. The target head loss for those orifices is about 5 cm. This head loss helps ensure that flow divides evenly between sedimentation tanks and divides evenly between the plate settlers.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}Design the sedimentation tank inlet manifold}
\PYG{n}{HL\PYGZus{}orifice} \PYG{o}{=} \PYG{l+m+mi}{5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{v\PYGZus{}orifice\PYGZus{}contracted} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{HL\PYGZus{}orifice}\PYG{p}{)}
\PYG{n}{v\PYGZus{}Effluent\PYGZus{}Manifold} \PYG{o}{=} \PYG{p}{(}\PYG{n}{v\PYGZus{}orifice\PYGZus{}contracted} \PYG{o}{/} \PYG{n}{Ratio\PYGZus{}Pipe\PYGZus{}Manifold\PYGZus{}V\PYGZus{}Port\PYGZus{}to\PYGZus{}V\PYGZus{}Man}\PYG{p}{(}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The maximum effluent manifold velocity is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{v\PYGZus{}Effluent\PYGZus{}Manifold}\PYG{p}{)}
\PYG{n}{Q\PYGZus{}sed} \PYG{o}{=}\PYG{p}{(}\PYG{n}{L\PYGZus{}Sed} \PYG{o}{*} \PYG{n}{W\PYGZus{}Sed} \PYG{o}{*} \PYG{n}{v\PYGZus{}FB}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{L}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
\PYG{n}{ID\PYGZus{}min\PYGZus{}Effluent\PYGZus{}Manifold} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{diam\PYGZus{}circle}\PYG{p}{(}\PYG{n}{Q\PYGZus{}sed}\PYG{o}{/}\PYG{n}{v\PYGZus{}Effluent\PYGZus{}Manifold}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The minimum effluent manifold diameter is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ID\PYGZus{}min\PYGZus{}Effluent\PYGZus{}Manifold}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{SDR} \PYG{o}{=} \PYG{l+m+mi}{41}
\PYG{n}{ID\PYGZus{}Effluent\PYGZus{}Manifold} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{ceil\PYGZus{}nearest}\PYG{p}{(}\PYG{n}{ID\PYGZus{}min\PYGZus{}Effluent\PYGZus{}Manifold}\PYG{p}{,}\PYG{n}{ac}\PYG{o}{.}\PYG{n}{ID\PYGZus{}SDR\PYGZus{}all\PYGZus{}available}\PYG{p}{(}\PYG{n}{SDR}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{ND\PYGZus{}Effluent\PYGZus{}Manifold} \PYG{o}{=} \PYG{n}{ac}\PYG{o}{.}\PYG{n}{ND\PYGZus{}SDR\PYGZus{}available}\PYG{p}{(}\PYG{n}{ID\PYGZus{}Effluent\PYGZus{}Manifold}\PYG{p}{,}\PYG{n}{SDR}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The manifold nominal diameter is}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ND\PYGZus{}Effluent\PYGZus{}Manifold}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{inch}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

The head loss through the sedimentation tank is due to:
\begin{itemize}
\item {} 
entrance and elbow in influent manifold

\item {} 
major losses in influent manifold

\item {} 
diffuser exit loss

\item {} 
floc blanket (negligible)

\item {} 
plate settlers (negligible)

\item {} 
effluent manifold orifices

\item {} 
effluent manifold major loss

\item {} 
effluent manifold exit

\end{itemize}

It might be convenient to set the total head loss through the sedimentation tank to be equal to exactly 5 cm so that influent and effluent weirs always have the same elevation difference. The effluent manifold orifices could be designed for whatever head loss is required to meet that target.


\section{Sedimentor Inlet Channel}
\label{\detokenize{Hydraulics/Hydraulics_Intro:sedimentor-inlet-channel}}\label{\detokenize{Hydraulics/Hydraulics_Intro:heading-sedimentor-inlet-channel}}
The sedimentor inlet channel is designed to distribute the flow uniformly between the sedimentation tanks. The flow paths through the various sedimentation tanks are identical except for the difference in the length of the path in the sedimentor inlet channel. Thus the difference in piezometric head in the sedimentor inlet channel must be small compared with the head loss through a sedimentation tank. The head loss through a sedimentation tank is dominated by the outlet manifold which is designed to have a head loss of 5 cm. This 5 cm of head loss is in turn dominated by the orifice head loss as required to achieve uniform flow distribution between the orifices (see {\hyperref[\detokenize{Hydraulics/Hydraulics_Intro:heading-sedimentation-tank-outlet-manifold}]{\sphinxcrossref{\DUrole{std,std-ref}{sedimentation tank outlet manifold}}}})

For a simple conservative design we calculate the maximum channel velocity assuming that the channel cross section is constant. In our designs we slope the bottom of this channel to maintain a constant velocity to ensure that flocs are scoured and don’t accumulate at the end of this channel where the velocities would be lower if the cross section were constant.

We can use \eqref{equation:Hydraulics/Hydraulics_Intro:Energy_and_Pi_Q_no_manifold_hl} to calculate maximum velocity in the sedimentor inlet channel. In this case the average manifold piezometric head, \(\bar \Psi_M\) ,is measured relative to the water level in the sedimentor that is above the sedimentor exit weir. This difference in elevation is dominated by the 5 cm of head loss created by the orifices in the sedimentor outlet manifold. Solving for the maximum channel velocity we obtain
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:vM_Energy_and_Pi_Q_no_manifold_hl}
\begin{split}\bar v_{M_1} = 2\sqrt{g\bar \Psi_{Sed}\frac{1 - \Pi_{Q}^2}{\Pi_{Q}^2 + 1}}\end{split}
\end{equation}
where \(\Pi_{Q}\) represents the uniformity of flow distribution taken as the minimum sedimentation tank flow divided by the maximum sedimentation tank flow.

The Ten State Standards states, “The velocity of flocculated water through conduits to settling basins shall not be less than 0.15 m/s nor greater than 0.45 m/s.” The lower velocity matches the constraint of ensuring that the velocity is high enough to scour flocs along the bottom of the channel and thus prevent sedimentation. The maximum velocity was presumably set to achieve reasonable flow distribution, but that values is dependent on the head loss through the sedimentation tanks.

Below we calculate the maximum sedimentor inlet channel velocity as a function of the flow distribution uniformity.

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Pi\PYGZus{}Q\PYGZus{}min} \PYG{o}{=} \PYG{l+m+mf}{0.8}
\PYG{n}{Pi\PYGZus{}Q} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}Q\PYGZus{}min}\PYG{p}{,}\PYG{l+m+mf}{0.99}\PYG{p}{,}\PYG{l+m+mi}{50}\PYG{p}{)}
\PYG{n}{Psi\PYGZus{}Sed} \PYG{o}{=} \PYG{l+m+mi}{5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}

\PYG{k}{def} \PYG{n+nf}{v\PYGZus{}man}\PYG{p}{(}\PYG{n}{Psi}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}Q}\PYG{p}{)}\PYG{p}{:}
  \PYG{n}{v\PYGZus{}man} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity} \PYG{o}{*} \PYG{n}{Psi} \PYG{o}{*} \PYG{p}{(}\PYG{l+m+mi}{1} \PYG{o}{\PYGZhy{}} \PYG{n}{Pi\PYGZus{}Q}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}Q}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}
  \PYG{k}{return} \PYG{n}{v\PYGZus{}man}

\PYG{n}{v\PYGZus{}man}\PYG{p}{(}\PYG{n}{Psi\PYGZus{}Sed}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}Q}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Pi\PYGZus{}Q}\PYG{p}{,}\PYG{n}{v\PYGZus{}man}\PYG{p}{(}\PYG{n}{Psi\PYGZus{}Sed}\PYG{p}{,}\PYG{n}{Pi\PYGZus{}Q}\PYG{p}{)}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{blue}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{[}\PYG{n}{Pi\PYGZus{}Q\PYGZus{}min}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+m+mf}{0.45}\PYG{p}{,}\PYG{l+m+mf}{0.45}\PYG{p}{]}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{[}\PYG{n}{Pi\PYGZus{}Q\PYGZus{}min}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+m+mf}{0.15}\PYG{p}{,}\PYG{l+m+mf}{0.15}\PYG{p}{]}\PYG{p}{,}\PYG{n}{linewidth}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{color}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{black}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{linestyle}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dashed}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Channel water velocity (m/s)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flow uniformity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylim}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mf}{0.7}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{legend}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max channel velocity}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{10 State Standards Max}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{10 State Standards Min}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Sedimentor_channel_max_v}.png}
\caption{The ratio of port velocity to manifold velocity must increase to obtain more uniform flow from the ports.}\label{\detokenize{Hydraulics/Hydraulics_Intro:id6}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-sedimentor-channel-max-v}}\end{figure}

The channel velocity must be less than 0.45 m/s to obtain a flow distribution uniformity above 0.9 given that the sedimentor head loss is 5 cm.


\section{Filter Inlet Channel with Rectangular Weir Flow Distribution}
\label{\detokenize{Hydraulics/Hydraulics_Intro:filter-inlet-channel-with-rectangular-weir-flow-distribution}}
In plants with flow rates large enough to use open stacked rapid sand filters the settled water is delivered to those filters through an open channel. The water exits the channel by flowing across a rectangular weir (see \hyperref[\detokenize{Hydraulics/Hydraulics_Intro:figure-filter-channel}]{Fig.\@ \ref{\detokenize{Hydraulics/Hydraulics_Intro:figure-filter-channel}}}). As is the case in a manifold pipe the water in the channel is decelerating and thus the piezometric head is increasing in the direction of flow. This increase in piezometric head is equivalent to the increase in the depth of water in the channel. This increase in water depth results in more water flowing across the final weir exiting the channel.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Filter_channel}.png}
\caption{The filter inlet channel distributes flow to all of the filters. The water in the channel flows across sharp crested weirs into the filter inlet boxes. The velocity in the channel decreases in the direction of flow and thus the kinetic energy of the flow is converted into height. That added height results in greater flow into downstream filter inlet boxes.}\label{\detokenize{Hydraulics/Hydraulics_Intro:id7}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-filter-channel}}\end{figure}

The flow across the weirs into the filter inlet boxes is complicated by several factors. First, there must be a \sphinxstyleemphasis{vena contracta} as the flow changes direction to flow across the weir and thus the \(90^{\circ}\) \sphinxstyleemphasis{vena contracta} coefficient should enter the equations. Second, the weirs as they are fabricated are neither sharp nor broad and thus it isn’t clear which equations are best suited. Sharp crested weirs are known to have a reduced depth of flow above the weir due to the acceleration of water approaching the weir and this effect is normally ignored and then thrown into the weir coefficient. Given that our weirs do not have a rounded upstream edge required by broad crested weirs we will use the sharp crested weir equation.


\subsection{Side Exit Sharp Crested Weir}
\label{\detokenize{Hydraulics/Hydraulics_Intro:side-exit-sharp-crested-weir}}\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Sharp_weir_Q_of_channel_depth}
\begin{split}Q = \Pi_{vc}\frac{2}{3} \sqrt{2g} w \left(H_{channel}\right)^\frac{3}{2}\end{split}
\end{equation}
where \(H_{channel}\) is the height of the water in the channel above the top of the weir. (see equation 10.30 in Fundamentals of Fluid Mechanics, Fifth Edition by Munson, Young, and Okiishi)


\subsection{Inlet Channel Design for Equal Filter Flow}
\label{\detokenize{Hydraulics/Hydraulics_Intro:inlet-channel-design-for-equal-filter-flow}}
We will simplify this manifold problem by assuming that the average water height in the channel above the weirs corresponds to the average flow across the weirs and that the upstream depth is decreased by 1/2 of the channel velocity head and the downstream depth is increased by 1/2 the channel velocity head.

The ratio of flows from the first filter and the last filter in the channel is given by
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Sharp_weir_flow_ratio_messy}
\begin{split}\Pi_{Q_{weir}} = \frac{Q_{Filter_1}}{Q_{Filter_n}} = \frac{\Pi_{vc}\frac{2}{3} \sqrt{2g} w \left(\bar H_{channel} - \frac{\bar v_{M_1}^2}{4g}\right)^\frac{3}{2}}{\Pi_{vc}\frac{2}{3} \sqrt{2g} w \left(\bar H_{channel} + \frac{\bar v_{M_1}^2}{4g}\right)^\frac{3}{2}}\end{split}
\end{equation}
where \(\bar H_{channel}\) is the average height of water in the channel relative to the top of the weir. Equation \eqref{equation:Hydraulics/Hydraulics_Intro:Sharp_weir_flow_ratio_messy} simplifies to
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Sharp_weir_flow_ratio1}
\begin{split}\Pi_{Q_{weir}} = \frac{ \left(\bar H_{channel} - \frac{\bar v_{M_1}^2}{4g}\right)^\frac{3}{2}}{\left(\bar H_{channel} + \frac{\bar v_{M_1}^2}{4g}\right)^\frac{3}{2}}\end{split}
\end{equation}
The slower the velocity in the channel the more uniform the flow distribution will be between the filters.

Solve for the maximum velocity in the channel given the average depth of water above the weirs and the required flow distribution.
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Sharp_weir_flow_ratio2}
\begin{split} \bar H_{channel}\Pi_{Q_{weir}}^\frac{2}{3} + \frac{\bar v_{M_1}^2}{4g}\Pi_{Q_{weir}}^\frac{2}{3}= { \bar H_{channel} - \frac{\bar v_{M_1}^2}{4g}}\end{split}
\end{equation}
Now we can solve for maximum manifold channel velocity.
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Inlet_Channel_v_max}
\begin{split}  \bar v_{M_1} =  2\sqrt{g\bar H_{channel}\frac{\left(1-\Pi_{Q_{weir}}^\frac{2}{3}\right)}{\left(\Pi_{Q_{weir}}^\frac{2}{3} + 1\right)}}\end{split}
\end{equation}
The channel depth of water above the weir, \(\bar H_{channel}\), and the flow uniformity target set the maximum velocity in the manifold channel (see \hyperref[\detokenize{Hydraulics/Hydraulics_Intro:figure-filter-channel-v-max}]{Fig.\@ \ref{\detokenize{Hydraulics/Hydraulics_Intro:figure-filter-channel-v-max}}}).

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{Inlet\PYGZus{}Channel\PYGZus{}V\PYGZus{}Max}\PYG{p}{(}\PYG{n}{H\PYGZus{}weir}\PYG{p}{,}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{p}{)}\PYG{p}{:}
\PYG{k}{return} \PYG{p}{(}\PYG{l+m+mi}{2} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sqrt}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{gravity}\PYG{o}{*}\PYG{n}{H\PYGZus{}weir}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{+}\PYG{n}{Ratio\PYGZus{}Flow}\PYG{o}{*}\PYG{o}{*}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{o}{/}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{to}\PYG{p}{(}\PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}\PYG{p}{)}

\PYG{n}{Ratio\PYGZus{}Q\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mf}{0.6}\PYG{p}{,}\PYG{l+m+mf}{0.95}\PYG{p}{,}\PYG{l+m+mi}{20}\PYG{p}{)}

\PYG{n}{H\PYGZus{}weir} \PYG{o}{=} \PYG{l+m+mi}{5} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{cm}
\PYG{n}{v\PYGZus{}graph} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{empty\PYGZus{}like}\PYG{p}{(}\PYG{n}{Ratio\PYGZus{}Q\PYGZus{}graph}\PYG{p}{)} \PYG{o}{*} \PYG{n}{u}\PYG{o}{.}\PYG{n}{m}\PYG{o}{/}\PYG{n}{u}\PYG{o}{.}\PYG{n}{s}
\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{:}
\PYG{n}{v\PYGZus{}graph}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{=} \PYG{n}{Inlet\PYGZus{}Channel\PYGZus{}V\PYGZus{}Max}\PYG{p}{(}\PYG{n}{H\PYGZus{}weir}\PYG{p}{,}\PYG{n}{Ratio\PYGZus{}Q\PYGZus{}graph}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{Ratio\PYGZus{}Q\PYGZus{}graph}\PYG{p}{,}\PYG{n}{v\PYGZus{}graph}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{xlabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Flow ratio, \PYGZdl{}}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{Pi\PYGZus{}}\PYG{l+s+s1}{\PYGZob{}}\PYG{l+s+s1}{Q\PYGZus{}}\PYG{l+s+si}{\PYGZob{}weir\PYGZcb{}}\PYG{l+s+s1}{\PYGZcb{}\PYGZdl{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{ylabel}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Maximum manifold channel velocity, \PYGZdl{} }\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{bar v\PYGZus{}}\PYG{l+s+si}{\PYGZob{}M\PYGZus{}1\PYGZcb{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{left(}\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{frac}\PYG{l+s+si}{\PYGZob{}m\PYGZcb{}}\PYG{l+s+si}{\PYGZob{}s\PYGZcb{}}\PYG{l+s+s1}{ }\PYG{l+s+s1}{\PYGZbs{}}\PYG{l+s+s1}{right)\PYGZdl{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Filter_channel_v_max}.png}
\caption{The maximum velocity in the filter inlet channel decreases as the target flow ratio, \(\Pi_{Q_{weir}}\), approaches 1. This graph was created assuming \(\bar H_{channel}\) of 5 cm.}\label{\detokenize{Hydraulics/Hydraulics_Intro:id8}}\label{\detokenize{Hydraulics/Hydraulics_Intro:figure-filter-channel-v-max}}\end{figure}


\subsection{Backwash Weir Slot Design}
\label{\detokenize{Hydraulics/Hydraulics_Intro:backwash-weir-slot-design}}
The goal of the backwash weir slot is to provide close to the design flow rate to a filter while it is in backwash mode. To accomplish this the wide gate weir is opened and the weir slot controls the flow of water into the inlet box. During backwash the water level in the inlet box is much lower and thus the backwash weir slot can extend deep into the box. The design constraint for this slot is that it must deliver the design flow when the water level in the inlet channel is at the design flow height and it must deliver at least 80\% of the design flow  when there is no flow going to any of the other filters. The difference in water level between the two cases is \(H_{channel}\) because this is the height of water flowing over the wide weir at the design flow rate. The height of the slot, \(H_{slot}\), is measured relative to the design flow water level in the inlet channel.

This design will result in more water available for backwash than is absolutely needed and if it turns out that too much water is directed to this filter than the bottom of the slot can be elevated by adding a few stop logs.

The equation is based on the sharp crested weir (Equation \eqref{equation:Hydraulics/Hydraulics_Intro:Sharp_weir_Q_of_channel_depth}). The head loss through the gate weir should be subtracted from both the top and bottom terms
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:Flow_ratio_backwash}
\begin{split}  \Pi_{Q_{BW}} = \frac{Q_{BW_{min}}}{Q_{BW_{max}}} = \frac{\Pi_{vc}\frac{2}{3} \sqrt{2g} w \left(H_{slot} - H_{channel} - HL_{Gate}\right)^\frac{3}{2}}{\Pi_{vc}\frac{2}{3} \sqrt{2g} w \left(H_{slot}- HL_{Gate}\right)^\frac{3}{2}}\end{split}
\end{equation}
Simplify and solve for \(H_{slot}\).
\begin{equation}\label{equation:Hydraulics/Hydraulics_Intro:backwash_slot_height}
\begin{split}  H_{slot} = \frac{H_{channel}}{1-\Pi_{Q_{BW}}^\frac{2}{3}} + HL_{Gate}\end{split}
\end{equation}

\chapter{Dissolved Gas Introduction}
\label{\detokenize{Dissolved_Gas/DG_Intro:dissolved-gas-introduction}}\label{\detokenize{Dissolved_Gas/DG_Intro:title-dissolved-gas-introduction}}\label{\detokenize{Dissolved_Gas/DG_Intro::doc}}
Dissolved gas supersaturation and subsequent bubble formation can cause significant performance deterioration in drinking water treatment plants. Supersaturation means that the dissolved gas concentration is greater than the equilibrium concentration. The liquid phase equilibrium concentration of a gas is directly proportional to the absolute partial pressure of the gas in the gas phase. This relationship is described by Henry’s law.


\section{Henry’s Law}
\label{\detokenize{Dissolved_Gas/DG_Intro:henry-s-law}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-henrys-law}}

\section{Effects of Gas Bubbles in Water Treatment Plants}
\label{\detokenize{Dissolved_Gas/DG_Intro:effects-of-gas-bubbles-in-water-treatment-plants}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-effects-of-gas-bubbles-in-water-treatment-plants}}
The American Water Works Association recognized the detrimental effects of gas bubble evolution in drinking water treatment plants and sponsored research at Virginia Polytechnic Institute and State University. \sphinxhref{../\_static/references/PaoloScardinaDissertation2004.pdf}{Paolo Scardina’s Dissertation} provides an excellent review of the problems that are caused by gas bubbles.

Dissolved gas removal is also a goal after anaerobic wastewater treatment for enhanced removal of dissolved methane.


\subsection{Flocculation}
\label{\detokenize{Dissolved_Gas/DG_Intro:flocculation}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-dg-flocculation}}
Minimal adverse effects. Foam produced can dry and be blown around the water treatment plant. Nuisance and aesthetically unpleasing.


\subsection{Floc Blankets}
\label{\detokenize{Dissolved_Gas/DG_Intro:floc-blankets}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-dg-floc-blankets}}
Disrupts floc blanket, breaks flocs, carries flocs into plate settlers.


\subsection{Sedimentation}
\label{\detokenize{Dissolved_Gas/DG_Intro:sedimentation}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-dg-sedimentation}}
Bubbles carry flocs rapidly to the top of the sedimentation tank where they form a surface mat of flocs. The surface mat of flocs isn’t necessarily harmful to plant performance, but it is a nuisance and requires that the operators scrape the flocs to remove them from the sedimentation tank. Some of the rising flocs are swept into the exit manifold and thus the settled water turbidity can be significantly increased by these rising flocs.


\subsection{Filtration}
\label{\detokenize{Dissolved_Gas/DG_Intro:filtration}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-dg-filtration}}
Filtration performance can be severely harmed by gas bubbles. The bubbles form in the pores of the filter and are unable to leave the pore due to surface tension. Filter media can fill rapidly with gas bubbles and this results in increased head loss or decreased flow through the filter. Bubble formation can significantly reduce the filter run time. The amount of bubble formation is strongly dependent on the pressure in the filter. Filters that operate with a deep column of water on top of the filter bed can be unaffected by dissolved gasses if the high pressure within the filter raises the equilibrium dissolved gas concentration above the actual dissolved gas concentration. Enclosed Stacked Rapid Sand Filters are more vulnerable to bubble formation that Open Stacked Rapid Sand Filters because of the difference in pressure in the sand bed. This pressure analysis also reveals that gas bubble formation will tend to occur at the lowest pressure zone in the filter bed. This low pressure zone can occur in a down flow filter right below the partially clogged section of the bed because of the decrease in pressure due to head loss.

At the El PODA Nicaragua AguaClara plant there was so much dissolved air in the influent water that the filters could only operate one hour before requiring backwash.


\section{Dissolved Gas Sources}
\label{\detokenize{Dissolved_Gas/DG_Intro:dissolved-gas-sources}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-dissolved-gas-sources}}\begin{itemize}
\item {} 
high pressure regions in transmission lines where the pipeline flow capacity exceeds the need AND where the flow control is restricted by upstream supply rather than by downstream head loss control (meaning by partially closing a valve!).

\item {} 
Temperature increase that reduces the equilibrium concentration. This gas source is observed in the AguaClara lab facilities where hot and cold incoming tap water are mixed to produce “room temperature” water. The increase in water temperature results in bubble formation.

\end{itemize}


\section{Dissolved Gas Concentration Reduction}
\label{\detokenize{Dissolved_Gas/DG_Intro:dissolved-gas-concentration-reduction}}\label{\detokenize{Dissolved_Gas/DG_Intro:heading-dissolved-gas-concentration-reduction}}

\subsection{Methods to provide nucleation sites}
\label{\detokenize{Dissolved_Gas/DG_Intro:methods-to-provide-nucleation-sites}}\begin{itemize}
\item {} 
aeration
- air can be pumped through diffusers
- air can be sucked into the diffusers if the reactor operated at less than atmospheric pressure

\item {} 
fluidized bed containing particles that have nucleation sites

\end{itemize}

The fluidized nucleation site particles must be dense enough and large enough so that attached gas bubbles can’t carry them out of the degassing reactor.


\subsection{Methods to reduce degassing reactor pressure}
\label{\detokenize{Dissolved_Gas/DG_Intro:methods-to-reduce-degassing-reactor-pressure}}
The top of the degassing reactor can be located several meters above the entrance tank of the water treatment plant. The higher the tank (up to a max of 10 m) the more pronounced the pressure reduction will be and the more effective the reactor will be at degassing. The degassing reactor will produce a water and bubble effluent that must be


\chapter{Fluoride Introduction}
\label{\detokenize{Fluoride/Fluoride_Intro:fluoride-introduction}}\label{\detokenize{Fluoride/Fluoride_Intro:title-fluoride-introduction}}\label{\detokenize{Fluoride/Fluoride_Intro::doc}}
References

\sphinxhref{https://repositories.lib.utexas.edu/handle/2152/39194}{Fluoride, natural organic matter, and particles : the effect of ligand competition on the size distribution of aluminum precipitates in flocculation}


\chapter{WasteWater Theory and Future Work}
\label{\detokenize{WasteWater/WW_Theory_and_Future_Work:wastewater-theory-and-future-work}}\label{\detokenize{WasteWater/WW_Theory_and_Future_Work:title-wastewater-theory-and-future-work}}\label{\detokenize{WasteWater/WW_Theory_and_Future_Work::doc}}
Although AguaClara began with a focus on drinking water treatment, we have always been keenly aware that adequate wastewater treatment is absolutely essential to reduce harm to the environment and harm to downstream communities.

One of the core ideas of the AguaClara design process is that reactor geometry and hydraulic design are critical to obtain the target performance. Environmental engineers have tended to focus on the microbiology and chemistry of unit processes and have sometimes neglected the interactions between fluids, particles, and reactor geometry. We hypothesize that it will be possible to significantly improve on the conventional UASB design by inventing a anaerobic digester that accounts for the interactions between fluids, particles, and reactor geometry. Similarly, we hypothesize that it will be possible to dramatically improve the design of ultra low energy atmospheric oxygen transfer into aerobic reactors.


\section{Anaerobic Pulsed Bed}
\label{\detokenize{WasteWater/WW_Theory_and_Future_Work:anaerobic-pulsed-bed}}\label{\detokenize{WasteWater/WW_Theory_and_Future_Work:heading-uasb}}
Upflow anaerobic settled bed (UASB) are conventionally known as upflow anaerobic sludge blanket reactors. The word “blanket” is frequently used in the field of water and wastewater treatment to refer to a fluidized bed of suspended particles (see floc blanket). Unfortunately that definition is not clearly communicated by the term “blanket” and this has led to confusion of the fundamental mechanisms at play in UASB reactors.

Fluidized bed reactors required inlet and bottom geometry configurations that prevent settled particles from accumulating anywhere on the bottom of the reactor. Many UASB reactors have flat bottoms and the inlets are not designed to ensure continuous resuspension of settled particles. Thus the use of the term  “blanket” for conventional UASB reactors is a misnomer.

UASB reactors typically require hydraulic residence times of x to y hours and have a height of z meters. The result is a maximum upflow velocity of z/y mm/s. This upflow velocity is orders of magnitude lower than the terminal velocity of the particles and thus it is clear that UASB reactors are primarily settled beds of sludge.

The flow distribution through settled sludge is very unlikely to be uniform. The flow is likely to erode a mostly vertical path the shortest distance between the inlet and the top of the settled sludge. There doesn’t appear to be any mechanism that would lead to the idealized uniform flow distribution. Thus conventional UASB reactors are evidently plagued by short circuiting with actual hydraulic residence times a fraction of the design value. (Cite literature in support of this hypothesis.) This leads to short-circuiting and formation of preference flow patterns in sludge bed which in turn leads to dead zones in the sludge as well as improper treatment (\sphinxhref{https://doi.org/10.1016/j.watres.2005.11.021}{Pena, 2006})

The upflow velocity required to maintain a fully fluidized bed of the anaerobic granules is approximately (cite AguaClara UASB research by Cho, et al. who measured the sedimentation velocity of anaerobic granules) x mm/s. At this velocity the height of the reactor would need to be x m in order to achieve the target hydraulic residence time of y hrs. This is not a practical design for community scale reactors and thus it would be advantageous to invent an alternate system for providing more uniform flow through the solids that contain the microorganisms in a UASB reactor.
\begin{description}
\item[{Our proposed solution to this mismatch between required upflow velocity for a fluidized bed and target hydraulic residence time is to use a pulsed flow inlet. The pulsed flow will be designed to lift the entire settled bed off of the floor of the UASB reactor so that the influent wastewater is uniformly distributed to the bottom of the reactor. We hypothesize that the settled bed will then break apart and settled into the band of fresh wastewater that is on the bottom of the reactor. With this proposed mechanism it is clear that a critical parameter is the depth of wastewater that should be injected with each pulse. It is likely that this depth of fresh wastewater should be}] \leavevmode\begin{itemize}
\item {} 
a small fraction of the depth of the UASB (perhaps less than 10\% to ensure that no fresh wastewater can jet through the entire UASB in the time that the sludge settled again)

\item {} 
large enough to provide a flow passage underneath the lifted bed without requiring flow velocities that are so high that the bed is scoured near the inlet jet. This translates to larger than a minimum ratio of fresh wastewater depth per pulse/inlet spacing.

\end{itemize}

\item[{Research is needed to characterize settled bed behavior under pulsed flow.}] \leavevmode\begin{itemize}
\item {} 
How does a settled bed form as suspended solids gradually settle for the cases of continuous and pulsed flows?

\item {} 
What is the actual hydraulic residence time distribution in the bed for the case of continuous and pulsed flows?

\item {} 
What are the failure modes for the pulsed system?

\item {} 
What is the optimal pulsed height (volume of pulse/area of reactor)?

\item {} 
How does the optimal pulsed height scale inlet spacing and bed depth? It will be difficult to conduct experiments at full scale and thus these experiments will require careful consideration of scaling effects. Full scale validation will be very helpful if we can develop a method.

\end{itemize}

All of this research will be aided by using transparent reactor walls to facilitate direct observation of the settled solids.

\end{description}


\section{String Digester (SD)}
\label{\detokenize{WasteWater/WW_Theory_and_Future_Work:string-digester-sd}}\label{\detokenize{WasteWater/WW_Theory_and_Future_Work:heading-string-digester}}
Trickling filters are an old wastewater treatment technology that is much more energy efficient than the activated sludge process.

The measured hydraulic residence time for trickling filters is very short. This suggests that with proper design the ASD could be very compact. \sphinxhref{https://www-sciencedirect-com.proxy.library.cornell.edu/science/article/pii/0043135491901179}{Hinton and Stense (1991)} measured the residence time per unit length to be 30 seconds/meter. Thus for a 4 meter deep trickling filter the residence time would be 120 seconds. If this is accurate, then we may be able to achieve a compact design if we can pack stainless steel cables close together (order 4 mm spacing) AND achieve uniform flow distribution. In addition, \sphinxhref{https://www-sciencedirect-com.proxy.library.cornell.edu/science/article/pii/0043135491901179}{Hinton and Stense (1991)} used a hydraulic application rate of 4 m/hr (1.1 mm/s). This velocity confirms that a compact, well-designed ASD may be smaller than AguaClara sedimentation tanks that traditionally have operated at 1 mm/s.

Modular plastic trickling filter media are typically manufactured with the \sphinxhref{http://dx.doi.org/10.2175/106143010X12681059117210}{following specific surface areas}:
\begin{itemize}
\item {} 
223 \(m^2/m^3\) as high density

\item {} 
138 \(m^2/m^3\) as medium density

\item {} 
100 \(m^2/m^3\) as low density

\end{itemize}

Vertical-flow media require an average hydraulic approach velocities greater than 1.8 m/h (0.5 mm/s) to maximize BOD5 removal efficiency. Shallow towers using cross-flow media have used hydraulic approach velocities in the range 0.4 to 1.1 m/h (0.1 to 0.3 mm/s) (\sphinxhref{http://dx.doi.org/10.2175/106143010X12681059117210}{Daigger and Boltz, 2011})

\sphinxhref{https://doi.org/10.2166/wst.1990.0149}{Crine et al. (1990)} found that the wetted area-to-specific-surface-area ratio ranged from 0.2 to 0.6 with the lowest values for high-density random pack trickling filter media. This confirms that conventional trickling filters are unable to efficiently wet all biofilm surfaces and thus the trickling filters must be substantially over-designed (by a factor of 2 to 5) to accommodate this poor wetting efficiency.

If we take the hydraulic approach velocity of 0.5 mm/s and divide by the wetted area-to-specific-surface-area ratio of 0.6 we obtain 0.83 mm/s, a velocity that is comparable to the upflow velocity in an AguaClara sedimentation tank. Thus a well designed String Digester could be quite compact.

There is extensive literature on design of trickling filters for removal of various nutrients and integration into multi-process treatment trains. Control of biofilm thickness seems to be a recurring issue and thus may be an important research area for the String Digester.

Can we make some sort of a diagnostic guide based on symptoms? Make the following into a giant table.


\chapter{Problems}
\label{\detokenize{Troubleshooting/Troubleshooting:problems}}\label{\detokenize{Troubleshooting/Troubleshooting::doc}}
Temperature fluctuations

Calcium from calcium hypochlorite combines with carbonate in the water to form low solubility calcium carbonate.


\chapter{Solutions}
\label{\detokenize{Troubleshooting/Troubleshooting:solutions}}
Drip chlorine into water rather than injecting it to eliminate formation of precipitate at the injection point

Use valves at the end of the pipeline to control transmission line flow rate rather than upstream control. Review the transmission line to ensure that all sections of the line have flow controlled by limiting available driving head. Air entrainment occurs when the available head exceeds the head required to transmit the target flow.


\begin{savenotes}\sphinxattablestart
\raggedright
\sphinxcapstartof{table}
\sphinxcaption{Table of symptoms, problems, and solutions for AguaClara plant operation.}\label{\detokenize{Troubleshooting/Troubleshooting:id1}}\label{\detokenize{Troubleshooting/Troubleshooting:table-troubleshooting}}
\sphinxaftercaption
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
Observation
&\sphinxstyletheadfamily 
Problem
&\sphinxstyletheadfamily 
Solution
\\
\hline
Air bubbles
&
Air entrainment in the transmission line and transport to a high pressure zone in the pipeline where the air is dissolved in the water
&
Use downstream head loss to prevent air entrainment in transmission line or add a unit process (TBD) that removes excess dissolved air
\\
\hline
Bubbles in sedimentation tanks
&
anaerobic production in methane in settled sludge
&
clean sedimentation tank and check design to eliminate all settled sludge
\\
\hline
Bubbles in EStaRS
&
water entering the plant is supersaturated with air and EStaRS filters operate at very low pressure (compared with OStaRS)
&
eliminate air entrainment in transmission line
\\
\hline
Short filter runtimes
&
poor performance of floc/sed system or clogged slotted pipes or air lock
&
various solutions
\\
\hline
Gradual increase in post backwash head loss in filters
&
slotted pipes are clogging
&
acid flush by pouring HCl (need the concentration) into the outlet pipes OR disassemble filter and clean with a pressure washer
\\
\hline
Scale deposition in the distribution system
&
increase in temperature from groundwater conditions causes supersaturation of calcium carbonate
&
reduce the pH of the water slightly (perhaps 0.5 pH units) to eliminate the supersaturation
\\
\hline
Clogging of chlorination system tubes and formation of precipitate at the injection point
&
dissolution of carbon dioxide from the atmosphere causes precipitation of calcium carbonate
&
Reduce exposure of the solution to the atmosphere OR drip the chlorine into the filtered water
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{High head loss after backwash in EStaRS}
\label{\detokenize{Troubleshooting/Troubleshooting:high-head-loss-after-backwash-in-estars}}
The 60 cm diameter EStaRS filters at El PODA had a very high head loss of 43 cm within a few minutes of ending backwash. The maximum available head is only 50 cm and thus filter runs lasted only a few hours. El PODA was the 2nd site where 60 cm diameter EStaRS filters were used. Given that the filter backwashed just fine without excess head required it appeared that the inlet system was performing as expected and did not have excessive head loss.

The key insight was that the top two layers of sand stopped producing filter water soon after beginning a filter run. A complete stoppage means that clogging ISN’T the issue! Clogging would decrease the flow rate, but it wouldn’t stop flow because the clogging would have to be absolute to stop the flow.

The failure was that the water traveling horizontally in the branches and trunk carries air bubbles to the vertically downward flowing pipe (see a photo here). The air accumulates in that pipe and the water falls through the air losing energy like a waterfall. Water completely stops flowing through the layers of the filter that exit through that trunk line when the height of the air is equal to the available energy driving water through the StaRS filter.

There are two improvements required at El PODA. First, the transmission line must be operated with downstream flow control to prevent air entrapment and compression. That will likely be sufficient to solve the problem of air in the filters. The second improvement is to add manual air release valves to the top of each of the trunk lines so that operates can expel air during filtration. Note that these air vents must have a valve that is closed during backwash because the filter is under negative pressure during backwash and would suck air into the filter through those vents if they were open.

EStaRS with the wing inlets make a possible failure mode. At the end of the backwash if the operator closes the valve in the siphon quickly, the water pressure rises quickly inside the filter. When the water rises in the three entry passages it is possible that the water carries the sand inside the branches with wings. And once there is sand inside the pipes, this sand may hinder the flow of water during the filter run.

The solution is in the operation of the system and maybe a change in the design. If the operators are manipulating pipe stubs to do the backwash, then the first step is to remove the pipe stubs before closing the valve. The other way around the problem would be to close the valve slowly to ensure that the water rises very slowly in the inlets.


\section{Encrustation of filter pipes at Las Vegas}
\label{\detokenize{Troubleshooting/Troubleshooting:encrustation-of-filter-pipes-at-las-vegas}}\begin{description}
\item[{Remove the encrustation without disassembling the filter by pouring buckets of hydrochloric acid into pipes that are inserted into the couplings in the filtered water effluent box. The hydrochloric acid at Las Vegas is a 10\% solution. Dilute that solution by a factor of 5 to produce a 2\% HCl solution. Note that all of the acid and water injected into the filter will simply go into the filter box and increase the water level during this treatment. When diluting acid always add acid to water!}] \leavevmode\begin{enumerate}
\item {} 
Insert pipe stubs into the couplings in the filter inlet box to prevent any water from flowing through the filter

\item {} 
Remove the drain pipe stub so that any effluent from the filter goes to drain

\item {} 
Insert pipe stubs into the couplings in the filtered water effluent box

\item {} 
Fill a 20 L bucket with 16 L of water (mark the bucket level!)

\item {} 
Pour 4 L of 10\% HCl into the bucket to reach a total of 20 L

\item {} 
Mix the diluted acid with a PVC pipe for a couple of minutes

\item {} 
Pour the 20 L of 2\% HCl into the bottom outlet of the filter

\item {} 
Wait 5 minutes

\item {} 
Repeat previous 2 steps 5 times to pour a total of 100 L of acid into the bottom outlet pipe (note that the goal is for this total volume to exceed the outlet pipe, trunk, and branch pipes volume)

\item {} 
Pour 20 L of water into the bottom outlet pipe

\item {} 
Wait 5 minutes

\item {} 
Repeat previous 2 steps 5 times to push all (or at least most) of the acid through the outlet pipes and into the sand bed

\end{enumerate}

\end{description}

Repeat steps 3 to 12 for the middle outlet pipe and then for the top outlet pipe.

With each addition of acid or water there should be a fresh batch of carbon dioxide bubbles released from the filter.

Turn the filter back on and dump all water to waste for at least 5 minutes and until the turbidity is less than 1 NTU.


\section{Slime at Las Vegas}
\label{\detokenize{Troubleshooting/Troubleshooting:slime-at-las-vegas}}
Iron bacteria slime showed up with application of hydrochloric acid at Las Vegas. The acid was needed to slightly reduce the pH to reduce the amount of encrustation in the distribution system. The addition of acid was correlated with the growth of a slime in the flocculator and sedimentation tanks. It was hypothesized that this slime was iron oxidizing bacteria (see \hyperref[\detokenize{Troubleshooting/Troubleshooting:figure-las-vegas-slime}]{Fig.\@ \ref{\detokenize{Troubleshooting/Troubleshooting:figure-las-vegas-slime}}}).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Las_Vegas_Slime}.jpg}
\caption{The slime at Las Vegas showed up in the flocculator and sedimentation tanks.}\label{\detokenize{Troubleshooting/Troubleshooting:id2}}\label{\detokenize{Troubleshooting/Troubleshooting:figure-las-vegas-slime}}\end{figure}

Iron oxidizing bacteria need oxygen and reduced iron. The Las Vegas water source is a stream that is clearly groundwater given its propensity to deposit calcium carbonate on everything in the stream. Thus the stream water is likely poor in oxygen.

We are adding oxygen at the LFOM. That oxygen can chemically oxidize the iron, but the rate of oxidation is a function of pH (see \hyperref[\detokenize{Troubleshooting/Troubleshooting:figure-oxygenation-vs-time}]{Fig.\@ \ref{\detokenize{Troubleshooting/Troubleshooting:figure-oxygenation-vs-time}}}). When we decrease the pH it slows the oxidation of iron and thus keeps a higher concentration of reduced iron available for bacteria to oxidize. Thus the LFOM adds oxygen needed by the iron oxidizing bacteria and the acid prevents the iron from being chemically oxidized.

\sphinxhref{https://njaes.rutgers.edu/pubs/fs516/}{The rate of iron oxidation is strongly pH dependent}
At pH 7.0, 90\% Fe+2 oxidation requires 1 hour at 21°C and 10 hours at 5°C.
At pH 8.0, 90\% Fe+2 oxidation occurs in 30 seconds.
At pH 6.0 it requires 100 hours.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{Oxygenation_vs_time}.png}
\caption{The time required for oxidation is strongly dependent on pH. From \sphinxhref{http://www.lenntech.com/iron-bacteria.htm}{Lenntech}.}\label{\detokenize{Troubleshooting/Troubleshooting:id3}}\label{\detokenize{Troubleshooting/Troubleshooting:figure-oxygenation-vs-time}}\end{figure}

For several reasons, routine chemical disinfectants that effectively wipe out other bacteria are only modestly successful against iron bacteria. Iron bacteria build up in thick layers, each forming a slime around bacterial cells that keeps disinfectants from penetrating beyond the surface cells. Chemical reactions occur far slower at the cool temperatures common in wells, and bacterial cell need a long exposure to the chemical for the treatment to be effective. Even if chlorine kills all the bacterial cells in the water, those in the groundwater can be drawn in by pumping or drift back into the well. \sphinxhref{http://www.lenntech.com/iron-bacteria.htm\#ixzz4ehUFJwO6}{Read more about chlorine and iron oxidizing bacteria}


\chapter{Proposed solutions to eliminate iron oxidizing slime bacteria}
\label{\detokenize{Troubleshooting/Troubleshooting:proposed-solutions-to-eliminate-iron-oxidizing-slime-bacteria}}\begin{description}
\item[{The solutions all revolve around oxidizing the iron chemically before the bacteria have a chance to oxidize the iron biologically.}] \leavevmode\begin{itemize}
\item {} 
Move the acid addition point to the end of the plant. This will allow chemical oxidation and removal of the iron. Note that once the iron is oxidized it precipitates as \(Fe(OH)_3\) and that is a wonderful coagulant. This is why the Las Vegas plant was shown to produce clean water even without addition of a coagulant!

\item {} 
It might be possible to move the acid addition point to the exit of the flocculator if the flocculation process provides enough time for iron oxidation

\item {} 
Create an aeration system upstream from the plant in the transmission line

\item {} 
Move chlorination to the rapid mix. This might work, but given the chlorine resistance of the slime and the disadvantages of prechlorination for production of disinfection by-products, we don’t recommend this.

\end{itemize}

\end{description}


\chapter{Introduction to RST and Sphinx for Textbook Contributors}
\label{\detokenize{Textbook_Creation_Help/rst_intro:introduction-to-rst-and-sphinx-for-textbook-contributors}}\label{\detokenize{Textbook_Creation_Help/rst_intro:title-rst-intro}}\label{\detokenize{Textbook_Creation_Help/rst_intro::doc}}

\section{What is RST?}
\label{\detokenize{Textbook_Creation_Help/rst_intro:what-is-rst}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-what-is-rst}}
RST stands for ReStructured Text. It is the standard markup language used for documenting python packages. \sphinxhref{http://www.sphinx-doc.org/en/master/}{Sphinx} is the Python package that generates an html website from RST files, and it is what we are using to generate this site. To read more about why we chose RST over markdown or Latex, read the following section, {\hyperref[\detokenize{Textbook_Creation_Help/rst_intro:heading-why-rst}]{\sphinxcrossref{\DUrole{std,std-ref}{Why RST?}}}}.


\subsection{Why RST?}
\label{\detokenize{Textbook_Creation_Help/rst_intro:why-rst}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-why-rst}}
In the beginning, we used markdown. As we tried to add different features to markdown (\DUrole{red}{colored words}, image sizes, citations), we were forced to use raw html and various pre-processors. With these various band-aid solutions came added complexity. Adding sections became cumbersome and awkward as it required ill-defined html. Additionally, providing site-wide style updates was prohibitively time-consuming and complex. Essentially, we were trying to pack too much functionality into markdown. In the search for an alternative, restructured text provided several advantages. Out of the box, RST supports globally-defined styles, figure numbering and referencing, Latex function rendering, image display customization and more. Furthermore, restructured text was already the language of choice for the AguaClara ecosystem’s documentation.


\section{Setting up RST for Development}
\label{\detokenize{Textbook_Creation_Help/rst_intro:setting-up-rst-for-development}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-setting-up-rst}}
There are two ways to \sphinxstyleemphasis{quickly} view an RST file. The first is using an \sphinxhref{https://ide.atom.io/}{Atom} plugin that renders the view alongside the source code. This is a good initial test to make sure the RST is proper RST and looks \sphinxstyleemphasis{mostly} correct. However, some functionality, such as any extensions provided by \sphinxhref{http://www.sphinx-doc.org/en/master/}{Sphinx} won’t run in the preview. In order to see the final html that will display on the website, you’ll need to use the second method, running sphinx locally to fully generate the html code. Once you are satisfied with your work and want to push it to the textbook, you’ll need to incorporate it to the master branch. To do so, refer to {\hyperref[\detokenize{Textbook_Creation_Help/rst_intro:publishing-online}]{\sphinxcrossref{Publishing online}}}.


\subsection{Installing the Atom Plugins}
\label{\detokenize{Textbook_Creation_Help/rst_intro:installing-the-atom-plugins}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-installing-atom}}
If you are using the Atom IDE to write RST, you can use the \sphinxhref{https://atom.io/packages/rst-preview-pandoc}{rst-preview-pandoc} plugin to auto-generate a live RST preview within atom (much like the markdown-preview-plus preview page.) To get rst-preview working, you’ll need to install \sphinxhref{https://atom.io/packages/language-restructuredtext}{language-restructuredtext} via atom and \sphinxhref{https://pandoc.org/installing.html}{Pandoc} via your command line (\sphinxcode{\sphinxupquote{\$pip install pandoc}}). If everything worked, you can use \sphinxcode{\sphinxupquote{ctrl + shift + e}} to toggle a display window for the live-updated RST preview.


\subsection{Building RST Locally with Sphinx}
\label{\detokenize{Textbook_Creation_Help/rst_intro:building-rst-locally-with-sphinx}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-building-rst-locally}}
We use \sphinxhref{http://www.sphinx-doc.org/en/master/}{Sphinx} to build RST locally and remotely. Follow these steps to get \sphinxhref{http://www.sphinx-doc.org/en/master/}{Sphinx} and run it locally:
\begin{enumerate}
\item {} 
Get \sphinxhref{https://www.python.org/downloads/}{Python 3.5+} and pipenv (\sphinxcode{\sphinxupquote{\$pip install pipenv}})

\item {} 
Install all dependencies and setup a virtual environment with \sphinxcode{\sphinxupquote{\$pipenv install}}

\item {} 
Whenever you want to issue commands, start your virtual environment with \sphinxcode{\sphinxupquote{\$pipenv shell}} - exit it with \sphinxcode{\sphinxupquote{\$exit}}

\item {} 
Generate all the html by navigating in the command line to the source directory /Textbook and creating the build in that directory with the command line \sphinxcode{\sphinxupquote{\$make html}}.

\item {} 
View the html generated in the /Textbook/\_build directory by copying the full file path of /Textbook/\_build/html/index.html and pasting it into your browser.

\end{enumerate}

\begin{sphinxadmonition}{note}{Note:}
Regarding \sphinxstylestrong{1.} the master branch for the package implementing disqus in sphinx \sphinxhref{https://github.com/Robpol86/sphinxcontrib-disqus/pull/7}{is broken}, which is why we use a non-standard pip/online installation. If you already have the incorrect sphinx-disqus version installed, uninstall it with \sphinxcode{\sphinxupquote{pip uninstall sphinxcontrib-disqus}} before installing the functioning version.
\end{sphinxadmonition}


\subsection{Publishing Online}
\label{\detokenize{Textbook_Creation_Help/rst_intro:publishing-online}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-publishing-online}}
We use \sphinxhref{https://travis-ci.org/}{Travis} to ensure this site will always contain functional builds. To publish online, you need to:
\begin{enumerate}
\item {} 
Always test your build by first :ref:{}` building RST locally \textless{}heading\_building\_rst\_locally\textgreater{}{}`, and then following the {\hyperref[\detokenize{Textbook_Creation_Help/rst_intro:heading-testing-online}]{\sphinxcrossref{\DUrole{std,std-ref}{testing online}}}} instructions. Once you like how your build looks, follow the steps below to introduce it into the master branch.

\item {} 
Submit a \sphinxhref{https://github.com/AguaClara/Textbook/pulls}{pull request to master}. You’ll need to ask for someone else to review your work at this stage- “request reviewers”. Every pull request \sphinxstylestrong{must} be reviewed by at least one other person.

\item {} 
\sphinxhref{https://travis-ci.org/}{Travis} will build the site using \sphinxhref{http://www.sphinx-doc.org/en/master/}{Sphinx}, and if there aren’t any errors, Travis will report success to GitHub on the “checks” part of the pull request.

\item {} 
All your requested reviewers must now approve and comment on  your commit before the merge is allowed.

\item {} 
Once the PR passes Travis and is approved by another author, feel free to “merge to master.”

\item {} \begin{description}
\item[{To release the master branch, (build the html, pdf, and latex, and upload the pdf to Pages) you’ll need to publish a \sphinxhref{https://github.com/AguaClara/Textbook/releases/new}{GitHub release}. Include a \sphinxhref{https://semver.org/}{semver} version number as the tag (under “Tag: Choose or create”), and a brief description of the updates under “Release Title”. Finally, for the description, detail the changes as much as you see fit and when ready, hit “Publish release”. Example:}] \leavevmode\begin{itemize}
\item {} 
Tag name: 0.1.5

\item {} 
Release title: Filtration section maintenance

\item {} 
Description: Added filter code from aguaclara 0.2.6. Also updated all broken external links.

\end{itemize}

\end{description}

\item {} 
Travis will rebuild the site and push the html to Pages, and the PDF and LaTeX to GitHub Releases under the tag name.

\end{enumerate}

\begin{sphinxadmonition}{important}{Important:}
If your changes to the master branch aren’t pushing to gh-pages, then check the status of the \sphinxhref{https://travis-ci.org/AguaClara/Textbook}{Travis build here}.
\end{sphinxadmonition}


\subsection{Building PDF Locally}
\label{\detokenize{Textbook_Creation_Help/rst_intro:building-pdf-locally}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-building-pdf-locally}}
To check errors with the PDF generation more quickly, it may be worthwhile to setup your local machine to build the PDF.

Now you should be able to run \sphinxcode{\sphinxupquote{./build\_pdf}} to run the build\_pdf bash script within the root of the Textbook repo.

\sphinxstylestrong{If you are on Windows, you’ll need to use a POSIX shell, such as git bash, Cygwin, etc…}


\subsection{Testing Online}
\label{\detokenize{Textbook_Creation_Help/rst_intro:testing-online}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-testing-online}}
To test exactly what will be published, we have a test branch. The test branch is built by Travis and contains all the processed html that Travis produces in \_build/html. This branch is populated when ANY COMMIT IS PUSHED. Meaning, the last commit to be pushed, if it passes the Travis tests, will be built and the output will be placed in the test branch. Also, if the PDF=True environment variable is triggered for a Travis build, the PDF will also be generated and placed in the test branch. To do this, use the “Trigger Build” option in Travis and put:

\fvset{hllines={, ,}}%
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{script}\PYG{p}{:}
    \PYG{o}{\PYGZhy{}} \PYG{n}{PDF}\PYG{o}{=}\PYG{k+kc}{True}
\end{sphinxVerbatim}

\sphinxhref{https://rawgit.com/AguaClara/Textbook/test/html/index.html}{The website output is viewable here}.


\subsection{Sharing Test Output}
\label{\detokenize{Textbook_Creation_Help/rst_intro:sharing-test-output}}
if you want to share what your latest branch developments look like without having whoever is viewing it actually have to build it, you can push a commit, and find the \sphinxhref{https://rawgit.com/}{rawgit URL with this site} by entering the URL of the git file within the test branch that you’d like to share. Furthermore, if you want to point to the commit so that even if someone else pushes, the URL will still point to the code you intend it to, make sure to include the commit SHA within the rawgit URL like so: \sphinxurl{https://rawgit.com/AguaClara/Textbook/e5693e0485702b95e11d4d6bdf76d07c42fdbf99/html/index.html}. That link will never change where it is pointing. To share the PDF output, follow the {\hyperref[\detokenize{Textbook_Creation_Help/rst_intro:heading-testing-online}]{\sphinxcrossref{\DUrole{std,std-ref}{testing online}}}} instructions to build the PDF, and point to the commit with the PDF. Happy testing!


\section{Brief Best Practices}
\label{\detokenize{Textbook_Creation_Help/rst_intro:brief-best-practices}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-brief-best-practices}}
When writing RST, there are often many ways to write the same thing. Almost always, the way with the fewest number of characters is the best way. Ideally, never copy and paste.


\subsection{How do I write RST?}
\label{\detokenize{Textbook_Creation_Help/rst_intro:how-do-i-write-rst}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-how-do-i-write-rst}}
RST is friendly to learn and powerful. There are many useful cheatsheets, like \sphinxhref{https://thomas-cokelaer.info/tutorials/sphinx/rest\_syntax.html\#inserting-code-and-literal-blocks}{this one} and the next page on this site: \DUrole{xref,std,std-ref}{Functionality in RST and AguaClara Convention}, which is specifically for AguaClara and this textbook project. When you start writing RST, look at the cheat sheets all the time. Use \sphinxcode{\sphinxupquote{ctrl-f}} all the time to find whatever you need.

\sphinxstylestrong{Things not covered in most cheat sheets which are of critical importance:}
\begin{itemize}
\item {} 
A document is referred to by its title, as defined between the \sphinxcode{\sphinxupquote{*****}} signs at the top of the page, \sphinxstylestrong{NOT} the filename. So it is critical to have a title.

\item {} 
Anything else you’d like to add for the future…

\end{itemize}


\subsection{Example to Start From}
\label{\detokenize{Textbook_Creation_Help/rst_intro:example-to-start-from}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-example-to-start-from}}
This file is written in RST. You can start there! Just click on “View page source” at the top of the page.

Also, the next page contains the convention, and is where we specify all AguaClara RST best practices: \DUrole{xref,std,std-ref}{Functionality in RST and AguaClara Convention}. I recommend looking at the raw RST and the rendered html side by side.


\section{Converting Markdown to RST}
\label{\detokenize{Textbook_Creation_Help/rst_intro:converting-markdown-to-rst}}\label{\detokenize{Textbook_Creation_Help/rst_intro:heading-converting-md-to-rst}}
Ideally, use pandoc to do the conversion in the command line: \sphinxcode{\sphinxupquote{pandoc -{-}from=markdown -{-}to=rst -{-}output=my\_file.rst my\_file.md}}.
Raw html will not be converted (because it is not actually markdown), and tables are converted poorly.
You’ll need to carefully review any page converted with pandoc.


\chapter{Parameter Convention List}
\label{\detokenize{Textbook_Creation_Help/parameter_convention_list:parameter-convention-list}}\label{\detokenize{Textbook_Creation_Help/parameter_convention_list:title-parameter-convention-list}}\label{\detokenize{Textbook_Creation_Help/parameter_convention_list::doc}}

\begin{savenotes}\sphinxattablestart
\centering
\sphinxcapstartof{table}
\sphinxcaption{Relevant Dimensions}\label{\detokenize{Textbook_Creation_Help/parameter_convention_list:id3}}\label{\detokenize{Textbook_Creation_Help/parameter_convention_list:table-dimension-table}}
\sphinxaftercaption
\begin{tabular}[t]{|\X{30}{90}|\X{30}{90}|\X{30}{90}|}
\hline
\sphinxstyletheadfamily 
Dimension
&\sphinxstyletheadfamily 
Abbreviation
&\sphinxstyletheadfamily 
Base Unit
\\
\hline
Length
&
\([L]\)
&
meter
\\
\hline
Mass
&
\([M]\)
&
kilogram
\\
\hline
Time
&
\([T]\)
&
second
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

If you would like to be able to \sphinxcode{\sphinxupquote{ctrl+f}} some variables, click on ‘View page source’ on the top right of this window. If you want to know what a Greek variable is but don’t know what it’s called, you can view the source text on the file where you found the variable. nu, mu, eta, who actually remembers what these all look like? The letter ‘v’ should sue ‘nu’ for copyright infringement. Or is it the other way around?


\begin{savenotes}\sphinxatlongtablestart\begin{longtable}{|\X{10}{50}|\X{30}{50}|\X{10}{50}|}
\caption{Parameter Guide\strut}\label{\detokenize{Textbook_Creation_Help/parameter_convention_list:id4}}\label{\detokenize{Textbook_Creation_Help/parameter_convention_list:table-parameter-table}}\\*[\sphinxlongtablecapskipadjust]
\hline
\sphinxstyletheadfamily 
Parameter
&\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Units
\\
\hline
\endfirsthead

\multicolumn{3}{c}%
{\makebox[0pt]{\sphinxtablecontinued{\tablename\ \thetable{} -- continued from previous page}}}\\
\hline
\sphinxstyletheadfamily 
Parameter
&\sphinxstyletheadfamily 
Description
&\sphinxstyletheadfamily 
Units
\\
\hline
\endhead

\hline
\multicolumn{3}{r}{\makebox[0pt][r]{\sphinxtablecontinued{Continued on next page}}}\\
\endfoot

\endlastfoot

Uppercase letters
&&\\
\hline
\(A\)
&
Area
&
\([L]^2\)
\\
\hline
\(A_{floc}\)
&
Projected cross sectional area of particle
&
\([L]^2\)
\\
\hline
:math:{\color{red}\bfseries{}{}`}A\_p {}`
&
Plan view area
&
\([L]^2\)
\\
\hline
\(B\)
&
Center-to-Center Spacing Between Two Objects
&
\([L]\)
\\
\hline
\(C\)
&
Concentration
&
\(\frac{[M]}{[L]^3}\)
\\
\hline
\(C_D\)
&
Drag coefficient
&
Dimensionless
\\
\hline
\(D\)
&
Diameter
&
\([L]\)
\\
\hline
\(D_0\)
&
Diameter of clay primary particle
&
\([L]\)
\\
\hline
\(D_{fractal}\)
&
Fractal Dimension
&
Dimensionless
\\
\hline
\(F\)
&
Force
&
\(\frac{[M][L]}{[T]^2}\)
\\
\hline
\(G\)
&
Velocity Gradient/Fluid Deformation
&
\(\frac{1}{[T]}\)
\\
\hline
\(G_{CS}\)
&
Camp Stein velocity gradient
&
\(\frac{1}{[T]}\)
\\
\hline
\(G\theta\)
&
Collision potential
&
Dimensionless
\\
\hline
\(H\)
&
Height
&
\([L]\)
\\
\hline
\(H_c\)
&
Critical height
&
\([L]\)
\\
\hline
\(H_e\)
&
Distance Between Flow Expansions in a Flocculator
&
\([L]\)
\\
\hline
\(H_{fb}\)
&
Height of the floc blanket
&
\([L]\)
\\
\hline
\(K\)
&
Minor Loss coefficient
&
Dimensionless
\\
\hline
\(L\)
&
Length
&
\([L]\)
\\
\hline
\(L_{SedActive}\)
&
Length of the plate settlers in the sedimentation tank (not including the triangle at the end of the tank)
&
\([L]\)
\\
\hline
\(L_{fb}\)
&
Length of the floc blanket in a sedimentation tank
&
\([L]\)
\\
\hline
\(M\)
&
Fluid Momentum
&
\(\frac{[M][L]}{[T]^2}\)
\\
\hline
\(P\)
&
Power
&
\(\frac{[M][L]^2}{[T]^3}\)
\\
\hline
\(Q\)
&
Flow rate
&
\(\frac{[L]^3}{[T]}\)
\\
\hline
\(Q_{diff}\)
&
Flow rate through each diffuser
&
\(\frac{[L]^3}{[T]}\)
\\
\hline
\(Q_{Sed}\)
&
Flow rate through each sedimentation tank
&
\(\frac{[L]^3}{[T]}\)
\\
\hline
\({\rm Re}\)
&
Reynolds Number
&
Dimensionless
\\
\hline
\(S\)
&
Spacing Between Two Objects
&
\([L]\)
\\
\hline
\(T\)
&
Object Thickness
&
\([L]\)
\\
\hline
\(\rlap{--} V\)
&
Volume
&
\([L]^3\)
\\
\hline
\(W\)
&
Width
&
\([L]\)
\\
\hline
\(W_{diff,min}\)
&
Minimum internal width of diffuser
&
\([L]\)
\\
\hline
\(W_{floc}\)
&
Gravitational weight of floc
&
\(\frac{[M][L]}{[T]^2}\)
\\
\hline
\(W_{Sed}\)
&
Width of each sedimentation tank
&
\([L]\)
\\
\hline
Lowercase letters
&&\\
\hline
\(\rm{f}\)
&
Darcy-Weisbach friction factor
&
Dimensionless
\\
\hline
\(\frac{du}{dy}\)
&
Velocity gradient between plate settlers
&
\(\frac{1}{[T]}\)
\\
\hline
\(g\)
&
Acceleration due to Gravity
&
\(\frac{[L]}{[T]^2}\)
\\
\hline
\(h\)
&
Head, Elevation
&
\([L]\)
\\
\hline
\(h_e\)
&
Minor Loss (expansion)
&
\([L]\)
\\
\hline
\(h_{\rm f}\)
&
Major Loss (friction)
&
\([L]\)
\\
\hline
\(h_L\)
&
Total headloss
&
\([L]\)
\\
\hline
\(h_{L,jet}\)
&
Head loss in jet leaving jet reverser
&
\([L]\)
\\
\hline
\(m\)
&
Mass
&
\([M]\)
\\
\hline
\(n\)
&
Number, Amount
&
Dimensionless
\\
\hline
\(p\)
&
Pressure
&
\(\frac{[M]}{[L][T]^2}\)
\\
\hline
\(r\)
&
Radius
&
\([L]\)
\\
\hline
\(t\)
&
Time
&
\([T]\)
\\
\hline
\(u\)
&
Velocity in the x-direction
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(v\)
&
Velocity
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(\bar v_{\alpha_{Plate}}\)
&
average fluid velocity between plate settlers
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(\bar v_{z_{Active}}\)
&
Upflow velocity of the water entering the plate settlers; vertical velocity in the ‘active’ region
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(\bar v_c\)
&
Capture velocity
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(\bar v_H\)
&
Horizontal velocity
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(\bar v_{jet}\)
&
Velocity of the jet exiting the diffuser
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(\bar v_{x_{Plate}}\)
&
Horizontal velocity through plate settlers
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(v_{particle}\)
&
Net velocity of a particle between plate settlers
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(v_{z_{Plate}}\)
&
Average vertical velocity of the water between the plate settlers
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(v_{Settle}\)
&
Settling velocity
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(v_{Slide}\)
&
Sedimentation velocity of floc between plate settlers
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(\bar v_{z_{FB}}\)
&
Average vertical velocity of the water through the floc blanket
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(v_t\)
&
Terminal velocity of particle
&
\(\frac{[L]}{[T]}\)
\\
\hline
\(z\)
&
Elevation
&
\([L]\)
\\
\hline
Greek lowercase letters
&&\\
\hline
\(\alpha\)
&
Angle of plate settler
&
Degrees
\\
\hline
\(\epsilon\)
&
Surface roughness
&
\([L]\)
\\
\hline
\(\varepsilon\)
&
Energy Dissipation Rate
&
\(\frac{[L]^2}{[T]^3}\)
\\
\hline
\(\eta_K\)
&
Kolmogorov Length Scale
&
\([L]\)
\\
\hline
\(\lambda_\nu\)
&
Inner Viscous Length Scale
&
\([L]\)
\\
\hline
\(\mu\)
&
Dynamic viscosity
&
\(\frac{[M]}{[T][L]}\)
\\
\hline
\(\nu\)
&
Kinematic viscosity
&
\(\frac{[L]^2}{[T]}\)
\\
\hline
\(\phi\)
&
Porosity
&
Dimensionless
\\
\hline
\(\phi_{fb}\)
&
Porosity of floc blanket
&
Dimensionless
\\
\hline
\(\rho\)
&
Density
&
\(\frac{[M]}{[L]^3}\)
\\
\hline
\(\theta\)
&
Residence Time
&
\([T]\)
\\
\hline
\(\tau\)
&
Shear
&
\(\frac{[L]}{[M][T]^2}\)
\\
\hline
Greek uppercase letters
&&\\
\hline
\(\Delta\)
&
Change in
&
Dimensionless
\\
\hline
\(\Lambda\)
&
Distance Between Particles
&
\([L]\)
\\
\hline
\(\Pi\)
&
Dimensionless Proportionality Ratio
&
Dimensionless
\\
\hline
\(\Pi_{Error}\)
&
Linearity Error Ratio
&
Dimensionless
\\
\hline
\(\Pi_{\bar \varepsilon}^{\varepsilon_{Max}}\)
&
\(\frac{\varepsilon_{Max}}{\bar \varepsilon}\) Ratio in a Reactor
&
Dimensionless
\\
\hline
\(\Pi_{\bar G}^{G_{Max}}\)
&
\(\frac{G_{Max}}{\bar G}\) Ratio in a Reactor
&
Dimensionless
\\
\hline
\(\Pi_{HS}\)
&
Height to Baffle Spacing in a Flocculator
&
Dimensionless
\\
\hline
\(\Pi_{K\nu}\)
&
Ratio of Inner Viscous Length Scale to Kolmogorov Length Scale
&
Dimensionless
\\
\hline
\(\Pi_{vc}\)
&
Vena Contracta Area Ratio
&
Dimensionless
\\
\hline
\end{longtable}\sphinxatlongtableend\end{savenotes}

\sphinxhref{https://github.com/AguaClara/Textbook/releases/latest}{PDF and LaTeX versions} %
\begin{footnote}[1]\sphinxAtStartFootnote
PDF and LaTeX versions may contain visual oddities because it is generated automatically. The website is the recommended way to read this textbook. \sphinxhref{https://github.com/AguaClara/Textbook}{Please visit our GitHub site} to submit an issue, contribute, or comment.
%
\end{footnote}.
\paragraph{\sphinxstylestrong{Notes}}

\begin{sphinxthebibliography}{BPMWSCIWSCUWS16}
\bibitem[BL13]{\detokenize{BL13}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-benjamin-water-2013}} 
Mark M. Benjamin and Desmond F. Lawler. \sphinxstyleemphasis{Water quality engineering: physical / chemical treatment processes}. Wiley, Hoboken, N.J., July 2013. ISBN 978-1-118-16965-0. URL: \sphinxurl{http://encompass.library.cornell.edu/cgi-bin/checkIP.cgi?access=gateway\_standard\%26url=http://search.ebscohost.com/login.aspx?direct=true\&scope=site\&db=nlebk\&db=nlabk\&AN=631668}.
}
\bibitem[BB98]{\detokenize{BB98}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-boller-particles-1998}} 
Markus Boller and Stefan Blaser. Particles under stress. \sphinxstyleemphasis{Water Science and Technology}, 37(10):9\textendash{}29, May 1998. URL: \sphinxurl{http://wst.iwaponline.com/content/37/10/9}.
}
\bibitem[DC08]{\detokenize{DC08}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-davis-introduction-2008}} 
Mackenzie Leo Davis and David A Cornwell. \sphinxstyleemphasis{Introduction to Environmental Engineering.} McGraw-Hill Companies, Dubuque, IA, 4th edition, 2008. ISBN 978-0-07-242411-9 978-0-07-125922-4 978-7-302-15210-1. OCLC: 70708094.
}
\bibitem[GWSL16]{\detokenize{GWSL16}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-garland-revisiting-2016}} 
Casey Garland, Monroe Weber-Shirk, and Leonard W. Lion. Revisiting Hydraulic Flocculator Design for Use in Water Treatment Systems with Fluidized Floc Beds. \sphinxstyleemphasis{Environmental Engineering Science}, 34(2):122\textendash{}129, August 2016. URL: \sphinxurl{http://online.liebertpub.com/doi/abs/10.1089/ees.2016.0174}, \sphinxhref{https://doi.org/10.1089/ees.2016.0174}{doi:10.1089/ees.2016.0174}.
}
\bibitem[Gra95]{\detokenize{Gra95}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-granger-fluid-1995}} 
Robert Alan Granger. \sphinxstyleemphasis{Fluid Mechanics}. Dover Publications, New York, 1995. ISBN 978-1-62198-654-6 1-62198-654-3.
}
\bibitem[ML00]{\detokenize{ML00}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-mcconnachie-design-2000}} 
G. L. McConnachie and J. Liu. Design of baffled hydraulic channels for turbulence-induced flocculation. \sphinxstyleemphasis{Water Research}, 34(6):1886\textendash{}1896, April 2000. URL: \sphinxurl{http://www.sciencedirect.com/science/article/pii/S0043135499003292}, \sphinxhref{https://doi.org/10.1016/S0043-1354(99)00329-2}{doi:10.1016/S0043-1354(99)00329-2}.
}
\bibitem[MCM+12]{\detokenize{MCM+12}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-mertens-polyaluminum-2012}} 
Jasmin Mertens, Barbara Casentini, Armand Masion, Rosemarie Pöthig, Bernhard Wehrli, and Gerhard Furrer. Polyaluminum chloride with high Al30 content as removal agent for arsenic-contaminated well water. \sphinxstyleemphasis{Water Research}, 46(1):53\textendash{}62, January 2012. URL: \sphinxurl{http://www.sciencedirect.com/science/article/pii/S0043135411006294}, \sphinxhref{https://doi.org/10.1016/j.watres.2011.10.031}{doi:10.1016/j.watres.2011.10.031}.
}
\bibitem[PCWSL16]{\detokenize{PCWSL16}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-pennock-theoretical-2016}} 
William H. Pennock, Felice C. Chan, Monroe L. Weber-Shirk, and Leonard W. Lion. Theoretical Foundation and Test Apparatus for an Agent-Based Flocculation Model. \sphinxstyleemphasis{Environmental Engineering Science}, July 2016. URL: \sphinxurl{http://online.liebertpub.com/doi/abs/10.1089/ees.2015.0558}, \sphinxhref{https://doi.org/10.1089/ees.2015.0558}{doi:10.1089/ees.2015.0558}.
}
\bibitem[SWSL15]{\detokenize{SWSL15}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-sun-characterization-2015}} 
Siwei Sun, Monroe Weber-Shirk, and Leonard W. Lion. Characterization of Flocs and Floc Size Distributions Using Image Analysis. \sphinxstyleemphasis{Environmental Engineering Science}, 33(1):25\textendash{}34, November 2015. URL: \sphinxurl{http://online.liebertpub.com/doi/10.1089/ees.2015.0311}, \sphinxhref{https://doi.org/10.1089/ees.2015.0311}{doi:10.1089/ees.2015.0311}.
}
\bibitem[SWSL13]{\detokenize{SWSL13}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-swetland-influence-2013}} 
Karen A. Swetland, Monroe L. Weber-Shirk, and Leonard W. Lion. Influence of Polymeric Aluminum Oxyhydroxide Precipitate-Aggregation on Flocculation Performance. \sphinxstyleemphasis{Environmental Engineering Science}, 30(9):536\textendash{}545, September 2013. URL: \sphinxurl{http://online.liebertpub.com/doi/abs/10.1089/ees.2012.0199}, \sphinxhref{https://doi.org/10.1089/ees.2012.0199}{doi:10.1089/ees.2012.0199}.
}
\bibitem[SWSL14]{\detokenize{SWSL14}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-swetland-flocculation-sedimentation-2014}} 
Karen A. Swetland, Monroe L. Weber-Shirk, and Leonard W. Lion. Flocculation-Sedimentation Performance Model for Laminar-Flow Hydraulic Flocculation with Polyaluminum Chloride and Aluminum Sulfate Coagulants. \sphinxstyleemphasis{Journal of Environmental Engineering}, 140(3):04014002, March 2014. URL: \sphinxurl{http://ascelibrary.org/doi/10.1061/\%28ASCE\%29EE.1943-7870.0000814}, \sphinxhref{https://doi.org/10.1061/(ASCE)EE.1943-7870.0000814}{doi:10.1061/(ASCE)EE.1943-7870.0000814}.
}
\bibitem[WZL+15]{\detokenize{WZL+15}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-wei-coagulation-2015}} 
Ning Wei, Zhongguo Zhang, Dan Liu, Yue Wu, Jun Wang, and Qunhui Wang. Coagulation behavior of polyaluminum chloride: Effects of pH and coagulant dosage. \sphinxstyleemphasis{Chinese Journal of Chemical Engineering}, 23(6):1041\textendash{}1046, June 2015. URL: \sphinxurl{http://www.sciencedirect.com/science/article/pii/S1004954115000804}, \sphinxhref{https://doi.org/10.1016/j.cjche.2015.02.003}{doi:10.1016/j.cjche.2015.02.003}.
}
\bibitem[BPMWSCIWSCUWS16]{\detokenize{BPMWSCIWSCUWS16}}{\phantomsection\label{\detokenize{Flocculation/Floc_Model:floc-model-bp-mws-drinking-2016}} 
BP-MWS, CIWS, and CUWS. Drinking Water Quality Report 2016. Technical Report, Bolton Point Municipal Water System, City of Ithaca Water System, Cornell University Water System, Ithaca, NY, 2016. URL: \sphinxurl{https://energyandsustainability.fs.cornell.edu/file/AWQR\_2016\%20final.pdf}.
}
\bibitem[Haa98]{\detokenize{Haa98}}{\phantomsection\label{\detokenize{Flocculation/Floc_Design:floc-haarhoff-design-1998}} 
Johannes Haarhoff. Design of Around-the-End Hydraulic Flocculators. \sphinxstyleemphasis{Journal of Water Supply: Research and Technology - Aqua}, 47(3):142\textendash{}152, June 1998. URL: \sphinxurl{https://doi.org/10.2166/aqua.1998.20}.
}
\bibitem[HvdW01]{\detokenize{HvdW01}}{\phantomsection\label{\detokenize{Flocculation/Floc_Design:floc-haarhoff-towards-2001}} 
Johannes Haarhoff and Jeremia J. van der Walt. Towards Optimal Design Parameters for Around-the-End Hydraulic Flocculators. \sphinxstyleemphasis{Journal of Water Supply: Research and Technology - Aqua}, 50(3):149\textendash{}159, 2001.
}
\end{sphinxthebibliography}



\renewcommand{\indexname}{Index}
\printindex
\end{document}