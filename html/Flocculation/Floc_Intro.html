

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Flocculation Introduction &mdash; AguaClara Textbook  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Flocculation Design" href="Floc_Design.html" />
    <link rel="prev" title="Rapid Mix Theory and Future Work" href="../Rapid_Mix/RM_Theory_and_Future_Work.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> AguaClara Textbook
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Acknowledgements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Authors.html">Authors</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributor's guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Textbook_Creation_Help/rst_intro.html">Introduction to RST and Sphinx for Textbook Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Textbook_Creation_Help/example_aguaclara_rst.html">Functionality in RST and AguaClara Convention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Textbook_Creation_Help/parameter_convention_list.html">Parameter Convention List</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 1: Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Introduction/Introduction.html">Introduction to AguaClara Water Treatment Design</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 1.1: Review: Fluid Mechanics and Python</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Review/Review_Fluid_Mechanics.html">Review: Fluid Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Review/Review_Fluid_Mechanics_Derivations.html">Review: Fluid Mechanics Derivations</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 3: Flow Control and Measurement</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Flow_Control_and_Measurement/FCM_Intro.html">Flow Control and Measurement Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Flow_Control_and_Measurement/FCM_Design.html">Flow Control and Measurement Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Flow_Control_and_Measurement/FCM_Derivations.html">Flow Control and Measurement Derivations</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 4: Rapid Mix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Rapid_Mix/RM_Intro.html">Rapid Mix Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Rapid_Mix/RM_Design.html">Rapid Mix Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Rapid_Mix/RM_Derivations.html">Rapid Mix Derivations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Rapid_Mix/RM_Examples.html">Rapid Mix Appendix C: Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Rapid_Mix/RM_Theory_and_Future_Work.html">Rapid Mix Theory and Future Work</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 5: Flocculation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Flocculation  Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#flocculation">Flocculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#primary-particles-cant-attach-to-large-flocs">Primary particles can’t attach to large flocs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#history">History</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Floc_Design.html">Flocculation Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="Floc_Derivations.html">Flocculation Derivations</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 6: Sedimentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Sedimentation/Sed_Intro.html">Sedimentation Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sedimentation/Sed_Examples.html">Sedimentation Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sedimentation/Sed_Theory_and_Future_Work.html">Sedimentation Theory and Future Work</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 8: Filtration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Filtration/Filtration_Design.html">Filtration Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Filtration/Filtration_Derivations.html">Filtration Derivations</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 9: Dissolved Gas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Dissolved_Gas/DG_Intro.html">Dissolved Gas Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">Chapter 10: Troubleshooting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Troubleshooting/Troubleshooting.html">Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Troubleshooting/Troubleshooting.html#solutions">Solutions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AguaClara Textbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Flocculation  Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Flocculation/Floc_Intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flocculation-introduction">
<span id="title-flocculation-introduction"></span><h1>Flocculation  Introduction<a class="headerlink" href="#flocculation-introduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="flocculation">
<h2>Flocculation<a class="headerlink" href="#flocculation" title="Permalink to this headline">¶</a></h2>
<p>Flocculation transform inorganic (clays such as <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0048969708010103">kaolinite, smectite, etc. and metallic oxy-hydroxides such as goethite and gibbsite</a>) and organic (viruses, bacteria and protozoa) primary particles into flocs (particle aggregates). Flocculation doesn’t remove any particles from suspension. Instead it causes particle aggregation and then floc blankets, lamellar sedimentation, and sand filtration will be used to separate those flocs from the water. Sedimentation can remove flocs more easily than it can remove primary particles because flocs have a higher terminal sedimentation velocity. Floc blankets and sand filtration rely primarily on capture based on interception and interception is much more efficient when the particles are larger. Thus the purpose of flocculation is to join <strong>all</strong> of the primary particles together into flocs.</p>
<p>It is also possible that a difference in a physical property between primary particles and flocs plays a role in enhanced removal of flocs in floc blankets and filters. For example, the many relatively weak connection points between the primary particles in the flocs enables the flocs to deform. It is possible that deformation plays an important role right at the moment of collision. Presumably the bond strength required to lock the colliding particles together is less if the particles can deform as they are colliding.</p>
<div class="section" id="primary-particles-cant-attach-to-large-flocs">
<h3>Primary particles can’t attach to large flocs<a class="headerlink" href="#primary-particles-cant-attach-to-large-flocs" title="Permalink to this headline">¶</a></h3>
<p>One of the mysteries of flocculation has been why it is such a slow process and yet it appears to be a very rapid process. Plant operators observe that with high raw water turbidities that they can see flocculation progressing after about 0.5 minutes of flocculation. We can estimate the collision potential, <span class="math notranslate nohighlight">\(G\theta\)</span> that corresponds to making visible flocs.</p>
<div class="math notranslate nohighlight" id="equation-flocculation-floc-intro-0">
<span class="eqno">(304)<a class="headerlink" href="#equation-flocculation-floc-intro-0" title="Permalink to this equation">¶</a></span>\[\bar G = \sqrt{ \frac{g h_e}{\theta \nu}}\]</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aide_design.play</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">aguaclara_research.play</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">pytexit</span> <span class="k">import</span> <span class="n">py2tex</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">root</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">brentq</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">HL_floc</span> <span class="o">=</span> <span class="mi">43</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span>
<span class="n">HRT</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">min</span>
<span class="n">Temperature</span> <span class="o">=</span><span class="mi">20</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">degC</span>
<span class="n">G_floc</span> <span class="o">=</span> <span class="p">((</span><span class="n">pc</span><span class="o">.</span><span class="n">gravity</span><span class="o">*</span><span class="n">HL_floc</span><span class="o">/</span><span class="p">(</span><span class="n">HRT</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">viscosity_kinematic</span><span class="p">(</span><span class="n">Temperature</span><span class="p">)))</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">G_floc</span><span class="p">)</span>
<span class="n">Gt_floc</span> <span class="o">=</span> <span class="n">G_floc</span><span class="o">*</span><span class="n">HRT</span>
<span class="n">HRT_floc_visible</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">min</span>
<span class="n">Gt_floc_visible</span> <span class="o">=</span> <span class="p">(</span><span class="n">G_floc</span><span class="o">*</span><span class="n">HRT_floc_visible</span><span class="p">)</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Gt_floc_visible</span><span class="p">)</span>
</pre></div>
</div>
<p>Here initial flocculation is visible at a <span class="math notranslate nohighlight">\(G\theta\)</span> of less than 3000. Given that flocculation is visible at this low collision potential, it is unclear why recommended <span class="math notranslate nohighlight">\(G\theta\)</span> are as high as 100,000. This is one of the great mysteries that motivated the search for a flocculation model that was based on hypotheses that were consistent with laboratory and field observations.</p>
</div>
</div>
<div class="section" id="history">
<h2>History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>The mechanism of particle-particle aggregation was thought to be controlled by an average surface charge. Apparently no one was able to develop a model of how that mechanism would influence particle attachment efficiency and the result was that no predictive models for flocculation were developed. There were several observations that were at odds with conventional explanations of flocculation.</dt>
<dd>1. Efficient flocculation at coagulant dosages that led to positive surface charge. This led to a second flocculation mechanism that was called “sweep floc” and that was used to describe any observations that didn’t fit the charge neutralization flocculation hypotheses
1. Flocculation time for highly turbid suspensions was expected to proceed very rapidly and produce very low turbidity settled water. This expectation was not observed and led to the hypothesis that flocs were continually breaking up and producing primary particles or at least very small flocs.
1. The floc break up hypotheses led to the expectation that high turbidity suspensions would have significantly higher settled water turbidity than low turbidity suspensions. This expectation was also not observed.</dd>
</dl>
<p>Evidence that the charge neutralization hypothesis doesn’t explain flocculation of surface waters has been accumulating for decades. <em>Sweep</em> flocculation has been proposed as an alternative “mechanism” that described common observations that didn’t fit the charge neutralization hypothesis. However, similar to the charge neutralization hypothesis, the <em>sweep</em> hypothesis didn’t result in the development of predictive equations to describe the process.</p>
<p>For example, in 1992 Ching, Tanaka, and Elimelech published their research on <a class="reference external" href="https://doi.org/10.1016/0043-1354(94)90007-8">Dynamics of coagulation of kaolin particles with ferric chloride</a>. They found
that the electrophoretic mobility which is a measure of the clay particle surface charge was never neutralized at pH 7.8 and was neutralized at <span class="math notranslate nohighlight">\(10\mu M\)</span> at pH 6.0. The results were interpreted by the authors to mean that some combination of sweep floc and charge patchiness was responsible for the observed results.</p>
<p>See <a class="reference internal" href="#figure-ching-electrophoretic-mobility-vs-ferric-chloride"><span class="std std-numref">Fig. 71</span></a> for a typical mountain view.</p>
<div class="figure align-center" id="id1">
<span id="figure-ching-electrophoretic-mobility-vs-ferric-chloride"></span><a class="reference internal image-reference" href="../_images/Ching_Electrophoretic_Mobility_vs_Ferric_Chloride.png"><img alt="internal figure" src="../_images/Ching_Electrophoretic_Mobility_vs_Ferric_Chloride.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 71 </span><span class="caption-text"><cite>Electrophoretic_Mobility for final pH (after coagulant addition) of 6.0 and 7.8 as a function of :math:`FeCl_3</cite> dose &lt;<a class="reference external" href="https://doi.org/10.1016/0043-1354(94)90007-8">https://doi.org/10.1016/0043-1354(94)90007-8</a>&gt;`__</span></p>
</div>
<div class="figure align-center" id="id2">
<span id="figure-ching-residual-turbidity-vs-ferric-chloride"></span><a class="reference internal image-reference" href="../_images/Ching_Residual_Turbidity_vs_Ferric_Chloride.png"><img alt="internal figure" src="../_images/Ching_Residual_Turbidity_vs_Ferric_Chloride.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 72 </span><span class="caption-text"><a class="reference external" href="https://doi.org/10.1016/0043-1354(94)90007-8">The settled water turbidity was almost independent of pH even though the electrophoretic mobility was quite different for the two pH values tested</a>.</span></p>
</div>
<p><a class="reference external" href="https://doi.org/10.1016/0043-1354(94)90007-8">At pH 6.0 the ferric hydroxide precipitates are positively charged and at pH 7.8 they are close to neutral</a>. Thus it is apparent that neutralization of the clay surface charge can not explain
these results.</p>
<p><a class="reference external" href="https://doi.org/10.1016/0043-1354(94)90007-8">Figure x. Settled water turbidity (jar tests) for final pH (after coagulant addition) of 6.0 and 7.8.</a></p>
<p>Electrostatic charge neutralization hypothesis The coagulant precipitate self aggregates – this is inconsistent with the positive charge that the electrostatic hypothesis asserts will prevent aggregation * Electrostatic repulsion extends only a few nm from the surface of a particle – and the coagulant adhesive nanoparticles are many times larger than the reach of the repulsive electrostatic force. The hypothesis that London van der Waals forces result in attachment neglects to account for the presence of water in the system. Water molecules will also be attracted to surfaces by London van der Waals forces and thus there will be competition between the coagulant and water. Thus eliminating repulsion is NOT sufficient to produce a bond between the particles. (see <a class="reference external" href="https://vtechworks.lib.vt.edu/bitstream/handle/10919/30137/Chapter1.pdf?sequence=9">hydration repulsion, page 21</a>) ` “The theory of DLP was a great step forward in that it appeared to circumvent the whole intractable problem of many body forces through its use of measured bulk dielectric response functions. However, it must be stressed again that it is a perturbation theory. That is, it depends on the assumption that an intervening liquid between interacting surfaces has bulk liquid properties up to a molecular distance from the surfaces. This is thermodynamically inconsistent, being equivalent to the statement that surface energies (or alternatively, the positions of the Gibbs dividing surfaces) are changed infinitesimally with distance of separation. This limits the theory to large distances (Young–Laplace vs. Poisson again) where large is undefined.” &lt;<a class="reference external" href="https://doi.org/10.1016/S0001-8686(99)00008-1">https://doi.org/10.1016/S0001-8686(99)00008-1</a>&gt;`__</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%</span>
<span class="c1">#Assumptions</span>
<span class="n">Pi_VC</span> <span class="o">=</span> <span class="o">.</span><span class="mi">62</span> <span class="c1">#Vena contracta coefficient of an orifice</span>
<span class="n">Ke</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">Pi_VC</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#expansion coefficient</span>

<span class="c1">#Functions to calculate key parameters</span>

<span class="k">def</span> <span class="nf">Gave</span><span class="p">(</span><span class="n">G_theta</span><span class="p">,</span><span class="n">h_floc</span><span class="p">,</span><span class="n">Temp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates average G given target minimum collision potential, total headloss, and design temperature</span>
<span class="sd">    equation from flocculation slides&quot;&quot;&quot;</span>
    <span class="n">G_ave</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">gravity</span><span class="o">*</span><span class="n">h_floc</span><span class="o">/</span><span class="p">(</span><span class="n">G_theta</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">viscosity_kinematic</span><span class="p">(</span><span class="n">Temp</span><span class="p">)))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">G_ave</span>

<span class="k">def</span> <span class="nf">restime</span><span class="p">(</span><span class="n">G_theta</span><span class="p">,</span><span class="n">G_ave</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates residence time given collision potential and average G</span>
<span class="sd">    equation from flocculation slides&quot;&quot;&quot;</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">G_theta</span><span class="o">/</span><span class="n">G_ave</span>
    <span class="k">return</span> <span class="n">theta</span>


<span class="k">def</span> <span class="nf">Dpipe</span><span class="p">(</span><span class="n">Ke</span><span class="p">,</span><span class="n">Pi_HS</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">G_ave</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">SDR</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the actual inner diameter of the pipe</span>
<span class="sd">    equation from flocculation slides&quot;&quot;&quot;</span>
    <span class="n">D_pipe</span> <span class="o">=</span> <span class="p">((</span><span class="n">Ke</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Pi_HS</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">viscosity_kinematic</span><span class="p">(</span><span class="n">Temp</span><span class="p">)</span><span class="o">*</span><span class="n">G_ave</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Q</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">D_pipe</span>

<span class="k">def</span> <span class="nf">Keactual</span><span class="p">(</span><span class="n">ID_pipe</span><span class="p">,</span><span class="n">G_ave</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">Pi_HS</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;estimates actual expansion coefficient given the actual inner diameter and other relevant inputs</span>
<span class="sd">    equation from flocculation slides&quot;&quot;&quot;</span>
    <span class="n">Ke_actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">ID_pipe</span><span class="o">**</span><span class="mi">7</span><span class="o">*</span><span class="n">G_ave</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">pc</span><span class="o">.</span><span class="n">viscosity_kinematic</span><span class="p">(</span><span class="n">Temp</span><span class="p">)</span><span class="o">*</span><span class="n">Pi_HS</span><span class="o">/</span><span class="p">(</span><span class="mi">32</span><span class="o">*</span><span class="n">Q</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Ke_actual</span>



<span class="k">def</span> <span class="nf">Aorifice</span><span class="p">(</span><span class="n">ID_pipe</span><span class="p">,</span><span class="n">Ke_actual</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">Q</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the orifice area given pipe inner diameter, expansion coefficient, Temperature, and flow&quot;&quot;&quot;</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">area_circle</span><span class="p">(</span><span class="n">ID_pipe</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span> <span class="c1">#Pipe area</span>
    <span class="n">Nu</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">viscosity_kinematic</span><span class="p">(</span><span class="n">Temp</span><span class="p">)</span> <span class="c1">#kinematic viscocity</span>
    <span class="n">Re</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">re_pipe</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">ID_pipe</span><span class="p">,</span><span class="n">Nu</span><span class="p">)</span> <span class="c1">#reynolds number</span>

    <span class="k">def</span> <span class="nf">f_orif</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span><span class="n">A1</span><span class="p">,</span><span class="n">Ke_actual</span><span class="p">,</span><span class="n">Re</span><span class="p">):</span> <span class="c1">#root of this function is the orifice area</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">2.72</span><span class="o">+</span><span class="p">(</span><span class="n">A2</span><span class="o">/</span><span class="n">A1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4000</span><span class="o">/</span><span class="n">Re</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">A2</span><span class="o">/</span><span class="n">A1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">A1</span><span class="o">/</span><span class="n">A2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Ke_actual</span>

    <span class="n">A_orifice</span> <span class="o">=</span> <span class="p">(</span><span class="n">brentq</span><span class="p">(</span><span class="k">lambda</span> <span class="n">A2</span><span class="p">:</span> <span class="n">f_orif</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span><span class="n">A1</span><span class="p">,</span><span class="n">Ke_actual</span><span class="p">,</span><span class="n">Re</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">A1</span><span class="p">))</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#numerical optimization</span>

    <span class="k">return</span> <span class="n">A_orifice</span>


<span class="k">def</span> <span class="nf">eave</span><span class="p">(</span><span class="n">G_ave</span><span class="p">,</span><span class="n">Temp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the average energy dissipation rate&quot;&quot;&quot;</span>
    <span class="n">e_ave</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">viscosity_kinematic</span><span class="p">(</span><span class="n">Temp</span><span class="p">)</span><span class="o">*</span><span class="n">G_ave</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">mW</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">e_ave</span>

<span class="k">def</span> <span class="nf">Hchip</span><span class="p">(</span><span class="n">A_orifice</span><span class="p">,</span><span class="n">ID_pipe</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function calculates the height of the chip based on the orifice area and pipe diameter</span>
<span class="sd">    The function uses numerical optimization to solve the transcendental equation&quot;&quot;&quot;</span>
    <span class="n">A_flow</span> <span class="o">=</span> <span class="n">A_orifice</span><span class="o">.</span><span class="n">magnitude</span> <span class="c1">#orifice area stripped of units</span>
    <span class="n">r</span><span class="o">=</span><span class="p">(</span><span class="n">ID_pipe</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span> <span class="c1">#radius stripped of units</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">A_flow</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#left hand side of equation</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">):</span> <span class="c1">#roots of this function are theta</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">c</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">brentq</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> <span class="c1">#numerical optimization</span>
    <span class="n">r_u</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="c1">#radius with units</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r_u</span> <span class="o">-</span> <span class="n">r_u</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="c1">#height of orifice</span>

    <span class="n">H_chip</span> <span class="o">=</span> <span class="n">ID_pipe</span><span class="o">-</span><span class="n">y</span> <span class="c1">#height of chip</span>
    <span class="k">return</span> <span class="n">H_chip</span>

<span class="k">def</span> <span class="nf">Cost_Length</span><span class="p">(</span><span class="n">L_pipe</span><span class="p">,</span><span class="n">ND_pipe</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This function calculates the total cost of the system and the total length of the system&quot;&quot;&quot;</span>
    <span class="c1">#Length of pipe and number of fittings needed</span>
    <span class="n">OD_pipe</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">OD</span><span class="p">(</span><span class="n">ND_pipe</span><span class="p">)</span>
    <span class="n">Total_Pipe</span> <span class="o">=</span> <span class="n">L_pipe</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">m</span>
    <span class="n">Number_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">Total_Pipe</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>
    <span class="n">Number_Elbow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">Total_Pipe</span><span class="o">.</span><span class="n">magnitude</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ND_pipe</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">Cost_T</span> <span class="o">=</span> <span class="mf">3.94</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Cost_Elbow</span> <span class="o">=</span> <span class="mf">3.53</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Cost_Pipe</span> <span class="o">=</span> <span class="p">(</span><span class="mf">17.14</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">foot</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="n">Cost_Valve</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Width_T</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.99</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">inch</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
        <span class="n">Width_Elbow</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.97</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">inch</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">ND_pipe</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">==</span><span class="mi">4</span><span class="p">:</span>
        <span class="n">Cost_T</span> <span class="o">=</span> <span class="mf">7.16</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Cost_Elbow</span> <span class="o">=</span> <span class="mf">5.40</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Cost_Pipe</span> <span class="o">=</span> <span class="p">(</span><span class="mf">21.5</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">foot</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="n">Cost_Valve</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Width_T</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.06</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">inch</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
        <span class="n">Width_Elbow</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.06</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">inch</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ND_pipe</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">==</span><span class="mi">6</span><span class="p">:</span>
        <span class="n">Cost_T</span> <span class="o">=</span> <span class="mf">7.16</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Cost_Elbow</span> <span class="o">=</span> <span class="mf">5.40</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Cost_Pipe</span> <span class="o">=</span> <span class="p">(</span><span class="mf">21.5</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">foot</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
        <span class="n">Cost_Valve</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">dollar</span>
        <span class="n">Width_T</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.06</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">inch</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
        <span class="n">Width_Elbow</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5.06</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">inch</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>


    <span class="n">Total_Cost</span> <span class="o">=</span> <span class="n">Cost_Pipe</span><span class="o">*</span><span class="n">Total_Pipe</span> <span class="o">+</span> <span class="n">Cost_T</span><span class="o">*</span><span class="n">Number_T</span> <span class="o">+</span> <span class="n">Cost_Elbow</span><span class="o">*</span><span class="n">Number_Elbow</span> <span class="o">+</span> <span class="n">Cost_Valve</span><span class="o">*</span><span class="n">Number_Elbow</span>
    <span class="n">Floor_Length</span> <span class="o">=</span> <span class="n">Number_T</span><span class="o">*</span><span class="p">(</span><span class="n">Width_T</span><span class="o">+</span><span class="n">Width_Elbow</span><span class="o">-</span><span class="n">OD_pipe</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
    <span class="n">Output</span><span class="o">=</span><span class="p">[</span><span class="n">Total_Cost</span><span class="p">,</span><span class="n">Floor_Length</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Output</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Inputs</span>
<span class="n">D_Sed</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span>
<span class="n">A_Sed</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">area_circle</span><span class="p">(</span><span class="n">D_Sed</span><span class="p">)</span>
<span class="n">v_Sed</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mm</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_Sed</span><span class="o">*</span><span class="n">A_Sed</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">mL</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The flow rate is&#39;</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>

<span class="n">Temp</span> <span class="o">=</span> <span class="mi">15</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degC</span>
<span class="n">h_floc</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="c1">#standard for Aguaclara plants</span>
<span class="n">G_theta</span> <span class="o">=</span> <span class="mi">20000</span> <span class="c1">#standard for Aguaclara plants</span>
<span class="n">Pi_HS</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1">##3-6 is a good range, more research needed</span>
<span class="n">SDR</span> <span class="o">=</span> <span class="mi">41</span> <span class="c1">#Standard ratio</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate G average using functions listed above and given inputs</span>
<span class="n">G_ave</span> <span class="o">=</span> <span class="n">Gave</span><span class="p">(</span><span class="n">G_theta</span><span class="p">,</span><span class="n">h_floc</span><span class="p">,</span><span class="n">Temp</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">restime</span><span class="p">(</span><span class="n">G_theta</span><span class="p">,</span><span class="n">G_ave</span><span class="p">)</span>
<span class="n">e_ave</span> <span class="o">=</span> <span class="n">eave</span><span class="p">(</span><span class="n">G_ave</span><span class="p">,</span><span class="n">Temp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The average G value is &#39;</span><span class="p">,</span><span class="n">G_ave</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The residence time in the flocculator is &#39;</span><span class="p">,</span><span class="n">theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The average energy dissipation rate is &#39;</span><span class="p">,</span> <span class="n">e_ave</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the pipe diameter, both inner and nominal and determine area of pipe using inner diameter output</span>
<span class="n">D_pipe</span> <span class="o">=</span> <span class="p">(</span><span class="n">Dpipe</span><span class="p">(</span><span class="n">Ke</span><span class="p">,</span><span class="n">Pi_HS</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">G_ave</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">SDR</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
<span class="c1">#Calculate nominal diameter of pipe</span>
<span class="n">ND_pipe</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">ND_SDR_available</span><span class="p">(</span><span class="n">D_pipe</span><span class="p">,</span><span class="n">SDR</span><span class="p">)</span>
<span class="c1">#Calculate nominal diameter of pipe</span>
<span class="n">ID_pipe</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">ID_SDR</span><span class="p">(</span><span class="n">ND_pipe</span><span class="p">,</span><span class="n">SDR</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>

<span class="n">ID_pipe</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mm</span>
<span class="c1">#Calculate inner diameter of pipe</span>
<span class="n">A_pipe</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">area_circle</span><span class="p">(</span><span class="n">ID_pipe</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The ideal inner diameter of the pipe would be &#39;</span><span class="p">,</span><span class="n">D_pipe</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The nominal diameter of the pipe is &#39;</span><span class="p">,</span><span class="n">ND_pipe</span><span class="p">,</span> <span class="s1">&#39;, and the inner diameter is &#39;</span><span class="p">,</span> <span class="n">ID_pipe</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The area of the pipe is &#39;</span><span class="p">,</span> <span class="n">A_pipe</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the actual Ke as a result of the calculated inner pipe diameter</span>
<span class="n">Ke_actual</span> <span class="o">=</span> <span class="p">(</span><span class="n">Keactual</span><span class="p">(</span><span class="n">ID_pipe</span><span class="p">,</span><span class="n">G_ave</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">Pi_HS</span><span class="p">,</span><span class="n">Q</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">dimensionless</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The initial expansion minor loss coefficient was &#39;</span><span class="p">,</span><span class="n">Ke</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The actual expansion minor loss coefficient is &#39;</span><span class="p">,</span><span class="n">Ke_actual</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate the orifice area</span>
<span class="n">A_orifice</span> <span class="o">=</span> <span class="n">Aorifice</span><span class="p">(</span><span class="n">ID_pipe</span><span class="p">,</span><span class="n">Ke_actual</span><span class="p">,</span><span class="n">Temp</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The orifice area is &#39;</span><span class="p">,</span><span class="n">A_orifice</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># The following line of code needs to be removed once the orifice area equation is corrected.</span>

<span class="n">H_chip</span> <span class="o">=</span> <span class="n">Hchip</span><span class="p">(</span><span class="n">A_orifice</span><span class="p">,</span><span class="n">ID_pipe</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The height of the chip is &#39;</span><span class="p">,</span> <span class="n">H_chip</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Calculate average velocity</span>
<span class="n">v_avg</span> <span class="o">=</span> <span class="p">(</span><span class="n">Q</span><span class="o">/</span><span class="n">pc</span><span class="o">.</span><span class="n">area_circle</span><span class="p">(</span><span class="n">ID_pipe</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span> <span class="c1">#first calculate average velocity</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The average velocity is &#39;</span><span class="p">,</span><span class="n">v_avg</span><span class="p">)</span>

<span class="c1">#Calculate pipe length</span>
<span class="n">L_pipe</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_avg</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span> <span class="c1">#then multiply velocity by residence time to get the required length of pipe</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The length of the pipe is &#39;</span><span class="p">,</span><span class="n">L_pipe</span><span class="p">)</span>
</pre></div>
</div>
<p>#references <a class="reference external" href="https://www.iwapublishing.com/news/coagulation-and-flocculation-water-and-wastewater-treatment">Coagulation and Flocculation in Water and Wastewater Treatment</a>,
iwapublishing</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Floc_Design.html" class="btn btn-neutral float-right" title="Flocculation Design" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Rapid_Mix/RM_Theory_and_Future_Work.html" class="btn btn-neutral" title="Rapid Mix Theory and Future Work" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, AguaClara Cornell.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/mathjax_config.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>